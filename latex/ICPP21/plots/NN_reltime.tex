%!TEX root = ../paper.tex

\begin{tikzpicture}[scale=.58]
\begin{axis}[
	width=.5\textwidth,
	xmode=log,
	log basis x={2},
	xlabel=Dimension, 
	ylabel=\ifthenelse{\equal{\threads}{1}}{Relative Time}{},
	legend style={at={(1.02,.5)},anchor=west},
	xtick={512,1024,2048,4096,8192},
	xticklabels={512,1024,2048,4096,8192},
        /pgf/number format/.cd, 1000 sep={},
        reverse legend,
]
\addplot[color=black] table[x=n, y expr=\thisrow{dgemm}/\thisrow{dgemm}]{\datafile}; \addlegendentry{Classical}
\addplot table[x=n, y expr=\thisrow{dgemm}/\thisrow{bini322}]{\datafile}; \addlegendentry{$\dims{3,2,2}$}
\addplot table[x=n, y expr=\thisrow{dgemm}/\thisrow{schonhage333}]{\datafile}; \addlegendentry{$\dims{3,3,3;21}$}
\addplot table[x=n, y expr=\thisrow{dgemm}/\thisrow{smirnov224}]{\datafile}; \addlegendentry{$\dims{4,2,2}$}
\addplot table[x=n, y expr=\thisrow{dgemm}/\thisrow{smirnov323}]{\datafile}; \addlegendentry{$\dims{3,3,2}$}
\addplot table[x=n, y expr=\thisrow{dgemm}/\thisrow{smirnov225}]{\datafile}; \addlegendentry{$\dims{5,2,2}$}
\addplot table[x=n, y expr=\thisrow{dgemm}/\thisrow{smirnov442}]{\datafile}; \addlegendentry{$\dims{4,4,2}$}
\addplot table[x=n, y expr=\thisrow{dgemm}/\thisrow{smirnov334}]{\datafile}; \addlegendentry{$\dims{4,3,3}$}
\addplot table[x=n, y expr=\thisrow{dgemm}/\thisrow{smirnov552}]{\datafile}; \addlegendentry{$\dims{5,5,2}$}
\addplot table[x=n, y expr=\thisrow{dgemm}/\thisrow{smirnov444}]{\datafile}; \addlegendentry{$\dims{4,4,4}$}
\addplot table[x=n, y expr=\thisrow{dgemm}/\thisrow{smirnov555}]{\datafile}; \addlegendentry{$\dims{5,5,5}$}
\addplot[color=red,mark=triangle] table[x=n, y expr=\thisrow{dgemm}/\thisrow{smirnov272}]{\datafile}; \addlegendentry{$\dims{7,2,2}$}
\addplot[color=brown,mark=diamond] table[x=n, y expr=\thisrow{dgemm}/\thisrow{smirnov333}]{\datafile}; \addlegendentry{$\dims{3,3,3;20}$}
\ifthenelse{\equal{\threads}{12}}{}{\legend{}}
\end{axis}
\end{tikzpicture}
