2021-03-05 22:18:34.228053: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:18:34.784112: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:18:34.784547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:18:34.784830: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:18:34.785004: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:18:34.785187: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:18:34.785370: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:18:34.785542: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:18:34.785706: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:18:34.785869: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:18:34.785900: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:18:34.824204: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:18:34.824633: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9d2c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:18:34.824693: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:18:34.828187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:18:34.828215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:18:34.930431: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:18:34.930564: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:18:34.932495: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:18:34.932528: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:18:34.932577: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:18:34.932614: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:18:34.932657: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:18:34.932682: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:18:34.932697: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9d5f6774c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:20:41.105060: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:20:41.243271: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:20:41.756083: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_bini322512/plugins/profile/2021_03_05_22_20_41
2021-03-05 22:20:42.246146: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_bini322512/plugins/profile/2021_03_05_22_20_41/householder.trace.json.gz
2021-03-05 22:20:42.346189: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:20:42.383676: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 22:20:42.386206: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_bini322512/plugins/profile/2021_03_05_22_20_41Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_bini322512/plugins/profile/2021_03_05_22_20_41/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_bini322512/plugins/profile/2021_03_05_22_20_41/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_bini322512/plugins/profile/2021_03_05_22_20_41/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_bini322512/plugins/profile/2021_03_05_22_20_41/householder.kernel_stats.pb

Time for Epoch:26.820616006851196
Average single batch time this epoch: 0.22922930350670448
Running Average Epoch time: 24.935810565948486

Time for Epoch:24.935810565948486
Average single batch time this epoch: 0.21311980842525124
Running Average Epoch time: 24.683295249938965

Time for Epoch:24.430779933929443
Average single batch time this epoch: 0.20880384934254181
Running Average Epoch time: 24.83485460281372

Time for Epoch:25.137973308563232
Average single batch time this epoch: 0.2148477827381884
Running Average Epoch time: 24.833737909793854

Time for Epoch:24.830387830734253
Average single batch time this epoch: 0.21221893057863936
Average time per Batch: 0.2122475927711552
Average time per Epoch: 24.833737909793854
batch size 512
epochs 5
nodes 512
num layers 4
algorithm bini322
num threads 12
total time 127.69736647605896
2021-03-05 22:20:46.583859: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:20:47.139319: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:20:47.139763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:20:47.140037: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:20:47.140211: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:20:47.140430: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:20:47.140609: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:20:47.140779: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:20:47.140946: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:20:47.141107: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:20:47.141136: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:20:47.180209: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:20:47.180676: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2858000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:20:47.180761: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:20:47.185329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:20:47.185373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:20:47.290646: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:20:47.290761: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:20:47.291030: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:20:47.291079: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:20:47.291103: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:20:47.291140: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:20:47.291199: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:20:47.291226: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:20:47.291241: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f288e0e24c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:22:01.238649: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:22:01.326882: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:22:01.806827: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_dgemm512/plugins/profile/2021_03_05_22_22_01
2021-03-05 22:22:02.296827: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_dgemm512/plugins/profile/2021_03_05_22_22_01/householder.trace.json.gz
2021-03-05 22:22:02.396005: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:22:02.434683: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 22:22:02.437192: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_dgemm512/plugins/profile/2021_03_05_22_22_01Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_dgemm512/plugins/profile/2021_03_05_22_22_01/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_dgemm512/plugins/profile/2021_03_05_22_22_01/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_dgemm512/plugins/profile/2021_03_05_22_22_01/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_dgemm512/plugins/profile/2021_03_05_22_22_01/householder.kernel_stats.pb

Time for Epoch:14.81294560432434
Average single batch time this epoch: 0.12659991296947512
Running Average Epoch time: 13.590271234512329

Time for Epoch:13.590271234512329
Average single batch time this epoch: 0.116150880471254
Running Average Epoch time: 15.196398615837097

Time for Epoch:16.802525997161865
Average single batch time this epoch: 0.14360575390677166
Running Average Epoch time: 14.749970277150473

Time for Epoch:13.857113599777222
Average single batch time this epoch: 0.11843168837392432
Running Average Epoch time: 14.779188930988312

Time for Epoch:14.866844892501831
Average single batch time this epoch: 0.12706135888384956
Average time per Batch: 0.12631242040894988
Average time per Epoch: 14.779188930988312
batch size 512
epochs 5
nodes 512
num layers 4
algorithm dgemm
num threads 12
total time 75.47466015815735
2021-03-05 22:22:06.764955: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:22:07.319581: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:22:07.320192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:22:07.320522: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:07.320720: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:07.320910: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:07.321096: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:07.321290: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:07.321499: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:07.321687: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:07.321723: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:22:07.360195: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:22:07.360650: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8598000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:22:07.360706: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:22:07.365794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:22:07.365838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:22:07.469072: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:22:07.469222: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:22:07.469503: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:07.469534: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:22:07.469553: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:22:07.469589: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:22:07.469631: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:22:07.469655: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:22:07.469690: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-05 22:22:08.156235: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:22:12.038483: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:22:12.591103: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:22:12.591533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:22:12.591844: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:12.592027: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:12.592191: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:12.592359: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:12.592527: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:12.592693: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:12.592854: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:12.592885: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:22:12.624135: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:22:12.624478: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6460000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:22:12.624866: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:22:12.627319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:22:12.627345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:22:12.724611: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:22:12.724725: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:22:12.724980: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:22:12.725009: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:22:12.725027: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:22:12.725061: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:22:12.725103: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:22:12.725127: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:22:12.725142: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f64947b94c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:24:24.691043: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:24:24.830452: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:24:25.326387: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_schonhage333512/plugins/profile/2021_03_05_22_24_24
2021-03-05 22:24:25.826610: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_schonhage333512/plugins/profile/2021_03_05_22_24_24/householder.trace.json.gz
2021-03-05 22:24:25.929673: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:24:25.968212: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 22:24:25.970633: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_schonhage333512/plugins/profile/2021_03_05_22_24_24Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_schonhage333512/plugins/profile/2021_03_05_22_24_24/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_schonhage333512/plugins/profile/2021_03_05_22_24_24/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_schonhage333512/plugins/profile/2021_03_05_22_24_24/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_schonhage333512/plugins/profile/2021_03_05_22_24_24/householder.kernel_stats.pb

Time for Epoch:27.992764234542847
Average single batch time this epoch: 0.23924769091809917
Running Average Epoch time: 26.168705224990845

Time for Epoch:26.168705224990845
Average single batch time this epoch: 0.22365825400393233
Running Average Epoch time: 26.079391837120056

Time for Epoch:25.990078449249268
Average single batch time this epoch: 0.2221312910063654
Running Average Epoch time: 26.014213879903156

Time for Epoch:25.88385796546936
Average single batch time this epoch: 0.22122390861185187
Running Average Epoch time: 25.988990247249603

Time for Epoch:25.91331934928894
Average single batch time this epoch: 0.2214754198351477
Average time per Batch: 0.22212221836432433
Average time per Epoch: 25.988990247249603
batch size 512
epochs 5
nodes 512
num layers 4
algorithm schonhage333
num threads 12
total time 133.43661618232727
2021-03-05 22:24:30.328299: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:24:30.855466: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:24:30.855990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:24:30.856305: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:24:30.856493: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:24:30.856669: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:24:30.856873: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:24:30.857053: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:24:30.857229: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:24:30.857401: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:24:30.857435: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:24:30.896253: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:24:30.896631: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc37c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:24:30.896668: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:24:30.900151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:24:30.900190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:24:31.002031: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:24:31.002177: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:24:31.002458: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:24:31.002489: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:24:31.002529: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:24:31.002566: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:24:31.002610: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:24:31.002633: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:24:31.002648: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc3b20824c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:26:19.217757: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:26:19.366482: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:26:19.907184: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov224512/plugins/profile/2021_03_05_22_26_19
2021-03-05 22:26:20.423824: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov224512/plugins/profile/2021_03_05_22_26_19/householder.trace.json.gz
2021-03-05 22:26:20.554734: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:26:20.596029: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 22:26:20.598658: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov224512/plugins/profile/2021_03_05_22_26_19Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov224512/plugins/profile/2021_03_05_22_26_19/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov224512/plugins/profile/2021_03_05_22_26_19/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov224512/plugins/profile/2021_03_05_22_26_19/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov224512/plugins/profile/2021_03_05_22_26_19/householder.kernel_stats.pb

Time for Epoch:23.079907655715942
Average single batch time this epoch: 0.1972569115141518
Running Average Epoch time: 21.035608053207397

Time for Epoch:21.035608053207397
Average single batch time this epoch: 0.1797842469989744
Running Average Epoch time: 21.254626989364624

Time for Epoch:21.47364592552185
Average single batch time this epoch: 0.1835295991000966
Running Average Epoch time: 21.248462359110516

Time for Epoch:21.236133098602295
Average single batch time this epoch: 0.18149892081562272
Running Average Epoch time: 21.276897132396698

Time for Epoch:21.36220145225525
Average single batch time this epoch: 0.18257757537385338
Average time per Batch: 0.18184758557213676
Average time per Epoch: 21.276897132396698
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov224
num threads 12
total time 109.69174361228943
2021-03-05 22:26:25.031814: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:26:25.563626: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:26:25.564263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:26:25.564617: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:26:25.564835: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:26:25.565039: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:26:25.565245: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:26:25.565450: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:26:25.565682: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:26:25.565882: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:26:25.565919: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:26:25.608282: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:26:25.608678: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0390000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:26:25.608715: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:26:25.612190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:26:25.612233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:26:25.711833: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:26:25.711977: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:26:25.712252: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:26:25.712283: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:26:25.712302: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:26:25.712337: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:26:25.712380: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:26:25.712404: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:26:25.712419: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f03c2258430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:28:20.599484: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:28:20.724278: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:28:21.195794: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov225512/plugins/profile/2021_03_05_22_28_20
2021-03-05 22:28:21.678018: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov225512/plugins/profile/2021_03_05_22_28_20/householder.trace.json.gz
2021-03-05 22:28:21.774856: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:28:21.812942: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 22:28:21.815362: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov225512/plugins/profile/2021_03_05_22_28_20Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov225512/plugins/profile/2021_03_05_22_28_20/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov225512/plugins/profile/2021_03_05_22_28_20/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov225512/plugins/profile/2021_03_05_22_28_20/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov225512/plugins/profile/2021_03_05_22_28_20/householder.kernel_stats.pb

Time for Epoch:22.872958183288574
Average single batch time this epoch: 0.19548711206159022
Running Average Epoch time: 23.425129175186157

Time for Epoch:23.425129175186157
Average single batch time this epoch: 0.20020612692221618
Running Average Epoch time: 23.084370255470276

Time for Epoch:22.743611335754395
Average single batch time this epoch: 0.19438388204982138
Running Average Epoch time: 23.023751099904377

Time for Epoch:22.902512788772583
Average single batch time this epoch: 0.19574102377280211
Running Average Epoch time: 22.998723208904266

Time for Epoch:22.92363953590393
Average single batch time this epoch: 0.19592169207385463
Average time per Batch: 0.1965631812046736
Average time per Epoch: 22.998723208904266
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov225
num threads 12
total time 116.37139892578125
2021-03-05 22:28:26.085845: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:28:26.620884: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:28:26.621395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:28:26.621699: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:28:26.621905: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:28:26.622098: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:28:26.622295: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:28:26.622486: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:28:26.622672: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:28:26.622863: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:28:26.622899: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:28:26.664286: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:28:26.664673: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9334000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:28:26.664711: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:28:26.668222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:28:26.668260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:28:26.769714: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:28:26.769859: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:28:26.770139: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:28:26.770170: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:28:26.770190: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:28:26.770226: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:28:26.770271: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:28:26.770295: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:28:26.770310: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9367aaf430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:30:27.891896: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:30:28.037887: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:30:28.576397: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov272512/plugins/profile/2021_03_05_22_30_28
2021-03-05 22:30:29.102179: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov272512/plugins/profile/2021_03_05_22_30_28/householder.trace.json.gz
2021-03-05 22:30:29.238052: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:30:29.279839: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 22:30:29.282482: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov272512/plugins/profile/2021_03_05_22_30_28Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov272512/plugins/profile/2021_03_05_22_30_28/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov272512/plugins/profile/2021_03_05_22_30_28/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov272512/plugins/profile/2021_03_05_22_30_28/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov272512/plugins/profile/2021_03_05_22_30_28/householder.kernel_stats.pb

Time for Epoch:25.020722150802612
Average single batch time this epoch: 0.21384371855320075
Running Average Epoch time: 23.59119701385498

Time for Epoch:23.59119701385498
Average single batch time this epoch: 0.20162749901795998
Running Average Epoch time: 24.143441319465637

Time for Epoch:24.695685625076294
Average single batch time this epoch: 0.21106738514370388
Running Average Epoch time: 23.92657430966695

Time for Epoch:23.49284029006958
Average single batch time this epoch: 0.20078700424259543
Running Average Epoch time: 24.018051505088806

Time for Epoch:24.29248309135437
Average single batch time this epoch: 0.20762122390616652
Average time per Batch: 0.20527577807760647
Average time per Epoch: 24.018051505088806
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov272
num threads 12
total time 122.60092568397522
2021-03-05 22:30:33.690153: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:30:34.211845: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:30:34.212470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:30:34.212822: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:30:34.213041: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:30:34.213273: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:30:34.213481: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:30:34.213683: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:30:34.213882: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:30:34.214082: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:30:34.214120: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:30:34.256311: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:30:34.256765: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8ad8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:30:34.256822: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:30:34.261894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:30:34.261939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:30:34.363419: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:30:34.363551: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:30:34.363845: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:30:34.363895: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:30:34.363915: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:30:34.363951: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:30:34.363993: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:30:34.364018: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:30:34.364033: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8b0c880430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:32:32.735070: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:32:32.874848: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:32:33.362039: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov323512/plugins/profile/2021_03_05_22_32_32
2021-03-05 22:32:33.843986: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov323512/plugins/profile/2021_03_05_22_32_32/householder.trace.json.gz
2021-03-05 22:32:33.967099: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:32:34.006644: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 22:32:34.009142: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov323512/plugins/profile/2021_03_05_22_32_32Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov323512/plugins/profile/2021_03_05_22_32_32/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov323512/plugins/profile/2021_03_05_22_32_32/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov323512/plugins/profile/2021_03_05_22_32_32/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov323512/plugins/profile/2021_03_05_22_32_32/householder.kernel_stats.pb

Time for Epoch:25.127490758895874
Average single batch time this epoch: 0.21475622796604776
Running Average Epoch time: 22.351328372955322

Time for Epoch:22.351328372955322
Average single batch time this epoch: 0.19103169237446582
Running Average Epoch time: 22.713838696479797

Time for Epoch:23.076349020004272
Average single batch time this epoch: 0.19722795894003323
Running Average Epoch time: 23.20833404858907

Time for Epoch:24.197324752807617
Average single batch time this epoch: 0.2068082104381333
Running Average Epoch time: 23.303647935390472

Time for Epoch:23.589589595794678
Average single batch time this epoch: 0.2016144226758908
Average time per Batch: 0.1991705711071308
Average time per Epoch: 23.303647935390472
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov323
num threads 12
total time 119.83531403541565
2021-03-05 22:32:38.408307: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:32:38.972130: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:32:38.972604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:32:38.972909: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:32:38.973106: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:32:38.973307: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:32:38.973520: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:32:38.973736: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:32:38.973945: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:32:38.974124: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:32:38.974158: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:32:39.012236: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:32:39.012693: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2c30000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:32:39.012779: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:32:39.017201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:32:39.017239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:32:39.118277: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:32:39.118406: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:32:39.118681: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:32:39.118712: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:32:39.118730: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:32:39.118765: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:32:39.118814: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:32:39.118839: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:32:39.118854: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f2c63fa44c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:34:43.835553: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:34:43.985237: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:34:44.456754: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov333512/plugins/profile/2021_03_05_22_34_44
2021-03-05 22:34:44.945118: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov333512/plugins/profile/2021_03_05_22_34_44/householder.trace.json.gz
2021-03-05 22:34:45.040219: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:34:45.077589: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 22:34:45.079949: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov333512/plugins/profile/2021_03_05_22_34_44Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov333512/plugins/profile/2021_03_05_22_34_44/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov333512/plugins/profile/2021_03_05_22_34_44/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov333512/plugins/profile/2021_03_05_22_34_44/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov333512/plugins/profile/2021_03_05_22_34_44/householder.kernel_stats.pb

Time for Epoch:25.06059217453003
Average single batch time this epoch: 0.21418676213321522
Running Average Epoch time: 24.48309874534607

Time for Epoch:24.48309874534607
Average single batch time this epoch: 0.20925093919802934
Running Average Epoch time: 24.321750164031982

Time for Epoch:24.160401582717896
Average single batch time this epoch: 0.20649337157224998
Running Average Epoch time: 24.448569536209106

Time for Epoch:24.702208280563354
Average single batch time this epoch: 0.21112422046498355
Running Average Epoch time: 24.90976780653

Time for Epoch:26.293362617492676
Average single batch time this epoch: 0.22472379146478114
Average time per Batch: 0.212898080675011
Average time per Epoch: 24.90976780653
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov333
num threads 12
total time 126.24118041992188
2021-03-05 22:34:49.288563: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:34:49.831108: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:34:49.831530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:34:49.831808: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:34:49.831987: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:34:49.832150: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:34:49.832316: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:34:49.832483: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:34:49.832647: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:34:49.832808: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:34:49.832838: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:34:49.864030: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:34:49.864438: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6014000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:34:49.864500: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:34:49.868161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:34:49.868202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:34:49.968104: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:34:49.968204: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:34:49.968457: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:34:49.968486: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:34:49.968503: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:34:49.968537: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:34:49.968578: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:34:49.968602: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:34:49.968617: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f6049906430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:36:53.555222: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:36:53.704538: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:36:54.284407: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov334512/plugins/profile/2021_03_05_22_36_53
2021-03-05 22:36:54.783306: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov334512/plugins/profile/2021_03_05_22_36_53/householder.trace.json.gz
2021-03-05 22:36:54.901142: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:36:54.951277: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 22:36:54.953728: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov334512/plugins/profile/2021_03_05_22_36_53Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov334512/plugins/profile/2021_03_05_22_36_53/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov334512/plugins/profile/2021_03_05_22_36_53/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov334512/plugins/profile/2021_03_05_22_36_53/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov334512/plugins/profile/2021_03_05_22_36_53/householder.kernel_stats.pb

Time for Epoch:26.027178049087524
Average single batch time this epoch: 0.22244465860546145
Running Average Epoch time: 24.384802103042603

Time for Epoch:24.384802103042603
Average single batch time this epoch: 0.20841083771143204
Running Average Epoch time: 24.01675307750702

Time for Epoch:23.648704051971436
Average single batch time this epoch: 0.2021191548078488
Running Average Epoch time: 24.24401354789734

Time for Epoch:24.69853448867798
Average single batch time this epoch: 0.21109266158861992
Running Average Epoch time: 24.38495182991028

Time for Epoch:24.807766675949097
Average single batch time this epoch: 0.21202617017631856
Average time per Batch: 0.20841220607105482
Average time per Epoch: 24.38495182991028
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov334
num threads 12
total time 125.04689264297485
2021-03-05 22:36:59.258227: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:36:59.809695: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:36:59.810226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:36:59.810583: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:36:59.810806: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:36:59.811063: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:36:59.811304: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:36:59.811545: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:36:59.811748: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:36:59.811972: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:36:59.812013: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:36:59.852413: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:36:59.852881: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3a14000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:36:59.852960: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:36:59.857457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:36:59.857496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:36:59.959148: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:36:59.959260: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:36:59.959529: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:36:59.959580: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:36:59.959605: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:36:59.959641: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:36:59.959684: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:36:59.959708: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:36:59.959724: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3a477424c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:38:47.043710: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:38:47.189536: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:38:47.714972: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov442512/plugins/profile/2021_03_05_22_38_47
2021-03-05 22:38:48.235818: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov442512/plugins/profile/2021_03_05_22_38_47/householder.trace.json.gz
2021-03-05 22:38:48.348061: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:38:48.389539: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 22:38:48.392087: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov442512/plugins/profile/2021_03_05_22_38_47Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov442512/plugins/profile/2021_03_05_22_38_47/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov442512/plugins/profile/2021_03_05_22_38_47/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov442512/plugins/profile/2021_03_05_22_38_47/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov442512/plugins/profile/2021_03_05_22_38_47/householder.kernel_stats.pb

Time for Epoch:22.683369874954224
Average single batch time this epoch: 0.1938680726238805
Running Average Epoch time: 21.184115886688232

Time for Epoch:21.184115886688232
Average single batch time this epoch: 0.18105513417822683
Running Average Epoch time: 21.103804111480713

Time for Epoch:21.023492336273193
Average single batch time this epoch: 0.17968240558591664
Running Average Epoch time: 21.128369490305584

Time for Epoch:21.177500247955322
Average single batch time this epoch: 0.18099786888839853
Running Average Epoch time: 21.094720244407654

Time for Epoch:20.993772506713867
Average single batch time this epoch: 0.1794281066992344
Average time per Batch: 0.1802908788379441
Average time per Epoch: 21.094720244407654
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov442
num threads 12
total time 108.59487533569336
2021-03-05 22:38:52.714149: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:38:53.271476: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:38:53.271969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:38:53.272287: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:38:53.272484: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:38:53.272680: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:38:53.272889: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:38:53.273092: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:38:53.273297: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:38:53.273472: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:38:53.273505: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:38:53.312254: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:38:53.312688: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f48fc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:38:53.312736: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:38:53.317412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:38:53.317458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:38:53.421124: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:38:53.421251: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:38:53.421521: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:38:53.421550: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:38:53.421568: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:38:53.421602: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:38:53.421642: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:38:53.421666: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:38:53.421701: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f492f4cf4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:40:48.658135: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:40:48.791439: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:40:49.313911: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov444512/plugins/profile/2021_03_05_22_40_48
2021-03-05 22:40:49.802774: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov444512/plugins/profile/2021_03_05_22_40_48/householder.trace.json.gz
2021-03-05 22:40:49.901725: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:40:49.939080: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 22:40:49.941535: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov444512/plugins/profile/2021_03_05_22_40_48Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov444512/plugins/profile/2021_03_05_22_40_48/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov444512/plugins/profile/2021_03_05_22_40_48/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov444512/plugins/profile/2021_03_05_22_40_48/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov444512/plugins/profile/2021_03_05_22_40_48/householder.kernel_stats.pb

Time for Epoch:24.404271364212036
Average single batch time this epoch: 0.20857666496537688
Running Average Epoch time: 22.741344213485718

Time for Epoch:22.741344213485718
Average single batch time this epoch: 0.1943639608529898
Running Average Epoch time: 22.781123995780945

Time for Epoch:22.820903778076172
Average single batch time this epoch: 0.19504390007410294
Running Average Epoch time: 22.61960832277934

Time for Epoch:22.296576976776123
Average single batch time this epoch: 0.1905623969868717
Running Average Epoch time: 22.70333033800125

Time for Epoch:22.954496383666992
Average single batch time this epoch: 0.1961860269562811
Average time per Batch: 0.19403907121756137
Average time per Epoch: 22.70333033800125
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov444
num threads 12
total time 116.75765347480774
2021-03-05 22:40:54.146331: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:40:54.673364: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:40:54.673849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:40:54.674192: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:40:54.674402: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:40:54.674591: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:40:54.674786: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:40:54.674975: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:40:54.675185: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:40:54.675372: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:40:54.675407: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:40:54.712177: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:40:54.712614: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f46d8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:40:54.712665: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:40:54.715987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:40:54.716023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:40:54.820120: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:40:54.820230: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:40:54.820489: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:40:54.820519: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:40:54.820537: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:40:54.820605: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:40:54.820664: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:40:54.820691: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:40:54.820706: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f470af0b430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:42:54.687392: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:42:54.822276: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:42:55.303896: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov552512/plugins/profile/2021_03_05_22_42_54
2021-03-05 22:42:55.793056: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov552512/plugins/profile/2021_03_05_22_42_54/householder.trace.json.gz
2021-03-05 22:42:55.887958: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:42:55.925632: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 22:42:55.928054: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov552512/plugins/profile/2021_03_05_22_42_54Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov552512/plugins/profile/2021_03_05_22_42_54/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov552512/plugins/profile/2021_03_05_22_42_54/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov552512/plugins/profile/2021_03_05_22_42_54/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov552512/plugins/profile/2021_03_05_22_42_54/householder.kernel_stats.pb

Time for Epoch:25.044846534729004
Average single batch time this epoch: 0.21405219420408592
Running Average Epoch time: 22.9874005317688

Time for Epoch:22.9874005317688
Average single batch time this epoch: 0.1964676156003251
Running Average Epoch time: 23.48325824737549

Time for Epoch:23.979115962982178
Average single batch time this epoch: 0.20494301910074347
Running Average Epoch time: 23.693970521291096

Time for Epoch:24.115395069122314
Average single batch time this epoch: 0.20610809122395313
Running Average Epoch time: 23.701606333255768

Time for Epoch:23.72451376914978
Average single batch time this epoch: 0.20276776745788053
Average time per Batch: 0.20257162334572554
Average time per Epoch: 23.701606333255768
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov552
num threads 12
total time 121.3650918006897
2021-03-05 22:43:00.283854: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:43:00.823627: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:43:00.824240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:43:00.824549: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:43:00.824769: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:43:00.825002: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:43:00.825211: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:43:00.825412: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:43:00.825611: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:43:00.825812: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:43:00.825850: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:43:00.864286: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:43:00.864742: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f93f8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:43:00.864820: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:43:00.869272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:43:00.869311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:43:00.968772: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:43:00.968885: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:43:00.969138: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:43:00.969185: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:43:00.969205: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:43:00.969240: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:43:00.969284: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:43:00.969308: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:43:00.969322: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f942ab37430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:45:13.009458: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:45:13.146454: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:45:13.626854: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov555512/plugins/profile/2021_03_05_22_45_13
2021-03-05 22:45:14.107056: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov555512/plugins/profile/2021_03_05_22_45_13/householder.trace.json.gz
2021-03-05 22:45:14.204178: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:45:14.241564: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 22:45:14.244026: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov555512/plugins/profile/2021_03_05_22_45_13Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov555512/plugins/profile/2021_03_05_22_45_13/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov555512/plugins/profile/2021_03_05_22_45_13/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov555512/plugins/profile/2021_03_05_22_45_13/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov555512/plugins/profile/2021_03_05_22_45_13/householder.kernel_stats.pb

Time for Epoch:28.140265226364136
Average single batch time this epoch: 0.24050754359644702
Running Average Epoch time: 26.43683385848999

Time for Epoch:26.43683385848999
Average single batch time this epoch: 0.22594899805183086
Running Average Epoch time: 26.405791401863098

Time for Epoch:26.374748945236206
Average single batch time this epoch: 0.2254183475787823
Running Average Epoch time: 26.256501356760662

Time for Epoch:25.957921266555786
Average single batch time this epoch: 0.22185616207937908
Running Average Epoch time: 25.970220804214478

Time for Epoch:25.111379146575928
Average single batch time this epoch: 0.2146207104381333
Average time per Batch: 0.22196105453703135
Average time per Epoch: 25.970220804214478
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov555
num threads 12
total time 133.51976418495178
2021-03-05 22:45:18.514680: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:45:19.067284: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:45:19.067733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:45:19.068040: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:45:19.068231: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:45:19.068422: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:45:19.068615: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:45:19.068806: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:45:19.069003: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:45:19.069176: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:45:19.069209: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:45:19.108272: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:45:19.108711: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f57b4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:45:19.108796: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:45:19.112800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:45:19.112828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:45:19.372949: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:45:19.373085: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:45:19.373377: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:45:19.373407: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:45:19.373426: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:45:19.373460: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:45:19.373508: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:45:19.373533: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:45:19.373569: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f57e9734430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:49:10.270460: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:49:10.455611: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:49:10.684683: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_bini3221024/plugins/profile/2021_03_05_22_49_10
2021-03-05 22:49:10.926497: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_bini3221024/plugins/profile/2021_03_05_22_49_10/householder.trace.json.gz
2021-03-05 22:49:10.973895: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:49:10.992233: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 22:49:10.994553: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_bini3221024/plugins/profile/2021_03_05_22_49_10Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_bini3221024/plugins/profile/2021_03_05_22_49_10/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_bini3221024/plugins/profile/2021_03_05_22_49_10/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_bini3221024/plugins/profile/2021_03_05_22_49_10/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_bini3221024/plugins/profile/2021_03_05_22_49_10/householder.kernel_stats.pb

Time for Epoch:49.00502061843872
Average single batch time this epoch: 0.8449056271849007
Running Average Epoch time: 45.6622474193573

Time for Epoch:45.6622474193573
Average single batch time this epoch: 0.787273435757078
Running Average Epoch time: 45.68840825557709

Time for Epoch:45.714569091796875
Average single batch time this epoch: 0.7881751882618871
Running Average Epoch time: 45.46387545267741

Time for Epoch:45.01480984687805
Average single batch time this epoch: 0.7761104271329683
Running Average Epoch time: 45.46897476911545

Time for Epoch:45.484272718429565
Average single batch time this epoch: 0.784204441925575
Average time per Batch: 0.7839408732693771
Average time per Epoch: 45.46897476911545
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm bini322
num threads 12
total time 232.57714986801147
2021-03-05 22:49:15.222986: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:49:15.780131: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:49:15.780599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:49:15.781368: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:49:15.781529: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:49:15.781656: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:49:15.781780: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:49:15.781911: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:49:15.782034: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:49:15.782160: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:49:15.782201: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:49:15.816364: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:49:15.816933: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fdaf4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:49:15.817003: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:49:15.823425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:49:15.823471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:49:16.083225: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:49:16.083377: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:49:16.083656: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:49:16.083687: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:49:16.083708: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:49:16.083745: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:49:16.083808: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:49:16.083837: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:49:16.083853: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fdb27a5a430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:51:49.978633: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:51:50.099838: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:51:50.334739: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_dgemm1024/plugins/profile/2021_03_05_22_51_50
2021-03-05 22:51:50.579423: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_dgemm1024/plugins/profile/2021_03_05_22_51_50/householder.trace.json.gz
2021-03-05 22:51:50.627582: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:51:50.645787: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 22:51:50.648115: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_dgemm1024/plugins/profile/2021_03_05_22_51_50Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_dgemm1024/plugins/profile/2021_03_05_22_51_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_dgemm1024/plugins/profile/2021_03_05_22_51_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_dgemm1024/plugins/profile/2021_03_05_22_51_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_dgemm1024/plugins/profile/2021_03_05_22_51_50/householder.kernel_stats.pb

Time for Epoch:32.48679041862488
Average single batch time this epoch: 0.5601091672634256
Running Average Epoch time: 30.501718521118164

Time for Epoch:30.501718521118164
Average single batch time this epoch: 0.5258844926439482
Running Average Epoch time: 30.511382460594177

Time for Epoch:30.52104640007019
Average single batch time this epoch: 0.5262172139924148
Running Average Epoch time: 30.35883855819702

Time for Epoch:30.05375075340271
Average single batch time this epoch: 0.518161416053772
Running Average Epoch time: 30.348011076450348

Time for Epoch:30.315528631210327
Average single batch time this epoch: 0.5226737384138436
Average time per Batch: 0.5232342152759947
Average time per Epoch: 30.348011076450348
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm dgemm
num threads 12
total time 155.54856085777283
2021-03-05 22:51:54.903948: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:51:55.435308: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:51:55.435760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:51:55.436376: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:51:55.436556: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:51:55.436711: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:51:55.436857: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:51:55.437005: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:51:55.437145: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:51:55.437278: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:51:55.437301: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:51:55.476245: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:51:55.476666: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9108000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:51:55.476718: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:51:55.481336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:51:55.481379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:51:55.743664: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:51:55.743795: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:51:55.744093: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:51:55.744144: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:51:55.744163: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:51:55.744198: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:51:55.744240: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:51:55.744265: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:51:55.744281: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-05 22:51:56.470209: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:52:00.450735: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:52:01.019360: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:52:01.019825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:52:01.020140: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:52:01.020325: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:52:01.020513: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:52:01.020712: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:52:01.020913: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:52:01.021112: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:52:01.021283: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:52:01.021312: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:52:01.060265: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:52:01.060668: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb5ec000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:52:01.060720: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:52:01.065320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:52:01.065362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:52:01.328524: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:52:01.328665: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:52:01.328964: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:52:01.328994: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:52:01.329013: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:52:01.329047: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:52:01.329091: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:52:01.329116: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:52:01.329132: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fb61e3b9430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:55:55.844127: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:55:56.053202: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:55:56.295034: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_schonhage3331024/plugins/profile/2021_03_05_22_55_56
2021-03-05 22:55:56.549377: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_schonhage3331024/plugins/profile/2021_03_05_22_55_56/householder.trace.json.gz
2021-03-05 22:55:56.598349: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:55:56.616746: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 22:55:56.619064: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_schonhage3331024/plugins/profile/2021_03_05_22_55_56Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_schonhage3331024/plugins/profile/2021_03_05_22_55_56/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_schonhage3331024/plugins/profile/2021_03_05_22_55_56/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_schonhage3331024/plugins/profile/2021_03_05_22_55_56/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_schonhage3331024/plugins/profile/2021_03_05_22_55_56/householder.kernel_stats.pb

Time for Epoch:47.947697162628174
Average single batch time this epoch: 0.8266770634157904
Running Average Epoch time: 46.966819286346436

Time for Epoch:46.966819286346436
Average single batch time this epoch: 0.8097655156563068
Running Average Epoch time: 46.830846071243286

Time for Epoch:46.69487285614014
Average single batch time this epoch: 0.8050770677369217
Running Average Epoch time: 46.76191020011902

Time for Epoch:46.62403845787048
Average single batch time this epoch: 0.8038561755213244
Running Average Epoch time: 46.638071954250336

Time for Epoch:46.26655721664429
Average single batch time this epoch: 0.7976923811024633
Average time per Batch: 0.8040977850042541
Average time per Epoch: 46.638071954250336
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm schonhage333
num threads 12
total time 236.2191882133484
2021-03-05 22:56:00.852100: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:56:01.411443: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:56:01.412026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:56:01.412348: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:56:01.412551: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:56:01.412742: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:56:01.412934: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:56:01.413123: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:56:01.413308: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:56:01.413496: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:56:01.413531: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:56:01.452250: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:56:01.452718: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1708000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:56:01.452779: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:56:01.458306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:56:01.458353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:56:01.718367: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:56:01.718521: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:56:01.718813: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:56:01.718845: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:56:01.718864: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:56:01.718899: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:56:01.718942: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:56:01.718966: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:56:01.718981: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f173a3174c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 22:59:37.699130: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:59:37.885115: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 22:59:38.124972: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2241024/plugins/profile/2021_03_05_22_59_37
2021-03-05 22:59:38.370600: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2241024/plugins/profile/2021_03_05_22_59_37/householder.trace.json.gz
2021-03-05 22:59:38.419169: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 22:59:38.437712: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 22:59:38.440033: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2241024/plugins/profile/2021_03_05_22_59_37Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2241024/plugins/profile/2021_03_05_22_59_37/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2241024/plugins/profile/2021_03_05_22_59_37/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2241024/plugins/profile/2021_03_05_22_59_37/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2241024/plugins/profile/2021_03_05_22_59_37/householder.kernel_stats.pb

Time for Epoch:44.54333806037903
Average single batch time this epoch: 0.7679791984886959
Running Average Epoch time: 42.78094744682312

Time for Epoch:42.78094744682312
Average single batch time this epoch: 0.7375946784841603
Running Average Epoch time: 42.81125509738922

Time for Epoch:42.84156274795532
Average single batch time this epoch: 0.7386396013457199
Running Average Epoch time: 42.82868027687073

Time for Epoch:42.86353063583374
Average single batch time this epoch: 0.7390187773211249
Running Average Epoch time: 42.85519999265671

Time for Epoch:42.93475914001465
Average single batch time this epoch: 0.7402469289713892
Average time per Batch: 0.7388749965305985
Average time per Epoch: 42.85519999265671
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov224
num threads 12
total time 217.6532163619995
2021-03-05 22:59:42.679973: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 22:59:43.227463: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 22:59:43.227991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 22:59:43.228680: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:59:43.228831: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:59:43.229000: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:59:43.229154: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:59:43.229304: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:59:43.229432: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:59:43.229561: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:59:43.229585: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 22:59:43.268257: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 22:59:43.268749: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9ecc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 22:59:43.268854: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 22:59:43.273971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 22:59:43.274015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 22:59:43.538311: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:59:43.538452: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 22:59:43.538766: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 22:59:43.538815: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:59:43.538835: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:59:43.538869: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:59:43.538912: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 22:59:43.538936: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 22:59:43.538951: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9f009514c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:03:32.612036: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:03:32.812600: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:03:33.060389: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2251024/plugins/profile/2021_03_05_23_03_32
2021-03-05 23:03:33.318181: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2251024/plugins/profile/2021_03_05_23_03_32/householder.trace.json.gz
2021-03-05 23:03:33.369771: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:03:33.388705: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 23:03:33.391059: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2251024/plugins/profile/2021_03_05_23_03_32Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2251024/plugins/profile/2021_03_05_23_03_32/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2251024/plugins/profile/2021_03_05_23_03_32/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2251024/plugins/profile/2021_03_05_23_03_32/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2251024/plugins/profile/2021_03_05_23_03_32/householder.kernel_stats.pb

Time for Epoch:47.35531687736511
Average single batch time this epoch: 0.8164627963098986
Running Average Epoch time: 45.769068002700806

Time for Epoch:45.769068002700806
Average single batch time this epoch: 0.7891144916929048
Running Average Epoch time: 45.43569564819336

Time for Epoch:45.10232329368591
Average single batch time this epoch: 0.7776191604548487
Running Average Epoch time: 45.25673500696818

Time for Epoch:44.89881372451782
Average single batch time this epoch: 0.7741110283752968
Running Average Epoch time: 45.42549812793732

Time for Epoch:45.93178749084473
Average single batch time this epoch: 0.7919206413729437
Average time per Batch: 0.7831913304739985
Average time per Epoch: 45.42549812793732
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov225
num threads 12
total time 230.7505292892456
2021-03-05 23:03:37.603583: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:03:38.159259: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:03:38.159697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:03:38.160004: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:03:38.160191: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:03:38.160360: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:03:38.160531: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:03:38.160692: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:03:38.160883: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:03:38.161083: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:03:38.161113: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:03:38.196288: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:03:38.196674: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f21cc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:03:38.196724: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:03:38.199950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:03:38.199986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:03:38.464654: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:03:38.464789: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:03:38.465068: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:03:38.465098: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:03:38.465115: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:03:38.465183: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:03:38.465227: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:03:38.465251: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:03:38.465266: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f2200a8c4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:07:32.621562: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:07:32.838311: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:07:33.105429: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2721024/plugins/profile/2021_03_05_23_07_32
2021-03-05 23:07:33.370810: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2721024/plugins/profile/2021_03_05_23_07_32/householder.trace.json.gz
2021-03-05 23:07:33.423306: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:07:33.441895: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 23:07:33.444198: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2721024/plugins/profile/2021_03_05_23_07_32Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2721024/plugins/profile/2021_03_05_23_07_32/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2721024/plugins/profile/2021_03_05_23_07_32/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2721024/plugins/profile/2021_03_05_23_07_32/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2721024/plugins/profile/2021_03_05_23_07_32/householder.kernel_stats.pb

Time for Epoch:47.63034439086914
Average single batch time this epoch: 0.8212064299090155
Running Average Epoch time: 47.060861110687256

Time for Epoch:47.060861110687256
Average single batch time this epoch: 0.8113878883164505
Running Average Epoch time: 46.67609179019928

Time for Epoch:46.291322469711304
Average single batch time this epoch: 0.7981201985786701
Running Average Epoch time: 46.623562812805176

Time for Epoch:46.51850485801697
Average single batch time this epoch: 0.8020373665053269
Running Average Epoch time: 46.627737641334534

Time for Epoch:46.64026212692261
Average single batch time this epoch: 0.8041362474704611
Average time per Batch: 0.8039204252177271
Average time per Epoch: 46.627737641334534
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov272
num threads 12
total time 235.83197784423828
2021-03-05 23:07:37.701450: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:07:38.240104: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:07:38.240701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:07:38.241013: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:07:38.241231: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:07:38.241437: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:07:38.241645: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:07:38.241848: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:07:38.242046: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:07:38.242247: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:07:38.242285: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:07:38.284339: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:07:38.284794: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc494000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:07:38.284851: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:07:38.289971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:07:38.290015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:07:38.552664: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:07:38.552819: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:07:38.553105: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:07:38.553136: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:07:38.553155: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:07:38.553190: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:07:38.553233: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:07:38.553258: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:07:38.553273: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc4c907f430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:11:25.102672: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:11:25.299171: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:11:25.537697: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3231024/plugins/profile/2021_03_05_23_11_25
2021-03-05 23:11:25.780454: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3231024/plugins/profile/2021_03_05_23_11_25/householder.trace.json.gz
2021-03-05 23:11:25.827679: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:11:25.846491: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 23:11:25.848786: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3231024/plugins/profile/2021_03_05_23_11_25Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3231024/plugins/profile/2021_03_05_23_11_25/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3231024/plugins/profile/2021_03_05_23_11_25/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3231024/plugins/profile/2021_03_05_23_11_25/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3231024/plugins/profile/2021_03_05_23_11_25/householder.kernel_stats.pb

Time for Epoch:46.846349000930786
Average single batch time this epoch: 0.8076861233546816
Running Average Epoch time: 45.465765714645386

Time for Epoch:45.465765714645386
Average single batch time this epoch: 0.7838844677497601
Running Average Epoch time: 45.29401111602783

Time for Epoch:45.12225651741028
Average single batch time this epoch: 0.7779626270820355
Running Average Epoch time: 45.050005197525024

Time for Epoch:44.56199336051941
Average single batch time this epoch: 0.7683030120257673
Running Average Epoch time: 44.922045946121216

Time for Epoch:44.53816819190979
Average single batch time this epoch: 0.7678914234556001
Average time per Batch: 0.7745103825782907
Average time per Epoch: 44.922045946121216
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov323
num threads 12
total time 228.20894646644592
2021-03-05 23:11:30.090150: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:11:30.624112: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:11:30.624568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:11:30.625227: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:11:30.625396: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:11:30.625559: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:11:30.625706: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:11:30.625851: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:11:30.625974: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:11:30.626100: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:11:30.626123: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:11:30.664298: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:11:30.664715: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fea4c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:11:30.664756: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:11:30.668708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:11:30.668748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:11:30.929794: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:11:30.929937: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:11:30.930246: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:11:30.930313: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:11:30.930337: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:11:30.930371: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:11:30.930413: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:11:30.930437: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:11:30.930452: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fea803a1430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:15:06.915372: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:15:07.070134: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:15:07.312858: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3331024/plugins/profile/2021_03_05_23_15_07
2021-03-05 23:15:07.558874: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3331024/plugins/profile/2021_03_05_23_15_07/householder.trace.json.gz
2021-03-05 23:15:07.608215: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:15:07.626094: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 23:15:07.628476: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3331024/plugins/profile/2021_03_05_23_15_07Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3331024/plugins/profile/2021_03_05_23_15_07/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3331024/plugins/profile/2021_03_05_23_15_07/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3331024/plugins/profile/2021_03_05_23_15_07/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3331024/plugins/profile/2021_03_05_23_15_07/householder.kernel_stats.pb

Time for Epoch:44.57980561256409
Average single batch time this epoch: 0.7686104692261795
Running Average Epoch time: 43.221065282821655

Time for Epoch:43.221065282821655
Average single batch time this epoch: 0.7451841214607502
Running Average Epoch time: 43.05366861820221

Time for Epoch:42.886271953582764
Average single batch time this epoch: 0.7394116171475115
Running Average Epoch time: 42.96501326560974

Time for Epoch:42.787702560424805
Average single batch time this epoch: 0.7377124120449198
Running Average Epoch time: 42.847294986248016

Time for Epoch:42.49414014816284
Average single batch time this epoch: 0.7326509788118559
Average time per Batch: 0.7387397823662594
Average time per Epoch: 42.847294986248016
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov333
num threads 12
total time 217.64645433425903
2021-03-05 23:15:11.869619: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:15:12.431331: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:15:12.431798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:15:12.432663: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:15:12.432825: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:15:12.432961: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:15:12.433097: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:15:12.433231: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:15:12.433374: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:15:12.433505: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:15:12.433531: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:15:12.468215: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:15:12.468642: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe4ec000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:15:12.468705: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:15:12.472730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:15:12.472773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:15:12.738533: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:15:12.738616: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:15:12.738829: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:15:12.738858: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:15:12.738878: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:15:12.738914: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:15:12.738957: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:15:12.738983: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:15:12.739018: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fe520c904c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:18:53.192071: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:18:53.410684: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:18:53.673597: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3341024/plugins/profile/2021_03_05_23_18_53
2021-03-05 23:18:53.930743: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3341024/plugins/profile/2021_03_05_23_18_53/householder.trace.json.gz
2021-03-05 23:18:53.987650: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:18:54.006390: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 23:18:54.008705: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3341024/plugins/profile/2021_03_05_23_18_53Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3341024/plugins/profile/2021_03_05_23_18_53/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3341024/plugins/profile/2021_03_05_23_18_53/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3341024/plugins/profile/2021_03_05_23_18_53/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3341024/plugins/profile/2021_03_05_23_18_53/householder.kernel_stats.pb

Time for Epoch:45.97823357582092
Average single batch time this epoch: 0.7927197341261238
Running Average Epoch time: 44.35096740722656

Time for Epoch:44.35096740722656
Average single batch time this epoch: 0.7646638319410127
Running Average Epoch time: 43.92982006072998

Time for Epoch:43.5086727142334
Average single batch time this epoch: 0.7501400955792131
Running Average Epoch time: 43.51377820968628

Time for Epoch:42.68169450759888
Average single batch time this epoch: 0.7358807777536327
Running Average Epoch time: 43.61291021108627

Time for Epoch:43.910306215286255
Average single batch time this epoch: 0.7570661141954619
Average time per Batch: 0.7519377048673301
Average time per Epoch: 43.61291021108627
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov334
num threads 12
total time 222.13904404640198
2021-03-05 23:18:58.382941: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:18:58.915671: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:18:58.916165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:18:58.916486: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:18:58.916664: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:18:58.916847: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:18:58.917041: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:18:58.917238: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:18:58.917404: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:18:58.917567: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:18:58.917597: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:18:58.956321: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:18:58.956720: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f724c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:18:58.956757: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:18:58.960314: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:18:58.960352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:18:59.223573: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:18:59.223717: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:18:59.224021: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:18:59.224053: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:18:59.224076: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:18:59.224111: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:18:59.224153: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:18:59.224177: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:18:59.224192: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f72800f34c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:22:35.189758: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:22:35.377464: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:22:35.616329: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov4421024/plugins/profile/2021_03_05_23_22_35
2021-03-05 23:22:35.866012: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov4421024/plugins/profile/2021_03_05_23_22_35/householder.trace.json.gz
2021-03-05 23:22:35.914891: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:22:35.933925: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 23:22:35.936241: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov4421024/plugins/profile/2021_03_05_23_22_35Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov4421024/plugins/profile/2021_03_05_23_22_35/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov4421024/plugins/profile/2021_03_05_23_22_35/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov4421024/plugins/profile/2021_03_05_23_22_35/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov4421024/plugins/profile/2021_03_05_23_22_35/householder.kernel_stats.pb

Time for Epoch:44.47725772857666
Average single batch time this epoch: 0.7668419624197071
Running Average Epoch time: 42.886144161224365

Time for Epoch:42.886144161224365
Average single batch time this epoch: 0.7394096522495665
Running Average Epoch time: 42.89051628112793

Time for Epoch:42.894888401031494
Average single batch time this epoch: 0.7395602999062374
Running Average Epoch time: 42.822092374165855

Time for Epoch:42.6852445602417
Average single batch time this epoch: 0.7359457139311165
Running Average Epoch time: 42.86821669340134

Time for Epoch:43.00658965110779
Average single batch time this epoch: 0.7414858259003738
Average time per Batch: 0.7391003729968235
Average time per Epoch: 42.86821669340134
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov442
num threads 12
total time 217.62490963935852
2021-03-05 23:22:40.208413: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:22:40.743335: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:22:40.743804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:22:40.744106: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:22:40.744289: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:22:40.744507: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:22:40.744704: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:22:40.744896: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:22:40.745057: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:22:40.745220: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:22:40.745250: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:22:40.784407: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:22:40.784851: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1dac000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:22:40.784900: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:22:40.789650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:22:40.789693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:22:41.048300: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:22:41.048446: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:22:41.048736: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:22:41.048787: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:22:41.048806: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:22:41.048840: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:22:41.048882: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:22:41.048906: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:22:41.048921: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f1de1aae430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:26:23.518445: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:26:23.737709: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:26:23.995732: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov4441024/plugins/profile/2021_03_05_23_26_23
2021-03-05 23:26:24.253814: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov4441024/plugins/profile/2021_03_05_23_26_23/householder.trace.json.gz
2021-03-05 23:26:24.306710: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:26:24.325586: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-05 23:26:24.327937: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov4441024/plugins/profile/2021_03_05_23_26_23Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov4441024/plugins/profile/2021_03_05_23_26_23/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov4441024/plugins/profile/2021_03_05_23_26_23/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov4441024/plugins/profile/2021_03_05_23_26_23/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov4441024/plugins/profile/2021_03_05_23_26_23/householder.kernel_stats.pb

Time for Epoch:45.757468461990356
Average single batch time this epoch: 0.7889136240400118
Running Average Epoch time: 44.420724868774414

Time for Epoch:44.420724868774414
Average single batch time this epoch: 0.7658683801519459
Running Average Epoch time: 44.424560546875

Time for Epoch:44.428396224975586
Average single batch time this epoch: 0.7660001064168995
Running Average Epoch time: 44.206405798594155

Time for Epoch:43.77009630203247
Average single batch time this epoch: 0.7546503584960411
Running Average Epoch time: 44.174040138721466

Time for Epoch:44.076943159103394
Average single batch time this epoch: 0.7599404104824724
Average time per Batch: 0.7616148138868397
Average time per Epoch: 44.174040138721466
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov444
num threads 12
total time 224.13721299171448
2021-03-05 23:26:28.530635: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:26:29.075717: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:26:29.076331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:26:29.076634: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:26:29.076851: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:26:29.077057: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:26:29.077267: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:26:29.077490: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:26:29.077691: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:26:29.077894: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:26:29.077932: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:26:29.120335: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:26:29.120805: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc060000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:26:29.120887: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:26:29.125625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:26:29.125669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:26:29.381808: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:26:29.381963: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:26:29.382254: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:26:29.382285: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:26:29.382304: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:26:29.382340: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:26:29.382389: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:26:29.382414: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:26:29.382446: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc094f554c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:30:32.812649: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:30:32.959409: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:30:33.228258: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov5521024/plugins/profile/2021_03_05_23_30_32
2021-03-05 23:30:33.484668: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov5521024/plugins/profile/2021_03_05_23_30_32/householder.trace.json.gz
2021-03-05 23:30:33.536733: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:30:33.555405: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 23:30:33.557777: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov5521024/plugins/profile/2021_03_05_23_30_32Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov5521024/plugins/profile/2021_03_05_23_30_32/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov5521024/plugins/profile/2021_03_05_23_30_32/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov5521024/plugins/profile/2021_03_05_23_30_32/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov5521024/plugins/profile/2021_03_05_23_30_32/householder.kernel_stats.pb

Time for Epoch:50.48819899559021
Average single batch time this epoch: 0.870477844928873
Running Average Epoch time: 48.43955326080322

Time for Epoch:48.43955326080322
Average single batch time this epoch: 0.8351570162279852
Running Average Epoch time: 48.272327303886414

Time for Epoch:48.105101346969604
Average single batch time this epoch: 0.82939036550193
Running Average Epoch time: 48.14304073651632

Time for Epoch:47.88446760177612
Average single batch time this epoch: 0.8255870794427806
Running Average Epoch time: 48.23193711042404

Time for Epoch:48.49862623214722
Average single batch time this epoch: 0.8361750841140747
Average time per Batch: 0.8315773863216926
Average time per Epoch: 48.23193711042404
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov552
num threads 12
total time 245.07389664649963
2021-03-05 23:30:37.821735: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:30:38.387345: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:30:38.387822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:30:38.388147: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:30:38.388368: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:30:38.388579: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:30:38.388801: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:30:38.389026: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:30:38.389216: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:30:38.389406: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:30:38.389469: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:30:38.432201: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:30:38.432643: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1e20000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:30:38.432714: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:30:38.437384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:30:38.437426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:30:38.701146: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:30:38.701284: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:30:38.701588: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:30:38.701618: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:30:38.701637: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:30:38.701672: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:30:38.701715: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:30:38.701740: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:30:38.701755: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f1e52800430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:35:15.103123: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:35:15.313840: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:35:15.556706: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov5551024/plugins/profile/2021_03_05_23_35_15
2021-03-05 23:35:15.802396: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov5551024/plugins/profile/2021_03_05_23_35_15/householder.trace.json.gz
2021-03-05 23:35:15.850690: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:35:15.868822: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 23:35:15.871114: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov5551024/plugins/profile/2021_03_05_23_35_15Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov5551024/plugins/profile/2021_03_05_23_35_15/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov5551024/plugins/profile/2021_03_05_23_35_15/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov5551024/plugins/profile/2021_03_05_23_35_15/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov5551024/plugins/profile/2021_03_05_23_35_15/householder.kernel_stats.pb

Time for Epoch:56.489012718200684
Average single batch time this epoch: 0.9739414124653257
Running Average Epoch time: 54.70580458641052

Time for Epoch:54.70580458641052
Average single batch time this epoch: 0.9431975216701113
Running Average Epoch time: 54.830519676208496

Time for Epoch:54.95523476600647
Average single batch time this epoch: 0.9474974624041853
Running Average Epoch time: 54.935092767079674

Time for Epoch:55.14423894882202
Average single batch time this epoch: 0.9507562949739653
Running Average Epoch time: 54.97438269853592

Time for Epoch:55.09225249290466
Average single batch time this epoch: 0.9498597671245707
Average time per Batch: 0.9478277615432081
Average time per Epoch: 54.97438269853592
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov555
num threads 12
total time 278.10954093933105
2021-03-05 23:35:20.086980: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:35:20.635631: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:35:20.636295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:35:20.636841: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:35:20.637016: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:35:20.637146: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:35:20.637274: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:35:20.637402: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:35:20.637528: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:35:20.637655: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:35:20.637679: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:35:20.676300: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:35:20.676826: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6458000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:35:20.676912: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:35:20.682363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:35:20.682413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:35:21.513101: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:35:21.513247: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:35:21.514045: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:35:21.514078: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:35:21.514101: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:35:21.514138: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:35:21.514180: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:35:21.514204: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:35:21.514219: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f648bbeb430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:44:36.857586: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:44:36.983621: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:44:37.111491: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_bini3222048/plugins/profile/2021_03_05_23_44_37
2021-03-05 23:44:37.246729: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_bini3222048/plugins/profile/2021_03_05_23_44_37/householder.trace.json.gz
2021-03-05 23:44:37.268940: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:44:37.278431: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 23:44:37.280626: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_bini3222048/plugins/profile/2021_03_05_23_44_37Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_bini3222048/plugins/profile/2021_03_05_23_44_37/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_bini3222048/plugins/profile/2021_03_05_23_44_37/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_bini3222048/plugins/profile/2021_03_05_23_44_37/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_bini3222048/plugins/profile/2021_03_05_23_44_37/householder.kernel_stats.pb

Time for Epoch:118.59167790412903
Average single batch time this epoch: 4.08935572361124
Running Average Epoch time: 109.55561900138855

Time for Epoch:109.55561900138855
Average single batch time this epoch: 3.7777693600490174
Running Average Epoch time: 109.46029257774353

Time for Epoch:109.36496615409851
Average single batch time this epoch: 3.771196192708509
Running Average Epoch time: 109.3681796391805

Time for Epoch:109.18395376205444
Average single batch time this epoch: 3.764954155889051
Running Average Epoch time: 109.18446427583694

Time for Epoch:108.63331818580627
Average single batch time this epoch: 3.7459667386679816
Average time per Batch: 3.7649716118286394
Average time per Epoch: 109.18446427583694
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm bini322
num threads 12
total time 557.5727863311768
2021-03-05 23:44:41.599209: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:44:42.151331: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:44:42.151810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:44:42.152097: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:44:42.152270: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:44:42.152432: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:44:42.152615: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:44:42.152823: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:44:42.153010: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:44:42.153174: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:44:42.153205: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:44:42.192270: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:44:42.192736: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9ee8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:44:42.192819: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:44:42.197470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:44:42.197514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:44:43.046255: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:44:43.046391: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:44:43.046677: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:44:43.046708: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:44:43.046731: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:44:43.046767: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:44:43.046840: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:44:43.046884: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:44:43.046901: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9f1af534c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:50:40.925161: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:50:40.947706: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:50:41.067813: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_dgemm2048/plugins/profile/2021_03_05_23_50_40
2021-03-05 23:50:41.195450: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_dgemm2048/plugins/profile/2021_03_05_23_50_40/householder.trace.json.gz
2021-03-05 23:50:41.216208: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:50:41.225584: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 23:50:41.227804: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_dgemm2048/plugins/profile/2021_03_05_23_50_40Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_dgemm2048/plugins/profile/2021_03_05_23_50_40/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_dgemm2048/plugins/profile/2021_03_05_23_50_40/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_dgemm2048/plugins/profile/2021_03_05_23_50_40/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_dgemm2048/plugins/profile/2021_03_05_23_50_40/householder.kernel_stats.pb

Time for Epoch:75.53268051147461
Average single batch time this epoch: 2.6045648887239654
Running Average Epoch time: 71.3519082069397

Time for Epoch:71.3519082069397
Average single batch time this epoch: 2.4604012390662886
Running Average Epoch time: 70.80334794521332

Time for Epoch:70.25478768348694
Average single batch time this epoch: 2.422569809288814
Running Average Epoch time: 70.67430265744527

Time for Epoch:70.41621208190918
Average single batch time this epoch: 2.42813674334822
Running Average Epoch time: 70.58307069540024

Time for Epoch:70.30937480926514
Average single batch time this epoch: 2.424452436381373
Average time per Batch: 2.433890057021174
Average time per Epoch: 70.58307069540024
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm dgemm
num threads 12
total time 360.14541888237
2021-03-05 23:50:45.912606: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:50:46.468368: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:50:46.468867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:50:46.469577: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:46.469740: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:46.469865: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:46.469990: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:46.470115: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:46.470235: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:46.470357: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:46.470397: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:50:46.504296: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:50:46.504887: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd298000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:50:46.504956: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:50:46.511377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:50:46.511421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:50:47.357115: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:50:47.357246: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:50:47.357512: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:47.357544: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:50:47.357563: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:50:47.357598: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:50:47.357641: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:50:47.357664: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:50:47.357679: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-05 23:50:48.049504: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:50:52.032180: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 23:50:52.591491: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 23:50:52.591964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 23:50:52.592286: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:52.592471: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:52.592689: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:52.592888: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:52.593099: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:52.593266: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:52.593435: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:52.593464: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 23:50:52.632230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 23:50:52.632713: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7244000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 23:50:52.632805: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 23:50:52.637208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 23:50:52.637246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 23:50:53.486346: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:50:53.486487: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 23:50:53.486783: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 23:50:53.486833: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:50:53.486853: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:50:53.486886: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:50:53.486934: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 23:50:53.486959: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:50:53.486973: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f7276e24430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 23:59:58.768591: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 23:59:58.825071: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 23:59:58.975445: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_schonhage3332048/plugins/profile/2021_03_05_23_59_58
2021-03-05 23:59:59.112139: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_schonhage3332048/plugins/profile/2021_03_05_23_59_58/householder.trace.json.gz
2021-03-05 23:59:59.134385: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 23:59:59.144204: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 23:59:59.146331: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_schonhage3332048/plugins/profile/2021_03_05_23_59_58Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_schonhage3332048/plugins/profile/2021_03_05_23_59_58/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_schonhage3332048/plugins/profile/2021_03_05_23_59_58/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_schonhage3332048/plugins/profile/2021_03_05_23_59_58/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_schonhage3332048/plugins/profile/2021_03_05_23_59_58/householder.kernel_stats.pb

Time for Epoch:112.05057501792908
Average single batch time this epoch: 3.863803740205436
Running Average Epoch time: 108.2759039402008

Time for Epoch:108.2759039402008
Average single batch time this epoch: 3.733643597569959
Running Average Epoch time: 108.30082321166992

Time for Epoch:108.32574248313904
Average single batch time this epoch: 3.7353632039037246
Running Average Epoch time: 108.25004529953003

Time for Epoch:108.14848947525024
Average single batch time this epoch: 3.7292507516926734
Running Average Epoch time: 108.30411845445633

Time for Epoch:108.46633791923523
Average single batch time this epoch: 3.740210459150117
Average time per Batch: 3.7346170030791184
Average time per Epoch: 108.30411845445633
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm schonhage333
num threads 12
total time 547.5606157779694
2021-03-06 00:00:03.438756: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 00:00:03.984395: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 00:00:03.984920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 00:00:03.985469: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:00:03.985618: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:00:03.985748: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:00:03.985881: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:00:03.986009: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:00:03.986151: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:00:03.986278: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:00:03.986302: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 00:00:04.024397: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 00:00:04.024819: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe858000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 00:00:04.024863: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 00:00:04.029071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 00:00:04.029112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 00:00:04.877464: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:00:04.877610: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 00:00:04.877898: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:00:04.877930: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:00:04.877949: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:00:04.877985: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:00:04.878028: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:00:04.878052: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:00:04.878086: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fe88b8784c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 00:07:28.612215: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:07:28.776989: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 00:07:28.898643: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2242048/plugins/profile/2021_03_06_00_07_28
2021-03-06 00:07:29.024450: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2242048/plugins/profile/2021_03_06_00_07_28/householder.trace.json.gz
2021-03-06 00:07:29.044888: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 00:07:29.054155: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 00:07:29.056287: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2242048/plugins/profile/2021_03_06_00_07_28Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2242048/plugins/profile/2021_03_06_00_07_28/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2242048/plugins/profile/2021_03_06_00_07_28/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2242048/plugins/profile/2021_03_06_00_07_28/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2242048/plugins/profile/2021_03_06_00_07_28/householder.kernel_stats.pb

Time for Epoch:91.29785346984863
Average single batch time this epoch: 3.148190301040123
Running Average Epoch time: 88.7943708896637

Time for Epoch:88.7943708896637
Average single batch time this epoch: 3.0618670808857886
Running Average Epoch time: 87.49923002719879

Time for Epoch:86.20408916473389
Average single batch time this epoch: 2.972547440693296
Running Average Epoch time: 87.60753671328227

Time for Epoch:87.82415008544922
Average single batch time this epoch: 3.0284106484774886
Running Average Epoch time: 88.10555422306061

Time for Epoch:89.59960675239563
Average single batch time this epoch: 3.0896332592799745
Average time per Batch: 3.038114607334137
Average time per Epoch: 88.10555422306061
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov224
num threads 12
total time 445.9677963256836
2021-03-06 00:07:33.338920: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 00:07:33.881356: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 00:07:33.881879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 00:07:33.892597: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:07:33.892771: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:07:33.892914: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:07:33.893063: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:07:33.893209: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:07:33.893334: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:07:33.893460: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:07:33.893483: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 00:07:33.932195: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 00:07:33.932670: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7a94000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 00:07:33.932758: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 00:07:33.937237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 00:07:33.937275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 00:07:34.787515: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:07:34.787645: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 00:07:34.787954: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:07:34.787985: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:07:34.788003: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:07:34.788038: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:07:34.788081: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:07:34.788105: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:07:34.788121: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f7ac921b4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 00:15:15.443157: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:15:15.575641: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 00:15:15.699462: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2252048/plugins/profile/2021_03_06_00_15_15
2021-03-06 00:15:15.830044: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2252048/plugins/profile/2021_03_06_00_15_15/householder.trace.json.gz
2021-03-06 00:15:15.850869: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 00:15:15.860386: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 00:15:15.862528: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2252048/plugins/profile/2021_03_06_00_15_15Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2252048/plugins/profile/2021_03_06_00_15_15/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2252048/plugins/profile/2021_03_06_00_15_15/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2252048/plugins/profile/2021_03_06_00_15_15/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2252048/plugins/profile/2021_03_06_00_15_15/householder.kernel_stats.pb

Time for Epoch:94.1485755443573
Average single batch time this epoch: 3.246492180331
Running Average Epoch time: 91.36746597290039

Time for Epoch:91.36746597290039
Average single batch time this epoch: 3.150595632092706
Running Average Epoch time: 91.52291238307953

Time for Epoch:91.67835879325867
Average single batch time this epoch: 3.161314133940072
Running Average Epoch time: 91.50385657946269

Time for Epoch:91.465744972229
Average single batch time this epoch: 3.1539841684801826
Running Average Epoch time: 91.62305533885956

Time for Epoch:91.98065161705017
Average single batch time this epoch: 3.1717387725566994
Average time per Batch: 3.159408176767415
Average time per Epoch: 91.62305533885956
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov225
num threads 12
total time 462.9351134300232
2021-03-06 00:15:20.141291: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 00:15:20.671565: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 00:15:20.672059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 00:15:20.672384: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:15:20.672584: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:15:20.672809: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:15:20.673027: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:15:20.673240: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:15:20.673416: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:15:20.673596: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:15:20.673628: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 00:15:20.712338: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 00:15:20.712731: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f492c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 00:15:20.712768: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 00:15:20.716319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 00:15:20.716357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 00:15:21.567494: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:15:21.567642: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 00:15:21.567947: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:15:21.567998: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:15:21.568018: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:15:21.568052: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:15:21.568094: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:15:21.568118: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:15:21.568133: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4961f404c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 00:23:20.037031: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:23:20.074429: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 00:23:20.221967: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2722048/plugins/profile/2021_03_06_00_23_20
2021-03-06 00:23:20.351890: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2722048/plugins/profile/2021_03_06_00_23_20/householder.trace.json.gz
2021-03-06 00:23:20.373929: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 00:23:20.383226: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 00:23:20.385425: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2722048/plugins/profile/2021_03_06_00_23_20Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2722048/plugins/profile/2021_03_06_00_23_20/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2722048/plugins/profile/2021_03_06_00_23_20/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2722048/plugins/profile/2021_03_06_00_23_20/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2722048/plugins/profile/2021_03_06_00_23_20/householder.kernel_stats.pb

Time for Epoch:97.5829610824585
Average single batch time this epoch: 3.364917459159062
Running Average Epoch time: 95.8060474395752

Time for Epoch:95.8060474395752
Average single batch time this epoch: 3.303648776021497
Running Average Epoch time: 95.4025627374649

Time for Epoch:94.99907803535461
Average single batch time this epoch: 3.2758215460284004
Running Average Epoch time: 95.3565951983134

Time for Epoch:95.26466012001038
Average single batch time this epoch: 3.2849803381952745
Running Average Epoch time: 95.21779555082321

Time for Epoch:94.80139660835266
Average single batch time this epoch: 3.269005833000972
Average time per Batch: 3.283364123311536
Average time per Epoch: 95.21779555082321
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov272
num threads 12
total time 480.70887756347656
2021-03-06 00:23:24.747376: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 00:23:25.304745: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 00:23:25.305240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 00:23:25.316930: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:23:25.317108: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:23:25.317254: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:23:25.317407: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:23:25.317555: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:23:25.317696: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:23:25.317824: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:23:25.317847: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 00:23:25.356258: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 00:23:25.356702: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8974000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 00:23:25.356760: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 00:23:25.361855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 00:23:25.361899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 00:23:26.196929: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:23:26.197084: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 00:23:26.197377: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:23:26.197407: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:23:26.197427: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:23:26.197461: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:23:26.197504: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:23:26.197528: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:23:26.197565: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f89a6ef8430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 00:32:14.945353: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:32:15.109325: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 00:32:15.228964: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3232048/plugins/profile/2021_03_06_00_32_15
2021-03-06 00:32:15.359764: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3232048/plugins/profile/2021_03_06_00_32_15/householder.trace.json.gz
2021-03-06 00:32:15.379451: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 00:32:15.388651: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 00:32:15.390807: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3232048/plugins/profile/2021_03_06_00_32_15Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3232048/plugins/profile/2021_03_06_00_32_15/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3232048/plugins/profile/2021_03_06_00_32_15/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3232048/plugins/profile/2021_03_06_00_32_15/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3232048/plugins/profile/2021_03_06_00_32_15/householder.kernel_stats.pb

Time for Epoch:105.37923264503479
Average single batch time this epoch: 3.633757311722328
Running Average Epoch time: 105.56986975669861

Time for Epoch:105.56986975669861
Average single batch time this epoch: 3.640331843803669
Running Average Epoch time: 105.62289559841156

Time for Epoch:105.67592144012451
Average single batch time this epoch: 3.6439883626740555
Running Average Epoch time: 105.7926561832428

Time for Epoch:106.13217735290527
Average single batch time this epoch: 3.6597200837628594
Running Average Epoch time: 105.83857131004333

Time for Epoch:105.97631669044495
Average single batch time this epoch: 3.6543459810059646
Average time per Batch: 3.6495965678116375
Average time per Epoch: 105.83857131004333
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov323
num threads 12
total time 531.0093142986298
2021-03-06 00:32:20.102256: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 00:32:20.687345: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 00:32:20.687819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 00:32:20.688123: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:32:20.688303: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:32:20.688486: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:32:20.688680: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:32:20.688874: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:32:20.689035: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:32:20.689199: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:32:20.689229: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 00:32:20.728426: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 00:32:20.728856: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd138000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 00:32:20.728905: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 00:32:20.733594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 00:32:20.733637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 00:32:21.590196: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:32:21.590342: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 00:32:21.590635: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:32:21.590665: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:32:21.590683: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:32:21.590718: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:32:21.590760: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:32:21.590783: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:32:21.590798: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd16d682430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 00:41:20.035654: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:41:20.152999: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 00:41:20.274177: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3332048/plugins/profile/2021_03_06_00_41_20
2021-03-06 00:41:20.402945: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3332048/plugins/profile/2021_03_06_00_41_20/householder.trace.json.gz
2021-03-06 00:41:20.422835: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 00:41:20.432092: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 00:41:20.434279: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3332048/plugins/profile/2021_03_06_00_41_20Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3332048/plugins/profile/2021_03_06_00_41_20/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3332048/plugins/profile/2021_03_06_00_41_20/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3332048/plugins/profile/2021_03_06_00_41_20/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3332048/plugins/profile/2021_03_06_00_41_20/householder.kernel_stats.pb

Time for Epoch:110.49429750442505
Average single batch time this epoch: 3.8101377651609223
Running Average Epoch time: 106.68861436843872

Time for Epoch:106.68861436843872
Average single batch time this epoch: 3.6789099759068984
Running Average Epoch time: 106.56095373630524

Time for Epoch:106.43329310417175
Average single batch time this epoch: 3.670105038018062
Running Average Epoch time: 106.8006362915039

Time for Epoch:107.28000140190125
Average single batch time this epoch: 3.6993020402974097
Running Average Epoch time: 106.98425078392029

Time for Epoch:107.53509426116943
Average single batch time this epoch: 3.7080988061839135
Average time per Batch: 3.689103965101571
Average time per Epoch: 106.98425078392029
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov333
num threads 12
total time 540.7516167163849
2021-03-06 00:41:24.763797: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 00:41:25.316721: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 00:41:25.317226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 00:41:25.325910: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:41:25.326076: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:41:25.326226: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:41:25.326361: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:41:25.326493: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:41:25.326619: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:41:25.326748: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:41:25.326773: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 00:41:25.368325: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 00:41:25.368742: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc12c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 00:41:25.368794: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 00:41:25.373612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 00:41:25.373659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 00:41:26.227537: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:41:26.227690: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 00:41:26.227998: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:41:26.228050: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:41:26.228070: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:41:26.228105: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:41:26.228149: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:41:26.228173: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:41:26.228188: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc15f2824c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 00:50:01.875352: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:50:01.918714: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 00:50:02.052972: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3342048/plugins/profile/2021_03_06_00_50_01
2021-03-06 00:50:02.187502: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3342048/plugins/profile/2021_03_06_00_50_01/householder.trace.json.gz
2021-03-06 00:50:02.209667: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 00:50:02.219292: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 00:50:02.221442: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3342048/plugins/profile/2021_03_06_00_50_01Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3342048/plugins/profile/2021_03_06_00_50_01/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3342048/plugins/profile/2021_03_06_00_50_01/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3342048/plugins/profile/2021_03_06_00_50_01/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3342048/plugins/profile/2021_03_06_00_50_01/householder.kernel_stats.pb

Time for Epoch:105.90563535690308
Average single batch time this epoch: 3.651909351348877
Running Average Epoch time: 103.48204469680786

Time for Epoch:103.48204469680786
Average single batch time this epoch: 3.5683375391466865
Running Average Epoch time: 102.63176226615906

Time for Epoch:101.78147983551025
Average single batch time this epoch: 3.509698201870096
Running Average Epoch time: 102.49480485916138

Time for Epoch:102.22089004516602
Average single batch time this epoch: 3.5248505575903533
Running Average Epoch time: 102.4317279458046

Time for Epoch:102.24249720573425
Average single batch time this epoch: 3.525595919839267
Average time per Batch: 3.5321205546116006
Average time per Epoch: 102.4317279458046
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov334
num threads 12
total time 517.9399678707123
2021-03-06 00:50:06.792598: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 00:50:07.336393: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 00:50:07.336961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 00:50:07.337668: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:50:07.337832: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:50:07.337958: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:50:07.338084: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:50:07.338229: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:50:07.338354: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:50:07.338477: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:50:07.338502: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 00:50:07.372282: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 00:50:07.372807: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f35a0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 00:50:07.372880: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 00:50:07.379451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 00:50:07.379497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 00:50:08.225321: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:50:08.225468: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 00:50:08.225749: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:50:08.225780: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:50:08.225805: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:50:08.225841: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:50:08.225883: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:50:08.225924: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:50:08.225940: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f35d40e3430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 00:57:11.331135: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:57:11.379630: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 00:57:11.530255: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov4422048/plugins/profile/2021_03_06_00_57_11
2021-03-06 00:57:11.663612: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov4422048/plugins/profile/2021_03_06_00_57_11/householder.trace.json.gz
2021-03-06 00:57:11.685692: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 00:57:11.695174: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 00:57:11.697310: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov4422048/plugins/profile/2021_03_06_00_57_11Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov4422048/plugins/profile/2021_03_06_00_57_11/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov4422048/plugins/profile/2021_03_06_00_57_11/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov4422048/plugins/profile/2021_03_06_00_57_11/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov4422048/plugins/profile/2021_03_06_00_57_11/householder.kernel_stats.pb

Time for Epoch:88.41568994522095
Average single batch time this epoch: 3.048806067170768
Running Average Epoch time: 85.00315546989441

Time for Epoch:85.00315546989441
Average single batch time this epoch: 2.931134618561843
Running Average Epoch time: 83.98333787918091

Time for Epoch:82.96352028846741
Average single batch time this epoch: 2.8608030615181756
Running Average Epoch time: 83.569748878479

Time for Epoch:82.7425708770752
Average single batch time this epoch: 2.8531836887885786
Running Average Epoch time: 83.66864293813705

Time for Epoch:83.9653251171112
Average single batch time this epoch: 2.8953492065955855
Average time per Batch: 2.885117643866046
Average time per Epoch: 83.66864293813705
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov442
num threads 12
total time 425.34637999534607
2021-03-06 00:57:16.007323: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 00:57:16.531814: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 00:57:16.532423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 00:57:16.533073: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:57:16.533240: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:57:16.533370: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:57:16.533503: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:57:16.533633: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:57:16.533760: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:57:16.533889: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:57:16.533928: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 00:57:16.568280: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 00:57:16.568652: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f19b4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 00:57:16.568713: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 00:57:16.573015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 00:57:16.573060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 00:57:17.418619: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:57:17.418807: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 00:57:17.419066: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 00:57:17.419100: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:57:17.419120: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:57:17.419190: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:57:17.419260: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 00:57:17.419286: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 00:57:17.419301: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f19e83c5430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 01:04:28.877314: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:04:29.028368: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 01:04:29.158415: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov4442048/plugins/profile/2021_03_06_01_04_29
2021-03-06 01:04:29.290736: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov4442048/plugins/profile/2021_03_06_01_04_29/householder.trace.json.gz
2021-03-06 01:04:29.312935: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 01:04:29.322619: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-06 01:04:29.324739: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov4442048/plugins/profile/2021_03_06_01_04_29Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov4442048/plugins/profile/2021_03_06_01_04_29/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov4442048/plugins/profile/2021_03_06_01_04_29/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov4442048/plugins/profile/2021_03_06_01_04_29/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov4442048/plugins/profile/2021_03_06_01_04_29/householder.kernel_stats.pb

Time for Epoch:89.26113224029541
Average single batch time this epoch: 3.0779532564097436
Running Average Epoch time: 86.88550591468811

Time for Epoch:86.88550591468811
Average single batch time this epoch: 2.9960447262073386
Running Average Epoch time: 86.6174521446228

Time for Epoch:86.3493983745575
Average single batch time this epoch: 2.9775573878452697
Running Average Epoch time: 85.77000427246094

Time for Epoch:84.0751085281372
Average single batch time this epoch: 2.899134693474605
Running Average Epoch time: 85.5435643196106

Time for Epoch:84.86424446105957
Average single batch time this epoch: 2.926345027726272
Average time per Batch: 2.9497704588133717
Average time per Epoch: 85.5435643196106
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov444
num threads 12
total time 433.6703724861145
2021-03-06 01:04:33.738819: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 01:04:34.295294: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 01:04:34.295745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 01:04:34.305300: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:04:34.305488: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:04:34.305617: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:04:34.305751: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:04:34.305883: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:04:34.306009: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:04:34.306134: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:04:34.306160: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 01:04:34.340199: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 01:04:34.340595: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f637c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 01:04:34.340652: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 01:04:34.344668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 01:04:34.344709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 01:04:35.208308: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 01:04:35.208455: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 01:04:35.209306: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:04:35.209336: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:04:35.209371: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:04:35.209410: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:04:35.209459: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 01:04:35.209484: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:04:35.209499: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f63b02424c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 01:13:34.322993: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:13:34.456330: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 01:13:34.576530: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov5522048/plugins/profile/2021_03_06_01_13_34
2021-03-06 01:13:34.701044: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov5522048/plugins/profile/2021_03_06_01_13_34/householder.trace.json.gz
2021-03-06 01:13:34.721818: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 01:13:34.731026: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 01:13:34.733209: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov5522048/plugins/profile/2021_03_06_01_13_34Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov5522048/plugins/profile/2021_03_06_01_13_34/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov5522048/plugins/profile/2021_03_06_01_13_34/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov5522048/plugins/profile/2021_03_06_01_13_34/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov5522048/plugins/profile/2021_03_06_01_13_34/householder.kernel_stats.pb

Time for Epoch:110.47787427902222
Average single batch time this epoch: 3.8095716114701896
Running Average Epoch time: 108.18435382843018

Time for Epoch:108.18435382843018
Average single batch time this epoch: 3.7304860312363197
Running Average Epoch time: 108.31960225105286

Time for Epoch:108.45485067367554
Average single batch time this epoch: 3.7398148733994057
Running Average Epoch time: 107.73695373535156

Time for Epoch:106.57165670394897
Average single batch time this epoch: 3.674877117420065
Running Average Epoch time: 107.1550242304802

Time for Epoch:105.40923571586609
Average single batch time this epoch: 3.6347943503281166
Average time per Batch: 3.694993093095977
Average time per Epoch: 107.1550242304802
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov552
num threads 12
total time 541.411625623703
2021-03-06 01:13:39.208145: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 01:13:39.751369: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 01:13:39.751838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 01:13:39.752429: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:13:39.752571: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:13:39.752709: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:13:39.752858: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:13:39.753020: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:13:39.753143: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:13:39.753269: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:13:39.753292: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 01:13:39.792260: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 01:13:39.792685: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4008000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 01:13:39.792733: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 01:13:39.796669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 01:13:39.796710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 01:13:40.646955: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 01:13:40.647097: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 01:13:40.647384: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:13:40.647415: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:13:40.647433: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:13:40.647468: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:13:40.647532: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 01:13:40.647558: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:13:40.647573: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f403dbeb430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 01:22:57.951251: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:22:58.020434: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 01:22:58.169987: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov5552048/plugins/profile/2021_03_06_01_22_58
2021-03-06 01:22:58.306508: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov5552048/plugins/profile/2021_03_06_01_22_58/householder.trace.json.gz
2021-03-06 01:22:58.333386: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 01:22:58.343347: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 01:22:58.345467: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov5552048/plugins/profile/2021_03_06_01_22_58Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov5552048/plugins/profile/2021_03_06_01_22_58/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov5552048/plugins/profile/2021_03_06_01_22_58/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov5552048/plugins/profile/2021_03_06_01_22_58/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov5552048/plugins/profile/2021_03_06_01_22_58/householder.kernel_stats.pb

Time for Epoch:112.83606886863708
Average single batch time this epoch: 3.8908888060471107
Running Average Epoch time: 110.16756343841553

Time for Epoch:110.16756343841553
Average single batch time this epoch: 3.7988740000231513
Running Average Epoch time: 110.85229754447937

Time for Epoch:111.53703165054321
Average single batch time this epoch: 3.84609159929999
Running Average Epoch time: 110.9195597966512

Time for Epoch:111.05408430099487
Average single batch time this epoch: 3.829441547393799
Running Average Epoch time: 111.1108278632164

Time for Epoch:111.68463206291199
Average single batch time this epoch: 3.85118580686635
Average time per Batch: 3.8313982383958223
Average time per Epoch: 111.1108278632164
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov555
num threads 12
total time 559.5704891681671
2021-03-06 01:23:02.878736: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 01:23:03.431542: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 01:23:03.432236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 01:23:03.439499: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:23:03.439684: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:23:03.439825: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:23:03.439954: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:23:03.440080: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:23:03.440203: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:23:03.440328: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:23:03.440368: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 01:23:03.472246: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 01:23:03.472629: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7e90000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 01:23:03.472678: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 01:23:03.476242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 01:23:03.476284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 01:23:06.649705: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 01:23:06.649865: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 01:23:06.650148: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:23:06.650181: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:23:06.650201: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:23:06.650238: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:23:06.650282: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 01:23:06.650306: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:23:06.650321: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f7ec43d14c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 01:43:34.417503: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:43:34.538442: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 01:43:34.599428: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_bini3224096/plugins/profile/2021_03_06_01_43_34
2021-03-06 01:43:34.664113: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_bini3224096/plugins/profile/2021_03_06_01_43_34/householder.trace.json.gz
2021-03-06 01:43:34.672745: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 01:43:34.677428: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 01:43:34.679439: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_bini3224096/plugins/profile/2021_03_06_01_43_34Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_bini3224096/plugins/profile/2021_03_06_01_43_34/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_bini3224096/plugins/profile/2021_03_06_01_43_34/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_bini3224096/plugins/profile/2021_03_06_01_43_34/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_bini3224096/plugins/profile/2021_03_06_01_43_34/householder.kernel_stats.pb

Time for Epoch:270.55632615089417
Average single batch time this epoch: 19.32542324066162
Running Average Epoch time: 249.4508237838745

Time for Epoch:249.4508237838745
Average single batch time this epoch: 17.817889298711503
Running Average Epoch time: 243.0656270980835

Time for Epoch:236.68043041229248
Average single batch time this epoch: 16.905719144003733
Running Average Epoch time: 240.0232174396515

Time for Epoch:233.93839812278748
Average single batch time this epoch: 16.70985700402941
Running Average Epoch time: 239.29808527231216

Time for Epoch:237.1226887702942
Average single batch time this epoch: 16.937306097575597
Average time per Batch: 17.09269288608006
Average time per Epoch: 239.29808527231216
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm bini322
num threads 12
total time 1232.3494200706482
2021-03-06 01:43:38.957815: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 01:43:39.519281: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 01:43:39.519758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 01:43:39.528856: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:43:39.529045: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:43:39.529182: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:43:39.529310: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:43:39.529440: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:43:39.529565: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:43:39.529692: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:43:39.529718: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 01:43:39.564243: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 01:43:39.564659: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6574000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 01:43:39.564721: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 01:43:39.569032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 01:43:39.569077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 01:43:42.715851: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 01:43:42.716013: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 01:43:42.716295: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 01:43:42.716325: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:43:42.716345: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:43:42.716379: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:43:42.716422: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 01:43:42.716446: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 01:43:42.716461: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f65a9ba64c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 02:02:05.172192: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:02:05.298079: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 02:02:05.361531: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_dgemm4096/plugins/profile/2021_03_06_02_02_05
2021-03-06 02:02:05.426671: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_dgemm4096/plugins/profile/2021_03_06_02_02_05/householder.trace.json.gz
2021-03-06 02:02:05.435493: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 02:02:05.440169: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 02:02:05.442223: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_dgemm4096/plugins/profile/2021_03_06_02_02_05Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_dgemm4096/plugins/profile/2021_03_06_02_02_05/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_dgemm4096/plugins/profile/2021_03_06_02_02_05/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_dgemm4096/plugins/profile/2021_03_06_02_02_05/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_dgemm4096/plugins/profile/2021_03_06_02_02_05/householder.kernel_stats.pb

Time for Epoch:223.11602330207825
Average single batch time this epoch: 15.93683670248304
Running Average Epoch time: 221.9569787979126

Time for Epoch:221.9569787979126
Average single batch time this epoch: 15.854050193514142
Running Average Epoch time: 221.118093252182

Time for Epoch:220.27920770645142
Average single batch time this epoch: 15.734207596097674
Running Average Epoch time: 219.24665673573813

Time for Epoch:215.50378370285034
Average single batch time this epoch: 15.393107448305402
Running Average Epoch time: 219.83133804798126

Time for Epoch:221.5853819847107
Average single batch time this epoch: 15.827505299023219
Average time per Batch: 15.702217634235108
Average time per Epoch: 219.83133804798126
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm dgemm
num threads 12
total time 1107.0326180458069
2021-03-06 02:02:09.715489: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 02:02:10.272364: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 02:02:10.272975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 02:02:10.273635: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:10.273797: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:10.273923: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:10.274051: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:10.274195: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:10.274317: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:10.274441: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:10.274466: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 02:02:10.308220: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 02:02:10.308648: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f78d0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 02:02:10.308709: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 02:02:10.312687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 02:02:10.312729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 02:02:13.461891: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 02:02:13.462041: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 02:02:13.462322: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:13.462354: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:02:13.462374: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:02:13.462411: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:02:13.462473: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 02:02:13.462498: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:02:13.462513: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-06 02:02:14.191206: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:02:18.199848: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 02:02:18.751584: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 02:02:18.752081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 02:02:18.752409: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:18.752603: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:18.752799: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:18.753005: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:18.753211: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:18.753386: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:18.753566: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:18.753599: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 02:02:18.792325: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 02:02:18.792735: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc944000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 02:02:18.792773: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 02:02:18.796214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 02:02:18.796253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 02:02:21.966581: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 02:02:21.966727: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 02:02:21.967525: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:02:21.967568: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:02:21.967591: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:02:21.967625: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:02:21.967667: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 02:02:21.967691: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:02:21.967706: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc9774124c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 02:22:46.074511: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:22:46.207281: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 02:22:46.273016: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_schonhage3334096/plugins/profile/2021_03_06_02_22_46
2021-03-06 02:22:46.340718: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_schonhage3334096/plugins/profile/2021_03_06_02_22_46/householder.trace.json.gz
2021-03-06 02:22:46.350056: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 02:22:46.354845: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 02:22:46.356959: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_schonhage3334096/plugins/profile/2021_03_06_02_22_46Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_schonhage3334096/plugins/profile/2021_03_06_02_22_46/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_schonhage3334096/plugins/profile/2021_03_06_02_22_46/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_schonhage3334096/plugins/profile/2021_03_06_02_22_46/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_schonhage3334096/plugins/profile/2021_03_06_02_22_46/householder.kernel_stats.pb

Time for Epoch:248.27912759780884
Average single batch time this epoch: 17.73420284475599
Running Average Epoch time: 242.14266991615295

Time for Epoch:242.14266991615295
Average single batch time this epoch: 17.295886789049423
Running Average Epoch time: 243.2989161014557

Time for Epoch:244.45516228675842
Average single batch time this epoch: 17.461059434073313
Running Average Epoch time: 243.27966125806174

Time for Epoch:243.2411515712738
Average single batch time this epoch: 17.374350326401846
Running Average Epoch time: 243.95328891277313

Time for Epoch:245.97417187690735
Average single batch time this epoch: 17.56956136226654
Average time per Batch: 17.425214477947783
Average time per Epoch: 243.95328891277313
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm schonhage333
num threads 12
total time 1228.7042145729065
2021-03-06 02:22:50.623592: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 02:22:51.183279: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 02:22:51.183762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 02:22:51.184468: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:22:51.184612: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:22:51.184772: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:22:51.184921: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:22:51.185069: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:22:51.185192: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:22:51.185316: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:22:51.185338: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 02:22:51.224260: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 02:22:51.224704: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f973c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 02:22:51.224773: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 02:22:51.229915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 02:22:51.229958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 02:22:54.382440: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 02:22:54.382586: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 02:22:54.382867: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:22:54.382917: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:22:54.382937: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:22:54.382972: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:22:54.383014: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 02:22:54.383037: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:22:54.383052: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f976e6bd4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 02:41:10.089576: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:41:10.209741: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 02:41:10.273329: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2244096/plugins/profile/2021_03_06_02_41_10
2021-03-06 02:41:10.338603: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2244096/plugins/profile/2021_03_06_02_41_10/householder.trace.json.gz
2021-03-06 02:41:10.347354: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 02:41:10.352082: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 02:41:10.354133: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2244096/plugins/profile/2021_03_06_02_41_10Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2244096/plugins/profile/2021_03_06_02_41_10/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2244096/plugins/profile/2021_03_06_02_41_10/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2244096/plugins/profile/2021_03_06_02_41_10/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2244096/plugins/profile/2021_03_06_02_41_10/householder.kernel_stats.pb

Time for Epoch:221.71923971176147
Average single batch time this epoch: 15.83707092489515
Running Average Epoch time: 217.9758927822113

Time for Epoch:217.9758927822113
Average single batch time this epoch: 15.56969049998692
Running Average Epoch time: 218.7162754535675

Time for Epoch:219.4566581249237
Average single batch time this epoch: 15.675458329064506
Running Average Epoch time: 218.94751127560934

Time for Epoch:219.409982919693
Average single batch time this epoch: 15.672123347009931
Running Average Epoch time: 218.49322229623795

Time for Epoch:217.13035535812378
Average single batch time this epoch: 15.509294271469116
Average time per Batch: 15.606641611882619
Average time per Epoch: 218.49322229623795
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov224
num threads 12
total time 1100.2824132442474
2021-03-06 02:41:14.662339: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 02:41:15.211762: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 02:41:15.212416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 02:41:15.212876: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:41:15.213027: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:41:15.213154: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:41:15.213282: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:41:15.213406: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:41:15.213541: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:41:15.213663: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:41:15.213688: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 02:41:15.252414: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 02:41:15.252860: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa490000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 02:41:15.252928: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 02:41:15.258462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 02:41:15.258509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 02:41:18.393925: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 02:41:18.394077: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 02:41:18.394381: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 02:41:18.394413: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:41:18.394433: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:41:18.394468: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:41:18.394511: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 02:41:18.394535: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 02:41:18.394566: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa4c60af4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 03:00:54.538614: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:00:54.662662: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 03:00:54.729072: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2254096/plugins/profile/2021_03_06_03_00_54
2021-03-06 03:00:54.795945: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2254096/plugins/profile/2021_03_06_03_00_54/householder.trace.json.gz
2021-03-06 03:00:54.805191: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 03:00:54.809947: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 03:00:54.811966: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2254096/plugins/profile/2021_03_06_03_00_54Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2254096/plugins/profile/2021_03_06_03_00_54/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2254096/plugins/profile/2021_03_06_03_00_54/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2254096/plugins/profile/2021_03_06_03_00_54/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2254096/plugins/profile/2021_03_06_03_00_54/householder.kernel_stats.pb

Time for Epoch:239.67623043060303
Average single batch time this epoch: 17.119711875915527
Running Average Epoch time: 235.4986388683319

Time for Epoch:235.4986388683319
Average single batch time this epoch: 16.821315748350962
Running Average Epoch time: 235.84962809085846

Time for Epoch:236.200617313385
Average single batch time this epoch: 16.87145435810089
Running Average Epoch time: 235.6883712609609

Time for Epoch:235.36585760116577
Average single batch time this epoch: 16.811830401420593
Running Average Epoch time: 234.1136686205864

Time for Epoch:229.3895606994629
Average single batch time this epoch: 16.38495591708592
Average time per Batch: 16.722389106239593
Average time per Epoch: 234.1136686205864
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov225
num threads 12
total time 1180.6870291233063
2021-03-06 03:00:59.052015: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 03:00:59.606134: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 03:00:59.606617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 03:00:59.607220: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:00:59.607371: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:00:59.607502: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:00:59.607635: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:00:59.607760: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:00:59.607899: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:00:59.608029: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:00:59.608067: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 03:00:59.644422: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 03:00:59.644866: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5558000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 03:00:59.644916: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 03:00:59.649620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 03:00:59.649665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 03:01:02.790687: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 03:01:02.790844: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 03:01:02.791128: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:01:02.791159: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:01:02.791179: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:01:02.791215: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:01:02.791258: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 03:01:02.791282: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:01:02.791297: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f558da6d430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 03:24:14.772221: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:24:14.927092: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 03:24:14.990216: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2724096/plugins/profile/2021_03_06_03_24_14
2021-03-06 03:24:15.057006: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2724096/plugins/profile/2021_03_06_03_24_14/householder.trace.json.gz
2021-03-06 03:24:15.065661: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 03:24:15.070298: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 03:24:15.072288: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2724096/plugins/profile/2021_03_06_03_24_14Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2724096/plugins/profile/2021_03_06_03_24_14/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2724096/plugins/profile/2021_03_06_03_24_14/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2724096/plugins/profile/2021_03_06_03_24_14/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2724096/plugins/profile/2021_03_06_03_24_14/householder.kernel_stats.pb

Time for Epoch:294.0363051891327
Average single batch time this epoch: 21.002572996275767
Running Average Epoch time: 273.81006026268005

Time for Epoch:273.81006026268005
Average single batch time this epoch: 19.55784216948918
Running Average Epoch time: 275.25400400161743

Time for Epoch:276.6979477405548
Average single batch time this epoch: 19.764118875776017
Running Average Epoch time: 274.533080180486

Time for Epoch:273.09123253822327
Average single batch time this epoch: 19.506498881748744
Running Average Epoch time: 274.4829988479614

Time for Epoch:274.3327548503876
Average single batch time this epoch: 19.595174602099828
Average time per Batch: 19.605908632278442
Average time per Epoch: 274.4829988479614
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov272
num threads 12
total time 1396.520385503769
2021-03-06 03:24:19.341489: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 03:24:19.895177: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 03:24:19.895652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 03:24:19.896516: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:24:19.896686: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:24:19.896836: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:24:19.896971: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:24:19.897101: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:24:19.897227: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:24:19.897365: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:24:19.897392: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 03:24:19.928303: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 03:24:19.928713: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fea68000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 03:24:19.928776: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 03:24:19.932154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 03:24:19.932196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 03:24:23.136229: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 03:24:23.136379: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 03:24:23.137272: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:24:23.137306: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:24:23.137325: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:24:23.137393: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:24:23.137476: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 03:24:23.137505: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:24:23.137521: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fea9afa54c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 03:43:21.899549: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:43:22.044710: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 03:43:22.106690: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3234096/plugins/profile/2021_03_06_03_43_22
2021-03-06 03:43:22.171147: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3234096/plugins/profile/2021_03_06_03_43_22/householder.trace.json.gz
2021-03-06 03:43:22.179566: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 03:43:22.184187: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 03:43:22.186174: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3234096/plugins/profile/2021_03_06_03_43_22Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3234096/plugins/profile/2021_03_06_03_43_22/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3234096/plugins/profile/2021_03_06_03_43_22/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3234096/plugins/profile/2021_03_06_03_43_22/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3234096/plugins/profile/2021_03_06_03_43_22/householder.kernel_stats.pb

Time for Epoch:229.8667335510254
Average single batch time this epoch: 16.419032795088633
Running Average Epoch time: 224.0944948196411

Time for Epoch:224.0944948196411
Average single batch time this epoch: 16.006733093942916
Running Average Epoch time: 225.7796767950058

Time for Epoch:227.46485877037048
Average single batch time this epoch: 16.247473546436854
Running Average Epoch time: 226.5090560913086

Time for Epoch:227.96781468391418
Average single batch time this epoch: 16.283396789005824
Running Average Epoch time: 227.2205581665039

Time for Epoch:229.35506439208984
Average single batch time this epoch: 16.38248666695186
Average time per Batch: 16.230022524084365
Average time per Epoch: 227.2205581665039
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov323
num threads 12
total time 1143.3760435581207
2021-03-06 03:43:26.516121: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 03:43:27.051283: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 03:43:27.051748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 03:43:27.052464: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:43:27.052644: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:43:27.052787: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:43:27.052937: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:43:27.053102: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:43:27.053226: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:43:27.053353: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:43:27.053376: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 03:43:27.092149: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 03:43:27.092639: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5d88000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 03:43:27.092729: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 03:43:27.097858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 03:43:27.097901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 03:43:30.254093: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 03:43:30.254235: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 03:43:30.254520: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 03:43:30.254550: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:43:30.254568: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:43:30.254603: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:43:30.254668: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 03:43:30.254717: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 03:43:30.254734: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5dbb5a44c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 04:03:33.476227: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:03:33.608603: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 04:03:33.677168: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3334096/plugins/profile/2021_03_06_04_03_33
2021-03-06 04:03:33.745208: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3334096/plugins/profile/2021_03_06_04_03_33/householder.trace.json.gz
2021-03-06 04:03:33.754696: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 04:03:33.759528: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 04:03:33.761588: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3334096/plugins/profile/2021_03_06_04_03_33Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3334096/plugins/profile/2021_03_06_04_03_33/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3334096/plugins/profile/2021_03_06_04_03_33/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3334096/plugins/profile/2021_03_06_04_03_33/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3334096/plugins/profile/2021_03_06_04_03_33/householder.kernel_stats.pb

Time for Epoch:240.66332125663757
Average single batch time this epoch: 17.190215587615967
Running Average Epoch time: 242.16757988929749

Time for Epoch:242.16757988929749
Average single batch time this epoch: 17.2976610490254
Running Average Epoch time: 241.38193917274475

Time for Epoch:240.59629845619202
Average single batch time this epoch: 17.185429300580704
Running Average Epoch time: 240.3022616704305

Time for Epoch:238.142906665802
Average single batch time this epoch: 17.01018794945308
Running Average Epoch time: 240.6358333826065

Time for Epoch:241.63654851913452
Average single batch time this epoch: 17.259731565202987
Average time per Batch: 17.188252466065542
Average time per Epoch: 240.6358333826065
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov333
num threads 12
total time 1207.7889428138733
2021-03-06 04:03:38.046102: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 04:03:38.569381: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 04:03:38.569914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 04:03:38.570499: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:03:38.570645: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:03:38.570775: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:03:38.570907: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:03:38.571037: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:03:38.571181: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:03:38.571310: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:03:38.571349: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 04:03:38.608379: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 04:03:38.608739: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8a80000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 04:03:38.608788: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 04:03:38.612042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 04:03:38.612083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 04:03:41.774121: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 04:03:41.774257: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 04:03:41.775067: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:03:41.775110: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:03:41.775137: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:03:41.775204: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:03:41.775249: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 04:03:41.775273: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:03:41.775288: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8ab54034c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 04:22:14.235108: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:22:14.362917: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 04:22:14.424666: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3344096/plugins/profile/2021_03_06_04_22_14
2021-03-06 04:22:14.488584: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3344096/plugins/profile/2021_03_06_04_22_14/householder.trace.json.gz
2021-03-06 04:22:14.496975: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 04:22:14.501530: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 04:22:14.503472: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3344096/plugins/profile/2021_03_06_04_22_14Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3344096/plugins/profile/2021_03_06_04_22_14/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3344096/plugins/profile/2021_03_06_04_22_14/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3344096/plugins/profile/2021_03_06_04_22_14/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3344096/plugins/profile/2021_03_06_04_22_14/householder.kernel_stats.pb

Time for Epoch:230.48395442962646
Average single batch time this epoch: 16.463119336536952
Running Average Epoch time: 224.0991280078888

Time for Epoch:224.0991280078888
Average single batch time this epoch: 16.00706229891096
Running Average Epoch time: 222.39490735530853

Time for Epoch:220.69068670272827
Average single batch time this epoch: 15.763604317392621
Running Average Epoch time: 221.5798343817393

Time for Epoch:219.94968843460083
Average single batch time this epoch: 15.710676840373448
Running Average Epoch time: 220.49061703681946

Time for Epoch:217.22296500205994
Average single batch time this epoch: 15.51590987614223
Average time per Batch: 15.749313333204814
Average time per Epoch: 220.49061703681946
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov334
num threads 12
total time 1117.0077188014984
2021-03-06 04:22:18.807580: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 04:22:19.332121: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 04:22:19.332624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 04:22:19.341118: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:22:19.341309: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:22:19.341454: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:22:19.341605: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:22:19.341756: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:22:19.341882: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:22:19.342010: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:22:19.342034: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 04:22:19.380348: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 04:22:19.380815: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2d60000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 04:22:19.380873: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 04:22:19.385928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 04:22:19.385972: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 04:22:22.630283: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 04:22:22.630447: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 04:22:22.631259: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:22:22.631289: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:22:22.631311: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:22:22.631346: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:22:22.631393: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 04:22:22.631418: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:22:22.631433: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f2d95d56430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 04:40:14.149250: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:40:14.279859: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 04:40:14.346229: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov4424096/plugins/profile/2021_03_06_04_40_14
2021-03-06 04:40:14.414482: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov4424096/plugins/profile/2021_03_06_04_40_14/householder.trace.json.gz
2021-03-06 04:40:14.423838: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 04:40:14.428598: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 04:40:14.430669: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov4424096/plugins/profile/2021_03_06_04_40_14Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov4424096/plugins/profile/2021_03_06_04_40_14/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov4424096/plugins/profile/2021_03_06_04_40_14/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov4424096/plugins/profile/2021_03_06_04_40_14/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov4424096/plugins/profile/2021_03_06_04_40_14/householder.kernel_stats.pb

Time for Epoch:219.7679102420807
Average single batch time this epoch: 15.697687642914909
Running Average Epoch time: 208.70791006088257

Time for Epoch:208.70791006088257
Average single batch time this epoch: 14.907688890184675
Running Average Epoch time: 209.7216054201126

Time for Epoch:210.73530077934265
Average single batch time this epoch: 15.05250528880528
Running Average Epoch time: 212.06100177764893

Time for Epoch:216.73979449272156
Average single batch time this epoch: 15.481392792293004
Running Average Epoch time: 212.933620095253

Time for Epoch:215.55147504806519
Average single batch time this epoch: 15.396512985229492
Average time per Batch: 15.209524989128113
Average time per Epoch: 212.933620095253
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov442
num threads 12
total time 1076.161926984787
2021-03-06 04:40:18.721085: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 04:40:19.241664: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 04:40:19.242169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 04:40:19.254519: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:40:19.254668: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:40:19.254798: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:40:19.254929: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:40:19.255077: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:40:19.255202: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:40:19.255328: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:40:19.255353: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 04:40:19.292430: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 04:40:19.292978: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff308000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 04:40:19.293060: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 04:40:19.298549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 04:40:19.298597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 04:40:22.437551: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 04:40:22.437699: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 04:40:22.437986: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:40:22.438018: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:40:22.438038: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:40:22.438074: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:40:22.438135: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 04:40:22.438161: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:40:22.438176: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ff33a9f6430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 04:58:39.188857: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:58:39.307042: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 04:58:39.373333: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov4444096/plugins/profile/2021_03_06_04_58_39
2021-03-06 04:58:39.443327: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov4444096/plugins/profile/2021_03_06_04_58_39/householder.trace.json.gz
2021-03-06 04:58:39.452642: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 04:58:39.457456: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 04:58:39.459492: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov4444096/plugins/profile/2021_03_06_04_58_39Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov4444096/plugins/profile/2021_03_06_04_58_39/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov4444096/plugins/profile/2021_03_06_04_58_39/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov4444096/plugins/profile/2021_03_06_04_58_39/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov4444096/plugins/profile/2021_03_06_04_58_39/householder.kernel_stats.pb

Time for Epoch:225.87036752700806
Average single batch time this epoch: 16.133579117911204
Running Average Epoch time: 214.67629671096802

Time for Epoch:214.67629671096802
Average single batch time this epoch: 15.334007757050651
Running Average Epoch time: 216.55033087730408

Time for Epoch:218.42436504364014
Average single batch time this epoch: 15.601724846022469
Running Average Epoch time: 217.32837812105814

Time for Epoch:218.88447260856628
Average single batch time this epoch: 15.634584716388158
Running Average Epoch time: 217.7168111205101

Time for Epoch:218.88211011886597
Average single batch time this epoch: 15.634421893528529
Average time per Batch: 15.551184803247452
Average time per Epoch: 217.7168111205101
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov444
num threads 12
total time 1101.268877029419
2021-03-06 04:58:43.765451: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 04:58:44.315352: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 04:58:44.315840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 04:58:44.316570: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:58:44.316732: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:58:44.316869: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:58:44.317007: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:58:44.317137: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:58:44.317263: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:58:44.317393: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:58:44.317433: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 04:58:44.352236: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 04:58:44.352688: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5e94000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 04:58:44.352751: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 04:58:44.356757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 04:58:44.356799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 04:58:47.510649: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 04:58:47.510798: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 04:58:47.511098: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 04:58:47.511128: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:58:47.511147: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:58:47.511181: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:58:47.511224: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 04:58:47.511247: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 04:58:47.511262: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5ec90604c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 05:16:28.189293: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 05:16:28.311702: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 05:16:28.374849: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov5524096/plugins/profile/2021_03_06_05_16_28
2021-03-06 05:16:28.440796: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov5524096/plugins/profile/2021_03_06_05_16_28/householder.trace.json.gz
2021-03-06 05:16:28.449642: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 05:16:28.454325: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 05:16:28.456391: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov5524096/plugins/profile/2021_03_06_05_16_28Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov5524096/plugins/profile/2021_03_06_05_16_28/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov5524096/plugins/profile/2021_03_06_05_16_28/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov5524096/plugins/profile/2021_03_06_05_16_28/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov5524096/plugins/profile/2021_03_06_05_16_28/householder.kernel_stats.pb

Time for Epoch:214.3605432510376
Average single batch time this epoch: 15.311450958251953
Running Average Epoch time: 215.02335786819458

Time for Epoch:215.02335786819458
Average single batch time this epoch: 15.358793548175267
Running Average Epoch time: 214.196981549263

Time for Epoch:213.37060523033142
Average single batch time this epoch: 15.240742308752877
Running Average Epoch time: 213.1380418141683

Time for Epoch:211.02016234397888
Average single batch time this epoch: 15.072851743016924
Running Average Epoch time: 211.57549965381622

Time for Epoch:206.88787317276
Average single batch time this epoch: 14.777691057750157
Average time per Batch: 15.112519664423807
Average time per Epoch: 211.57549965381622
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov552
num threads 12
total time 1065.2506983280182
2021-03-06 05:16:32.728021: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 05:16:33.268924: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 05:16:33.269444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 05:16:33.270317: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:16:33.270499: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:16:33.270629: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:16:33.270762: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:16:33.270891: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:16:33.271022: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:16:33.271150: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:16:33.271175: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 05:16:33.304368: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 05:16:33.304789: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fea90000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 05:16:33.304853: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 05:16:33.308291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 05:16:33.308335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 05:16:36.518814: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 05:16:36.518969: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 05:16:36.519804: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:16:36.519835: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 05:16:36.519854: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 05:16:36.519922: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 05:16:36.520011: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 05:16:36.520038: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 05:16:36.520054: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7feac2a9d430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 05:34:40.940351: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 05:34:41.063579: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 05:34:41.129925: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov5554096/plugins/profile/2021_03_06_05_34_41
2021-03-06 05:34:41.197561: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov5554096/plugins/profile/2021_03_06_05_34_41/householder.trace.json.gz
2021-03-06 05:34:41.206865: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 05:34:41.211707: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 05:34:41.213739: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov5554096/plugins/profile/2021_03_06_05_34_41Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov5554096/plugins/profile/2021_03_06_05_34_41/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov5554096/plugins/profile/2021_03_06_05_34_41/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov5554096/plugins/profile/2021_03_06_05_34_41/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov5554096/plugins/profile/2021_03_06_05_34_41/householder.kernel_stats.pb

Time for Epoch:220.6147346496582
Average single batch time this epoch: 15.758179766791207
Running Average Epoch time: 216.87356042861938

Time for Epoch:216.87356042861938
Average single batch time this epoch: 15.490954416138786
Running Average Epoch time: 216.50616562366486

Time for Epoch:216.13877081871033
Average single batch time this epoch: 15.438469086374555
Running Average Epoch time: 216.3647743066152

Time for Epoch:216.08199167251587
Average single batch time this epoch: 15.434413484164647
Running Average Epoch time: 215.94817489385605

Time for Epoch:214.6983766555786
Average single batch time this epoch: 15.335583976336888
Average time per Batch: 15.424855240753718
Average time per Epoch: 215.94817489385605
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov555
num threads 12
total time 1089.0367693901062
2021-03-06 05:34:45.564084: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 05:34:46.105025: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 05:34:46.105516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 05:34:46.106177: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:34:46.106343: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:34:46.106470: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:34:46.106597: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:34:46.106741: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:34:46.106865: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:34:46.106989: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:34:46.107013: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 05:34:46.140305: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 05:34:46.140865: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa094000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 05:34:46.140934: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 05:34:46.147380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 05:34:46.147427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 05:34:58.384897: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 05:34:58.385053: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 05:34:58.385899: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 05:34:58.385931: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 05:34:58.385954: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 05:34:58.385998: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 05:34:58.386069: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 05:34:58.386095: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 05:34:58.386110: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa0c7522430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 06:38:17.859141: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 06:38:17.868512: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 06:38:17.906489: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_bini3228192/plugins/profile/2021_03_06_06_38_17
2021-03-06 06:38:17.943695: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_bini3228192/plugins/profile/2021_03_06_06_38_17/householder.trace.json.gz
2021-03-06 06:38:17.948479: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 06:38:17.951211: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 06:38:17.953110: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_bini3228192/plugins/profile/2021_03_06_06_38_17Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_bini3228192/plugins/profile/2021_03_06_06_38_17/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_bini3228192/plugins/profile/2021_03_06_06_38_17/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_bini3228192/plugins/profile/2021_03_06_06_38_17/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_bini3228192/plugins/profile/2021_03_06_06_38_17/householder.kernel_stats.pb

Time for Epoch:966.76304936409
Average single batch time this epoch: 138.10897306033544
Running Average Epoch time: 706.4750537872314

Time for Epoch:706.4750537872314
Average single batch time this epoch: 100.92497273853847
Running Average Epoch time: 704.270256280899

Time for Epoch:702.0654587745667
Average single batch time this epoch: 100.29503216062274
Running Average Epoch time: 712.0260790189108

Time for Epoch:727.5377244949341
Average single batch time this epoch: 103.93392794472831
Running Average Epoch time: 708.172626554966

Time for Epoch:696.6122691631317
Average single batch time this epoch: 99.51600524357387
Average time per Batch: 101.16748452186584
Average time per Epoch: 708.172626554966
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm bini322
num threads 12
total time 3813.10733127594
2021-03-06 06:38:22.358445: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 06:38:22.919479: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 06:38:22.920019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 06:38:22.920643: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 06:38:22.920811: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 06:38:22.920940: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 06:38:22.921087: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 06:38:22.921233: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 06:38:22.921377: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 06:38:22.921506: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 06:38:22.921547: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 06:38:22.960304: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 06:38:22.960825: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0ad0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 06:38:22.960911: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 06:38:22.965921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 06:38:22.965966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 06:38:35.086171: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 06:38:35.086318: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 06:38:35.087102: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 06:38:35.087133: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 06:38:35.087151: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 06:38:35.087185: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 06:38:35.087227: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 06:38:35.087251: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 06:38:35.087266: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f0b05de7430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 07:26:46.496820: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 07:26:46.505609: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 07:26:46.542811: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_dgemm8192/plugins/profile/2021_03_06_07_26_46
2021-03-06 07:26:46.579466: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_dgemm8192/plugins/profile/2021_03_06_07_26_46/householder.trace.json.gz
2021-03-06 07:26:46.584126: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 07:26:46.586872: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 07:26:46.588818: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_dgemm8192/plugins/profile/2021_03_06_07_26_46Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_dgemm8192/plugins/profile/2021_03_06_07_26_46/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_dgemm8192/plugins/profile/2021_03_06_07_26_46/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_dgemm8192/plugins/profile/2021_03_06_07_26_46/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_dgemm8192/plugins/profile/2021_03_06_07_26_46/householder.kernel_stats.pb

Time for Epoch:586.0507843494415
Average single batch time this epoch: 83.72151010377067
Running Average Epoch time: 577.5575182437897

Time for Epoch:577.5575182437897
Average single batch time this epoch: 82.50819151742118
Running Average Epoch time: 577.0064498186111

Time for Epoch:576.4553813934326
Average single batch time this epoch: 82.35074002402169
Running Average Epoch time: 576.914389292399

Time for Epoch:576.730268239975
Average single batch time this epoch: 82.3900146484375
Running Average Epoch time: 576.3355795145035

Time for Epoch:574.5991501808167
Average single batch time this epoch: 82.0855690070561
Average time per Batch: 82.33362879923412
Average time per Epoch: 576.3355795145035
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm dgemm
num threads 12
total time 2904.9660744667053
2021-03-06 07:26:50.980013: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 07:26:51.541432: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 07:26:51.542058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 07:26:51.542681: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:26:51.542859: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:26:51.542990: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:26:51.543121: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:26:51.543246: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:26:51.543369: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:26:51.543497: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:26:51.543522: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 07:26:51.580425: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 07:26:51.580869: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe7a8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 07:26:51.580919: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 07:26:51.585519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 07:26:51.585583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 07:27:03.827466: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 07:27:03.827669: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 07:27:03.828522: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:27:03.828555: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 07:27:03.828575: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 07:27:03.828620: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 07:27:03.828669: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 07:27:03.828694: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 07:27:03.828709: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-06 07:27:04.623210: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 07:27:08.658003: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 07:27:09.223264: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 07:27:09.223710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 07:27:09.224037: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:27:09.224223: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:27:09.224412: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:27:09.224610: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:27:09.224803: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:27:09.225000: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:27:09.225169: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:27:09.225199: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 07:27:09.264401: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 07:27:09.264848: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa800000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 07:27:09.264903: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 07:27:09.269513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 07:27:09.269557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 07:27:21.363884: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 07:27:21.364039: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 07:27:21.364859: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 07:27:21.364893: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 07:27:21.364915: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 07:27:21.364952: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 07:27:21.364996: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 07:27:21.365021: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 07:27:21.365057: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa832e09430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 08:30:17.939359: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 08:30:17.948398: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 08:30:17.984095: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_schonhage3338192/plugins/profile/2021_03_06_08_30_17
2021-03-06 08:30:18.018721: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_schonhage3338192/plugins/profile/2021_03_06_08_30_17/householder.trace.json.gz
2021-03-06 08:30:18.022936: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 08:30:18.025518: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 08:30:18.027388: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_schonhage3338192/plugins/profile/2021_03_06_08_30_17Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_schonhage3338192/plugins/profile/2021_03_06_08_30_17/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_schonhage3338192/plugins/profile/2021_03_06_08_30_17/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_schonhage3338192/plugins/profile/2021_03_06_08_30_17/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_schonhage3338192/plugins/profile/2021_03_06_08_30_17/householder.kernel_stats.pb

Time for Epoch:762.7568805217743
Average single batch time this epoch: 108.96524548530579
Running Average Epoch time: 751.4505326747894

Time for Epoch:751.4505326747894
Average single batch time this epoch: 107.35005164146423
Running Average Epoch time: 753.9792424440384

Time for Epoch:756.5079522132874
Average single batch time this epoch: 108.07254198619297
Running Average Epoch time: 753.0198003451029

Time for Epoch:751.100916147232
Average single batch time this epoch: 107.30011020387921
Running Average Epoch time: 753.4503190517426

Time for Epoch:754.7418751716614
Average single batch time this epoch: 107.82024669647217
Average time per Batch: 107.63573763200215
Average time per Epoch: 753.4503190517426
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm schonhage333
num threads 12
total time 3790.10808634758
2021-03-06 08:30:22.426802: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 08:30:22.976310: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 08:30:22.976770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 08:30:22.977412: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 08:30:22.977576: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 08:30:22.977705: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 08:30:22.977844: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 08:30:22.977994: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 08:30:22.978139: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 08:30:22.978264: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 08:30:22.978305: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 08:30:23.016295: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 08:30:23.016705: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd334000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 08:30:23.016745: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 08:30:23.020482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 08:30:23.020519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 08:30:35.158260: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 08:30:35.158417: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 08:30:35.159218: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 08:30:35.159253: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 08:30:35.159273: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 08:30:35.159307: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 08:30:35.159350: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 08:30:35.159374: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 08:30:35.159389: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd3661dc430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 09:17:35.584636: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 09:17:35.590994: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 09:17:35.626039: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2248192/plugins/profile/2021_03_06_09_17_35
2021-03-06 09:17:35.660942: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2248192/plugins/profile/2021_03_06_09_17_35/householder.trace.json.gz
2021-03-06 09:17:35.665249: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 09:17:35.667865: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 09:17:35.669772: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2248192/plugins/profile/2021_03_06_09_17_35Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2248192/plugins/profile/2021_03_06_09_17_35/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2248192/plugins/profile/2021_03_06_09_17_35/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2248192/plugins/profile/2021_03_06_09_17_35/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2248192/plugins/profile/2021_03_06_09_17_35/householder.kernel_stats.pb

Time for Epoch:572.3921146392822
Average single batch time this epoch: 81.77028090613229
Running Average Epoch time: 562.1260905265808

Time for Epoch:562.1260905265808
Average single batch time this epoch: 80.30370552199227
Running Average Epoch time: 562.762025475502

Time for Epoch:563.3979604244232
Average single batch time this epoch: 80.48540210723877
Running Average Epoch time: 563.1055043538412

Time for Epoch:563.7924621105194
Average single batch time this epoch: 80.54175993374416
Running Average Epoch time: 562.0050512552261

Time for Epoch:558.7036919593811
Average single batch time this epoch: 79.81479382514954
Average time per Batch: 80.28641534703118
Average time per Epoch: 562.0050512552261
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov224
num threads 12
total time 2833.978324651718
2021-03-06 09:17:40.071730: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 09:17:40.640801: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 09:17:40.641307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 09:17:40.641899: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 09:17:40.642063: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 09:17:40.642204: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 09:17:40.642351: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 09:17:40.642500: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 09:17:40.642623: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 09:17:40.642749: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 09:17:40.642772: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 09:17:40.680309: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 09:17:40.680686: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f38a4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 09:17:40.680723: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 09:17:40.684263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 09:17:40.684300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 09:17:52.803089: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 09:17:52.803245: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 09:17:52.804098: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 09:17:52.804134: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 09:17:52.804155: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 09:17:52.804190: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 09:17:52.804236: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 09:17:52.804260: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 09:17:52.804276: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f38d77d2430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 10:09:27.299217: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 10:09:27.305376: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 10:09:27.338487: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2258192/plugins/profile/2021_03_06_10_09_27
2021-03-06 10:09:27.373872: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2258192/plugins/profile/2021_03_06_10_09_27/householder.trace.json.gz
2021-03-06 10:09:27.378144: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 10:09:27.380781: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 10:09:27.382710: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2258192/plugins/profile/2021_03_06_10_09_27Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2258192/plugins/profile/2021_03_06_10_09_27/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2258192/plugins/profile/2021_03_06_10_09_27/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2258192/plugins/profile/2021_03_06_10_09_27/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2258192/plugins/profile/2021_03_06_10_09_27/householder.kernel_stats.pb

Time for Epoch:623.5738532543182
Average single batch time this epoch: 89.08195757865906
Running Average Epoch time: 619.8891892433167

Time for Epoch:619.8891892433167
Average single batch time this epoch: 88.55557503019061
Running Average Epoch time: 617.4816015958786

Time for Epoch:615.0740139484406
Average single batch time this epoch: 87.86769556999207
Running Average Epoch time: 618.4534744421641

Time for Epoch:620.3972201347351
Average single batch time this epoch: 88.62815294946942
Running Average Epoch time: 617.7272676825523

Time for Epoch:615.548647403717
Average single batch time this epoch: 87.93550051961627
Average time per Batch: 88.24673101731709
Average time per Epoch: 617.7272676825523
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov225
num threads 12
total time 3108.0482194423676
2021-03-06 10:09:31.811749: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 10:09:32.351994: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 10:09:32.352532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 10:09:32.353276: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 10:09:32.353432: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 10:09:32.353564: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 10:09:32.353695: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 10:09:32.353840: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 10:09:32.353962: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 10:09:32.354086: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 10:09:32.354110: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 10:09:32.388257: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 10:09:32.388713: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f82dc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 10:09:32.388781: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 10:09:32.393103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 10:09:32.393148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 10:09:44.705516: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 10:09:44.705686: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 10:09:44.706513: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 10:09:44.706542: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 10:09:44.706561: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 10:09:44.706603: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 10:09:44.706652: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 10:09:44.706700: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 10:09:44.706718: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8310f1b4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 11:08:49.704901: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 11:08:49.711225: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 11:08:49.746169: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov2728192/plugins/profile/2021_03_06_11_08_49
2021-03-06 11:08:49.781574: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov2728192/plugins/profile/2021_03_06_11_08_49/householder.trace.json.gz
2021-03-06 11:08:49.785851: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 11:08:49.788469: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 11:08:49.790403: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov2728192/plugins/profile/2021_03_06_11_08_49Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov2728192/plugins/profile/2021_03_06_11_08_49/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov2728192/plugins/profile/2021_03_06_11_08_49/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov2728192/plugins/profile/2021_03_06_11_08_49/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov2728192/plugins/profile/2021_03_06_11_08_49/householder.kernel_stats.pb

Time for Epoch:716.933034658432
Average single batch time this epoch: 102.4189806325095
Running Average Epoch time: 713.5351846218109

Time for Epoch:713.5351846218109
Average single batch time this epoch: 101.93357508523124
Running Average Epoch time: 713.116333603859

Time for Epoch:712.697482585907
Average single batch time this epoch: 101.81390394483294
Running Average Epoch time: 709.6322962443033

Time for Epoch:702.6642215251923
Average single batch time this epoch: 100.38057974406651
Running Average Epoch time: 707.0128189921379

Time for Epoch:699.1543872356415
Average single batch time this epoch: 99.8791744027819
Average time per Batch: 101.00180829422814
Average time per Epoch: 707.0128189921379
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov272
num threads 12
total time 3558.714409828186
2021-03-06 11:08:54.236365: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 11:08:54.795559: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 11:08:54.796444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 11:08:54.796819: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 11:08:54.797026: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 11:08:54.797219: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 11:08:54.797416: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 11:08:54.797607: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 11:08:54.797793: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 11:08:54.797983: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 11:08:54.798038: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 11:08:54.836331: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 11:08:54.836726: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f45d0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 11:08:54.836763: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 11:08:54.840333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 11:08:54.840375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 11:09:07.080082: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 11:09:07.080278: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 11:09:07.081163: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 11:09:07.081196: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 11:09:07.081215: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 11:09:07.081259: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 11:09:07.081307: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 11:09:07.081331: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 11:09:07.081346: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f46030464c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 12:05:26.803493: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 12:05:26.812110: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 12:05:26.849148: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3238192/plugins/profile/2021_03_06_12_05_26
2021-03-06 12:05:26.886186: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3238192/plugins/profile/2021_03_06_12_05_26/householder.trace.json.gz
2021-03-06 12:05:26.890871: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 12:05:26.893568: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 12:05:26.895454: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3238192/plugins/profile/2021_03_06_12_05_26Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3238192/plugins/profile/2021_03_06_12_05_26/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3238192/plugins/profile/2021_03_06_12_05_26/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3238192/plugins/profile/2021_03_06_12_05_26/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3238192/plugins/profile/2021_03_06_12_05_26/householder.kernel_stats.pb

Time for Epoch:685.2411513328552
Average single batch time this epoch: 97.8915685926165
Running Average Epoch time: 673.4700107574463

Time for Epoch:673.4700107574463
Average single batch time this epoch: 96.20997531073434
Running Average Epoch time: 673.1640770435333

Time for Epoch:672.8581433296204
Average single batch time this epoch: 96.12256332806179
Running Average Epoch time: 672.7527564366659

Time for Epoch:671.9301152229309
Average single batch time this epoch: 95.98999343599591
Running Average Epoch time: 673.6163918972015

Time for Epoch:676.2072982788086
Average single batch time this epoch: 96.6010172026498
Average time per Batch: 96.23088731936046
Average time per Epoch: 673.6163918972015
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov323
num threads 12
total time 3393.3677258491516
2021-03-06 12:05:31.287588: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 12:05:31.840594: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 12:05:31.841045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 12:05:31.841735: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 12:05:31.841915: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 12:05:31.842050: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 12:05:31.842185: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 12:05:31.842318: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 12:05:31.842446: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 12:05:31.842572: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 12:05:31.842597: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 12:05:31.876201: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 12:05:31.876617: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f912c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 12:05:31.876675: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 12:05:31.880734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 12:05:31.880777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 12:05:44.186574: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 12:05:44.186770: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 12:05:44.187645: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 12:05:44.187679: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 12:05:44.187712: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 12:05:44.187759: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 12:05:44.187827: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 12:05:44.187856: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 12:05:44.187872: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f91615f84c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 13:07:50.019365: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 13:07:50.026355: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 13:07:50.060734: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3338192/plugins/profile/2021_03_06_13_07_50
2021-03-06 13:07:50.096534: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3338192/plugins/profile/2021_03_06_13_07_50/householder.trace.json.gz
2021-03-06 13:07:50.100797: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 13:07:50.103447: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 13:07:50.105346: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3338192/plugins/profile/2021_03_06_13_07_50Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3338192/plugins/profile/2021_03_06_13_07_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3338192/plugins/profile/2021_03_06_13_07_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3338192/plugins/profile/2021_03_06_13_07_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3338192/plugins/profile/2021_03_06_13_07_50/householder.kernel_stats.pb

Time for Epoch:757.3249092102051
Average single batch time this epoch: 108.18925098010472
Running Average Epoch time: 746.4608855247498

Time for Epoch:746.4608855247498
Average single batch time this epoch: 106.63724848202297
Running Average Epoch time: 744.0216598510742

Time for Epoch:741.5824341773987
Average single batch time this epoch: 105.94032638413566
Running Average Epoch time: 742.8625371456146

Time for Epoch:740.5442917346954
Average single batch time this epoch: 105.79201926503863
Running Average Epoch time: 742.1230512857437

Time for Epoch:739.904593706131
Average single batch time this epoch: 105.7006333555494
Average time per Batch: 106.01755687168665
Average time per Epoch: 742.1230512857437
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov333
num threads 12
total time 3739.5490605831146
2021-03-06 13:07:54.524347: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 13:07:55.085285: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 13:07:55.085878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 13:07:55.086351: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 13:07:55.086517: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 13:07:55.086643: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 13:07:55.086772: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 13:07:55.086915: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 13:07:55.087040: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 13:07:55.087163: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 13:07:55.087188: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 13:07:55.120364: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 13:07:55.120747: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd514000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 13:07:55.120796: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 13:07:55.124379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 13:07:55.124420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 13:08:07.362717: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 13:08:07.362923: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 13:08:07.363828: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 13:08:07.363865: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 13:08:07.363886: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 13:08:07.363929: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 13:08:07.363995: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 13:08:07.364020: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 13:08:07.364036: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd5484a1430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 14:03:38.060829: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 14:03:38.068913: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 14:03:38.103975: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov3348192/plugins/profile/2021_03_06_14_03_38
2021-03-06 14:03:38.139496: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov3348192/plugins/profile/2021_03_06_14_03_38/householder.trace.json.gz
2021-03-06 14:03:38.143821: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 14:03:38.146465: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 14:03:38.148343: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov3348192/plugins/profile/2021_03_06_14_03_38Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov3348192/plugins/profile/2021_03_06_14_03_38/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov3348192/plugins/profile/2021_03_06_14_03_38/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov3348192/plugins/profile/2021_03_06_14_03_38/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov3348192/plugins/profile/2021_03_06_14_03_38/householder.kernel_stats.pb

Time for Epoch:680.3834328651428
Average single batch time this epoch: 97.19760128429958
Running Average Epoch time: 662.1878826618195

Time for Epoch:662.1878826618195
Average single batch time this epoch: 94.59823955808368
Running Average Epoch time: 663.831059217453

Time for Epoch:665.4742357730865
Average single batch time this epoch: 95.06771816526141
Running Average Epoch time: 663.3550347487131

Time for Epoch:662.4029858112335
Average single batch time this epoch: 94.62896374293736
Running Average Epoch time: 662.5737367272377

Time for Epoch:660.2298426628113
Average single batch time this epoch: 94.31851584570748
Average time per Batch: 94.65335932799749
Average time per Epoch: 662.5737367272377
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov334
num threads 12
total time 3344.337047815323
2021-03-06 14:03:42.566203: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 14:03:43.131269: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 14:03:43.131760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 14:03:43.132143: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:03:43.132308: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:03:43.132439: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:03:43.132580: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:03:43.132733: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:03:43.132880: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:03:43.133007: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:03:43.133045: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 14:03:43.172271: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 14:03:43.172737: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f69bc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 14:03:43.172805: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 14:03:43.177947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 14:03:43.177990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 14:03:55.320093: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 14:03:55.320248: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 14:03:55.321063: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:03:55.321096: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 14:03:55.321116: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 14:03:55.321150: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 14:03:55.321209: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 14:03:55.321235: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 14:03:55.321250: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f69f1a1a430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 14:48:54.697015: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 14:48:54.705533: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 14:48:54.742369: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov4428192/plugins/profile/2021_03_06_14_48_54
2021-03-06 14:48:54.779542: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov4428192/plugins/profile/2021_03_06_14_48_54/householder.trace.json.gz
2021-03-06 14:48:54.784158: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 14:48:54.786819: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 14:48:54.788685: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov4428192/plugins/profile/2021_03_06_14_48_54Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov4428192/plugins/profile/2021_03_06_14_48_54/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov4428192/plugins/profile/2021_03_06_14_48_54/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov4428192/plugins/profile/2021_03_06_14_48_54/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov4428192/plugins/profile/2021_03_06_14_48_54/householder.kernel_stats.pb

Time for Epoch:549.0630435943604
Average single batch time this epoch: 78.43755149841309
Running Average Epoch time: 535.9621639251709

Time for Epoch:535.9621639251709
Average single batch time this epoch: 76.56599834987095
Running Average Epoch time: 536.9082350730896

Time for Epoch:537.8543062210083
Average single batch time this epoch: 76.8363059588841
Running Average Epoch time: 536.4903399944305

Time for Epoch:535.6545498371124
Average single batch time this epoch: 76.52205276489258
Running Average Epoch time: 537.5741984248161

Time for Epoch:540.8257737159729
Average single batch time this epoch: 77.26080077035087
Average time per Batch: 76.79628946099962
Average time per Epoch: 537.5741984248161
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov442
num threads 12
total time 2712.949944972992
2021-03-06 14:48:59.247884: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 14:48:59.799552: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 14:48:59.800267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 14:48:59.800813: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:48:59.800980: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:48:59.801110: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:48:59.801243: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:48:59.801371: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:48:59.801496: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:48:59.801624: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:48:59.801649: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 14:48:59.840399: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 14:48:59.840894: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f20ac000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 14:48:59.840973: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 14:48:59.846442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 14:48:59.846491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 14:49:12.035263: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 14:49:12.035468: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 14:49:12.036327: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 14:49:12.036366: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 14:49:12.036389: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 14:49:12.036433: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 14:49:12.036482: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 14:49:12.036508: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 14:49:12.036524: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f20df08d4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 15:38:16.321393: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 15:38:16.328860: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 15:38:16.363074: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov4448192/plugins/profile/2021_03_06_15_38_16
2021-03-06 15:38:16.397994: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov4448192/plugins/profile/2021_03_06_15_38_16/householder.trace.json.gz
2021-03-06 15:38:16.402265: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 15:38:16.404943: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 15:38:16.406852: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov4448192/plugins/profile/2021_03_06_15_38_16Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov4448192/plugins/profile/2021_03_06_15_38_16/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov4448192/plugins/profile/2021_03_06_15_38_16/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov4448192/plugins/profile/2021_03_06_15_38_16/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov4448192/plugins/profile/2021_03_06_15_38_16/householder.kernel_stats.pb

Time for Epoch:601.1306009292603
Average single batch time this epoch: 85.87576852525983
Running Average Epoch time: 591.5978291034698

Time for Epoch:591.5978291034698
Average single batch time this epoch: 84.51394551140922
Running Average Epoch time: 586.801496386528

Time for Epoch:582.0051636695862
Average single batch time this epoch: 83.14356422424316
Running Average Epoch time: 587.5717310110728

Time for Epoch:589.1122002601624
Average single batch time this epoch: 84.15885622160775
Running Average Epoch time: 585.7838699221611

Time for Epoch:580.420286655426
Average single batch time this epoch: 82.91715598106384
Average time per Batch: 83.683380484581
Average time per Epoch: 585.7838699221611
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov444
num threads 12
total time 2957.8816788196564
2021-03-06 15:38:20.794259: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 15:38:21.351206: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 15:38:21.351655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 15:38:21.352492: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 15:38:21.352657: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 15:38:21.352791: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 15:38:21.352923: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 15:38:21.353078: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 15:38:21.353211: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 15:38:21.353338: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 15:38:21.353364: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 15:38:21.384207: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 15:38:21.384630: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f95fc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 15:38:21.384685: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 15:38:21.388301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 15:38:21.388343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 15:38:33.699526: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 15:38:33.699675: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 15:38:33.700570: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 15:38:33.700605: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 15:38:33.700638: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 15:38:33.700684: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 15:38:33.700754: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 15:38:33.700780: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 15:38:33.700794: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f962f0724c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 16:34:41.243532: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 16:34:41.250212: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 16:34:41.286940: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov5528192/plugins/profile/2021_03_06_16_34_41
2021-03-06 16:34:41.323428: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov5528192/plugins/profile/2021_03_06_16_34_41/householder.trace.json.gz
2021-03-06 16:34:41.328030: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 16:34:41.330654: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 16:34:41.332559: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov5528192/plugins/profile/2021_03_06_16_34_41Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov5528192/plugins/profile/2021_03_06_16_34_41/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov5528192/plugins/profile/2021_03_06_16_34_41/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov5528192/plugins/profile/2021_03_06_16_34_41/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov5528192/plugins/profile/2021_03_06_16_34_41/householder.kernel_stats.pb

Time for Epoch:674.5487632751465
Average single batch time this epoch: 96.36408621924264
Running Average Epoch time: 677.276495218277

Time for Epoch:677.276495218277
Average single batch time this epoch: 96.7537614277431
Running Average Epoch time: 673.9352560043335

Time for Epoch:670.59401679039
Average single batch time this epoch: 95.79912110737392
Running Average Epoch time: 673.1346802711487

Time for Epoch:671.533528804779
Average single batch time this epoch: 95.93333952767509
Running Average Epoch time: 673.2450754642487

Time for Epoch:673.5762610435486
Average single batch time this epoch: 96.22515664781842
Average time per Batch: 96.17784467765263
Average time per Epoch: 673.2450754642487
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov552
num threads 12
total time 3381.2766773700714
2021-03-06 16:34:45.776212: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-06 16:34:46.339046: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-06 16:34:46.339544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-06 16:34:46.340124: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 16:34:46.340278: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 16:34:46.340410: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 16:34:46.340545: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 16:34:46.340673: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 16:34:46.340800: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 16:34:46.340951: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 16:34:46.341004: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-06 16:34:46.376360: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-06 16:34:46.376783: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4458000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-06 16:34:46.376855: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-06 16:34:46.380887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-06 16:34:46.380932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-06 16:34:58.554881: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 16:34:58.555039: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-06 16:34:58.555893: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-06 16:34:58.555939: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 16:34:58.555964: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 16:34:58.556030: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 16:34:58.556100: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-06 16:34:58.556126: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 16:34:58.556142: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f448c6d04c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-06 17:28:53.611500: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-06 17:28:53.619810: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-06 17:28:53.657044: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_try_2_12_threads_smirnov5558192/plugins/profile/2021_03_06_17_28_53
2021-03-06 17:28:53.693982: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_try_2_12_threads_smirnov5558192/plugins/profile/2021_03_06_17_28_53/householder.trace.json.gz
2021-03-06 17:28:53.698609: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-06 17:28:53.701286: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-06 17:28:53.703159: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_try_2_12_threads_smirnov5558192/plugins/profile/2021_03_06_17_28_53Dumped tool data for overview_page.pb to PAPER_try_2_12_threads_smirnov5558192/plugins/profile/2021_03_06_17_28_53/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_try_2_12_threads_smirnov5558192/plugins/profile/2021_03_06_17_28_53/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_try_2_12_threads_smirnov5558192/plugins/profile/2021_03_06_17_28_53/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_try_2_12_threads_smirnov5558192/plugins/profile/2021_03_06_17_28_53/householder.kernel_stats.pb

Time for Epoch:656.834404706955
Average single batch time this epoch: 93.8334594794682
Running Average Epoch time: 647.2168958187103

Time for Epoch:647.2168958187103
Average single batch time this epoch: 92.4595296382904
Running Average Epoch time: 643.9753531217575

Time for Epoch:640.7338104248047
Average single batch time this epoch: 91.53337509291512
Running Average Epoch time: 642.9642756779989

Time for Epoch:640.9421207904816
Average single batch time this epoch: 91.56313409124103
Running Average Epoch time: 644.5512610077858

Time for Epoch:649.3122169971466
Average single batch time this epoch: 92.758864232472
Average time per Batch: 92.07872576372964
Average time per Epoch: 644.5512610077858
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov555
num threads 12
total time 3248.660374403
