2021-02-27 15:02:49.764492: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:02:50.327835: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:02:50.328455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:02:50.330295: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:02:50.330520: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:02:50.330733: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:02:50.330936: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:02:50.331145: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:02:50.331344: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:02:50.331545: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:02:50.331583: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:02:50.372186: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:02:50.372648: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6fe4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:02:50.372697: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:02:50.377257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:02:50.377302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:02:50.497317: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:02:50.497466: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:02:50.497776: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:02:50.497806: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:02:50.497825: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:02:50.497861: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:02:50.497902: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:02:50.497926: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:02:50.497940: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f701651f550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:05:04.809025: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:05:04.889885: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:05:05.368338: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_bini322512/plugins/profile/2021_02_27_15_05_04
2021-02-27 15:05:05.846748: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_bini322512/plugins/profile/2021_02_27_15_05_04/householder.trace.json.gz
2021-02-27 15:05:05.945781: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:05:05.983762: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:05:05.986336: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_bini322512/plugins/profile/2021_02_27_15_05_04Dumped tool data for overview_page.pb to PAPER_1_thread_bini322512/plugins/profile/2021_02_27_15_05_04/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_bini322512/plugins/profile/2021_02_27_15_05_04/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_bini322512/plugins/profile/2021_02_27_15_05_04/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_bini322512/plugins/profile/2021_02_27_15_05_04/householder.kernel_stats.pb

Epoch 1, Loss: 0.3242879807949066, Train Accuracy: 90.4346923828125,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:28.14038848876953
Average single batch time this epoch: 0.23770281188508385
Epoch 2, Loss: 0.10299982130527496, Train Accuracy: 96.88167572021484,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.32477831840515

Time for Epoch:26.32477831840515
Average single batch time this epoch: 0.22435828763195592
Epoch 3, Loss: 0.06566111743450165, Train Accuracy: 97.93836975097656,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.30712354183197

Time for Epoch:26.28946876525879
Average single batch time this epoch: 0.22405441194518
Epoch 4, Loss: 0.05705492943525314, Train Accuracy: 98.16706848144531,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.45455201466878

Time for Epoch:26.749408960342407
Average single batch time this epoch: 0.22800127868978387
Epoch 5, Loss: 0.041706521064043045, Train Accuracy: 98.71127319335938,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.53391456604004

Time for Epoch:26.77200222015381
Average single batch time this epoch: 0.228204496905335
Average time per Batch: 0.2261546187930637
Average time per Epoch: 26.53391456604004
2021-02-27 15:05:10.209865: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:05:10.755730: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:05:10.756243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:05:10.756538: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:05:10.756768: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:05:10.756957: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:05:10.757170: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:05:10.757364: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:05:10.757550: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:05:10.757739: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:05:10.757774: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:05:10.796262: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:05:10.796763: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4188000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:05:10.796849: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:05:10.801162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:05:10.801199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:05:10.923048: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:05:10.923199: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:05:10.923491: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:05:10.923520: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:05:10.923537: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:05:10.923571: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:05:10.923612: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:05:10.923636: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:05:10.923651: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f41bd4594c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:07:15.122647: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:07:15.201861: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:07:15.686748: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_dgemm512/plugins/profile/2021_02_27_15_07_15
2021-02-27 15:07:16.195099: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_dgemm512/plugins/profile/2021_02_27_15_07_15/householder.trace.json.gz
2021-02-27 15:07:16.304250: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:07:16.342269: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:07:16.344936: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_dgemm512/plugins/profile/2021_02_27_15_07_15Dumped tool data for overview_page.pb to PAPER_1_thread_dgemm512/plugins/profile/2021_02_27_15_07_15/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_dgemm512/plugins/profile/2021_02_27_15_07_15/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_dgemm512/plugins/profile/2021_02_27_15_07_15/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_dgemm512/plugins/profile/2021_02_27_15_07_15/householder.kernel_stats.pb

Epoch 1, Loss: 0.32327353954315186, Train Accuracy: 90.47476196289062,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:26.128366470336914
Average single batch time this epoch: 0.22041601604885525
Epoch 2, Loss: 0.10301115363836288, Train Accuracy: 96.88167572021484,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 24.50583505630493

Time for Epoch:24.50583505630493
Average single batch time this epoch: 0.20880996671497312
Epoch 3, Loss: 0.06551103293895721, Train Accuracy: 97.99179077148438,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 24.513793468475342

Time for Epoch:24.521751880645752
Average single batch time this epoch: 0.20895201935727373
Epoch 4, Loss: 0.057493358850479126, Train Accuracy: 98.17707824707031,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 24.5078067779541

Time for Epoch:24.49583339691162
Average single batch time this epoch: 0.208725189551329
Epoch 5, Loss: 0.036968130618333817, Train Accuracy: 98.84148406982422,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 24.508301198482513

Time for Epoch:24.50978446006775
Average single batch time this epoch: 0.20885328349904117
Average time per Batch: 0.20883511478065425
Average time per Epoch: 24.508301198482513
2021-02-27 15:07:20.655018: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:07:21.209366: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:07:21.209946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:07:21.210282: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:21.210478: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:21.210667: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:21.210882: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:21.211078: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:21.211262: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:21.211448: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:21.211484: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:07:21.252229: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:07:21.252744: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6630000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:07:21.252801: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:07:21.257785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:07:21.257832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:07:21.377004: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:07:21.377142: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:07:21.377445: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:21.377476: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:07:21.377495: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:07:21.377546: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:07:21.377596: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:07:21.377620: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:07:21.377635: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 187, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-02-27 15:07:22.098463: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:07:26.063289: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:07:26.584802: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:07:26.585274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:07:26.585746: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:26.585899: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:26.586027: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:26.586152: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:26.586306: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:26.586432: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:26.586557: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:26.586597: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:07:26.624258: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:07:26.624638: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa8d8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:07:26.624676: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:07:26.628142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:07:26.628180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:07:26.751945: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:07:26.752080: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:07:26.752378: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:07:26.752407: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:07:26.752430: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:07:26.752465: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:07:26.752526: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:07:26.752552: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:07:26.752567: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa90dee24c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:09:46.513194: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:09:46.589190: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:09:47.070240: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_schonhage333512/plugins/profile/2021_02_27_15_09_46
2021-02-27 15:09:47.558126: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_schonhage333512/plugins/profile/2021_02_27_15_09_46/householder.trace.json.gz
2021-02-27 15:09:47.657464: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:09:47.695556: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:09:47.698085: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_schonhage333512/plugins/profile/2021_02_27_15_09_46Dumped tool data for overview_page.pb to PAPER_1_thread_schonhage333512/plugins/profile/2021_02_27_15_09_46/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_schonhage333512/plugins/profile/2021_02_27_15_09_46/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_schonhage333512/plugins/profile/2021_02_27_15_09_46/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_schonhage333512/plugins/profile/2021_02_27_15_09_46/householder.kernel_stats.pb

Epoch 1, Loss: 0.3215218782424927, Train Accuracy: 90.49479675292969,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:29.230764627456665
Average single batch time this epoch: 0.24718945658105052
Epoch 2, Loss: 0.10148046910762787, Train Accuracy: 96.95011901855469,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.63559579849243

Time for Epoch:27.63559579849243
Average single batch time this epoch: 0.23556489007085815
Epoch 3, Loss: 0.06492853909730911, Train Accuracy: 97.9483871459961,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.63254964351654

Time for Epoch:27.62950348854065
Average single batch time this epoch: 0.23551674989553598
Epoch 4, Loss: 0.052670594304800034, Train Accuracy: 98.36238098144531,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.626738627751667

Time for Epoch:27.615116596221924
Average single batch time this epoch: 0.2353831988114577
Epoch 5, Loss: 0.0449402816593647, Train Accuracy: 98.51596069335938,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.62381398677826

Time for Epoch:27.615040063858032
Average single batch time this epoch: 0.23539244211637056
Average time per Batch: 0.2354643202235556
Average time per Epoch: 27.62381398677826
2021-02-27 15:09:52.019295: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:09:52.579902: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:09:52.580512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:09:52.580891: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:09:52.581103: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:09:52.581310: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:09:52.581516: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:09:52.581724: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:09:52.581928: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:09:52.582127: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:09:52.582166: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:09:52.624208: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:09:52.624590: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe400000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:09:52.624630: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:09:52.628456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:09:52.628501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:09:52.748654: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:09:52.748799: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:09:52.749091: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:09:52.749122: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:09:52.749140: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:09:52.749174: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:09:52.749224: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:09:52.749249: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:09:52.749264: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fe4346534c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:12:02.729171: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:12:02.820204: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:12:03.292868: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov224512/plugins/profile/2021_02_27_15_12_02
2021-02-27 15:12:03.772012: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov224512/plugins/profile/2021_02_27_15_12_02/householder.trace.json.gz
2021-02-27 15:12:03.870103: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:12:03.908493: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:12:03.910931: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov224512/plugins/profile/2021_02_27_15_12_02Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov224512/plugins/profile/2021_02_27_15_12_02/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov224512/plugins/profile/2021_02_27_15_12_02/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov224512/plugins/profile/2021_02_27_15_12_02/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov224512/plugins/profile/2021_02_27_15_12_02/householder.kernel_stats.pb

Epoch 1, Loss: 0.3228725492954254, Train Accuracy: 90.43135833740234,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:27.24096369743347
Average single batch time this epoch: 0.23000320613893688
Epoch 2, Loss: 0.10253585129976273, Train Accuracy: 96.91673278808594,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 25.589205980300903

Time for Epoch:25.589205980300903
Average single batch time this epoch: 0.21805796256432167
Epoch 3, Loss: 0.0677202120423317, Train Accuracy: 97.861572265625,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 25.63590407371521

Time for Epoch:25.682602167129517
Average single batch time this epoch: 0.21886768504085705
Epoch 4, Loss: 0.054491013288497925, Train Accuracy: 98.23384094238281,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 25.662505467732746

Time for Epoch:25.715708255767822
Average single batch time this epoch: 0.21915415209582728
Epoch 5, Loss: 0.04109121859073639, Train Accuracy: 98.72462463378906,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 25.676168382167816

Time for Epoch:25.717157125473022
Average single batch time this epoch: 0.21916273720244056
Average time per Batch: 0.2188106342258616
Average time per Epoch: 25.676168382167816
2021-02-27 15:12:08.145621: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:12:08.695549: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:12:08.696045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:12:08.696347: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:12:08.696532: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:12:08.696729: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:12:08.696940: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:12:08.697135: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:12:08.697310: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:12:08.697488: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:12:08.697520: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:12:08.736276: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:12:08.736674: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3d68000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:12:08.736711: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:12:08.740167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:12:08.740206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:12:08.861131: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:12:08.861255: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:12:08.861533: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:12:08.861582: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:12:08.861601: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:12:08.861635: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:12:08.861675: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:12:08.861698: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:12:08.861713: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3d9a14e550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:14:21.706085: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:14:21.787137: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:14:22.324180: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov225512/plugins/profile/2021_02_27_15_14_21
2021-02-27 15:14:22.834456: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov225512/plugins/profile/2021_02_27_15_14_21/householder.trace.json.gz
2021-02-27 15:14:22.941869: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:14:22.981054: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:14:22.983549: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov225512/plugins/profile/2021_02_27_15_14_21Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov225512/plugins/profile/2021_02_27_15_14_21/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov225512/plugins/profile/2021_02_27_15_14_21/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov225512/plugins/profile/2021_02_27_15_14_21/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov225512/plugins/profile/2021_02_27_15_14_21/householder.kernel_stats.pb

Epoch 1, Loss: 0.38236719369888306, Train Accuracy: 88.41145324707031,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:27.83122491836548
Average single batch time this epoch: 0.23522134723826352
Epoch 2, Loss: 0.13078930974006653, Train Accuracy: 95.9251480102539,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.25068736076355

Time for Epoch:26.25068736076355
Average single batch time this epoch: 0.22371616730323204
Epoch 3, Loss: 0.09029778838157654, Train Accuracy: 97.22389221191406,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.266239166259766

Time for Epoch:26.28179097175598
Average single batch time this epoch: 0.22398087102123815
Epoch 4, Loss: 0.06932200491428375, Train Accuracy: 97.80648803710938,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.2515283425649

Time for Epoch:26.22210669517517
Average single batch time this epoch: 0.22347946452279377
Epoch 5, Loss: 0.05360827222466469, Train Accuracy: 98.29560852050781,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.244439601898193

Time for Epoch:26.22317337989807
Average single batch time this epoch: 0.2234853516277085
Average time per Batch: 0.22366546361874312
Average time per Epoch: 26.244439601898193
2021-02-27 15:14:27.244832: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:14:27.771941: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:14:27.772533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:14:27.772868: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:14:27.773070: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:14:27.773264: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:14:27.773461: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:14:27.773649: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:14:27.773860: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:14:27.774051: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:14:27.774086: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:14:27.816172: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:14:27.816604: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f058c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:14:27.816641: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:14:27.820100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:14:27.820140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:14:27.937040: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:14:27.937179: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:14:27.937456: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:14:27.937487: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:14:27.937506: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:14:27.937542: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:14:27.937584: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:14:27.937608: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:14:27.937641: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f05be97b4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:16:58.387435: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:16:58.464008: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:16:58.955024: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov272512/plugins/profile/2021_02_27_15_16_58
2021-02-27 15:16:59.449769: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov272512/plugins/profile/2021_02_27_15_16_58/householder.trace.json.gz
2021-02-27 15:16:59.551629: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:16:59.590317: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:16:59.592774: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov272512/plugins/profile/2021_02_27_15_16_58Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov272512/plugins/profile/2021_02_27_15_16_58/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov272512/plugins/profile/2021_02_27_15_16_58/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov272512/plugins/profile/2021_02_27_15_16_58/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov272512/plugins/profile/2021_02_27_15_16_58/householder.kernel_stats.pb

Epoch 1, Loss: 24717864.0, Train Accuracy: 10.71547794342041,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:31.598013401031494
Average single batch time this epoch: 0.26726627349853516
Epoch 2, Loss: 9599367.0, Train Accuracy: 11.054353713989258,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.676626682281494

Time for Epoch:29.676626682281494
Average single batch time this epoch: 0.25300576340438974
Epoch 3, Loss: 2689346.5, Train Accuracy: 10.678752899169922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.68409788608551

Time for Epoch:29.691569089889526
Average single batch time this epoch: 0.2531251092242379
Epoch 4, Loss: 2413311.0, Train Accuracy: 10.733840942382812,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.689608256022137

Time for Epoch:29.700628995895386
Average single batch time this epoch: 0.2532079994169056
Epoch 5, Loss: 2218911.75, Train Accuracy: 10.717147827148438,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.70389461517334

Time for Epoch:29.746753692626953
Average single batch time this epoch: 0.2535909322591928
Average time per Batch: 0.25323245107618153
Average time per Epoch: 29.70389461517334
2021-02-27 15:17:03.862321: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:17:04.423890: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:17:04.424344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:17:04.424622: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:17:04.424795: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:17:04.424978: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:17:04.425145: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:17:04.425340: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:17:04.425504: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:17:04.425666: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:17:04.425723: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:17:04.464298: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:17:04.464719: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fca78000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:17:04.464768: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:17:04.469355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:17:04.469397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:17:04.593142: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:17:04.593240: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:17:04.593495: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:17:04.593524: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:17:04.593542: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:17:04.593575: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:17:04.593625: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:17:04.593649: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:17:04.593665: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fcaab823550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:19:22.965087: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:19:23.059846: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:19:23.543735: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov323512/plugins/profile/2021_02_27_15_19_23
2021-02-27 15:19:24.029809: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov323512/plugins/profile/2021_02_27_15_19_23/householder.trace.json.gz
2021-02-27 15:19:24.128914: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:19:24.167081: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:19:24.169640: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov323512/plugins/profile/2021_02_27_15_19_23Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov323512/plugins/profile/2021_02_27_15_19_23/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov323512/plugins/profile/2021_02_27_15_19_23/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov323512/plugins/profile/2021_02_27_15_19_23/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov323512/plugins/profile/2021_02_27_15_19_23/householder.kernel_stats.pb

Epoch 1, Loss: 0.35158056020736694, Train Accuracy: 89.39469909667969,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:28.87982153892517
Average single batch time this epoch: 0.2441990681183644
Epoch 2, Loss: 0.11593293398618698, Train Accuracy: 96.53945922851562,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.488834142684937

Time for Epoch:27.488834142684937
Average single batch time this epoch: 0.2343053552839491
Epoch 3, Loss: 0.07663504034280777, Train Accuracy: 97.53438568115234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.413198709487915

Time for Epoch:27.337563276290894
Average single batch time this epoch: 0.2330331374437381
Epoch 4, Loss: 0.06464466452598572, Train Accuracy: 97.89496612548828,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.426894108454388

Time for Epoch:27.45428490638733
Average single batch time this epoch: 0.23401345350803474
Epoch 5, Loss: 0.049826301634311676, Train Accuracy: 98.42581939697266,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.363749980926514

Time for Epoch:27.174317598342896
Average single batch time this epoch: 0.23160675855783316
Average time per Batch: 0.23323967619838878
Average time per Epoch: 27.363749980926514
2021-02-27 15:19:28.452080: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:19:29.007611: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:19:29.008299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:19:29.008683: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:19:29.008898: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:19:29.009104: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:19:29.009314: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:19:29.009523: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:19:29.009726: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:19:29.009930: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:19:29.009970: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:19:29.052318: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:19:29.052822: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb848000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:19:29.052921: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:19:29.058319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:19:29.058369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:19:29.177161: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:19:29.177297: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:19:29.177603: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:19:29.177634: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:19:29.177653: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:19:29.177687: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:19:29.177737: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:19:29.177762: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:19:29.177776: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fb87ca83550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:21:47.990245: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:21:48.076349: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:21:48.596800: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov333512/plugins/profile/2021_02_27_15_21_48
2021-02-27 15:21:49.106901: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov333512/plugins/profile/2021_02_27_15_21_48/householder.trace.json.gz
2021-02-27 15:21:49.213943: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:21:49.253495: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:21:49.256110: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov333512/plugins/profile/2021_02_27_15_21_48Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov333512/plugins/profile/2021_02_27_15_21_48/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov333512/plugins/profile/2021_02_27_15_21_48/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov333512/plugins/profile/2021_02_27_15_21_48/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov333512/plugins/profile/2021_02_27_15_21_48/householder.kernel_stats.pb

Epoch 1, Loss: 3343151872.0, Train Accuracy: 9.970952987670898,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:29.17684507369995
Average single batch time this epoch: 0.24656269081637391
Epoch 2, Loss: 2440063488.0, Train Accuracy: 9.922542572021484,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.362839937210083

Time for Epoch:27.362839937210083
Average single batch time this epoch: 0.23324932399977985
Epoch 3, Loss: 3505019904.0, Train Accuracy: 9.750600814819336,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.38057005405426

Time for Epoch:27.398300170898438
Average single batch time this epoch: 0.2335437587183765
Epoch 4, Loss: 9873131520.0, Train Accuracy: 10.104500770568848,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.404428084691364

Time for Epoch:27.452144145965576
Average single batch time this epoch: 0.23401389570317715
Epoch 5, Loss: 28360431616.0, Train Accuracy: 9.997662544250488,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.400192737579346

Time for Epoch:27.387486696243286
Average single batch time this epoch: 0.23345596362382937
Average time per Batch: 0.23356573551129073
Average time per Epoch: 27.400192737579346
2021-02-27 15:21:53.509790: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:21:54.072088: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:21:54.072539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:21:54.072821: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:21:54.072994: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:21:54.073208: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:21:54.073377: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:21:54.073561: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:21:54.073722: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:21:54.073886: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:21:54.073916: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:21:54.112261: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:21:54.112689: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9964000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:21:54.112739: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:21:54.117331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:21:54.117373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:21:54.238681: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:21:54.238810: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:21:54.239106: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:21:54.239156: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:21:54.239175: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:21:54.239209: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:21:54.239251: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:21:54.239275: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:21:54.239290: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f99984f04c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:24:12.050587: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:24:12.137156: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:24:12.666938: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov334512/plugins/profile/2021_02_27_15_24_12
2021-02-27 15:24:13.186183: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov334512/plugins/profile/2021_02_27_15_24_12/householder.trace.json.gz
2021-02-27 15:24:13.296124: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:24:13.336077: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:24:13.338570: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov334512/plugins/profile/2021_02_27_15_24_12Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov334512/plugins/profile/2021_02_27_15_24_12/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov334512/plugins/profile/2021_02_27_15_24_12/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov334512/plugins/profile/2021_02_27_15_24_12/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov334512/plugins/profile/2021_02_27_15_24_12/householder.kernel_stats.pb

Epoch 1, Loss: 0.34054210782051086, Train Accuracy: 89.81370544433594,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:28.879050970077515
Average single batch time this epoch: 0.2441924820598374
Epoch 2, Loss: 0.11181624233722687, Train Accuracy: 96.61624908447266,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.229047775268555

Time for Epoch:27.229047775268555
Average single batch time this epoch: 0.23208616533849993
Epoch 3, Loss: 0.07374721020460129, Train Accuracy: 97.71300506591797,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.231745719909668

Time for Epoch:27.23444366455078
Average single batch time this epoch: 0.23214579647422856
Epoch 4, Loss: 0.059223275631666183, Train Accuracy: 98.0685806274414,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.236735979715984

Time for Epoch:27.246716499328613
Average single batch time this epoch: 0.23225470893403405
Epoch 5, Loss: 0.0457635261118412, Train Accuracy: 98.5443344116211,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 27.22443574666977

Time for Epoch:27.187535047531128
Average single batch time this epoch: 0.23174700166425136
Average time per Batch: 0.23205841810275346
Average time per Epoch: 27.22443574666977
2021-02-27 15:24:17.635695: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:24:18.187261: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:24:18.187700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:24:18.188014: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:24:18.188211: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:24:18.188380: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:24:18.188552: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:24:18.188756: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:24:18.188927: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:24:18.189093: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:24:18.189164: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:24:18.228218: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:24:18.228571: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9bd0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:24:18.228619: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:24:18.231816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:24:18.231858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:24:18.353424: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:24:18.353515: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:24:18.353798: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:24:18.353828: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:24:18.353846: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:24:18.353913: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:24:18.354000: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:24:18.354028: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:24:18.354044: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9c05453550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:26:27.768028: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:26:27.898810: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:26:28.380445: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov442512/plugins/profile/2021_02_27_15_26_27
2021-02-27 15:26:28.869248: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov442512/plugins/profile/2021_02_27_15_26_27/householder.trace.json.gz
2021-02-27 15:26:28.967460: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:26:29.005484: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:26:29.008016: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov442512/plugins/profile/2021_02_27_15_26_27Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov442512/plugins/profile/2021_02_27_15_26_27/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov442512/plugins/profile/2021_02_27_15_26_27/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov442512/plugins/profile/2021_02_27_15_26_27/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov442512/plugins/profile/2021_02_27_15_26_27/householder.kernel_stats.pb

Epoch 1, Loss: 0.3378550410270691, Train Accuracy: 89.92554473876953,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:27.4262855052948
Average single batch time this epoch: 0.23175569681020883
Epoch 2, Loss: 0.10827533900737762, Train Accuracy: 96.67801666259766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 25.603354454040527

Time for Epoch:25.603354454040527
Average single batch time this epoch: 0.21818081130329361
Epoch 3, Loss: 0.06956152617931366, Train Accuracy: 97.8832778930664,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 25.562446236610413

Time for Epoch:25.521538019180298
Average single batch time this epoch: 0.21750012829772428
Epoch 4, Loss: 0.05709916725754738, Train Accuracy: 98.16873931884766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 25.521087249120075

Time for Epoch:25.438369274139404
Average single batch time this epoch: 0.21679038471645778
Epoch 5, Loss: 0.04610349237918854, Train Accuracy: 98.54100036621094,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 25.488339245319366

Time for Epoch:25.390095233917236
Average single batch time this epoch: 0.2163643368289002
Average time per Batch: 0.21720891528659397
Average time per Epoch: 25.488339245319366
2021-02-27 15:26:33.261850: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:26:33.812625: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:26:33.813057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:26:33.813340: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:26:33.813523: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:26:33.813693: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:26:33.813866: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:26:33.814030: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:26:33.814195: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:26:33.814392: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:26:33.814466: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:26:33.852174: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:26:33.852506: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4acc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:26:33.852542: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:26:33.854936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:26:33.854962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:26:33.977609: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:26:33.977739: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:26:33.978029: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:26:33.978059: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:26:33.978078: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:26:33.978146: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:26:33.978214: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:26:33.978242: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:26:33.978257: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4afe7a74c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:28:47.703367: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:28:47.794895: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:28:48.279214: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov444512/plugins/profile/2021_02_27_15_28_47
2021-02-27 15:28:48.765585: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov444512/plugins/profile/2021_02_27_15_28_47/householder.trace.json.gz
2021-02-27 15:28:48.863412: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:28:48.901382: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 15:28:48.903892: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov444512/plugins/profile/2021_02_27_15_28_47Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov444512/plugins/profile/2021_02_27_15_28_47/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov444512/plugins/profile/2021_02_27_15_28_47/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov444512/plugins/profile/2021_02_27_15_28_47/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov444512/plugins/profile/2021_02_27_15_28_47/householder.kernel_stats.pb

Epoch 1, Loss: 0.34663379192352295, Train Accuracy: 89.65177917480469,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:27.89380431175232
Average single batch time this epoch: 0.23578099919180584
Epoch 2, Loss: 0.11175301671028137, Train Accuracy: 96.6529769897461,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.419859170913696

Time for Epoch:26.419859170913696
Average single batch time this epoch: 0.22516364317673904
Epoch 3, Loss: 0.07229816913604736, Train Accuracy: 97.75140380859375,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.44780433177948

Time for Epoch:26.475749492645264
Average single batch time this epoch: 0.22563863004374707
Epoch 4, Loss: 0.062126219272613525, Train Accuracy: 98.08860778808594,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.44189778963725

Time for Epoch:26.430084705352783
Average single batch time this epoch: 0.22525255904238448
Epoch 5, Loss: 0.04055600240826607, Train Accuracy: 98.71627807617188,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 26.44896948337555

Time for Epoch:26.470184564590454
Average single batch time this epoch: 0.22560415716252774
Average time per Batch: 0.2254147473563496
Average time per Epoch: 26.44896948337555
2021-02-27 15:28:53.219566: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:28:53.775247: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:28:53.775726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:28:53.776036: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:28:53.776229: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:28:53.776394: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:28:53.776561: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:28:53.776724: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:28:53.776884: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:28:53.777045: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:28:53.777116: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:28:53.812192: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:28:53.812503: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fec08000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:28:53.812540: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:28:53.814935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:28:53.814959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:28:53.935462: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:28:53.935585: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:28:53.935889: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:28:53.935920: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:28:53.935938: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:28:53.936005: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:28:53.936057: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:28:53.936082: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:28:53.936097: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fec3aa634c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:31:23.496034: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:31:23.583292: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:31:24.126520: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov552512/plugins/profile/2021_02_27_15_31_23
2021-02-27 15:31:24.637262: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov552512/plugins/profile/2021_02_27_15_31_23/householder.trace.json.gz
2021-02-27 15:31:24.744914: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:31:24.784245: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:31:24.786710: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov552512/plugins/profile/2021_02_27_15_31_23Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov552512/plugins/profile/2021_02_27_15_31_23/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov552512/plugins/profile/2021_02_27_15_31_23/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov552512/plugins/profile/2021_02_27_15_31_23/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov552512/plugins/profile/2021_02_27_15_31_23/householder.kernel_stats.pb

Epoch 1, Loss: 0.33203041553497314, Train Accuracy: 90.0707778930664,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:31.239652395248413
Average single batch time this epoch: 0.26434290307199854
Epoch 2, Loss: 0.10729173570871353, Train Accuracy: 96.73811340332031,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.590227603912354

Time for Epoch:29.590227603912354
Average single batch time this epoch: 0.25228531136472
Epoch 3, Loss: 0.06759300827980042, Train Accuracy: 97.8866195678711,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.57097554206848

Time for Epoch:29.55172348022461
Average single batch time this epoch: 0.25193068512484557
Epoch 4, Loss: 0.058794986456632614, Train Accuracy: 98.13368225097656,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.575629393259685

Time for Epoch:29.58493709564209
Average single batch time this epoch: 0.2522292972629906
Epoch 5, Loss: 0.040298834443092346, Train Accuracy: 98.70793151855469,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.571624100208282

Time for Epoch:29.559608221054077
Average single batch time this epoch: 0.2519975401397444
Average time per Batch: 0.25211070847307515
Average time per Epoch: 29.571624100208282
2021-02-27 15:31:29.119926: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:31:29.683640: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:31:29.684324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:31:29.684681: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:31:29.684893: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:31:29.685130: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:31:29.685340: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:31:29.685544: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:31:29.685744: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:31:29.685947: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:31:29.685985: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:31:29.728213: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:31:29.728587: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb0d0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:31:29.728624: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:31:29.732069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:31:29.732109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:31:29.849318: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:31:29.849451: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:31:29.849756: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:31:29.849807: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:31:29.849833: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:31:29.849869: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:31:29.849910: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:31:29.849933: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:31:29.849948: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fb102292550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:34:12.768787: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:34:12.851691: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:34:13.390712: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov555512/plugins/profile/2021_02_27_15_34_12
2021-02-27 15:34:13.901461: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov555512/plugins/profile/2021_02_27_15_34_12/householder.trace.json.gz
2021-02-27 15:34:14.009568: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:34:14.048641: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 15:34:14.051075: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov555512/plugins/profile/2021_02_27_15_34_12Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov555512/plugins/profile/2021_02_27_15_34_12/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov555512/plugins/profile/2021_02_27_15_34_12/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov555512/plugins/profile/2021_02_27_15_34_12/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov555512/plugins/profile/2021_02_27_15_34_12/householder.kernel_stats.pb

Epoch 1, Loss: 0.3461752235889435, Train Accuracy: 89.61505126953125,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:34.2045214176178
Average single batch time this epoch: 0.2895348316583878
Epoch 2, Loss: 0.10969031602144241, Train Accuracy: 96.7147445678711,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 32.4368782043457

Time for Epoch:32.4368782043457
Average single batch time this epoch: 0.27658985415075577
Epoch 3, Loss: 0.0717269629240036, Train Accuracy: 97.71467590332031,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 32.46021223068237

Time for Epoch:32.48354625701904
Average single batch time this epoch: 0.27704183260599774
Epoch 4, Loss: 0.05816972255706787, Train Accuracy: 98.16706848144531,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 32.27372558911642

Time for Epoch:31.900752305984497
Average single batch time this epoch: 0.27201455882471853
Epoch 5, Loss: 0.04933717101812363, Train Accuracy: 98.35903930664062,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 32.16918432712555

Time for Epoch:31.855560541152954
Average single batch time this epoch: 0.2716235564305232
Average time per Batch: 0.27431745050299877
Average time per Epoch: 32.16918432712555
2021-02-27 15:34:18.275680: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:34:18.835767: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:34:18.836490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:34:18.836841: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:34:18.837056: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:34:18.837269: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:34:18.837472: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:34:18.837706: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:34:18.837906: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:34:18.838109: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:34:18.838147: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:34:18.880270: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:34:18.880681: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fcf08000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:34:18.880725: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:34:18.884830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:34:18.884876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:34:19.163225: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:34:19.163380: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:34:19.163679: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:34:19.163710: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:34:19.163735: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:34:19.163771: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:34:19.163852: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:34:19.163878: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:34:19.163893: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fcf3dea24c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:40:44.166691: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:40:44.257018: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:40:44.487565: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_bini3221024/plugins/profile/2021_02_27_15_40_44
2021-02-27 15:40:44.732956: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_bini3221024/plugins/profile/2021_02_27_15_40_44/householder.trace.json.gz
2021-02-27 15:40:44.780267: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:40:44.798265: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 15:40:44.800578: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_bini3221024/plugins/profile/2021_02_27_15_40_44Dumped tool data for overview_page.pb to PAPER_1_thread_bini3221024/plugins/profile/2021_02_27_15_40_44/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_bini3221024/plugins/profile/2021_02_27_15_40_44/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_bini3221024/plugins/profile/2021_02_27_15_40_44/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_bini3221024/plugins/profile/2021_02_27_15_40_44/householder.kernel_stats.pb

Epoch 1, Loss: 0.5367894768714905, Train Accuracy: 84.51643371582031,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:78.9704921245575
Average single batch time this epoch: 1.3559253791282917
Epoch 2, Loss: 0.10321103036403656, Train Accuracy: 96.93898010253906,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 76.82956266403198

Time for Epoch:76.82956266403198
Average single batch time this epoch: 1.3233740740808948
Epoch 3, Loss: 0.06723804026842117, Train Accuracy: 97.92059326171875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 76.6188600063324

Time for Epoch:76.40815734863281
Average single batch time this epoch: 1.3160876940036643
Epoch 4, Loss: 0.04181540012359619, Train Accuracy: 98.70352935791016,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 76.54759112993877

Time for Epoch:76.40505337715149
Average single batch time this epoch: 1.316066022576957
Epoch 5, Loss: 0.03730127960443497, Train Accuracy: 98.81128692626953,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 76.49920815229416

Time for Epoch:76.35405921936035
Average single batch time this epoch: 1.315152513569799
Average time per Batch: 1.3176700760578288
Average time per Epoch: 76.49920815229416
2021-02-27 15:40:49.057328: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:40:49.612016: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:40:49.612464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:40:49.613119: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:40:49.613282: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:40:49.613409: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:40:49.613551: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:40:49.613677: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:40:49.613799: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:40:49.613943: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:40:49.613966: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:40:49.652238: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:40:49.652656: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8ef4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:40:49.652697: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:40:49.656539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:40:49.656579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:40:49.936663: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:40:49.936790: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:40:49.937075: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:40:49.937104: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:40:49.937122: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:40:49.937156: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:40:49.937214: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:40:49.937240: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:40:49.937255: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8f2754f4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:47:10.390785: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:47:10.518839: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:47:10.758641: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_dgemm1024/plugins/profile/2021_02_27_15_47_10
2021-02-27 15:47:11.007660: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_dgemm1024/plugins/profile/2021_02_27_15_47_10/householder.trace.json.gz
2021-02-27 15:47:11.056257: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:47:11.074557: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 15:47:11.076975: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_dgemm1024/plugins/profile/2021_02_27_15_47_10Dumped tool data for overview_page.pb to PAPER_1_thread_dgemm1024/plugins/profile/2021_02_27_15_47_10/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_dgemm1024/plugins/profile/2021_02_27_15_47_10/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_dgemm1024/plugins/profile/2021_02_27_15_47_10/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_dgemm1024/plugins/profile/2021_02_27_15_47_10/householder.kernel_stats.pb

Epoch 1, Loss: 0.5341726541519165, Train Accuracy: 84.60735321044922,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:77.56826519966125
Average single batch time this epoch: 1.3320431791502854
Epoch 2, Loss: 0.10124395787715912, Train Accuracy: 96.98949432373047,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.66076040267944

Time for Epoch:75.66076040267944
Average single batch time this epoch: 1.3032153844833374
Epoch 3, Loss: 0.06716670095920563, Train Accuracy: 97.85997772216797,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.70834767818451

Time for Epoch:75.75593495368958
Average single batch time this epoch: 1.3048653931453311
Epoch 4, Loss: 0.045483194291591644, Train Accuracy: 98.61092376708984,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.7035726706187

Time for Epoch:75.69402265548706
Average single batch time this epoch: 1.303795522656934
Epoch 5, Loss: 0.03505110740661621, Train Accuracy: 98.85169982910156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.71246999502182

Time for Epoch:75.7391619682312
Average single batch time this epoch: 1.3045635922201748
Average time per Batch: 1.3041099731264443
Average time per Epoch: 75.71246999502182
2021-02-27 15:47:15.291906: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:47:15.843551: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:47:15.844216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:47:15.844569: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:15.844782: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:15.844994: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:15.845197: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:15.845401: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:15.845602: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:15.845803: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:15.845842: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:47:15.888317: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:47:15.888812: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1cf8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:47:15.888888: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:47:15.893295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:47:15.893335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:47:16.169641: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:47:16.169794: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:47:16.170110: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:16.170141: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:47:16.170159: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:47:16.170194: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:47:16.170237: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:47:16.170261: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:47:16.170276: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 187, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-02-27 15:47:16.865531: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:47:20.793987: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:47:21.331999: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:47:21.332521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:47:21.332863: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:21.333085: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:21.333294: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:21.333559: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:21.333778: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:21.333993: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:21.334201: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:21.334240: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:47:21.376201: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:47:21.376716: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f49e8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:47:21.376821: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:47:21.381822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:47:21.381866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:47:21.661081: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:47:21.661222: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:47:21.661506: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:47:21.661536: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:47:21.661576: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:47:21.661611: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:47:21.661651: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:47:21.661675: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:47:21.661690: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4a1c36a4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 15:53:48.437814: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:53:48.496085: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 15:53:48.735808: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_schonhage3331024/plugins/profile/2021_02_27_15_53_48
2021-02-27 15:53:48.986095: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_schonhage3331024/plugins/profile/2021_02_27_15_53_48/householder.trace.json.gz
2021-02-27 15:53:49.034913: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 15:53:49.053302: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 15:53:49.055761: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_schonhage3331024/plugins/profile/2021_02_27_15_53_48Dumped tool data for overview_page.pb to PAPER_1_thread_schonhage3331024/plugins/profile/2021_02_27_15_53_48/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_schonhage3331024/plugins/profile/2021_02_27_15_53_48/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_schonhage3331024/plugins/profile/2021_02_27_15_53_48/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_schonhage3331024/plugins/profile/2021_02_27_15_53_48/householder.kernel_stats.pb

Epoch 1, Loss: 0.5285864472389221, Train Accuracy: 84.65618133544922,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:79.20434188842773
Average single batch time this epoch: 1.360254221949084
Epoch 2, Loss: 0.10117790848016739, Train Accuracy: 96.92719268798828,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 77.21616268157959

Time for Epoch:77.21616268157959
Average single batch time this epoch: 1.3300472991219883
Epoch 3, Loss: 0.06578025966882706, Train Accuracy: 97.98120880126953,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 77.12256920337677

Time for Epoch:77.02897572517395
Average single batch time this epoch: 1.3268309091699535
Epoch 4, Loss: 0.04562543332576752, Train Accuracy: 98.54862976074219,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 76.96960481007893

Time for Epoch:76.66367602348328
Average single batch time this epoch: 1.3205120933466945
Epoch 5, Loss: 0.03952047973871231, Train Accuracy: 98.69679260253906,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 76.8841307759285

Time for Epoch:76.62770867347717
Average single batch time this epoch: 1.319907204858188
Average time per Batch: 1.324324376624206
Average time per Epoch: 76.8841307759285
2021-02-27 15:53:53.360145: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 15:53:53.911553: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 15:53:53.912218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 15:53:53.912881: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:53:53.913035: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:53:53.913162: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:53:53.913291: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:53:53.913417: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:53:53.913559: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:53:53.913686: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:53:53.913709: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 15:53:53.944187: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 15:53:53.944596: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8c48000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 15:53:53.944650: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 15:53:53.948132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 15:53:53.948168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 15:53:54.224128: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:53:54.224386: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 15:53:54.224803: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 15:53:54.224853: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:53:54.224884: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:53:54.224986: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:53:54.225088: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 15:53:54.225130: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 15:53:54.225154: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8c7b1cd550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 16:00:03.909769: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:00:04.029387: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 16:00:04.312974: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2241024/plugins/profile/2021_02_27_16_00_04
2021-02-27 16:00:04.576422: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2241024/plugins/profile/2021_02_27_16_00_04/householder.trace.json.gz
2021-02-27 16:00:04.629465: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 16:00:04.648065: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 16:00:04.650411: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2241024/plugins/profile/2021_02_27_16_00_04Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2241024/plugins/profile/2021_02_27_16_00_04/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2241024/plugins/profile/2021_02_27_16_00_04/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2241024/plugins/profile/2021_02_27_16_00_04/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2241024/plugins/profile/2021_02_27_16_00_04/householder.kernel_stats.pb

Epoch 1, Loss: 0.537628173828125, Train Accuracy: 84.52653503417969,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:75.51232767105103
Average single batch time this epoch: 1.2961887491160426
Epoch 2, Loss: 0.1032010093331337, Train Accuracy: 96.89857482910156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 73.51592588424683

Time for Epoch:73.51592588424683
Average single batch time this epoch: 1.2662188924592117
Epoch 3, Loss: 0.06467343866825104, Train Accuracy: 98.03508758544922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 73.56418597698212

Time for Epoch:73.61244606971741
Average single batch time this epoch: 1.2678715607215618
Epoch 4, Loss: 0.04061894491314888, Train Accuracy: 98.70352935791016,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 73.54247657457988

Time for Epoch:73.49905776977539
Average single batch time this epoch: 1.2659551809573997
Epoch 5, Loss: 0.036996256560087204, Train Accuracy: 98.77593231201172,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 73.53379809856415

Time for Epoch:73.50776267051697
Average single batch time this epoch: 1.2660966166134537
Average time per Batch: 1.2665355626879067
Average time per Epoch: 73.53379809856415
2021-02-27 16:00:08.846433: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 16:00:09.395327: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 16:00:09.395819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 16:00:09.396565: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:00:09.396709: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:00:09.396838: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:00:09.396971: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:00:09.397118: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:00:09.397244: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:00:09.397375: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:00:09.397413: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 16:00:09.436253: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 16:00:09.436759: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f61a0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 16:00:09.436848: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 16:00:09.441870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 16:00:09.441914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 16:00:09.724644: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:00:09.724775: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 16:00:09.725082: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:00:09.725111: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:00:09.725134: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:00:09.725169: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:00:09.725208: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:00:09.725232: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:00:09.725246: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f61d38c24c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 16:06:27.340093: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:06:27.481983: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 16:06:27.725386: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2251024/plugins/profile/2021_02_27_16_06_27
2021-02-27 16:06:27.980720: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2251024/plugins/profile/2021_02_27_16_06_27/householder.trace.json.gz
2021-02-27 16:06:28.030696: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 16:06:28.049268: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 16:06:28.051682: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2251024/plugins/profile/2021_02_27_16_06_27Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2251024/plugins/profile/2021_02_27_16_06_27/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2251024/plugins/profile/2021_02_27_16_06_27/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2251024/plugins/profile/2021_02_27_16_06_27/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2251024/plugins/profile/2021_02_27_16_06_27/householder.kernel_stats.pb

Epoch 1, Loss: 0.6204593181610107, Train Accuracy: 82.01609802246094,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:77.15157413482666
Average single batch time this epoch: 1.3248939514160156
Epoch 2, Loss: 0.12836551666259766, Train Accuracy: 96.04660034179688,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.08421778678894

Time for Epoch:75.08421778678894
Average single batch time this epoch: 1.2932708098970611
Epoch 3, Loss: 0.08419707417488098, Train Accuracy: 97.37338256835938,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.09249353408813

Time for Epoch:75.10076928138733
Average single batch time this epoch: 1.293548900505592
Epoch 4, Loss: 0.06874778121709824, Train Accuracy: 97.86334991455078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.11146378517151

Time for Epoch:75.14940428733826
Average single batch time this epoch: 1.2944137556799526
Epoch 5, Loss: 0.051895663142204285, Train Accuracy: 98.36846923828125,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.10652631521225

Time for Epoch:75.09171390533447
Average single batch time this epoch: 1.2934011508678567
Average time per Batch: 1.2936586542376158
Average time per Epoch: 75.10652631521225
2021-02-27 16:06:32.251186: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 16:06:32.812893: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 16:06:32.813512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 16:06:32.814259: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:06:32.814405: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:06:32.814543: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:06:32.814680: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:06:32.814815: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:06:32.814946: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:06:32.815080: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:06:32.815104: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 16:06:32.852343: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 16:06:32.852738: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9cbc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 16:06:32.852777: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 16:06:32.856248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 16:06:32.856290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 16:06:33.134281: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:06:33.134455: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 16:06:33.134766: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:06:33.134807: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:06:33.134826: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:06:33.134871: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:06:33.134914: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:06:33.134938: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:06:33.134954: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9cefc514c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 16:13:19.722179: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:13:19.848035: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 16:13:20.094011: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2721024/plugins/profile/2021_02_27_16_13_19
2021-02-27 16:13:20.343695: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2721024/plugins/profile/2021_02_27_16_13_19/householder.trace.json.gz
2021-02-27 16:13:20.393879: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 16:13:20.412332: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 16:13:20.414627: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2721024/plugins/profile/2021_02_27_16_13_19Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2721024/plugins/profile/2021_02_27_16_13_19/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2721024/plugins/profile/2021_02_27_16_13_19/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2721024/plugins/profile/2021_02_27_16_13_19/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2721024/plugins/profile/2021_02_27_16_13_19/householder.kernel_stats.pb

Epoch 1, Loss: 369506592.0, Train Accuracy: 10.371767044067383,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:84.05078125
Average single batch time this epoch: 1.4435149349015335
Epoch 2, Loss: 332582080.0, Train Accuracy: 10.903825759887695,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 81.46885204315186

Time for Epoch:81.46885204315186
Average single batch time this epoch: 1.4033402862219975
Epoch 3, Loss: 216774208.0, Train Accuracy: 11.550376892089844,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 81.14587616920471

Time for Epoch:80.82290029525757
Average single batch time this epoch: 1.3922315013819728
Epoch 4, Loss: 96377584.0, Train Accuracy: 11.247305870056152,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 80.83280380566914

Time for Epoch:80.20665907859802
Average single batch time this epoch: 1.381592166834864
Epoch 5, Loss: 72150960.0, Train Accuracy: 10.828057289123535,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 80.62526613473892

Time for Epoch:80.00265312194824
Average single batch time this epoch: 1.378078847095884
Average time per Batch: 1.3888107003836794
Average time per Epoch: 80.62526613473892
2021-02-27 16:13:24.606494: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 16:13:25.159337: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 16:13:25.159807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 16:13:25.160094: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:13:25.160268: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:13:25.160455: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:13:25.160654: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:13:25.160840: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:13:25.161002: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:13:25.161167: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:13:25.161198: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 16:13:25.200376: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 16:13:25.200903: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0974000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 16:13:25.200985: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 16:13:25.205624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 16:13:25.205668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 16:13:25.485791: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:13:25.485925: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 16:13:25.486225: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:13:25.486255: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:13:25.486293: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:13:25.486328: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:13:25.486371: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:13:25.486394: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:13:25.486409: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f09a63ce550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 16:19:52.687096: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:19:52.823627: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 16:19:53.097875: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3231024/plugins/profile/2021_02_27_16_19_52
2021-02-27 16:19:53.346104: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3231024/plugins/profile/2021_02_27_16_19_52/householder.trace.json.gz
2021-02-27 16:19:53.398911: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 16:19:53.417329: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 16:19:53.419809: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3231024/plugins/profile/2021_02_27_16_19_52Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3231024/plugins/profile/2021_02_27_16_19_52/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3231024/plugins/profile/2021_02_27_16_19_52/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3231024/plugins/profile/2021_02_27_16_19_52/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3231024/plugins/profile/2021_02_27_16_19_52/householder.kernel_stats.pb

Epoch 1, Loss: 0.5898852944374084, Train Accuracy: 82.81417846679688,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:78.26556587219238
Average single batch time this epoch: 1.344031259931367
Epoch 2, Loss: 0.1120421439409256, Train Accuracy: 96.59718322753906,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 77.20511102676392

Time for Epoch:77.20511102676392
Average single batch time this epoch: 1.3298235186215104
Epoch 3, Loss: 0.07275515049695969, Train Accuracy: 97.75895690917969,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 77.22707903385162

Time for Epoch:77.24904704093933
Average single batch time this epoch: 1.330583983454211
Epoch 4, Loss: 0.05238204449415207, Train Accuracy: 98.32300567626953,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 77.1949212551117

Time for Epoch:77.13060569763184
Average single batch time this epoch: 1.328557170670608
Epoch 5, Loss: 0.04484361782670021, Train Accuracy: 98.55535888671875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 77.22446727752686

Time for Epoch:77.31310534477234
Average single batch time this epoch: 1.3317030051658894
Average time per Batch: 1.3301669194780548
Average time per Epoch: 77.22446727752686
2021-02-27 16:19:57.616211: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 16:19:58.172197: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 16:19:58.172660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 16:19:58.173411: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:19:58.173567: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:19:58.173694: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:19:58.173823: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:19:58.173947: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:19:58.174086: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:19:58.174244: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:19:58.174281: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 16:19:58.208206: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 16:19:58.208596: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa858000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 16:19:58.208665: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 16:19:58.212649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 16:19:58.212693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 16:19:58.487530: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:19:58.487658: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 16:19:58.487961: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:19:58.487992: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:19:58.488010: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:19:58.488077: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:19:58.488138: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:19:58.488165: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:19:58.488204: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa88b75d4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 16:26:20.399978: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:26:20.447086: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 16:26:20.717128: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3331024/plugins/profile/2021_02_27_16_26_20
2021-02-27 16:26:20.982009: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3331024/plugins/profile/2021_02_27_16_26_20/householder.trace.json.gz
2021-02-27 16:26:21.035928: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 16:26:21.054921: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 16:26:21.057280: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3331024/plugins/profile/2021_02_27_16_26_20Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3331024/plugins/profile/2021_02_27_16_26_20/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3331024/plugins/profile/2021_02_27_16_26_20/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3331024/plugins/profile/2021_02_27_16_26_20/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3331024/plugins/profile/2021_02_27_16_26_20/householder.kernel_stats.pb

Epoch 1, Loss: 17173126144.0, Train Accuracy: 9.888537406921387,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:78.01478505134583
Average single batch time this epoch: 1.3397346652787308
Epoch 2, Loss: 29944072192.0, Train Accuracy: 9.917160987854004,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.94068574905396

Time for Epoch:75.94068574905396
Average single batch time this epoch: 1.3080370138431419
Epoch 3, Loss: 28984147968.0, Train Accuracy: 9.947467803955078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.9226861000061

Time for Epoch:75.90468645095825
Average single batch time this epoch: 1.3074121968499546
Epoch 4, Loss: 27843848192.0, Train Accuracy: 9.61577320098877,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.94412446022034

Time for Epoch:75.9870011806488
Average single batch time this epoch: 1.3088400610562028
Epoch 5, Loss: 85269970944.0, Train Accuracy: 9.85991382598877,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.96542233228683

Time for Epoch:76.02931594848633
Average single batch time this epoch: 1.309578907900843
Average time per Batch: 1.3084670449125357
Average time per Epoch: 75.96542233228683
2021-02-27 16:26:25.303249: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 16:26:25.867560: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 16:26:25.868225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 16:26:25.868605: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:26:25.868826: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:26:25.869039: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:26:25.869254: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:26:25.869465: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:26:25.869672: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:26:25.869882: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:26:25.869952: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 16:26:25.912353: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 16:26:25.912830: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6b20000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 16:26:25.912908: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 16:26:25.917254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 16:26:25.917296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 16:26:26.193363: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:26:26.193516: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 16:26:26.193836: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:26:26.193867: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:26:26.193886: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:26:26.193922: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:26:26.193964: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:26:26.193987: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:26:26.194002: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f6b55d104c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 16:32:49.912655: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:32:50.037985: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 16:32:50.305967: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3341024/plugins/profile/2021_02_27_16_32_50
2021-02-27 16:32:50.571947: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3341024/plugins/profile/2021_02_27_16_32_50/householder.trace.json.gz
2021-02-27 16:32:50.628293: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 16:32:50.647976: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 16:32:50.650416: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3341024/plugins/profile/2021_02_27_16_32_50Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3341024/plugins/profile/2021_02_27_16_32_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3341024/plugins/profile/2021_02_27_16_32_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3341024/plugins/profile/2021_02_27_16_32_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3341024/plugins/profile/2021_02_27_16_32_50/householder.kernel_stats.pb

Epoch 1, Loss: 0.564949631690979, Train Accuracy: 83.54155731201172,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:77.92627096176147
Average single batch time this epoch: 1.3378584138278304
Epoch 2, Loss: 0.11357929557561874, Train Accuracy: 96.55845642089844,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 76.40617895126343

Time for Epoch:76.40617895126343
Average single batch time this epoch: 1.3160672105591873
Epoch 3, Loss: 0.07041015475988388, Train Accuracy: 97.79768371582031,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 76.40362107753754

Time for Epoch:76.40106320381165
Average single batch time this epoch: 1.3159700097708866
Epoch 4, Loss: 0.04744264855980873, Train Accuracy: 98.49474334716797,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 76.39176122347514

Time for Epoch:76.36804151535034
Average single batch time this epoch: 1.3153993055738251
Epoch 5, Loss: 0.04271397739648819, Train Accuracy: 98.59745788574219,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 76.43897956609726

Time for Epoch:76.58063459396362
Average single batch time this epoch: 1.319061932892635
Average time per Batch: 1.3166246146991334
Average time per Epoch: 76.43897956609726
2021-02-27 16:32:54.853744: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 16:32:55.411320: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 16:32:55.411804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 16:32:55.412763: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:32:55.412920: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:32:55.413055: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:32:55.413188: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:32:55.413321: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:32:55.413449: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:32:55.413579: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:32:55.413603: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 16:32:55.448385: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 16:32:55.448839: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4ed4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 16:32:55.448923: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 16:32:55.452936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 16:32:55.452979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 16:32:55.731453: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:32:55.731533: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 16:32:55.731737: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:32:55.731767: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:32:55.731806: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:32:55.731842: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:32:55.731884: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:32:55.731908: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:32:55.731923: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4f081cc550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 16:38:53.512361: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:38:53.642915: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 16:38:53.895652: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov4421024/plugins/profile/2021_02_27_16_38_53
2021-02-27 16:38:54.149025: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov4421024/plugins/profile/2021_02_27_16_38_53/householder.trace.json.gz
2021-02-27 16:38:54.198589: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 16:38:54.216805: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 16:38:54.219207: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov4421024/plugins/profile/2021_02_27_16_38_53Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov4421024/plugins/profile/2021_02_27_16_38_53/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov4421024/plugins/profile/2021_02_27_16_38_53/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov4421024/plugins/profile/2021_02_27_16_38_53/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov4421024/plugins/profile/2021_02_27_16_38_53/householder.kernel_stats.pb

Epoch 1, Loss: 0.5975496768951416, Train Accuracy: 82.99097442626953,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:73.04230999946594
Average single batch time this epoch: 1.2539131888027848
Epoch 2, Loss: 0.11881839483976364, Train Accuracy: 96.43218231201172,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.14399671554565

Time for Epoch:71.14399671554565
Average single batch time this epoch: 1.2253416242270634
Epoch 3, Loss: 0.07367724180221558, Train Accuracy: 97.74885559082031,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.16476893424988

Time for Epoch:71.1855411529541
Average single batch time this epoch: 1.2260670620819618
Epoch 4, Loss: 0.055160630494356155, Train Accuracy: 98.26744079589844,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.17943541208903

Time for Epoch:71.20876836776733
Average single batch time this epoch: 1.2264449925258243
Epoch 5, Loss: 0.046232935041189194, Train Accuracy: 98.44255065917969,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.17552071809769

Time for Epoch:71.16377663612366
Average single batch time this epoch: 1.225697817473576
Average time per Batch: 1.2258878740771064
Average time per Epoch: 71.17552071809769
2021-02-27 16:38:58.413790: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 16:38:58.967345: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 16:38:58.967800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 16:38:58.968083: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:38:58.968255: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:38:58.968447: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:38:58.968613: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:38:58.968806: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:38:58.968966: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:38:58.969128: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:38:58.969158: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 16:38:59.008255: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 16:38:59.008657: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7664000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 16:38:59.008695: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 16:38:59.012127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 16:38:59.012166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 16:38:59.292961: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:38:59.293104: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 16:38:59.293388: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:38:59.293440: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:38:59.293460: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:38:59.293493: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:38:59.293551: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:38:59.293577: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:38:59.293592: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f76973c7550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 16:44:59.679209: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:44:59.792499: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 16:45:00.030752: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov4441024/plugins/profile/2021_02_27_16_44_59
2021-02-27 16:45:00.284258: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov4441024/plugins/profile/2021_02_27_16_44_59/householder.trace.json.gz
2021-02-27 16:45:00.332855: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 16:45:00.351127: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 16:45:00.353435: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov4441024/plugins/profile/2021_02_27_16_44_59Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov4441024/plugins/profile/2021_02_27_16_44_59/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov4441024/plugins/profile/2021_02_27_16_44_59/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov4441024/plugins/profile/2021_02_27_16_44_59/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov4441024/plugins/profile/2021_02_27_16_44_59/householder.kernel_stats.pb

Epoch 1, Loss: 0.601698637008667, Train Accuracy: 82.63233947753906,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:73.67017483711243
Average single batch time this epoch: 1.264852844435593
Epoch 2, Loss: 0.12031872570514679, Train Accuracy: 96.37661743164062,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.65631651878357

Time for Epoch:71.65631651878357
Average single batch time this epoch: 1.2341850667164243
Epoch 3, Loss: 0.08022242039442062, Train Accuracy: 97.4609375,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.66483581066132

Time for Epoch:71.67335510253906
Average single batch time this epoch: 1.2344756907430188
Epoch 4, Loss: 0.05716066062450409, Train Accuracy: 98.193359375,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.65957474708557

Time for Epoch:71.64905261993408
Average single batch time this epoch: 1.2340454438637043
Epoch 5, Loss: 0.04191603884100914, Train Accuracy: 98.67322540283203,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.67004919052124

Time for Epoch:71.70147252082825
Average single batch time this epoch: 1.2349495928863
Average time per Batch: 1.234413948552362
Average time per Epoch: 71.67004919052124
2021-02-27 16:45:04.617424: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 16:45:05.175813: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 16:45:05.176443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 16:45:05.177031: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:45:05.177191: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:45:05.177321: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:45:05.177453: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:45:05.177600: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:45:05.177726: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:45:05.177856: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:45:05.177880: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 16:45:05.212202: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 16:45:05.212642: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd424000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 16:45:05.212712: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 16:45:05.216691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 16:45:05.216734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 16:45:05.493267: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:45:05.493533: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 16:45:05.493946: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:45:05.493999: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:45:05.494028: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:45:05.494130: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:45:05.494232: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:45:05.494298: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:45:05.494324: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd456139550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 16:51:53.311549: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:51:53.448388: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 16:51:53.712349: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov5521024/plugins/profile/2021_02_27_16_51_53
2021-02-27 16:51:53.962607: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov5521024/plugins/profile/2021_02_27_16_51_53/householder.trace.json.gz
2021-02-27 16:51:54.011557: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 16:51:54.030017: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 16:51:54.032406: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov5521024/plugins/profile/2021_02_27_16_51_53Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov5521024/plugins/profile/2021_02_27_16_51_53/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov5521024/plugins/profile/2021_02_27_16_51_53/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov5521024/plugins/profile/2021_02_27_16_51_53/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov5521024/plugins/profile/2021_02_27_16_51_53/householder.kernel_stats.pb

Epoch 1, Loss: 0.5701323747634888, Train Accuracy: 83.61563873291016,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:83.37857127189636
Average single batch time this epoch: 1.4316971466459076
Epoch 2, Loss: 0.11124677956104279, Train Accuracy: 96.66284942626953,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 80.9443690776825

Time for Epoch:80.9443690776825
Average single batch time this epoch: 1.3942913598027722
Epoch 3, Loss: 0.06918971240520477, Train Accuracy: 97.82967376708984,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 81.090136885643

Time for Epoch:81.23590469360352
Average single batch time this epoch: 1.3993050476600384
Epoch 4, Loss: 0.045026667416095734, Train Accuracy: 98.62102508544922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 81.08698225021362

Time for Epoch:81.08067297935486
Average single batch time this epoch: 1.396623685442168
Epoch 5, Loss: 0.03684273734688759, Train Accuracy: 98.81465148925781,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 81.09959709644318

Time for Epoch:81.13744163513184
Average single batch time this epoch: 1.3976311437014877
Average time per Batch: 1.3969628091516166
Average time per Epoch: 81.09959709644318
2021-02-27 16:51:58.218273: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 16:51:58.772523: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 16:51:58.773028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 16:51:58.773750: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:51:58.773896: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:51:58.774046: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:51:58.774178: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:51:58.774322: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:51:58.774449: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:51:58.774594: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:51:58.774617: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 16:51:58.812372: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 16:51:58.812762: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb868000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 16:51:58.812800: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 16:51:58.816242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 16:51:58.816278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 16:51:59.096426: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:51:59.096556: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 16:51:59.096827: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:51:59.096857: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:51:59.096875: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:51:59.096909: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:51:59.096958: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:51:59.096982: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:51:59.096997: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fb89c1744c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 16:59:09.514484: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:59:09.647311: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 16:59:09.895761: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov5551024/plugins/profile/2021_02_27_16_59_09
2021-02-27 16:59:10.151099: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov5551024/plugins/profile/2021_02_27_16_59_09/householder.trace.json.gz
2021-02-27 16:59:10.201149: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 16:59:10.219357: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 16:59:10.221753: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov5551024/plugins/profile/2021_02_27_16_59_09Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov5551024/plugins/profile/2021_02_27_16_59_09/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov5551024/plugins/profile/2021_02_27_16_59_09/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov5551024/plugins/profile/2021_02_27_16_59_09/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov5551024/plugins/profile/2021_02_27_16_59_09/householder.kernel_stats.pb

Epoch 1, Loss: 0.5852153301239014, Train Accuracy: 83.08526611328125,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:87.62926745414734
Average single batch time this epoch: 1.505530862972654
Epoch 2, Loss: 0.11622358113527298, Train Accuracy: 96.41365814208984,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 85.68604969978333

Time for Epoch:85.68604969978333
Average single batch time this epoch: 1.476097920845295
Epoch 3, Loss: 0.07497668266296387, Train Accuracy: 97.64446258544922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 85.65888822078705

Time for Epoch:85.63172674179077
Average single batch time this epoch: 1.4751356593493758
Epoch 4, Loss: 0.05292972922325134, Train Accuracy: 98.35836029052734,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 85.67761826515198

Time for Epoch:85.71507835388184
Average single batch time this epoch: 1.476582695697916
Epoch 5, Loss: 0.04334361478686333, Train Accuracy: 98.5772476196289,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 85.68820786476135

Time for Epoch:85.71997666358948
Average single batch time this epoch: 1.4766429827131073
Average time per Batch: 1.4761148146514236
Average time per Epoch: 85.68820786476135
2021-02-27 16:59:14.434364: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 16:59:14.987617: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 16:59:14.988324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 16:59:14.988662: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:59:14.988859: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:59:14.989056: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:59:14.989243: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:59:14.989434: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:59:14.989624: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:59:14.989811: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:59:14.989846: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 16:59:15.028248: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 16:59:15.028735: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4aa4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 16:59:15.028801: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 16:59:15.033902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 16:59:15.033952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 16:59:15.894477: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:59:15.894635: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 16:59:15.894952: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 16:59:15.894983: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:59:15.895002: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:59:15.895037: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:59:15.895079: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 16:59:15.895102: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 16:59:15.895117: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4ad625c550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 17:19:54.717307: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:19:54.819031: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 17:19:54.940394: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_bini3222048/plugins/profile/2021_02_27_17_19_54
2021-02-27 17:19:55.072327: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_bini3222048/plugins/profile/2021_02_27_17_19_54/householder.trace.json.gz
2021-02-27 17:19:55.093322: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 17:19:55.102683: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 17:19:55.104789: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_bini3222048/plugins/profile/2021_02_27_17_19_54Dumped tool data for overview_page.pb to PAPER_1_thread_bini3222048/plugins/profile/2021_02_27_17_19_54/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_bini3222048/plugins/profile/2021_02_27_17_19_54/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_bini3222048/plugins/profile/2021_02_27_17_19_54/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_bini3222048/plugins/profile/2021_02_27_17_19_54/householder.kernel_stats.pb

Epoch 1, Loss: 9.17103099822998, Train Accuracy: 54.46019744873047,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:248.86806559562683
Average single batch time this epoch: 8.570357092495623
Epoch 2, Loss: 0.26091015338897705, Train Accuracy: 92.2430648803711,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 246.95922923088074

Time for Epoch:246.95922923088074
Average single batch time this epoch: 8.513294614594558
Epoch 3, Loss: 0.1432773321866989, Train Accuracy: 95.67113494873047,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 246.9383270740509

Time for Epoch:246.91742491722107
Average single batch time this epoch: 8.511858290639417
Epoch 4, Loss: 0.09130698442459106, Train Accuracy: 97.216796875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 247.0791873137156

Time for Epoch:247.36090779304504
Average single batch time this epoch: 8.52717767090633
Epoch 5, Loss: 0.061613406985998154, Train Accuracy: 98.15968322753906,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 247.4799361228943

Time for Epoch:248.6821825504303
Average single batch time this epoch: 8.572747666260291
Average time per Batch: 8.531269560600148
Average time per Epoch: 247.4799361228943
2021-02-27 17:19:59.440082: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 17:19:59.999331: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 17:19:59.999817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 17:20:00.000733: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:20:00.000885: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:20:00.001027: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:20:00.001158: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:20:00.001291: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:20:00.001416: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:20:00.001540: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:20:00.001565: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 17:20:00.036326: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 17:20:00.036819: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f07b8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 17:20:00.036880: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 17:20:00.040888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 17:20:00.040930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 17:20:00.907442: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 17:20:00.907591: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 17:20:00.907902: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:20:00.907969: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:20:00.907998: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:20:00.908033: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:20:00.908090: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 17:20:00.908116: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:20:00.908131: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f07ec0934c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 17:41:11.915029: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:41:12.018791: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 17:41:12.144704: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_dgemm2048/plugins/profile/2021_02_27_17_41_12
2021-02-27 17:41:12.279830: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_dgemm2048/plugins/profile/2021_02_27_17_41_12/householder.trace.json.gz
2021-02-27 17:41:12.302270: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 17:41:12.311801: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 17:41:12.313977: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_dgemm2048/plugins/profile/2021_02_27_17_41_12Dumped tool data for overview_page.pb to PAPER_1_thread_dgemm2048/plugins/profile/2021_02_27_17_41_12/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_dgemm2048/plugins/profile/2021_02_27_17_41_12/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_dgemm2048/plugins/profile/2021_02_27_17_41_12/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_dgemm2048/plugins/profile/2021_02_27_17_41_12/householder.kernel_stats.pb

Epoch 1, Loss: 9.23232650756836, Train Accuracy: 55.11348342895508,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:255.95527911186218
Average single batch time this epoch: 8.815337139984656
Epoch 2, Loss: 0.25126567482948303, Train Accuracy: 92.50404357910156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 253.86771893501282

Time for Epoch:253.86771893501282
Average single batch time this epoch: 8.751492894929031
Epoch 3, Loss: 0.14506620168685913, Train Accuracy: 95.60714721679688,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 253.50712752342224

Time for Epoch:253.14653611183167
Average single batch time this epoch: 8.726615839991076
Epoch 4, Loss: 0.09291068464517593, Train Accuracy: 97.13092803955078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 253.40684684117636

Time for Epoch:253.20628547668457
Average single batch time this epoch: 8.728717047592689
Epoch 5, Loss: 0.06734994053840637, Train Accuracy: 97.93070220947266,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 253.75411981344223

Time for Epoch:254.79593873023987
Average single batch time this epoch: 8.783582226983432
Average time per Batch: 8.747602002374057
Average time per Epoch: 253.75411981344223
2021-02-27 17:41:16.751604: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 17:41:17.273214: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 17:41:17.273654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 17:41:17.273942: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:17.274138: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:17.274310: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:17.274497: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:17.274708: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:17.274868: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:17.275035: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:17.275064: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 17:41:17.316198: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 17:41:17.316694: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1244000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 17:41:17.316801: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 17:41:17.321810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 17:41:17.321854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 17:41:18.185712: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 17:41:18.185835: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 17:41:18.186129: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:18.186158: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:41:18.186176: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:41:18.186209: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:41:18.186272: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 17:41:18.186297: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:41:18.186312: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 187, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-02-27 17:41:18.905277: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:41:22.858149: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 17:41:23.411979: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 17:41:23.412501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 17:41:23.412827: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:23.413044: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:23.413248: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:23.413476: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:23.413687: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:23.413888: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:23.414094: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:23.414133: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 17:41:23.456212: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 17:41:23.456626: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd158000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 17:41:23.456675: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 17:41:23.461258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 17:41:23.461300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 17:41:24.314661: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 17:41:24.314804: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 17:41:24.315102: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 17:41:24.315147: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:41:24.315170: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:41:24.315203: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:41:24.315250: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 17:41:24.315275: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 17:41:24.315290: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd18a5554c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 18:01:50.991329: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:01:51.053161: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 18:01:51.178926: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_schonhage3332048/plugins/profile/2021_02_27_18_01_51
2021-02-27 18:01:51.315858: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_schonhage3332048/plugins/profile/2021_02_27_18_01_51/householder.trace.json.gz
2021-02-27 18:01:51.337870: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 18:01:51.347824: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 18:01:51.349981: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_schonhage3332048/plugins/profile/2021_02_27_18_01_51Dumped tool data for overview_page.pb to PAPER_1_thread_schonhage3332048/plugins/profile/2021_02_27_18_01_51/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_schonhage3332048/plugins/profile/2021_02_27_18_01_51/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_schonhage3332048/plugins/profile/2021_02_27_18_01_51/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_schonhage3332048/plugins/profile/2021_02_27_18_01_51/householder.kernel_stats.pb

Epoch 1, Loss: 9.058396339416504, Train Accuracy: 55.04781723022461,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:247.82619500160217
Average single batch time this epoch: 8.535144633260266
Epoch 2, Loss: 0.25608184933662415, Train Accuracy: 92.33230590820312,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 245.29156017303467

Time for Epoch:245.29156017303467
Average single batch time this epoch: 8.455777751988379
Epoch 3, Loss: 0.1420925110578537, Train Accuracy: 95.71659851074219,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 244.92014634609222

Time for Epoch:244.54873251914978
Average single batch time this epoch: 8.430175838799313
Epoch 4, Loss: 0.08959938585758209, Train Accuracy: 97.26898956298828,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 244.7557430267334

Time for Epoch:244.42693638801575
Average single batch time this epoch: 8.425950658732447
Epoch 5, Loss: 0.06280514597892761, Train Accuracy: 98.11759185791016,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 244.7039297223091

Time for Epoch:244.54848980903625
Average single batch time this epoch: 8.430128541486017
Average time per Batch: 8.435508197751538
Average time per Epoch: 244.7039297223091
2021-02-27 18:01:55.664012: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 18:01:56.224875: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 18:01:56.225517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 18:01:56.226114: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:01:56.226290: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:01:56.226416: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:01:56.226546: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:01:56.226670: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:01:56.226793: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:01:56.226919: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:01:56.226944: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 18:01:56.260251: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 18:01:56.260633: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f94ec000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 18:01:56.260682: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 18:01:56.264221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 18:01:56.264263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 18:01:57.124879: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 18:01:57.125077: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 18:01:57.125469: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:01:57.125522: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:01:57.125552: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:01:57.125652: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:01:57.125753: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 18:01:57.125795: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:01:57.125819: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f951fd694c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 18:21:24.670404: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:21:24.697568: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 18:21:24.863614: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2242048/plugins/profile/2021_02_27_18_21_24
2021-02-27 18:21:24.999411: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2242048/plugins/profile/2021_02_27_18_21_24/householder.trace.json.gz
2021-02-27 18:21:25.021204: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 18:21:25.034297: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 18:21:25.036554: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2242048/plugins/profile/2021_02_27_18_21_24Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2242048/plugins/profile/2021_02_27_18_21_24/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2242048/plugins/profile/2021_02_27_18_21_24/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2242048/plugins/profile/2021_02_27_18_21_24/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2242048/plugins/profile/2021_02_27_18_21_24/householder.kernel_stats.pb

Epoch 1, Loss: 9.228546142578125, Train Accuracy: 54.236263275146484,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:237.09693384170532
Average single batch time this epoch: 8.16422676217967
Epoch 2, Loss: 0.25584888458251953, Train Accuracy: 92.41312408447266,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 233.14929389953613

Time for Epoch:233.14929389953613
Average single batch time this epoch: 8.037086963653564
Epoch 3, Loss: 0.14343184232711792, Train Accuracy: 95.62904357910156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 232.74505865573883

Time for Epoch:232.34082341194153
Average single batch time this epoch: 8.009172932855014
Epoch 4, Loss: 0.09005726128816605, Train Accuracy: 97.23699951171875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 232.65282797813416

Time for Epoch:232.4683666229248
Average single batch time this epoch: 8.01357704195483
Epoch 5, Loss: 0.05974825099110603, Train Accuracy: 98.21019744873047,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 232.60238921642303

Time for Epoch:232.45107293128967
Average single batch time this epoch: 8.013013198457916
Average time per Batch: 8.018212534230333
Average time per Epoch: 232.60238921642303
2021-02-27 18:21:29.329055: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 18:21:29.851574: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 18:21:29.852073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 18:21:29.852893: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:21:29.853048: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:21:29.853186: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:21:29.853339: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:21:29.853472: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:21:29.853600: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:21:29.853727: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:21:29.853754: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 18:21:29.892291: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 18:21:29.892733: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5fd4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 18:21:29.892799: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 18:21:29.896307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 18:21:29.896348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 18:21:30.762039: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 18:21:30.762169: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 18:21:30.762463: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:21:30.762494: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:21:30.762517: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:21:30.762574: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:21:30.762617: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 18:21:30.762641: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:21:30.762656: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f60069f34c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 18:41:18.468378: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:41:18.495527: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 18:41:18.648443: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2252048/plugins/profile/2021_02_27_18_41_18
2021-02-27 18:41:18.792189: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2252048/plugins/profile/2021_02_27_18_41_18/householder.trace.json.gz
2021-02-27 18:41:18.816001: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 18:41:18.826083: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 18:41:18.828268: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2252048/plugins/profile/2021_02_27_18_41_18Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2252048/plugins/profile/2021_02_27_18_41_18/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2252048/plugins/profile/2021_02_27_18_41_18/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2252048/plugins/profile/2021_02_27_18_41_18/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2252048/plugins/profile/2021_02_27_18_41_18/householder.kernel_stats.pb

Epoch 1, Loss: 7.720065116882324, Train Accuracy: 55.263336181640625,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:239.69990301132202
Average single batch time this epoch: 8.2547767162323
Epoch 2, Loss: 0.3006839156150818, Train Accuracy: 90.87755584716797,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 236.92507910728455

Time for Epoch:236.92507910728455
Average single batch time this epoch: 8.1673013095198
Epoch 3, Loss: 0.17866560816764832, Train Accuracy: 94.4756851196289,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 236.8944536447525

Time for Epoch:236.86382818222046
Average single batch time this epoch: 8.165185607712845
Epoch 4, Loss: 0.12903185188770294, Train Accuracy: 96.00450897216797,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 236.92094914118448

Time for Epoch:236.97394013404846
Average single batch time this epoch: 8.168999639050714
Epoch 5, Loss: 0.09927430003881454, Train Accuracy: 96.93561553955078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 236.99278223514557

Time for Epoch:237.2082815170288
Average single batch time this epoch: 8.177033062638907
Average time per Batch: 8.169629904730566
Average time per Epoch: 236.99278223514557
2021-02-27 18:41:23.130097: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 18:41:23.656001: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 18:41:23.656547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 18:41:23.657225: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:41:23.657390: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:41:23.657537: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:41:23.657663: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:41:23.657804: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:41:23.657944: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:41:23.658069: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:41:23.658092: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 18:41:23.696190: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 18:41:23.696674: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb648000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 18:41:23.696760: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 18:41:23.701121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 18:41:23.701159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 18:41:24.562537: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 18:41:24.562682: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 18:41:24.562989: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 18:41:24.563019: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:41:24.563038: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:41:24.563071: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:41:24.563131: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 18:41:24.563157: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 18:41:24.563173: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fb67a4ea4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 19:01:35.181461: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:01:35.222289: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 19:01:35.355093: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2722048/plugins/profile/2021_02_27_19_01_35
2021-02-27 19:01:35.497459: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2722048/plugins/profile/2021_02_27_19_01_35/householder.trace.json.gz
2021-02-27 19:01:35.523735: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 19:01:35.534020: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 19:01:35.536258: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2722048/plugins/profile/2021_02_27_19_01_35Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2722048/plugins/profile/2021_02_27_19_01_35/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2722048/plugins/profile/2021_02_27_19_01_35/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2722048/plugins/profile/2021_02_27_19_01_35/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2722048/plugins/profile/2021_02_27_19_01_35/householder.kernel_stats.pb

Epoch 1, Loss: 2307664384.0, Train Accuracy: 10.218547821044922,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:245.06948924064636
Average single batch time this epoch: 8.439965626289105
Epoch 2, Loss: 2647192832.0, Train Accuracy: 11.01663589477539,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 241.9942216873169

Time for Epoch:241.9942216873169
Average single batch time this epoch: 8.342064989024195
Epoch 3, Loss: 2643887616.0, Train Accuracy: 11.595837593078613,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 241.54446291923523

Time for Epoch:241.09470415115356
Average single batch time this epoch: 8.31103381617316
Epoch 4, Loss: 2504419328.0, Train Accuracy: 11.767578125,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 241.40921966234842

Time for Epoch:241.13873314857483
Average single batch time this epoch: 8.312549064899313
Epoch 5, Loss: 2173301504.0, Train Accuracy: 11.95952320098877,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 241.37832295894623

Time for Epoch:241.28563284873962
Average single batch time this epoch: 8.317600258465472
Average time per Batch: 8.320812032140534
Average time per Epoch: 241.37832295894623
2021-02-27 19:01:39.851020: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 19:01:40.403940: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 19:01:40.404554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 19:01:40.405282: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:01:40.405437: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:01:40.405563: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:01:40.405691: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:01:40.405814: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:01:40.405936: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:01:40.406060: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:01:40.406099: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 19:01:40.440163: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 19:01:40.440594: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa174000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 19:01:40.440664: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 19:01:40.444964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 19:01:40.445009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 19:01:41.306630: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 19:01:41.306886: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 19:01:41.307303: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:01:41.307354: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:01:41.307384: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:01:41.307487: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:01:41.307589: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 19:01:41.307631: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:01:41.307656: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa1a76d74c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 19:21:57.641658: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:21:57.752278: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 19:21:57.921839: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3232048/plugins/profile/2021_02_27_19_21_57
2021-02-27 19:21:58.066886: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3232048/plugins/profile/2021_02_27_19_21_57/householder.trace.json.gz
2021-02-27 19:21:58.090793: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 19:21:58.100628: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 19:21:58.102795: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3232048/plugins/profile/2021_02_27_19_21_57Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3232048/plugins/profile/2021_02_27_19_21_57/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3232048/plugins/profile/2021_02_27_19_21_57/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3232048/plugins/profile/2021_02_27_19_21_57/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3232048/plugins/profile/2021_02_27_19_21_57/householder.kernel_stats.pb

Epoch 1, Loss: 7.780392646789551, Train Accuracy: 57.27202224731445,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:244.43621182441711
Average single batch time this epoch: 8.417363734080874
Epoch 2, Loss: 0.2710411548614502, Train Accuracy: 91.70932006835938,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 242.14442324638367

Time for Epoch:242.14442324638367
Average single batch time this epoch: 8.347293278266644
Epoch 3, Loss: 0.1612883061170578, Train Accuracy: 95.0616226196289,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 242.54176783561707

Time for Epoch:242.93911242485046
Average single batch time this epoch: 8.374652435039652
Epoch 4, Loss: 0.11032579094171524, Train Accuracy: 96.63253784179688,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 242.72382044792175

Time for Epoch:243.08792567253113
Average single batch time this epoch: 8.379810366137274
Epoch 5, Loss: 0.07918676733970642, Train Accuracy: 97.54007720947266,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 242.9649248123169

Time for Epoch:243.68823790550232
Average single batch time this epoch: 8.400523514583194
Average time per Batch: 8.375569898506692
Average time per Epoch: 242.9649248123169
2021-02-27 19:22:02.678821: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 19:22:03.217200: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 19:22:03.217654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 19:22:03.217957: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:22:03.218165: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:22:03.218350: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:22:03.218521: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:22:03.218706: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:22:03.218869: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:22:03.219036: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:22:03.219067: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 19:22:03.260327: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 19:22:03.260762: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fbf18000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 19:22:03.260811: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 19:22:03.265402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 19:22:03.265467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 19:22:04.118648: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 19:22:04.118790: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 19:22:04.119109: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:22:04.119140: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:22:04.119159: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:22:04.119192: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:22:04.119233: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 19:22:04.119256: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:22:04.119272: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fbf4b347550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 19:42:21.622023: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:42:21.678555: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 19:42:21.801771: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3332048/plugins/profile/2021_02_27_19_42_21
2021-02-27 19:42:21.934246: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3332048/plugins/profile/2021_02_27_19_42_21/householder.trace.json.gz
2021-02-27 19:42:21.955436: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 19:42:21.965835: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 19:42:21.968029: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3332048/plugins/profile/2021_02_27_19_42_21Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3332048/plugins/profile/2021_02_27_19_42_21/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3332048/plugins/profile/2021_02_27_19_42_21/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3332048/plugins/profile/2021_02_27_19_42_21/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3332048/plugins/profile/2021_02_27_19_42_21/householder.kernel_stats.pb

Epoch 1, Loss: 157693231104.0, Train Accuracy: 10.02828598022461,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:245.42432498931885
Average single batch time this epoch: 8.452292836945633
Epoch 2, Loss: 344257757184.0, Train Accuracy: 10.115839958190918,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 243.33953619003296

Time for Epoch:243.33953619003296
Average single batch time this epoch: 8.388476223781192
Epoch 3, Loss: 540760211456.0, Train Accuracy: 10.063645362854004,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 243.16625356674194

Time for Epoch:242.99297094345093
Average single batch time this epoch: 8.376507487790338
Epoch 4, Loss: 680796225536.0, Train Accuracy: 10.004714012145996,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 243.08371845881143

Time for Epoch:242.91864824295044
Average single batch time this epoch: 8.373949108452633
Epoch 5, Loss: 722898124800.0, Train Accuracy: 9.836341857910156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 243.0109607577324

Time for Epoch:242.79268765449524
Average single batch time this epoch: 8.369599950724634
Average time per Batch: 8.3771331926872
Average time per Epoch: 243.0109607577324
2021-02-27 19:42:26.249008: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 19:42:26.777609: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 19:42:26.778207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 19:42:26.778827: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:42:26.778987: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:42:26.779115: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:42:26.779264: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:42:26.779391: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:42:26.779514: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:42:26.779640: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:42:26.779667: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 19:42:26.820227: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 19:42:26.820609: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6bf8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 19:42:26.820647: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 19:42:26.824082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 19:42:26.824123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 19:42:27.665536: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 19:42:27.665692: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 19:42:27.665992: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 19:42:27.666024: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:42:27.666060: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:42:27.666096: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:42:27.666141: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 19:42:27.666166: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 19:42:27.666181: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f6c2adff4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 20:02:47.650434: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:02:47.697266: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 20:02:47.818725: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3342048/plugins/profile/2021_02_27_20_02_47
2021-02-27 20:02:47.950841: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3342048/plugins/profile/2021_02_27_20_02_47/householder.trace.json.gz
2021-02-27 20:02:47.971571: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 20:02:47.981894: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 20:02:47.984039: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3342048/plugins/profile/2021_02_27_20_02_47Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3342048/plugins/profile/2021_02_27_20_02_47/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3342048/plugins/profile/2021_02_27_20_02_47/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3342048/plugins/profile/2021_02_27_20_02_47/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3342048/plugins/profile/2021_02_27_20_02_47/householder.kernel_stats.pb

Epoch 1, Loss: 8.391324996948242, Train Accuracy: 55.53104782104492,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:245.58090472221375
Average single batch time this epoch: 8.457031578853213
Epoch 2, Loss: 0.2754426896572113, Train Accuracy: 91.68070220947266,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 243.77787852287292

Time for Epoch:243.77787852287292
Average single batch time this epoch: 8.403608379692868
Epoch 3, Loss: 0.15367943048477173, Train Accuracy: 95.33775329589844,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 243.67582070827484

Time for Epoch:243.57376289367676
Average single batch time this epoch: 8.39657764599241
Epoch 4, Loss: 0.10376115143299103, Train Accuracy: 96.7840805053711,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 243.66857719421387

Time for Epoch:243.65409016609192
Average single batch time this epoch: 8.399348694702674
Epoch 5, Loss: 0.07860403507947922, Train Accuracy: 97.58048248291016,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 243.59221237897873

Time for Epoch:243.36311793327332
Average single batch time this epoch: 8.389296498791925
Average time per Batch: 8.39720780479497
Average time per Epoch: 243.59221237897873
2021-02-27 20:02:52.219143: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 20:02:52.773298: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 20:02:52.773795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 20:02:52.774364: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:02:52.774526: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:02:52.774669: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:02:52.774798: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:02:52.774940: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:02:52.775083: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:02:52.775209: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:02:52.775234: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 20:02:52.812272: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 20:02:52.812676: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f604c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 20:02:52.812713: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 20:02:52.816157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 20:02:52.816196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 20:02:53.679753: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 20:02:53.679912: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 20:02:53.680205: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:02:53.680235: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:02:53.680254: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:02:53.680288: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:02:53.680328: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 20:02:53.680351: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:02:53.680388: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f607f75e550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 20:21:22.451026: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:21:22.504446: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 20:21:22.636138: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov4422048/plugins/profile/2021_02_27_20_21_22
2021-02-27 20:21:22.775755: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov4422048/plugins/profile/2021_02_27_20_21_22/householder.trace.json.gz
2021-02-27 20:21:22.798948: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 20:21:22.808956: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 20:21:22.811130: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov4422048/plugins/profile/2021_02_27_20_21_22Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov4422048/plugins/profile/2021_02_27_20_21_22/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov4422048/plugins/profile/2021_02_27_20_21_22/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov4422048/plugins/profile/2021_02_27_20_21_22/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov4422048/plugins/profile/2021_02_27_20_21_22/householder.kernel_stats.pb

Epoch 1, Loss: 8.475893020629883, Train Accuracy: 53.3203125,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:224.02483344078064
Average single batch time this epoch: 7.71444900282498
Epoch 2, Loss: 0.28394630551338196, Train Accuracy: 91.38267517089844,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 221.64449954032898

Time for Epoch:221.64449954032898
Average single batch time this epoch: 7.640391949949594
Epoch 3, Loss: 0.15998302400112152, Train Accuracy: 95.07341003417969,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 221.33994662761688

Time for Epoch:221.03539371490479
Average single batch time this epoch: 7.619409816018466
Epoch 4, Loss: 0.10898137092590332, Train Accuracy: 96.64601135253906,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 221.09838318824768

Time for Epoch:220.61525630950928
Average single batch time this epoch: 7.604857041917998
Epoch 5, Loss: 0.0818106159567833, Train Accuracy: 97.45757293701172,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 221.1778284907341

Time for Epoch:221.41616439819336
Average single batch time this epoch: 7.632475713203693
Average time per Batch: 7.624283630272438
Average time per Epoch: 221.1778284907341
2021-02-27 20:21:27.060906: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 20:21:27.611301: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 20:21:27.611772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 20:21:27.612531: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:21:27.612692: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:21:27.612820: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:21:27.612949: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:21:27.613073: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:21:27.613194: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:21:27.613319: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:21:27.613358: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 20:21:27.648333: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 20:21:27.648720: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f61c8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 20:21:27.648769: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 20:21:27.652048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 20:21:27.652090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 20:21:28.517240: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 20:21:28.517353: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 20:21:28.517632: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:21:28.517661: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:21:28.517679: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:21:28.517747: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:21:28.517792: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 20:21:28.517817: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:21:28.517832: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f61fbbb94c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 20:39:58.821166: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:39:58.925665: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 20:39:59.052617: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov4442048/plugins/profile/2021_02_27_20_39_58
2021-02-27 20:39:59.190476: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov4442048/plugins/profile/2021_02_27_20_39_58/householder.trace.json.gz
2021-02-27 20:39:59.212140: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 20:39:59.222588: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 20:39:59.224731: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov4442048/plugins/profile/2021_02_27_20_39_58Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov4442048/plugins/profile/2021_02_27_20_39_58/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov4442048/plugins/profile/2021_02_27_20_39_58/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov4442048/plugins/profile/2021_02_27_20_39_58/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov4442048/plugins/profile/2021_02_27_20_39_58/householder.kernel_stats.pb

Epoch 1, Loss: 7.851120471954346, Train Accuracy: 54.514076232910156,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:223.18920803070068
Average single batch time this epoch: 7.685550056654831
Epoch 2, Loss: 0.2930469512939453, Train Accuracy: 91.11495971679688,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 221.2684042453766

Time for Epoch:221.2684042453766
Average single batch time this epoch: 7.627392448227981
Epoch 3, Loss: 0.16432175040245056, Train Accuracy: 94.95386505126953,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 221.59040415287018

Time for Epoch:221.91240406036377
Average single batch time this epoch: 7.64960869427385
Epoch 4, Loss: 0.11167781800031662, Train Accuracy: 96.55845642089844,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 221.67823831240335

Time for Epoch:221.85390663146973
Average single batch time this epoch: 7.647612629265621
Epoch 5, Loss: 0.08490448445081711, Train Accuracy: 97.37843322753906,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 221.76983481645584

Time for Epoch:222.04462432861328
Average single batch time this epoch: 7.654173300184053
Average time per Batch: 7.644696767987876
Average time per Epoch: 221.76983481645584
2021-02-27 20:40:03.883415: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 20:40:04.435432: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 20:40:04.435897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 20:40:04.436228: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:40:04.436411: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:40:04.436579: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:40:04.436749: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:40:04.436917: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:40:04.437081: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:40:04.437280: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:40:04.437311: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 20:40:04.476282: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 20:40:04.476648: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8884000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 20:40:04.476723: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 20:40:04.480004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 20:40:04.480046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 20:40:05.343404: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 20:40:05.343507: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 20:40:05.343769: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 20:40:05.343813: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:40:05.343831: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:40:05.343899: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:40:05.343967: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 20:40:05.343994: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 20:40:05.344010: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f88b798a4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 21:00:55.085820: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 21:00:55.188944: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 21:00:55.321527: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov5522048/plugins/profile/2021_02_27_21_00_55
2021-02-27 21:00:55.461451: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov5522048/plugins/profile/2021_02_27_21_00_55/householder.trace.json.gz
2021-02-27 21:00:55.484378: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 21:00:55.494081: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 21:00:55.496221: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov5522048/plugins/profile/2021_02_27_21_00_55Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov5522048/plugins/profile/2021_02_27_21_00_55/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov5522048/plugins/profile/2021_02_27_21_00_55/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov5522048/plugins/profile/2021_02_27_21_00_55/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov5522048/plugins/profile/2021_02_27_21_00_55/householder.kernel_stats.pb

Epoch 1, Loss: 8.978726387023926, Train Accuracy: 54.31539535522461,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:251.2225148677826
Average single batch time this epoch: 8.652275776040964
Epoch 2, Loss: 0.28446751832962036, Train Accuracy: 91.34563446044922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 248.87201142311096

Time for Epoch:248.87201142311096
Average single batch time this epoch: 8.579204074267683
Epoch 3, Loss: 0.1565624475479126, Train Accuracy: 95.26030731201172,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 249.29811549186707

Time for Epoch:249.72421956062317
Average single batch time this epoch: 8.608612915565228
Epoch 4, Loss: 0.10762227326631546, Train Accuracy: 96.74871826171875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 249.4704909324646

Time for Epoch:249.81524181365967
Average single batch time this epoch: 8.611775357147742
Epoch 5, Loss: 0.0757848471403122, Train Accuracy: 97.70002746582031,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 249.62114536762238

Time for Epoch:250.0731086730957
Average single batch time this epoch: 8.62065681917914
Average time per Batch: 8.605062291539948
Average time per Epoch: 249.62114536762238
2021-02-27 21:01:00.007390: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 21:01:00.559885: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 21:01:00.560385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 21:01:00.561125: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:01:00.561270: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:01:00.561413: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:01:00.561541: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:01:00.561665: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:01:00.561787: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:01:00.561938: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:01:00.561961: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 21:01:00.596235: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 21:01:00.596571: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f454c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 21:01:00.596607: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 21:01:00.599021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 21:01:00.599046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 21:01:01.462280: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 21:01:01.462408: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 21:01:01.462712: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:01:01.462762: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 21:01:01.462781: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 21:01:01.462849: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 21:01:01.462901: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 21:01:01.462926: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 21:01:01.462941: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f45813154c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 21:22:24.457526: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 21:22:24.550355: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 21:22:24.673438: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov5552048/plugins/profile/2021_02_27_21_22_24
2021-02-27 21:22:24.806512: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov5552048/plugins/profile/2021_02_27_21_22_24/householder.trace.json.gz
2021-02-27 21:22:24.827612: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 21:22:24.837020: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-27 21:22:24.839149: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov5552048/plugins/profile/2021_02_27_21_22_24Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov5552048/plugins/profile/2021_02_27_21_22_24/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov5552048/plugins/profile/2021_02_27_21_22_24/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov5552048/plugins/profile/2021_02_27_21_22_24/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov5552048/plugins/profile/2021_02_27_21_22_24/householder.kernel_stats.pb

Epoch 1, Loss: 8.445032119750977, Train Accuracy: 53.84226989746094,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:257.37613224983215
Average single batch time this epoch: 8.86443125790563
Epoch 2, Loss: 0.28879013657569885, Train Accuracy: 91.32038116455078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 255.33549094200134

Time for Epoch:255.33549094200134
Average single batch time this epoch: 8.802112168279187
Epoch 3, Loss: 0.1656671017408371, Train Accuracy: 94.98417663574219,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 255.5849404335022

Time for Epoch:255.83438992500305
Average single batch time this epoch: 8.819364860140045
Epoch 4, Loss: 0.11286730319261551, Train Accuracy: 96.56351470947266,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 256.03113047281903

Time for Epoch:256.92351055145264
Average single batch time this epoch: 8.85686863701919
Epoch 5, Loss: 0.08810689300298691, Train Accuracy: 97.24037170410156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 256.395982503891

Time for Epoch:257.49053859710693
Average single batch time this epoch: 8.876418113708496
Average time per Batch: 8.83869094478673
Average time per Epoch: 256.395982503891
2021-02-27 21:22:29.504047: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 21:22:30.039643: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 21:22:30.040359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 21:22:30.040719: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:22:30.040937: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:22:30.041154: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:22:30.041359: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:22:30.041596: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:22:30.041800: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:22:30.042005: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:22:30.042044: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 21:22:30.084162: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 21:22:30.084609: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd250000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 21:22:30.084660: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 21:22:30.089228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 21:22:30.089275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 21:22:33.267983: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 21:22:33.268177: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 21:22:33.269044: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 21:22:33.269077: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 21:22:33.269100: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 21:22:33.269144: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 21:22:33.269195: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 21:22:33.269236: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 21:22:33.269253: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd284af84c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 22:31:27.346350: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 22:31:27.439668: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 22:31:27.505821: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_bini3224096/plugins/profile/2021_02_27_22_31_27
2021-02-27 22:31:27.576140: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_bini3224096/plugins/profile/2021_02_27_22_31_27/householder.trace.json.gz
2021-02-27 22:31:27.585441: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 22:31:27.590299: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 22:31:27.592318: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_bini3224096/plugins/profile/2021_02_27_22_31_27Dumped tool data for overview_page.pb to PAPER_1_thread_bini3224096/plugins/profile/2021_02_27_22_31_27/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_bini3224096/plugins/profile/2021_02_27_22_31_27/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_bini3224096/plugins/profile/2021_02_27_22_31_27/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_bini3224096/plugins/profile/2021_02_27_22_31_27/householder.kernel_stats.pb

Epoch 1, Loss: 152.2679901123047, Train Accuracy: 27.60881805419922,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:835.4097416400909
Average single batch time this epoch: 59.64879192624773
Epoch 2, Loss: 0.9108641743659973, Train Accuracy: 72.65101623535156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 824.0614926815033

Time for Epoch:824.0614926815033
Average single batch time this epoch: 58.85629112379892
Epoch 3, Loss: 0.3347579538822174, Train Accuracy: 89.82456970214844,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 824.1931858062744

Time for Epoch:824.3248789310455
Average single batch time this epoch: 58.875026089804514
Epoch 4, Loss: 0.21416449546813965, Train Accuracy: 93.43959045410156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 824.3899507522583

Time for Epoch:824.7834806442261
Average single batch time this epoch: 58.907822608947754
Epoch 5, Loss: 0.14990366995334625, Train Accuracy: 95.41887664794922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 824.6584473252296

Time for Epoch:825.4639370441437
Average single batch time this epoch: 58.956461668014526
Average time per Batch: 58.89890037264143
Average time per Epoch: 824.6584473252296
2021-02-27 22:31:31.815318: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 22:31:32.375307: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 22:31:32.375753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 22:31:32.376363: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 22:31:32.376541: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 22:31:32.376684: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 22:31:32.376826: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 22:31:32.376956: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 22:31:32.377081: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 22:31:32.377208: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 22:31:32.377247: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 22:31:32.416203: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 22:31:32.416643: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb584000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 22:31:32.416712: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 22:31:32.422158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 22:31:32.422206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 22:31:35.553821: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 22:31:35.553960: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 22:31:35.554260: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 22:31:35.554289: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 22:31:35.554308: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 22:31:35.554342: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 22:31:35.554384: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 22:31:35.554408: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 22:31:35.554423: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fb5b836b550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-27 23:47:53.215248: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 23:47:53.310203: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-27 23:47:53.379524: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_dgemm4096/plugins/profile/2021_02_27_23_47_53
2021-02-27 23:47:53.451632: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_dgemm4096/plugins/profile/2021_02_27_23_47_53/householder.trace.json.gz
2021-02-27 23:47:53.461527: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-27 23:47:53.466453: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-27 23:47:53.468493: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_dgemm4096/plugins/profile/2021_02_27_23_47_53Dumped tool data for overview_page.pb to PAPER_1_thread_dgemm4096/plugins/profile/2021_02_27_23_47_53/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_dgemm4096/plugins/profile/2021_02_27_23_47_53/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_dgemm4096/plugins/profile/2021_02_27_23_47_53/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_dgemm4096/plugins/profile/2021_02_27_23_47_53/householder.kernel_stats.pb

Epoch 1, Loss: 165.1659393310547, Train Accuracy: 25.48653793334961,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:916.7674150466919
Average single batch time this epoch: 65.46107591901507
Epoch 2, Loss: 0.8463029265403748, Train Accuracy: 74.00599670410156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 914.1514525413513

Time for Epoch:914.1514525413513
Average single batch time this epoch: 65.29118939808437
Epoch 3, Loss: 0.33098104596138, Train Accuracy: 90.06696319580078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 914.3821405172348

Time for Epoch:914.6128284931183
Average single batch time this epoch: 65.32416704722813
Epoch 4, Loss: 0.20475950837135315, Train Accuracy: 93.94182586669922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 914.8780143260956

Time for Epoch:915.8697619438171
Average single batch time this epoch: 65.41398841994149
Epoch 5, Loss: 0.1382189244031906, Train Accuracy: 95.84786224365234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 915.2148167490959

Time for Epoch:916.2252240180969
Average single batch time this epoch: 65.43940051964351
Average time per Batch: 65.36718634622437
Average time per Epoch: 915.2148167490959
2021-02-27 23:47:57.706629: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 23:47:58.272207: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 23:47:58.272814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 23:47:58.273514: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:47:58.273666: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:47:58.273796: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:47:58.273920: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:47:58.274046: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:47:58.274168: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:47:58.274292: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:47:58.274317: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 23:47:58.308185: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 23:47:58.308628: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f11cc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 23:47:58.308712: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 23:47:58.313025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 23:47:58.313070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 23:48:01.461510: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 23:48:01.461763: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 23:48:01.462179: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:48:01.462230: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 23:48:01.462260: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 23:48:01.462364: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 23:48:01.462469: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 23:48:01.462510: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 23:48:01.462536: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 187, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-02-27 23:48:02.202559: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 23:48:06.162386: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-27 23:48:06.711487: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-27 23:48:06.711981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-27 23:48:06.712291: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:48:06.712497: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:48:06.712694: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:48:06.712887: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:48:06.713100: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:48:06.713273: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:48:06.713450: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:48:06.713500: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-27 23:48:06.752237: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-27 23:48:06.752767: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f18ec000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-27 23:48:06.752876: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-27 23:48:06.757325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-27 23:48:06.757364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-27 23:48:09.889233: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 23:48:09.889356: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-27 23:48:09.889640: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-27 23:48:09.889670: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 23:48:09.889688: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 23:48:09.889722: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 23:48:09.889785: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-27 23:48:09.889811: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-27 23:48:09.889826: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f192098d550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 00:55:24.329291: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 00:55:24.420707: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 00:55:24.486052: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_schonhage3334096/plugins/profile/2021_02_28_00_55_24
2021-02-28 00:55:24.555446: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_schonhage3334096/plugins/profile/2021_02_28_00_55_24/householder.trace.json.gz
2021-02-28 00:55:24.564662: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 00:55:24.569547: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 00:55:24.571541: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_schonhage3334096/plugins/profile/2021_02_28_00_55_24Dumped tool data for overview_page.pb to PAPER_1_thread_schonhage3334096/plugins/profile/2021_02_28_00_55_24/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_schonhage3334096/plugins/profile/2021_02_28_00_55_24/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_schonhage3334096/plugins/profile/2021_02_28_00_55_24/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_schonhage3334096/plugins/profile/2021_02_28_00_55_24/householder.kernel_stats.pb

Epoch 1, Loss: 145.2084197998047, Train Accuracy: 29.71365737915039,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:819.3433976173401
Average single batch time this epoch: 58.50227527959006
Epoch 2, Loss: 0.7189317345619202, Train Accuracy: 78.70047760009766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 803.3166358470917

Time for Epoch:803.3166358470917
Average single batch time this epoch: 57.37418760572161
Epoch 3, Loss: 0.29824700951576233, Train Accuracy: 90.96331024169922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 803.2878065109253

Time for Epoch:803.2589771747589
Average single batch time this epoch: 57.370227796690806
Epoch 4, Loss: 0.18658986687660217, Train Accuracy: 94.31675720214844,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 803.3964665730795

Time for Epoch:803.6137866973877
Average single batch time this epoch: 57.3956253187997
Epoch 5, Loss: 0.1295263022184372, Train Accuracy: 96.04666900634766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 803.7649282217026

Time for Epoch:804.870313167572
Average single batch time this epoch: 57.48539657252176
Average time per Batch: 57.40635932343347
Average time per Epoch: 803.7649282217026
2021-02-28 00:55:28.775342: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 00:55:29.339288: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 00:55:29.339730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 00:55:29.343733: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 00:55:29.343939: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 00:55:29.344087: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 00:55:29.344220: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 00:55:29.344366: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 00:55:29.344494: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 00:55:29.344643: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 00:55:29.344681: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 00:55:29.384261: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 00:55:29.384721: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0e00000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 00:55:29.384792: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 00:55:29.390221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 00:55:29.390268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 00:55:32.545182: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 00:55:32.545329: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 00:55:32.546111: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 00:55:32.546140: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 00:55:32.546162: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 00:55:32.546195: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 00:55:32.546235: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 00:55:32.546259: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 00:55:32.546274: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f0e359ac550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 02:04:58.166769: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 02:04:58.266296: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 02:04:58.331678: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2244096/plugins/profile/2021_02_28_02_04_58
2021-02-28 02:04:58.401630: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2244096/plugins/profile/2021_02_28_02_04_58/householder.trace.json.gz
2021-02-28 02:04:58.410729: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 02:04:58.415559: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 02:04:58.417585: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2244096/plugins/profile/2021_02_28_02_04_58Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2244096/plugins/profile/2021_02_28_02_04_58/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2244096/plugins/profile/2021_02_28_02_04_58/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2244096/plugins/profile/2021_02_28_02_04_58/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2244096/plugins/profile/2021_02_28_02_04_58/householder.kernel_stats.pb

Epoch 1, Loss: 166.77293395996094, Train Accuracy: 25.993999481201172,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:837.2480826377869
Average single batch time this epoch: 59.78132290499551
Epoch 2, Loss: 0.8847616314888, Train Accuracy: 73.36077117919922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 830.789922952652

Time for Epoch:830.789922952652
Average single batch time this epoch: 59.3368547643934
Epoch 3, Loss: 0.3369230628013611, Train Accuracy: 89.88734436035156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 831.3448390960693

Time for Epoch:831.8997552394867
Average single batch time this epoch: 59.41602269240788
Epoch 4, Loss: 0.21219733357429504, Train Accuracy: 93.59130859375,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 831.8813350200653

Time for Epoch:832.9543268680573
Average single batch time this epoch: 59.49140623637608
Epoch 5, Loss: 0.14470116794109344, Train Accuracy: 95.6298828125,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 832.0846541523933

Time for Epoch:832.6946115493774
Average single batch time this epoch: 59.47285303047725
Average time per Batch: 59.429284180913655
Average time per Epoch: 832.0846541523933
2021-02-28 02:05:02.661095: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 02:05:03.221343: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 02:05:03.221955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 02:05:03.222599: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 02:05:03.222762: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 02:05:03.222898: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 02:05:03.223035: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 02:05:03.223170: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 02:05:03.223300: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 02:05:03.223431: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 02:05:03.223457: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 02:05:03.260232: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 02:05:03.260678: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1b64000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 02:05:03.260728: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 02:05:03.265330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 02:05:03.265376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 02:05:06.388306: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 02:05:06.388459: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 02:05:06.388770: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 02:05:06.388802: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 02:05:06.388821: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 02:05:06.388856: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 02:05:06.388898: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 02:05:06.388921: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 02:05:06.388936: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f1b969cd550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 03:12:32.657859: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 03:12:32.749938: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 03:12:32.819856: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2254096/plugins/profile/2021_02_28_03_12_32
2021-02-28 03:12:32.891562: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2254096/plugins/profile/2021_02_28_03_12_32/householder.trace.json.gz
2021-02-28 03:12:32.901622: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 03:12:32.906597: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 03:12:32.908607: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2254096/plugins/profile/2021_02_28_03_12_32Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2254096/plugins/profile/2021_02_28_03_12_32/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2254096/plugins/profile/2021_02_28_03_12_32/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2254096/plugins/profile/2021_02_28_03_12_32/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2254096/plugins/profile/2021_02_28_03_12_32/householder.kernel_stats.pb

Epoch 1, Loss: 149.80209350585938, Train Accuracy: 25.739398956298828,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:810.0730431079865
Average single batch time this epoch: 57.83888304233551
Epoch 2, Loss: 1.063140630722046, Train Accuracy: 68.95577239990234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 807.5245473384857

Time for Epoch:807.5245473384857
Average single batch time this epoch: 57.67499354907444
Epoch 3, Loss: 0.42824921011924744, Train Accuracy: 86.95243072509766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 808.1242792606354

Time for Epoch:808.724011182785
Average single batch time this epoch: 57.7607147863933
Epoch 4, Loss: 0.30051061511039734, Train Accuracy: 90.59012603759766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 808.5853178501129

Time for Epoch:809.507395029068
Average single batch time this epoch: 57.81657069069998
Epoch 5, Loss: 0.23260554671287537, Train Accuracy: 92.78739166259766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 809.0404616594315

Time for Epoch:810.4058930873871
Average single batch time this epoch: 57.880809732845854
Average time per Batch: 57.7832721897534
Average time per Epoch: 809.0404616594315
2021-02-28 03:12:37.121878: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 03:12:37.676279: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 03:12:37.676736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 03:12:37.677316: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 03:12:37.677506: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 03:12:37.677647: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 03:12:37.677774: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 03:12:37.677913: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 03:12:37.678035: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 03:12:37.678159: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 03:12:37.678195: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 03:12:37.716275: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 03:12:37.716676: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f86f0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 03:12:37.716717: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 03:12:37.720572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 03:12:37.720611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 03:12:40.855103: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 03:12:40.855250: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 03:12:40.855552: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 03:12:40.855582: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 03:12:40.855600: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 03:12:40.855633: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 03:12:40.855673: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 03:12:40.855696: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 03:12:40.855711: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8722474550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 04:25:05.970302: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 04:25:06.048799: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 04:25:06.113749: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2724096/plugins/profile/2021_02_28_04_25_06
2021-02-28 04:25:06.183919: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2724096/plugins/profile/2021_02_28_04_25_06/householder.trace.json.gz
2021-02-28 04:25:06.192937: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 04:25:06.197735: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 04:25:06.199716: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2724096/plugins/profile/2021_02_28_04_25_06Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2724096/plugins/profile/2021_02_28_04_25_06/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2724096/plugins/profile/2021_02_28_04_25_06/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2724096/plugins/profile/2021_02_28_04_25_06/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2724096/plugins/profile/2021_02_28_04_25_06/householder.kernel_stats.pb

Epoch 1, Loss: 23662718976.0, Train Accuracy: 10.585240364074707,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:891.7872149944305
Average single batch time this epoch: 63.67645674092429
Epoch 2, Loss: 26396952576.0, Train Accuracy: 10.942731857299805,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 861.8772368431091

Time for Epoch:861.8772368431091
Average single batch time this epoch: 61.55730964456286
Epoch 3, Loss: 28932638720.0, Train Accuracy: 11.765833854675293,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 862.3195436000824

Time for Epoch:862.7618503570557
Average single batch time this epoch: 61.620369281087605
Epoch 4, Loss: 30849546240.0, Train Accuracy: 11.947196006774902,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 862.8843771616617

Time for Epoch:864.0140442848206
Average single batch time this epoch: 61.709922194480896
Epoch 5, Loss: 32259180544.0, Train Accuracy: 11.882673263549805,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 863.3234786987305

Time for Epoch:864.6407833099365
Average single batch time this epoch: 61.754667333194185
Average time per Batch: 61.66056711333139
Average time per Epoch: 863.3234786987305
2021-02-28 04:25:10.476300: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 04:25:11.035256: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 04:25:11.035771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 04:25:11.036494: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 04:25:11.036636: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 04:25:11.036763: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 04:25:11.036907: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 04:25:11.037034: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 04:25:11.037157: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 04:25:11.037280: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 04:25:11.037329: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 04:25:11.072170: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 04:25:11.072643: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3ee0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 04:25:11.072704: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 04:25:11.076384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 04:25:11.076426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 04:25:14.260600: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 04:25:14.260723: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 04:25:14.261497: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 04:25:14.261527: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 04:25:14.261545: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 04:25:14.261631: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 04:25:14.261681: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 04:25:14.261705: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 04:25:14.261721: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3f12c2f4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 05:31:48.739501: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 05:31:48.837400: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 05:31:48.902084: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3234096/plugins/profile/2021_02_28_05_31_48
2021-02-28 05:31:48.972427: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3234096/plugins/profile/2021_02_28_05_31_48/householder.trace.json.gz
2021-02-28 05:31:48.981544: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 05:31:48.986371: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 05:31:48.988378: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3234096/plugins/profile/2021_02_28_05_31_48Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3234096/plugins/profile/2021_02_28_05_31_48/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3234096/plugins/profile/2021_02_28_05_31_48/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3234096/plugins/profile/2021_02_28_05_31_48/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3234096/plugins/profile/2021_02_28_05_31_48/householder.kernel_stats.pb

Epoch 1, Loss: 148.5550079345703, Train Accuracy: 28.130229949951172,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:807.2749650478363
Average single batch time this epoch: 57.640266231128145
Epoch 2, Loss: 0.9329743385314941, Train Accuracy: 71.70584869384766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 795.6480836868286

Time for Epoch:795.6480836868286
Average single batch time this epoch: 56.82665823187147
Epoch 3, Loss: 0.3807138502597809, Train Accuracy: 88.20975494384766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 796.1304928064346

Time for Epoch:796.6129019260406
Average single batch time this epoch: 56.89558814253126
Epoch 4, Loss: 0.24939079582691193, Train Accuracy: 92.3095703125,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 796.372516711553

Time for Epoch:796.8565645217896
Average single batch time this epoch: 56.91299911907741
Epoch 5, Loss: 0.18306876718997955, Train Accuracy: 94.33419036865234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 796.7922728061676

Time for Epoch:798.0515410900116
Average single batch time this epoch: 56.99830935682569
Average time per Batch: 56.90838871257646
Average time per Epoch: 796.7922728061676
2021-02-28 05:31:53.275723: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 05:31:53.820557: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 05:31:53.821206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 05:31:53.821588: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 05:31:53.821769: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 05:31:53.821895: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 05:31:53.822023: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 05:31:53.822147: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 05:31:53.822286: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 05:31:53.822410: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 05:31:53.822433: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 05:31:53.856247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 05:31:53.856674: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f649c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 05:31:53.856745: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 05:31:53.860700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 05:31:53.860742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 05:31:57.041384: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 05:31:57.041639: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 05:31:57.042063: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 05:31:57.042114: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 05:31:57.042144: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 05:31:57.042249: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 05:31:57.042364: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 05:31:57.042407: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 05:31:57.042432: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f64ced164c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 06:37:50.039394: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 06:37:50.160329: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 06:37:50.225872: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3334096/plugins/profile/2021_02_28_06_37_50
2021-02-28 06:37:50.296774: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3334096/plugins/profile/2021_02_28_06_37_50/householder.trace.json.gz
2021-02-28 06:37:50.306128: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 06:37:50.310947: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 06:37:50.312969: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3334096/plugins/profile/2021_02_28_06_37_50Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3334096/plugins/profile/2021_02_28_06_37_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3334096/plugins/profile/2021_02_28_06_37_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3334096/plugins/profile/2021_02_28_06_37_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3334096/plugins/profile/2021_02_28_06_37_50/householder.kernel_stats.pb

Epoch 1, Loss: 1182108352512.0, Train Accuracy: 9.629603385925293,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:795.6193060874939
Average single batch time this epoch: 56.806422335760935
Epoch 2, Loss: 2711001759744.0, Train Accuracy: 9.8876953125,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 786.3955178260803

Time for Epoch:786.3955178260803
Average single batch time this epoch: 56.16578389917101
Epoch 3, Loss: 4499454820352.0, Train Accuracy: 9.978376388549805,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 788.1104127168655

Time for Epoch:789.8253076076508
Average single batch time this epoch: 56.41081164564405
Epoch 4, Loss: 5928697987072.0, Train Accuracy: 9.967912673950195,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 789.0230725606283

Time for Epoch:790.8483922481537
Average single batch time this epoch: 56.483827931540354
Epoch 5, Loss: 6903007019008.0, Train Accuracy: 10.011509895324707,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 789.3355109095573

Time for Epoch:790.2728259563446
Average single batch time this epoch: 56.442699568612234
Average time per Batch: 56.37578076124191
Average time per Epoch: 789.3355109095573
2021-02-28 06:37:54.523025: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 06:37:55.076992: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 06:37:55.077495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 06:37:55.078306: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 06:37:55.078468: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 06:37:55.078601: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 06:37:55.078732: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 06:37:55.078862: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 06:37:55.078988: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 06:37:55.079115: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 06:37:55.079141: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 06:37:55.112342: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 06:37:55.112767: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fae04000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 06:37:55.112829: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 06:37:55.116478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 06:37:55.116520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 06:37:58.283608: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 06:37:58.283760: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 06:37:58.284053: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 06:37:58.284083: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 06:37:58.284102: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 06:37:58.284137: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 06:37:58.284203: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 06:37:58.284230: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 06:37:58.284247: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fae38d7f4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 07:43:42.288196: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 07:43:42.400291: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 07:43:42.471028: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3344096/plugins/profile/2021_02_28_07_43_42
2021-02-28 07:43:42.548653: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3344096/plugins/profile/2021_02_28_07_43_42/householder.trace.json.gz
2021-02-28 07:43:42.558857: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 07:43:42.563878: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 07:43:42.565893: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3344096/plugins/profile/2021_02_28_07_43_42Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3344096/plugins/profile/2021_02_28_07_43_42/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3344096/plugins/profile/2021_02_28_07_43_42/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3344096/plugins/profile/2021_02_28_07_43_42/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3344096/plugins/profile/2021_02_28_07_43_42/householder.kernel_stats.pb

Epoch 1, Loss: 143.6181182861328, Train Accuracy: 26.77873992919922,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:790.9691095352173
Average single batch time this epoch: 56.47543266841343
Epoch 2, Loss: 0.8010492324829102, Train Accuracy: 75.20228576660156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 787.0089628696442

Time for Epoch:787.0089628696442
Average single batch time this epoch: 56.20958435535431
Epoch 3, Loss: 0.3554869592189789, Train Accuracy: 89.30140686035156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 787.2096202373505

Time for Epoch:787.4102776050568
Average single batch time this epoch: 56.238256795065745
Epoch 4, Loss: 0.2355932891368866, Train Accuracy: 92.75774383544922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 787.7641078631083

Time for Epoch:788.873083114624
Average single batch time this epoch: 56.34272493634905
Epoch 5, Loss: 0.1753796488046646, Train Accuracy: 94.56612396240234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 788.2501327991486

Time for Epoch:789.7082076072693
Average single batch time this epoch: 56.40239611693791
Average time per Batch: 56.29824055092675
Average time per Epoch: 788.2501327991486
2021-02-28 07:43:46.825498: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 07:43:47.371954: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 07:43:47.372527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 07:43:47.373182: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 07:43:47.373351: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 07:43:47.373482: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 07:43:47.373614: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 07:43:47.373744: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 07:43:47.373870: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 07:43:47.373999: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 07:43:47.374024: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 07:43:47.412212: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 07:43:47.412613: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f30f0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 07:43:47.412662: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 07:43:47.416142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 07:43:47.416184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 07:43:50.560892: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 07:43:50.561049: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 07:43:50.561359: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 07:43:50.561392: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 07:43:50.561411: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 07:43:50.561445: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 07:43:50.561488: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 07:43:50.561512: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 07:43:50.561527: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3125fd2550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 08:47:28.582288: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 08:47:28.674526: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 08:47:28.744565: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov4424096/plugins/profile/2021_02_28_08_47_28
2021-02-28 08:47:28.816981: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov4424096/plugins/profile/2021_02_28_08_47_28/householder.trace.json.gz
2021-02-28 08:47:28.827105: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 08:47:28.832105: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 08:47:28.834110: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov4424096/plugins/profile/2021_02_28_08_47_28Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov4424096/plugins/profile/2021_02_28_08_47_28/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov4424096/plugins/profile/2021_02_28_08_47_28/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov4424096/plugins/profile/2021_02_28_08_47_28/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov4424096/plugins/profile/2021_02_28_08_47_28/householder.kernel_stats.pb

Epoch 1, Loss: 146.18211364746094, Train Accuracy: 25.13427734375,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:767.7369680404663
Average single batch time this epoch: 54.81439370768411
Epoch 2, Loss: 0.882647693157196, Train Accuracy: 72.61265563964844,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 761.5302405357361

Time for Epoch:761.5302405357361
Average single batch time this epoch: 54.38959418024336
Epoch 3, Loss: 0.36960309743881226, Train Accuracy: 88.73988342285156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 761.7928414344788

Time for Epoch:762.0554423332214
Average single batch time this epoch: 54.42708706855774
Epoch 4, Loss: 0.2500554025173187, Train Accuracy: 92.30782318115234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 762.066282749176

Time for Epoch:762.6131653785706
Average single batch time this epoch: 54.46698262010302
Epoch 5, Loss: 0.18638519942760468, Train Accuracy: 94.24874114990234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 762.5622149705887

Time for Epoch:764.0500116348267
Average single batch time this epoch: 54.5696256501334
Average time per Batch: 54.463322379759376
Average time per Epoch: 762.5622149705887
2021-02-28 08:47:33.071602: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 08:47:33.609791: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 08:47:33.610333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 08:47:33.610927: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 08:47:33.611107: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 08:47:33.611247: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 08:47:33.611391: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 08:47:33.611530: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 08:47:33.611651: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 08:47:33.611788: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 08:47:33.611828: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 08:47:33.652263: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 08:47:33.652650: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa458000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 08:47:33.652687: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 08:47:33.656155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 08:47:33.656193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 08:47:36.822383: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 08:47:36.822523: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 08:47:36.822819: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 08:47:36.822848: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 08:47:36.822885: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 08:47:36.822919: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 08:47:36.822976: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 08:47:36.823003: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 08:47:36.823018: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa48d3f94c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 09:50:02.559510: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 09:50:02.648284: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 09:50:02.718069: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov4444096/plugins/profile/2021_02_28_09_50_02
2021-02-28 09:50:02.791560: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov4444096/plugins/profile/2021_02_28_09_50_02/householder.trace.json.gz
2021-02-28 09:50:02.801453: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 09:50:02.809102: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-28 09:50:02.812336: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov4444096/plugins/profile/2021_02_28_09_50_02Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov4444096/plugins/profile/2021_02_28_09_50_02/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov4444096/plugins/profile/2021_02_28_09_50_02/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov4444096/plugins/profile/2021_02_28_09_50_02/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov4444096/plugins/profile/2021_02_28_09_50_02/householder.kernel_stats.pb

Epoch 1, Loss: 144.14739990234375, Train Accuracy: 27.9541015625,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:751.3414735794067
Average single batch time this epoch: 53.64493216787066
Epoch 2, Loss: 0.9009739756584167, Train Accuracy: 71.94649505615234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 747.2698309421539

Time for Epoch:747.2698309421539
Average single batch time this epoch: 53.3709865467889
Epoch 3, Loss: 0.3776629865169525, Train Accuracy: 88.57247161865234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 747.5624079704285

Time for Epoch:747.854984998703
Average single batch time this epoch: 53.412850686482024
Epoch 4, Loss: 0.25723525881767273, Train Accuracy: 92.02008819580078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 748.1297099590302

Time for Epoch:749.2643139362335
Average single batch time this epoch: 53.51347589492798
Epoch 5, Loss: 0.19464996457099915, Train Accuracy: 93.98542022705078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 748.5902512669563

Time for Epoch:749.9718751907349
Average single batch time this epoch: 53.56402451651437
Average time per Batch: 53.46533441117832
Average time per Epoch: 748.5902512669563
2021-02-28 09:50:07.226825: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 09:50:07.787341: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 09:50:07.787809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 09:50:07.788143: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 09:50:07.788343: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 09:50:07.788530: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 09:50:07.788701: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 09:50:07.788884: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 09:50:07.789075: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 09:50:07.789243: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 09:50:07.789273: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 09:50:07.828321: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 09:50:07.828715: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7efbf0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 09:50:07.828752: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 09:50:07.832246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 09:50:07.832284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 09:50:10.997305: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 09:50:10.997449: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 09:50:10.997741: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 09:50:10.997770: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 09:50:10.997789: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 09:50:10.997822: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 09:50:10.997863: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 09:50:10.997887: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 09:50:10.997902: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7efc22a72550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 10:57:08.971446: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 10:57:09.064321: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 10:57:09.129566: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov5524096/plugins/profile/2021_02_28_10_57_09
2021-02-28 10:57:09.199986: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov5524096/plugins/profile/2021_02_28_10_57_09/householder.trace.json.gz
2021-02-28 10:57:09.209046: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 10:57:09.213825: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 10:57:09.215757: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov5524096/plugins/profile/2021_02_28_10_57_09Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov5524096/plugins/profile/2021_02_28_10_57_09/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov5524096/plugins/profile/2021_02_28_10_57_09/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov5524096/plugins/profile/2021_02_28_10_57_09/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov5524096/plugins/profile/2021_02_28_10_57_09/householder.kernel_stats.pb

Epoch 1, Loss: 144.48118591308594, Train Accuracy: 26.752582550048828,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:794.8445229530334
Average single batch time this epoch: 56.75240639277867
Epoch 2, Loss: 0.8177093267440796, Train Accuracy: 75.46212005615234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 796.0369851589203

Time for Epoch:796.0369851589203
Average single batch time this epoch: 56.854378887585234
Epoch 3, Loss: 0.3527188003063202, Train Accuracy: 89.29443359375,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 799.1437264680862

Time for Epoch:802.2504677772522
Average single batch time this epoch: 57.29823391778128
Epoch 4, Loss: 0.23126789927482605, Train Accuracy: 92.93038177490234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 802.8953141371409

Time for Epoch:810.3984894752502
Average single batch time this epoch: 57.880312408719746
Epoch 5, Loss: 0.1731325089931488, Train Accuracy: 94.61146545410156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 805.7737300992012

Time for Epoch:814.4089779853821
Average single batch time this epoch: 58.16670390537807
Average time per Batch: 57.54990727986609
Average time per Epoch: 805.7737300992012
2021-02-28 10:57:13.503941: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 10:57:14.040321: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 10:57:14.040941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 10:57:14.041540: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 10:57:14.041697: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 10:57:14.041823: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 10:57:14.041951: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 10:57:14.042075: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 10:57:14.042198: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 10:57:14.042321: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 10:57:14.042363: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 10:57:14.076202: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 10:57:14.076628: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9364000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 10:57:14.076681: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 10:57:14.080218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 10:57:14.080260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 10:57:17.245361: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 10:57:17.245575: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 10:57:17.245935: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 10:57:17.245982: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 10:57:17.246017: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 10:57:17.246107: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 10:57:17.246218: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 10:57:17.246254: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 10:57:17.246276: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9397f46550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 12:04:40.000206: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 12:04:40.107025: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 12:04:40.172289: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov5554096/plugins/profile/2021_02_28_12_04_40
2021-02-28 12:04:40.242244: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov5554096/plugins/profile/2021_02_28_12_04_40/householder.trace.json.gz
2021-02-28 12:04:40.251573: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 12:04:40.256477: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 12:04:40.258475: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov5554096/plugins/profile/2021_02_28_12_04_40Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov5554096/plugins/profile/2021_02_28_12_04_40/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov5554096/plugins/profile/2021_02_28_12_04_40/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov5554096/plugins/profile/2021_02_28_12_04_40/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov5554096/plugins/profile/2021_02_28_12_04_40/householder.kernel_stats.pb

Epoch 1, Loss: 148.22862243652344, Train Accuracy: 23.517717361450195,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:810.3837599754333
Average single batch time this epoch: 57.86115322794233
Epoch 2, Loss: 0.9887381196022034, Train Accuracy: 70.58280181884766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 807.0005121231079

Time for Epoch:807.0005121231079
Average single batch time this epoch: 57.63757472378867
Epoch 3, Loss: 0.39330941438674927, Train Accuracy: 88.02315521240234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 807.1421411037445

Time for Epoch:807.2837700843811
Average single batch time this epoch: 57.657842704227996
Epoch 4, Loss: 0.2711753249168396, Train Accuracy: 91.73409271240234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 807.532496213913

Time for Epoch:808.3132064342499
Average single batch time this epoch: 57.731346113341196
Epoch 5, Loss: 0.2058538943529129, Train Accuracy: 93.76395416259766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 808.0835010409355

Time for Epoch:809.7365155220032
Average single batch time this epoch: 57.832989590508596
Average time per Batch: 57.714938282966614
Average time per Epoch: 808.0835010409355
2021-02-28 12:04:44.514218: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 12:04:45.040615: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 12:04:45.041072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 12:04:45.041715: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 12:04:45.041908: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 12:04:45.042051: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 12:04:45.042191: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 12:04:45.042332: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 12:04:45.042457: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 12:04:45.042584: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 12:04:45.042620: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 12:04:45.080287: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 12:04:45.080757: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6d40000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 12:04:45.080826: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 12:04:45.085857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 12:04:45.085900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 12:04:57.183574: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 12:04:57.183727: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 12:04:57.184569: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 12:04:57.184600: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 12:04:57.184618: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 12:04:57.184652: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 12:04:57.184700: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 12:04:57.184726: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 12:04:57.184742: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f6d74c774c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 16:23:40.020228: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 16:23:40.027161: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 16:23:40.065805: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_bini3228192/plugins/profile/2021_02_28_16_23_40
2021-02-28 16:23:40.132485: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_bini3228192/plugins/profile/2021_02_28_16_23_40/householder.trace.json.gz
2021-02-28 16:23:40.137311: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 16:23:40.140052: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 16:23:40.141920: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_bini3228192/plugins/profile/2021_02_28_16_23_40Dumped tool data for overview_page.pb to PAPER_1_thread_bini3228192/plugins/profile/2021_02_28_16_23_40/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_bini3228192/plugins/profile/2021_02_28_16_23_40/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_bini3228192/plugins/profile/2021_02_28_16_23_40/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_bini3228192/plugins/profile/2021_02_28_16_23_40/householder.kernel_stats.pb

Epoch 1, Loss: 4000.73974609375, Train Accuracy: 16.863142013549805,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:3107.4124183654785
Average single batch time this epoch: 443.8710471221379
Epoch 2, Loss: 131.84791564941406, Train Accuracy: 30.73904800415039,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3102.8515582084656

Time for Epoch:3102.8515582084656
Average single batch time this epoch: 443.2535553659712
Epoch 3, Loss: 5.230561256408691, Train Accuracy: 46.36579132080078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3104.068625330925

Time for Epoch:3105.2856924533844
Average single batch time this epoch: 443.60135422434126
Epoch 4, Loss: 1.0802985429763794, Train Accuracy: 69.81201171875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3103.936171849569

Time for Epoch:3103.671264886856
Average single batch time this epoch: 443.37063186509266
Epoch 5, Loss: 0.5515257716178894, Train Accuracy: 82.47418975830078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3103.8472631573677

Time for Epoch:3103.5805370807648
Average single batch time this epoch: 443.35763801847185
Average time per Batch: 443.39579486846924
Average time per Epoch: 3103.8472631573677
2021-02-28 16:23:44.566349: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 16:23:45.099877: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 16:23:45.100449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 16:23:45.101989: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 16:23:45.102122: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 16:23:45.102248: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 16:23:45.102395: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 16:23:45.102533: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 16:23:45.102662: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 16:23:45.102787: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 16:23:45.102811: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 16:23:45.140280: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 16:23:45.140745: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3028000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 16:23:45.140813: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 16:23:45.145832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 16:23:45.145879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 16:23:57.362626: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 16:23:57.362830: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 16:23:57.363662: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 16:23:57.363697: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 16:23:57.363737: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 16:23:57.363797: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 16:23:57.363855: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 16:23:57.363880: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 16:23:57.363895: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f305bf4d4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-28 21:09:52.697046: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 21:09:52.704456: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-28 21:09:52.785703: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_dgemm8192/plugins/profile/2021_02_28_21_09_52
2021-02-28 21:09:52.831860: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_dgemm8192/plugins/profile/2021_02_28_21_09_52/householder.trace.json.gz
2021-02-28 21:09:52.837114: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-28 21:09:52.839965: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-28 21:09:52.841858: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_dgemm8192/plugins/profile/2021_02_28_21_09_52Dumped tool data for overview_page.pb to PAPER_1_thread_dgemm8192/plugins/profile/2021_02_28_21_09_52/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_dgemm8192/plugins/profile/2021_02_28_21_09_52/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_dgemm8192/plugins/profile/2021_02_28_21_09_52/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_dgemm8192/plugins/profile/2021_02_28_21_09_52/householder.kernel_stats.pb

Epoch 1, Loss: 4174.49755859375, Train Accuracy: 15.253557205200195,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:3434.881629705429
Average single batch time this epoch: 490.6505460739136
Epoch 2, Loss: 138.0056915283203, Train Accuracy: 30.46875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3430.770045042038

Time for Epoch:3430.770045042038
Average single batch time this epoch: 490.0993291991098
Epoch 3, Loss: 5.650033473968506, Train Accuracy: 45.7275390625,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3431.129427909851

Time for Epoch:3431.488810777664
Average single batch time this epoch: 490.2021057946341
Epoch 4, Loss: 1.3960411548614502, Train Accuracy: 68.02803802490234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3431.0759614308677

Time for Epoch:3430.9690284729004
Average single batch time this epoch: 490.1277382033212
Epoch 5, Loss: 0.6027077436447144, Train Accuracy: 80.60302734375,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3430.099719941616

Time for Epoch:3427.1709954738617
Average single batch time this epoch: 489.58516911097934
Average time per Batch: 490.0035855770111
Average time per Epoch: 3430.099719941616
2021-02-28 21:09:57.150525: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 21:09:57.683302: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 21:09:57.683753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 21:09:57.684722: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:09:57.684878: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:09:57.685024: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:09:57.685162: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:09:57.685304: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:09:57.685456: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:09:57.685582: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:09:57.685617: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 21:09:57.724359: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 21:09:57.724766: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3e5c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 21:09:57.724805: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 21:09:57.728537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 21:09:57.728574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 21:10:09.848326: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 21:10:09.848479: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 21:10:09.849280: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:10:09.849310: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 21:10:09.849332: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 21:10:09.849366: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 21:10:09.849407: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 21:10:09.849431: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 21:10:09.849467: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 187, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-02-28 21:10:10.628856: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 21:10:14.665281: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-28 21:10:15.227618: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-28 21:10:15.228360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-28 21:10:15.228773: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:10:15.228932: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:10:15.229063: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:10:15.229192: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:10:15.229328: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:10:15.229456: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:10:15.229584: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:10:15.229608: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-28 21:10:15.260241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-28 21:10:15.260643: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5d68000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-28 21:10:15.260717: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-28 21:10:15.264265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-28 21:10:15.264307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-28 21:10:27.484345: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 21:10:27.484546: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-28 21:10:27.485392: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-28 21:10:27.485425: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 21:10:27.485450: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 21:10:27.485497: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 21:10:27.485544: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-28 21:10:27.485568: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-28 21:10:27.485584: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5d9a1854c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-01 01:19:46.428874: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 01:19:46.436186: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-01 01:19:46.500643: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_schonhage3338192/plugins/profile/2021_03_01_01_19_46
2021-03-01 01:19:46.544324: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_schonhage3338192/plugins/profile/2021_03_01_01_19_46/householder.trace.json.gz
2021-03-01 01:19:46.549077: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-01 01:19:46.551838: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-01 01:19:46.553679: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_schonhage3338192/plugins/profile/2021_03_01_01_19_46Dumped tool data for overview_page.pb to PAPER_1_thread_schonhage3338192/plugins/profile/2021_03_01_01_19_46/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_schonhage3338192/plugins/profile/2021_03_01_01_19_46/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_schonhage3338192/plugins/profile/2021_03_01_01_19_46/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_schonhage3338192/plugins/profile/2021_03_01_01_19_46/householder.kernel_stats.pb

Epoch 1, Loss: 4099.16552734375, Train Accuracy: 15.788923263549805,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:3004.5910272598267
Average single batch time this epoch: 429.18018228667125
Epoch 2, Loss: 121.20409393310547, Train Accuracy: 28.41622543334961,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2992.859567642212

Time for Epoch:2992.859567642212
Average single batch time this epoch: 427.54071184567044
Epoch 3, Loss: 6.505588054656982, Train Accuracy: 47.74344253540039,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2991.286700963974

Time for Epoch:2989.713834285736
Average single batch time this epoch: 427.09136724472046
Epoch 4, Loss: 1.2976884841918945, Train Accuracy: 67.99141693115234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2989.899671316147

Time for Epoch:2987.1256120204926
Average single batch time this epoch: 426.72138701166426
Epoch 5, Loss: 0.6274608373641968, Train Accuracy: 80.94657135009766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2988.579461812973

Time for Epoch:2984.6188333034515
Average single batch time this epoch: 426.3634146281651
Average time per Batch: 426.92922018255507
Average time per Epoch: 2988.579461812973
2021-03-01 01:19:50.919345: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-01 01:19:51.475264: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-01 01:19:51.475708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-01 01:19:51.476596: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 01:19:51.476767: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 01:19:51.476922: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 01:19:51.477058: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 01:19:51.477192: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 01:19:51.477321: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 01:19:51.477450: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 01:19:51.477481: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-01 01:19:51.516312: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-01 01:19:51.516851: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd530000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-01 01:19:51.516929: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-01 01:19:51.521273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-01 01:19:51.521319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-01 01:20:03.797641: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 01:20:03.797819: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-01 01:20:03.798682: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 01:20:03.798732: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 01:20:03.798752: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 01:20:03.798795: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 01:20:03.798849: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 01:20:03.798874: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 01:20:03.798890: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd56361d4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-01 05:29:07.362272: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 05:29:07.369368: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-01 05:29:07.408111: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2248192/plugins/profile/2021_03_01_05_29_07
2021-03-01 05:29:07.448738: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2248192/plugins/profile/2021_03_01_05_29_07/householder.trace.json.gz
2021-03-01 05:29:07.453566: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-01 05:29:07.456344: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-01 05:29:07.458217: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2248192/plugins/profile/2021_03_01_05_29_07Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2248192/plugins/profile/2021_03_01_05_29_07/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2248192/plugins/profile/2021_03_01_05_29_07/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2248192/plugins/profile/2021_03_01_05_29_07/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2248192/plugins/profile/2021_03_01_05_29_07/householder.kernel_stats.pb

Epoch 1, Loss: 4218.03564453125, Train Accuracy: 15.178571701049805,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:2993.6129772663116
Average single batch time this epoch: 427.613876581192
Epoch 2, Loss: 136.2300567626953, Train Accuracy: 29.04924774169922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2988.664472103119

Time for Epoch:2988.664472103119
Average single batch time this epoch: 426.94114616939
Epoch 3, Loss: 5.1358489990234375, Train Accuracy: 45.55489730834961,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2988.20606136322

Time for Epoch:2987.7476506233215
Average single batch time this epoch: 426.8100242955344
Epoch 4, Loss: 1.1717727184295654, Train Accuracy: 69.35163116455078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2987.9810575644174

Time for Epoch:2987.531049966812
Average single batch time this epoch: 426.77913675989424
Epoch 5, Loss: 0.5842380523681641, Train Accuracy: 82.17598724365234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2987.478910624981

Time for Epoch:2985.972469806671
Average single batch time this epoch: 426.5564308166504
Average time per Batch: 426.77168451036727
Average time per Epoch: 2987.478910624981
2021-03-01 05:29:11.843970: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-01 05:29:12.399588: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-01 05:29:12.400278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-01 05:29:12.400832: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 05:29:12.400976: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 05:29:12.401106: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 05:29:12.401238: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 05:29:12.401384: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 05:29:12.401510: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 05:29:12.401639: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 05:29:12.401663: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-01 05:29:12.440418: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-01 05:29:12.440933: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f79d4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-01 05:29:12.441015: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-01 05:29:12.446094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-01 05:29:12.446141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-01 05:29:24.657430: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 05:29:24.657632: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-01 05:29:24.658523: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 05:29:24.658559: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 05:29:24.658582: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 05:29:24.658629: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 05:29:24.658695: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 05:29:24.658722: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 05:29:24.658738: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f7a07ebe4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-01 09:36:27.795625: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 09:36:27.802672: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-01 09:36:27.842111: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2258192/plugins/profile/2021_03_01_09_36_27
2021-03-01 09:36:27.886431: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2258192/plugins/profile/2021_03_01_09_36_27/householder.trace.json.gz
2021-03-01 09:36:27.891955: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-01 09:36:27.894808: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-01 09:36:27.896702: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2258192/plugins/profile/2021_03_01_09_36_27Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2258192/plugins/profile/2021_03_01_09_36_27/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2258192/plugins/profile/2021_03_01_09_36_27/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2258192/plugins/profile/2021_03_01_09_36_27/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2258192/plugins/profile/2021_03_01_09_36_27/householder.kernel_stats.pb

Epoch 1, Loss: 3811.830810546875, Train Accuracy: 13.760812759399414,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:2981.5787744522095
Average single batch time this epoch: 425.8919931479863
Epoch 2, Loss: 81.0582275390625, Train Accuracy: 24.90060043334961,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2959.030310869217

Time for Epoch:2959.030310869217
Average single batch time this epoch: 422.7076141493661
Epoch 3, Loss: 4.693476676940918, Train Accuracy: 43.50411605834961,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2959.856353521347

Time for Epoch:2960.682396173477
Average single batch time this epoch: 422.9437548433031
Epoch 4, Loss: 1.4169343709945679, Train Accuracy: 69.58705139160156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2960.3236107031503

Time for Epoch:2961.258125066757
Average single batch time this epoch: 423.026082106999
Epoch 5, Loss: 0.7821962237358093, Train Accuracy: 78.51737213134766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2960.380991101265

Time for Epoch:2960.5531322956085
Average single batch time this epoch: 422.92522392954146
Average time per Batch: 422.9006687573024
Average time per Epoch: 2960.380991101265
2021-03-01 09:36:32.230439: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-01 09:36:32.787353: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-01 09:36:32.787815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-01 09:36:32.788141: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 09:36:32.788339: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 09:36:32.788531: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 09:36:32.788706: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 09:36:32.788897: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 09:36:32.789067: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 09:36:32.789282: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 09:36:32.789330: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-01 09:36:32.828424: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-01 09:36:32.828848: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb1c4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-01 09:36:32.829565: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-01 09:36:32.833248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-01 09:36:32.833279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-01 09:36:45.103195: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 09:36:45.103359: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-01 09:36:45.104227: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 09:36:45.104265: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 09:36:45.104298: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 09:36:45.104346: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 09:36:45.104393: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 09:36:45.104420: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 09:36:45.104436: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fb1f985a4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-01 13:59:24.536522: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 13:59:24.543556: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-01 13:59:24.582417: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov2728192/plugins/profile/2021_03_01_13_59_24
2021-03-01 13:59:24.623726: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov2728192/plugins/profile/2021_03_01_13_59_24/householder.trace.json.gz
2021-03-01 13:59:24.628529: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-01 13:59:24.631366: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-01 13:59:24.633209: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov2728192/plugins/profile/2021_03_01_13_59_24Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov2728192/plugins/profile/2021_03_01_13_59_24/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov2728192/plugins/profile/2021_03_01_13_59_24/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov2728192/plugins/profile/2021_03_01_13_59_24/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov2728192/plugins/profile/2021_03_01_13_59_24/householder.kernel_stats.pb

Epoch 1, Loss: 153981550592.0, Train Accuracy: 10.187639236450195,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:3183.295398235321
Average single batch time this epoch: 454.71146198681424
Epoch 2, Loss: 150591160320.0, Train Accuracy: 10.934012413024902,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3146.628927230835

Time for Epoch:3146.628927230835
Average single batch time this epoch: 449.50758954456876
Epoch 3, Loss: 159937249280.0, Train Accuracy: 11.615861892700195,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3144.7185710668564

Time for Epoch:3142.808214902878
Average single batch time this epoch: 448.96171184948514
Epoch 4, Loss: 171236704256.0, Train Accuracy: 11.572265625,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3143.912677923838

Time for Epoch:3142.300891637802
Average single batch time this epoch: 448.88932718549455
Epoch 5, Loss: 181304950784.0, Train Accuracy: 12.301199913024902,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3144.0257271528244

Time for Epoch:3144.3648748397827
Average single batch time this epoch: 449.1840241977147
Average time per Batch: 449.1356631943158
Average time per Epoch: 3144.0257271528244
2021-03-01 13:59:29.007960: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-01 13:59:29.564694: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-01 13:59:29.565307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-01 13:59:29.565787: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 13:59:29.565949: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 13:59:29.566081: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 13:59:29.566215: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 13:59:29.566348: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 13:59:29.566475: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 13:59:29.566606: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 13:59:29.566630: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-01 13:59:29.600279: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-01 13:59:29.600844: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f86bc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-01 13:59:29.600915: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-01 13:59:29.607349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-01 13:59:29.607393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-01 13:59:41.840110: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 13:59:41.840274: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-01 13:59:41.841137: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 13:59:41.841169: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 13:59:41.841192: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 13:59:41.841238: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 13:59:41.841285: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 13:59:41.841309: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 13:59:41.841324: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f86f17a3550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-01 18:05:31.958077: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 18:05:31.965283: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-01 18:05:32.003996: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3238192/plugins/profile/2021_03_01_18_05_31
2021-03-01 18:05:32.045313: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3238192/plugins/profile/2021_03_01_18_05_31/householder.trace.json.gz
2021-03-01 18:05:32.050189: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-01 18:05:32.052942: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-01 18:05:32.054810: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3238192/plugins/profile/2021_03_01_18_05_31Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3238192/plugins/profile/2021_03_01_18_05_31/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3238192/plugins/profile/2021_03_01_18_05_31/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3238192/plugins/profile/2021_03_01_18_05_31/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3238192/plugins/profile/2021_03_01_18_05_31/householder.kernel_stats.pb

Epoch 1, Loss: 3340.94482421875, Train Accuracy: 18.026296615600586,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:2960.2669088840485
Average single batch time this epoch: 422.84804841450284
Epoch 2, Loss: 57.568992614746094, Train Accuracy: 24.417551040649414,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2947.6357913017273

Time for Epoch:2947.6357913017273
Average single batch time this epoch: 421.080064535141
Epoch 3, Loss: 4.501559734344482, Train Accuracy: 48.78627395629883,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2947.5649185180664

Time for Epoch:2947.4940457344055
Average single batch time this epoch: 421.0598310743059
Epoch 4, Loss: 1.182134985923767, Train Accuracy: 70.61942291259766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2947.2528990109763

Time for Epoch:2946.6288599967957
Average single batch time this epoch: 420.9362104279654
Epoch 5, Loss: 0.6311084032058716, Train Accuracy: 82.50035095214844,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2947.453990161419

Time for Epoch:2948.057263612747
Average single batch time this epoch: 421.14029724257335
Average time per Batch: 421.05410081999645
Average time per Epoch: 2947.453990161419
2021-03-01 18:05:36.421742: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-01 18:05:36.979299: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-01 18:05:36.979748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-01 18:05:36.981246: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 18:05:36.981429: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 18:05:36.981596: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 18:05:36.981728: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 18:05:36.981895: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 18:05:36.982022: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 18:05:36.982153: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 18:05:36.982191: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-01 18:05:37.020259: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-01 18:05:37.020709: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9b58000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-01 18:05:37.020747: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-01 18:05:37.024240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-01 18:05:37.024276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-01 18:05:49.124554: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 18:05:49.124699: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-01 18:05:49.125496: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 18:05:49.125528: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 18:05:49.125550: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 18:05:49.125583: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 18:05:49.125624: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 18:05:49.125648: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 18:05:49.125663: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9b8ae1b550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-01 22:06:47.838953: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 22:06:47.845710: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-01 22:06:47.884350: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3338192/plugins/profile/2021_03_01_22_06_47
2021-03-01 22:06:47.926286: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3338192/plugins/profile/2021_03_01_22_06_47/householder.trace.json.gz
2021-03-01 22:06:47.931125: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-01 22:06:47.933912: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-01 22:06:47.935840: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3338192/plugins/profile/2021_03_01_22_06_47Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3338192/plugins/profile/2021_03_01_22_06_47/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3338192/plugins/profile/2021_03_01_22_06_47/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3338192/plugins/profile/2021_03_01_22_06_47/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3338192/plugins/profile/2021_03_01_22_06_47/householder.kernel_stats.pb

Epoch 1, Loss: 11137957494784.0, Train Accuracy: 9.599958419799805,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:2902.0919897556305
Average single batch time this epoch: 414.5399011203221
Epoch 2, Loss: 16280004329472.0, Train Accuracy: 9.502302169799805,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2893.0847527980804

Time for Epoch:2893.0847527980804
Average single batch time this epoch: 413.28689064298356
Epoch 3, Loss: 25873426153472.0, Train Accuracy: 9.894670486450195,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2891.5485421419144

Time for Epoch:2890.0123314857483
Average single batch time this epoch: 412.84799228395735
Epoch 4, Loss: 38995861962752.0, Train Accuracy: 9.8388671875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2890.0964636802673

Time for Epoch:2887.1923067569733
Average single batch time this epoch: 412.4451449598585
Epoch 5, Loss: 51218260951040.0, Train Accuracy: 9.805733680725098,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2889.146823346615

Time for Epoch:2886.2979023456573
Average single batch time this epoch: 412.31719643729076
Average time per Batch: 412.7243060810225
Average time per Epoch: 2889.146823346615
2021-03-01 22:06:52.333905: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-01 22:06:52.884277: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-01 22:06:52.884774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-01 22:06:52.885268: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 22:06:52.885417: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 22:06:52.885556: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 22:06:52.885691: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 22:06:52.885848: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 22:06:52.885982: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 22:06:52.886119: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 22:06:52.886144: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-01 22:06:52.928417: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-01 22:06:52.928902: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2d00000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-01 22:06:52.928975: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-01 22:06:52.933369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-01 22:06:52.933406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-01 22:07:05.099328: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 22:07:05.099488: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-01 22:07:05.100355: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-01 22:07:05.100389: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 22:07:05.100417: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 22:07:05.100478: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 22:07:05.100528: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-01 22:07:05.100553: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-01 22:07:05.100568: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f2d351a6550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-02 02:09:58.893963: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 02:09:58.900869: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-02 02:09:58.934528: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov3348192/plugins/profile/2021_03_02_02_09_58
2021-03-02 02:09:58.975494: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov3348192/plugins/profile/2021_03_02_02_09_58/householder.trace.json.gz
2021-03-02 02:09:58.980387: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-02 02:09:58.983182: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-02 02:09:58.985029: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov3348192/plugins/profile/2021_03_02_02_09_58Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov3348192/plugins/profile/2021_03_02_02_09_58/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov3348192/plugins/profile/2021_03_02_02_09_58/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov3348192/plugins/profile/2021_03_02_02_09_58/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov3348192/plugins/profile/2021_03_02_02_09_58/householder.kernel_stats.pb

Epoch 1, Loss: 3526.958740234375, Train Accuracy: 17.38455581665039,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:2919.167733669281
Average single batch time this epoch: 416.9770815031869
Epoch 2, Loss: 76.57389831542969, Train Accuracy: 27.11181640625,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2910.3864619731903

Time for Epoch:2910.3864619731903
Average single batch time this epoch: 415.7590589863913
Epoch 3, Loss: 3.5868046283721924, Train Accuracy: 51.320106506347656,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2911.5590391159058

Time for Epoch:2912.731616258621
Average single batch time this epoch: 416.09390439305986
Epoch 4, Loss: 1.1807348728179932, Train Accuracy: 71.826171875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2913.414087613424

Time for Epoch:2917.1241846084595
Average single batch time this epoch: 416.72105050086975
Epoch 5, Loss: 0.5900736451148987, Train Accuracy: 82.38350677490234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2913.64780575037

Time for Epoch:2914.348960161209
Average single batch time this epoch: 416.32502613748824
Average time per Batch: 416.2247600044523
Average time per Epoch: 2913.64780575037
2021-03-02 02:10:03.317651: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-02 02:10:03.871942: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-02 02:10:03.872471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-02 02:10:03.872766: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 02:10:03.873025: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 02:10:03.873266: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 02:10:03.873493: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 02:10:03.873700: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 02:10:03.873901: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 02:10:03.874138: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 02:10:03.874176: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-02 02:10:03.912042: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-02 02:10:03.912304: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc2a0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-02 02:10:03.913026: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-02 02:10:03.916666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-02 02:10:03.916695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-02 02:10:16.203662: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-02 02:10:16.203841: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-02 02:10:16.204723: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 02:10:16.204754: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 02:10:16.204786: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 02:10:16.204834: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 02:10:16.204886: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-02 02:10:16.204911: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 02:10:16.204926: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc2d3c45550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-02 06:05:50.791242: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 06:05:50.798149: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-02 06:05:50.836796: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov4428192/plugins/profile/2021_03_02_06_05_50
2021-03-02 06:05:50.878831: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov4428192/plugins/profile/2021_03_02_06_05_50/householder.trace.json.gz
2021-03-02 06:05:50.883982: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-02 06:05:50.886804: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-02 06:05:50.888646: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov4428192/plugins/profile/2021_03_02_06_05_50Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov4428192/plugins/profile/2021_03_02_06_05_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov4428192/plugins/profile/2021_03_02_06_05_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov4428192/plugins/profile/2021_03_02_06_05_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov4428192/plugins/profile/2021_03_02_06_05_50/householder.kernel_stats.pb

Epoch 1, Loss: 3338.882568359375, Train Accuracy: 16.13943862915039,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:2827.4572739601135
Average single batch time this epoch: 403.8775867053441
Epoch 2, Loss: 59.64104461669922, Train Accuracy: 35.51897430419922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2823.267352581024

Time for Epoch:2823.267352581024
Average single batch time this epoch: 403.3132130418505
Epoch 3, Loss: 3.461221218109131, Train Accuracy: 53.615028381347656,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2825.0856631994247

Time for Epoch:2826.9039738178253
Average single batch time this epoch: 403.8324900354658
Epoch 4, Loss: 1.04237961769104, Train Accuracy: 73.974609375,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2826.045422077179

Time for Epoch:2827.9649398326874
Average single batch time this epoch: 403.9839998653957
Epoch 5, Loss: 0.6254919171333313, Train Accuracy: 82.4951171875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2826.7737829089165

Time for Epoch:2828.958865404129
Average single batch time this epoch: 404.12601559502735
Average time per Batch: 403.8139296344348
Average time per Epoch: 2826.7737829089165
2021-03-02 06:05:55.230728: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-02 06:05:55.759894: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-02 06:05:55.760400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-02 06:05:55.760738: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 06:05:55.760972: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 06:05:55.761178: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 06:05:55.761380: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 06:05:55.761591: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 06:05:55.761791: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 06:05:55.762032: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 06:05:55.762091: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-02 06:05:55.800278: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-02 06:05:55.800646: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2654000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-02 06:05:55.801284: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-02 06:05:55.803756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-02 06:05:55.803796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-02 06:06:07.952066: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-02 06:06:07.952222: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-02 06:06:07.953057: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 06:06:07.953086: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 06:06:07.953107: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 06:06:07.953176: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 06:06:07.953238: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-02 06:06:07.953265: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 06:06:07.953280: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f26894ef550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-02 09:55:41.752795: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 09:55:41.760018: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-02 09:55:41.796648: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov4448192/plugins/profile/2021_03_02_09_55_41
2021-03-02 09:55:41.839471: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov4448192/plugins/profile/2021_03_02_09_55_41/householder.trace.json.gz
2021-03-02 09:55:41.844790: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-02 09:55:41.847703: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-02 09:55:41.849578: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov4448192/plugins/profile/2021_03_02_09_55_41Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov4448192/plugins/profile/2021_03_02_09_55_41/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov4448192/plugins/profile/2021_03_02_09_55_41/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov4448192/plugins/profile/2021_03_02_09_55_41/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov4448192/plugins/profile/2021_03_02_09_55_41/householder.kernel_stats.pb

Epoch 1, Loss: 3304.99853515625, Train Accuracy: 15.128000259399414,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:2763.064755678177
Average single batch time this epoch: 394.67837027141024
Epoch 2, Loss: 55.28709030151367, Train Accuracy: 27.70647430419922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2750.4296503067017

Time for Epoch:2750.4296503067017
Average single batch time this epoch: 392.9077033315386
Epoch 3, Loss: 3.842958688735962, Train Accuracy: 52.305381774902344,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2751.4652712345123

Time for Epoch:2752.500892162323
Average single batch time this epoch: 393.20347108159746
Epoch 4, Loss: 1.2075203657150269, Train Accuracy: 70.03522491455078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2752.962636868159

Time for Epoch:2755.9573681354523
Average single batch time this epoch: 393.6972950867244
Epoch 5, Loss: 0.6586861610412598, Train Accuracy: 80.98841857910156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2752.6751784086227

Time for Epoch:2751.812803030014
Average single batch time this epoch: 393.1051716123308
Average time per Batch: 393.2284102780478
Average time per Epoch: 2752.6751784086227
2021-03-02 09:55:46.240030: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-02 09:55:46.799478: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-02 09:55:46.799994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-02 09:55:46.800557: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 09:55:46.800737: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 09:55:46.800880: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 09:55:46.801018: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 09:55:46.801162: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 09:55:46.801285: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 09:55:46.801411: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 09:55:46.801434: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-02 09:55:46.840283: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-02 09:55:46.840705: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8044000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-02 09:55:46.840746: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-02 09:55:46.844802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-02 09:55:46.844842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-02 09:55:58.931139: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-02 09:55:58.931312: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-02 09:55:58.932110: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 09:55:58.932144: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 09:55:58.932165: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 09:55:58.932199: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 09:55:58.932245: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-02 09:55:58.932270: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 09:55:58.932285: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f80779c1550> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-02 14:04:51.934730: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 14:04:51.941625: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-02 14:04:51.980428: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov5528192/plugins/profile/2021_03_02_14_04_51
2021-03-02 14:04:52.021256: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov5528192/plugins/profile/2021_03_02_14_04_51/householder.trace.json.gz
2021-03-02 14:04:52.026053: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-02 14:04:52.028874: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-02 14:04:52.030755: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov5528192/plugins/profile/2021_03_02_14_04_51Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov5528192/plugins/profile/2021_03_02_14_04_51/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov5528192/plugins/profile/2021_03_02_14_04_51/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov5528192/plugins/profile/2021_03_02_14_04_51/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov5528192/plugins/profile/2021_03_02_14_04_51/householder.kernel_stats.pb

Epoch 1, Loss: 3597.123779296875, Train Accuracy: 15.764509201049805,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:2988.6096229553223
Average single batch time this epoch: 426.8991266659328
Epoch 2, Loss: 78.3233871459961, Train Accuracy: 29.889789581298828,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2989.582823038101

Time for Epoch:2989.582823038101
Average single batch time this epoch: 427.07230057035173
Epoch 3, Loss: 3.8288776874542236, Train Accuracy: 52.60707092285156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2986.8164417743683

Time for Epoch:2984.0500605106354
Average single batch time this epoch: 426.28188024248396
Epoch 4, Loss: 1.0478622913360596, Train Accuracy: 73.51946258544922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2986.295386393865

Time for Epoch:2985.2532756328583
Average single batch time this epoch: 426.45370139394487
Epoch 5, Loss: 0.578310489654541, Train Accuracy: 83.08802795410156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2986.0897595882416

Time for Epoch:2985.4728791713715
Average single batch time this epoch: 426.4850607599531
Average time per Batch: 426.5732357416834
Average time per Epoch: 2986.0897595882416
2021-03-02 14:04:56.413719: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-02 14:04:56.956357: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-02 14:04:56.956969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-02 14:04:56.957701: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 14:04:56.957861: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 14:04:56.957988: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 14:04:56.958132: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 14:04:56.958264: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 14:04:56.958386: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 14:04:56.958514: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 14:04:56.958538: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-02 14:04:56.992186: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-02 14:04:56.992624: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f72c0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-02 14:04:56.992695: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-02 14:04:56.996684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-02 14:04:56.996726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-02 14:05:09.241621: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-02 14:05:09.241825: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-02 14:05:09.242724: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-02 14:05:09.242757: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 14:05:09.242791: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 14:05:09.242858: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 14:05:09.242909: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-02 14:05:09.242934: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 14:05:09.242949: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f72f3be24c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-02 18:04:41.993017: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-02 18:04:42.000252: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-02 18:04:42.041050: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_1_thread_smirnov5558192/plugins/profile/2021_03_02_18_04_42
2021-03-02 18:04:42.083217: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_1_thread_smirnov5558192/plugins/profile/2021_03_02_18_04_42/householder.trace.json.gz
2021-03-02 18:04:42.088415: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-02 18:04:42.091235: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-02 18:04:42.093132: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_1_thread_smirnov5558192/plugins/profile/2021_03_02_18_04_42Dumped tool data for overview_page.pb to PAPER_1_thread_smirnov5558192/plugins/profile/2021_03_02_18_04_42/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_1_thread_smirnov5558192/plugins/profile/2021_03_02_18_04_42/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_1_thread_smirnov5558192/plugins/profile/2021_03_02_18_04_42/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_1_thread_smirnov5558192/plugins/profile/2021_03_02_18_04_42/householder.kernel_stats.pb

Epoch 1, Loss: 3255.07861328125, Train Accuracy: 15.89181137084961,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:2876.6481025218964
Average single batch time this epoch: 410.9020770617894
Epoch 2, Loss: 58.284664154052734, Train Accuracy: 27.39432144165039,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2874.5537152290344

Time for Epoch:2874.5537152290344
Average single batch time this epoch: 410.6396275929042
Epoch 3, Loss: 3.514139175415039, Train Accuracy: 52.62102508544922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2874.606844305992

Time for Epoch:2874.65997338295
Average single batch time this epoch: 410.6547064781189
Epoch 4, Loss: 1.0682438611984253, Train Accuracy: 73.26311492919922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2874.955816666285

Time for Epoch:2875.6537613868713
Average single batch time this epoch: 410.79684485707963
Epoch 5, Loss: 0.6002032160758972, Train Accuracy: 83.52225494384766,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 2874.016978561878

Time for Epoch:2871.200464248657
Average single batch time this epoch: 410.16040713446483
Average time per Batch: 410.56289651564185
Average time per Epoch: 2874.016978561878
