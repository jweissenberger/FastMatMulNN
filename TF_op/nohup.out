mkdir: cannot create directory ‘./output_12_thread_fastmm_gradient_regular_bini_dgemm’: File exists
2020-12-14 16:44:59.942840: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 16:45:00.455821: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 16:45:00.456283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 16:45:00.456712: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:45:00.456892: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:45:00.457062: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:45:00.457229: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:45:00.457401: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:45:00.457568: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:45:00.457735: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:45:00.457769: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 16:45:00.500342: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 16:45:00.503390: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fba70000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 16:45:00.503495: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 16:45:00.508601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 16:45:00.508642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 16:45:00.583074: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:45:00.583199: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 16:45:00.583459: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:45:00.583491: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:45:00.583510: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:45:00.583545: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:45:00.583612: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:45:00.583639: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:45:00.583654: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fbb0baa8ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 16:49:05.733645: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:49:05.876215: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 16:49:06.304961: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_bini322512/plugins/profile/2020_12_14_16_49_05
2020-12-14 16:49:06.723118: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_bini322512/plugins/profile/2020_12_14_16_49_05/householder.trace.json.gz
2020-12-14 16:49:06.814363: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 16:49:06.843165: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 16:49:06.845375: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_bini322512/plugins/profile/2020_12_14_16_49_05Dumped tool data for overview_page.pb to all_threads_bini322512/plugins/profile/2020_12_14_16_49_05/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_bini322512/plugins/profile/2020_12_14_16_49_05/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_bini322512/plugins/profile/2020_12_14_16_49_05/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_bini322512/plugins/profile/2020_12_14_16_49_05/householder.kernel_stats.pb

Epoch 1, Loss: 0.32423850893974304, Train Accuracy: 90.3979721069336,Test Loss: 0.13249048590660095, Test Accuracy: 95.93000030517578
Time for Epoch:50.77124094963074
Average single batch time this epoch: 0.4239646226931841
Epoch 2, Loss: 0.10316634923219681, Train Accuracy: 96.87165832519531,Test Loss: 0.09707402437925339, Test Accuracy: 96.94000244140625
Running Average Epoch time: 49.639742612838745

Time for Epoch:49.639742612838745
Average single batch time this epoch: 0.4165680958674504
Epoch 3, Loss: 0.06677897274494171, Train Accuracy: 97.8248519897461,Test Loss: 0.11898371577262878, Test Accuracy: 96.62000274658203
Running Average Epoch time: 49.276127099990845

Time for Epoch:48.912511587142944
Average single batch time this epoch: 0.41119853859273797
Epoch 4, Loss: 0.0544399730861187, Train Accuracy: 98.31230163574219,Test Loss: 0.0922626405954361, Test Accuracy: 97.3499984741211
Running Average Epoch time: 48.99842095375061

Time for Epoch:48.44300866127014
Average single batch time this epoch: 0.40591085262787646
Epoch 5, Loss: 0.03943677246570587, Train Accuracy: 98.75133514404297,Test Loss: 0.10882873833179474, Test Accuracy: 97.1500015258789
Running Average Epoch time: 48.577705919742584

Time for Epoch:47.315560817718506
Average single batch time this epoch: 0.3983583185407851
Average time per Batch: 0.4080089514072125
Average time per Epoch: 48.577705919742584
2020-12-14 16:49:10.329136: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 16:49:10.842819: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 16:49:10.843212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 16:49:10.844282: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:49:10.844449: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:49:10.844570: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:49:10.844688: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:49:10.844810: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:49:10.844928: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:49:10.845045: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:49:10.845070: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 16:49:10.880197: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 16:49:10.884399: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2878000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 16:49:10.884472: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 16:49:10.888469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 16:49:10.888528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 16:49:10.963462: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:49:10.963575: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 16:49:10.963858: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:49:10.963891: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:49:10.963910: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:49:10.963946: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:49:10.963989: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:49:10.964012: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:49:10.964028: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f2915c6eca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 16:50:13.773615: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:50:13.959058: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 16:50:14.422711: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_dgemm512/plugins/profile/2020_12_14_16_50_14
2020-12-14 16:50:14.843929: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_dgemm512/plugins/profile/2020_12_14_16_50_14/householder.trace.json.gz
2020-12-14 16:50:14.931734: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 16:50:14.960446: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 16:50:14.962565: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_dgemm512/plugins/profile/2020_12_14_16_50_14Dumped tool data for overview_page.pb to all_threads_dgemm512/plugins/profile/2020_12_14_16_50_14/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_dgemm512/plugins/profile/2020_12_14_16_50_14/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_dgemm512/plugins/profile/2020_12_14_16_50_14/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_dgemm512/plugins/profile/2020_12_14_16_50_14/householder.kernel_stats.pb

Epoch 1, Loss: 0.3232310712337494, Train Accuracy: 90.45472717285156,Test Loss: 0.13729962706565857, Test Accuracy: 95.70999908447266
Time for Epoch:13.81506633758545
Average single batch time this epoch: 0.11324336386134481
Epoch 2, Loss: 0.1026090607047081, Train Accuracy: 96.91840362548828,Test Loss: 0.0986790657043457, Test Accuracy: 96.9000015258789
Running Average Epoch time: 12.453405141830444

Time for Epoch:12.453405141830444
Average single batch time this epoch: 0.10330744278736603
Epoch 3, Loss: 0.06668688356876373, Train Accuracy: 97.92167663574219,Test Loss: 0.10299155116081238, Test Accuracy: 97.18000030517578
Running Average Epoch time: 12.295372247695923

Time for Epoch:12.137339353561401
Average single batch time this epoch: 0.10093089454194419
Epoch 4, Loss: 0.056224673986434937, Train Accuracy: 98.2154769897461,Test Loss: 0.09972213208675385, Test Accuracy: 97.2699966430664
Running Average Epoch time: 12.318097829818726

Time for Epoch:12.363548994064331
Average single batch time this epoch: 0.10280091742165068
Epoch 5, Loss: 0.03919781744480133, Train Accuracy: 98.74966430664062,Test Loss: 0.11189696937799454, Test Accuracy: 97.36000061035156
Running Average Epoch time: 12.232647895812988

Time for Epoch:11.976298093795776
Average single batch time this epoch: 0.09939482680752747
Average time per Batch: 0.1016085203896221
Average time per Epoch: 12.232647895812988
2020-12-14 16:50:18.388768: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 16:50:18.892539: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 16:50:18.893009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 16:50:18.893438: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:18.893621: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:18.893793: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:18.893989: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:18.894164: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:18.894333: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:18.894504: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:18.894536: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 16:50:18.932404: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 16:50:18.935865: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe298000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 16:50:18.935967: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 16:50:18.940015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 16:50:18.940048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 16:50:19.012964: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:50:19.013087: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 16:50:19.013354: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:19.013385: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:50:19.013422: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:50:19.013458: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:50:19.013536: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:50:19.013563: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:50:19.013579: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

Traceback (most recent call last):
  File "tensorboard_test.py", line 182, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:97 train_step  *
        predictions = model(images)
    tensorboard_test.py:86 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:67 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2020-12-14 16:50:19.699522: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:50:22.741168: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 16:50:23.217519: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 16:50:23.217940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 16:50:23.218339: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:23.218502: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:23.218655: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:23.218805: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:23.218963: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:23.219114: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:23.219265: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:23.219314: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 16:50:23.260152: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 16:50:23.263852: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0d40000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 16:50:23.263944: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 16:50:23.268133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 16:50:23.268168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 16:50:23.348901: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:50:23.349030: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 16:50:23.349292: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:50:23.349323: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:50:23.349342: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:50:23.349377: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:50:23.349419: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:50:23.349442: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:50:23.349457: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f0ddd72dd30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 16:55:28.726503: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:55:28.932026: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 16:55:29.382449: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_schonhage333512/plugins/profile/2020_12_14_16_55_28
2020-12-14 16:55:29.805016: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_schonhage333512/plugins/profile/2020_12_14_16_55_28/householder.trace.json.gz
2020-12-14 16:55:29.896689: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 16:55:29.925818: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 16:55:29.927889: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_schonhage333512/plugins/profile/2020_12_14_16_55_28Dumped tool data for overview_page.pb to all_threads_schonhage333512/plugins/profile/2020_12_14_16_55_28/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_schonhage333512/plugins/profile/2020_12_14_16_55_28/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_schonhage333512/plugins/profile/2020_12_14_16_55_28/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_schonhage333512/plugins/profile/2020_12_14_16_55_28/householder.kernel_stats.pb

Epoch 1, Loss: 0.32214364409446716, Train Accuracy: 90.4563980102539,Test Loss: 0.13681356608867645, Test Accuracy: 95.74000549316406
Time for Epoch:63.3154833316803
Average single batch time this epoch: 0.529727155326778
Epoch 2, Loss: 0.10221178084611893, Train Accuracy: 96.92842102050781,Test Loss: 0.09610699117183685, Test Accuracy: 96.91999816894531
Running Average Epoch time: 61.523502588272095

Time for Epoch:61.523502588272095
Average single batch time this epoch: 0.5174027141342815
Epoch 3, Loss: 0.06540665775537491, Train Accuracy: 97.9583969116211,Test Loss: 0.11014983057975769, Test Accuracy: 96.87999725341797
Running Average Epoch time: 61.02256381511688

Time for Epoch:60.52162504196167
Average single batch time this epoch: 0.5087133859976743
Epoch 4, Loss: 0.060513585805892944, Train Accuracy: 98.09194946289062,Test Loss: 0.0840950533747673, Test Accuracy: 97.68999481201172
Running Average Epoch time: 60.75509572029114

Time for Epoch:60.22015953063965
Average single batch time this epoch: 0.5061776352743818
Epoch 5, Loss: 0.04129106551408768, Train Accuracy: 98.69290924072266,Test Loss: 0.10324111580848694, Test Accuracy: 97.40999603271484
Running Average Epoch time: 60.4946323633194

Time for Epoch:59.713242292404175
Average single batch time this epoch: 0.5025070284166907
Average time per Batch: 0.5087001909557571
Average time per Epoch: 60.4946323633194
2020-12-14 16:55:33.375304: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 16:55:33.900466: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 16:55:33.900963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 16:55:33.901632: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:55:33.901749: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:55:33.901847: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:55:33.901943: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:55:33.902053: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:55:33.902149: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:55:33.902244: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:55:33.902261: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 16:55:33.940128: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 16:55:33.943422: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4534000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 16:55:33.943488: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 16:55:33.947454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 16:55:33.947486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 16:55:34.021575: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:55:34.021706: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 16:55:34.021979: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:55:34.022008: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:55:34.022026: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:55:34.022060: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:55:34.022101: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:55:34.022125: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:55:34.022141: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f45e0f40ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 16:59:38.867513: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:59:39.059708: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 16:59:39.470077: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov224512/plugins/profile/2020_12_14_16_59_39
2020-12-14 16:59:39.886505: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov224512/plugins/profile/2020_12_14_16_59_39/householder.trace.json.gz
2020-12-14 16:59:39.984022: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 16:59:40.012757: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 16:59:40.014947: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov224512/plugins/profile/2020_12_14_16_59_39Dumped tool data for overview_page.pb to all_threads_smirnov224512/plugins/profile/2020_12_14_16_59_39/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov224512/plugins/profile/2020_12_14_16_59_39/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov224512/plugins/profile/2020_12_14_16_59_39/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov224512/plugins/profile/2020_12_14_16_59_39/householder.kernel_stats.pb

Epoch 1, Loss: 0.3230379819869995, Train Accuracy: 90.44136810302734,Test Loss: 0.13501696288585663, Test Accuracy: 95.93000030517578
Time for Epoch:51.65397024154663
Average single batch time this epoch: 0.4326145404424423
Epoch 2, Loss: 0.10279253870248795, Train Accuracy: 96.91339874267578,Test Loss: 0.09659729152917862, Test Accuracy: 96.9000015258789
Running Average Epoch time: 50.77940058708191

Time for Epoch:50.77940058708191
Average single batch time this epoch: 0.4287198180826301
Epoch 3, Loss: 0.06586451083421707, Train Accuracy: 97.94171142578125,Test Loss: 0.10095483064651489, Test Accuracy: 97.05000305175781
Running Average Epoch time: 49.079731822013855

Time for Epoch:47.3800630569458
Average single batch time this epoch: 0.3994056526412312
Epoch 4, Loss: 0.051906339824199677, Train Accuracy: 98.35236358642578,Test Loss: 0.09165100008249283, Test Accuracy: 97.52999877929688
Running Average Epoch time: 48.80180764198303

Time for Epoch:48.24595928192139
Average single batch time this epoch: 0.40631329707610303
Epoch 5, Loss: 0.05006211996078491, Train Accuracy: 98.40911865234375,Test Loss: 0.10704392194747925, Test Accuracy: 97.1199951171875
Running Average Epoch time: 48.26674962043762

Time for Epoch:46.66157555580139
Average single batch time this epoch: 0.39301613660959095
Average time per Batch: 0.4068637261023888
Average time per Epoch: 48.26674962043762
2020-12-14 16:59:43.586436: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 16:59:44.086978: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 16:59:44.087377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 16:59:44.088437: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:59:44.088595: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:59:44.088739: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:59:44.088861: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:59:44.088988: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:59:44.089108: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:59:44.089228: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:59:44.089252: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 16:59:44.124253: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 16:59:44.128747: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7998000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 16:59:44.128822: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 16:59:44.133186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 16:59:44.133232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 16:59:44.211064: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:59:44.211183: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 16:59:44.211424: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 16:59:44.211472: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:59:44.211492: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:59:44.211526: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:59:44.211568: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 16:59:44.211593: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 16:59:44.211608: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f7a35859d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:04:22.526726: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:04:22.744860: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:04:23.181984: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov225512/plugins/profile/2020_12_14_17_04_22
2020-12-14 17:04:23.643785: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov225512/plugins/profile/2020_12_14_17_04_22/householder.trace.json.gz
2020-12-14 17:04:23.747736: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:04:23.778208: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:04:23.780478: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov225512/plugins/profile/2020_12_14_17_04_22Dumped tool data for overview_page.pb to all_threads_smirnov225512/plugins/profile/2020_12_14_17_04_22/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov225512/plugins/profile/2020_12_14_17_04_22/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov225512/plugins/profile/2020_12_14_17_04_22/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov225512/plugins/profile/2020_12_14_17_04_22/householder.kernel_stats.pb

Epoch 1, Loss: 0.38625311851501465, Train Accuracy: 88.30128479003906,Test Loss: 0.1573961228132248, Test Accuracy: 95.01000213623047
Time for Epoch:58.85896944999695
Average single batch time this epoch: 0.4956215263431908
Epoch 2, Loss: 0.13119731843471527, Train Accuracy: 95.92180633544922,Test Loss: 0.12467900663614273, Test Accuracy: 96.20000457763672
Running Average Epoch time: 56.006951093673706

Time for Epoch:56.006951093673706
Average single batch time this epoch: 0.47276618745591903
Epoch 3, Loss: 0.08959569036960602, Train Accuracy: 97.20886993408203,Test Loss: 0.11396946012973785, Test Accuracy: 96.55000305175781
Running Average Epoch time: 55.08626043796539

Time for Epoch:54.16556978225708
Average single batch time this epoch: 0.4570570501506838
Epoch 4, Loss: 0.07118895649909973, Train Accuracy: 97.75640869140625,Test Loss: 0.09817782789468765, Test Accuracy: 97.18000030517578
Running Average Epoch time: 55.4009157816569

Time for Epoch:56.03022646903992
Average single batch time this epoch: 0.4738832029521975
Epoch 5, Loss: 0.05294394865632057, Train Accuracy: 98.32398223876953,Test Loss: 0.11826683580875397, Test Accuracy: 96.77999877929688
Running Average Epoch time: 54.84780377149582

Time for Epoch:53.18846774101257
Average single batch time this epoch: 0.4483552814548851
Average time per Batch: 0.4630154305034214
Average time per Epoch: 54.84780377149582
2020-12-14 17:04:27.216881: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:04:27.728175: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:04:27.728649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:04:27.729495: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:04:27.729608: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:04:27.729709: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:04:27.729807: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:04:27.729920: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:04:27.730019: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:04:27.730117: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:04:27.730136: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:04:27.768312: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:04:27.771922: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f44c8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:04:27.772022: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:04:27.776163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:04:27.776197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:04:27.851849: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:04:27.851976: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:04:27.852246: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:04:27.852278: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:04:27.852297: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:04:27.852333: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:04:27.852410: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:04:27.852438: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:04:27.852453: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f456633cca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:09:13.772885: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:09:13.949002: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:09:14.366828: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov272512/plugins/profile/2020_12_14_17_09_14
2020-12-14 17:09:14.794617: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov272512/plugins/profile/2020_12_14_17_09_14/householder.trace.json.gz
2020-12-14 17:09:14.887811: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:09:14.916928: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:09:14.919017: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov272512/plugins/profile/2020_12_14_17_09_14Dumped tool data for overview_page.pb to all_threads_smirnov272512/plugins/profile/2020_12_14_17_09_14/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov272512/plugins/profile/2020_12_14_17_09_14/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov272512/plugins/profile/2020_12_14_17_09_14/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov272512/plugins/profile/2020_12_14_17_09_14/householder.kernel_stats.pb

Epoch 1, Loss: 24528932.0, Train Accuracy: 10.647035598754883,Test Loss: 19205382.0, Test Accuracy: 11.0600004196167
Time for Epoch:58.947999000549316
Average single batch time this epoch: 0.4926780900384626
Epoch 2, Loss: 9134535.0, Train Accuracy: 10.977563858032227,Test Loss: 3971843.25, Test Accuracy: 9.880000114440918
Running Average Epoch time: 57.47504425048828

Time for Epoch:57.47504425048828
Average single batch time this epoch: 0.4837690663133931
Epoch 3, Loss: 2877654.25, Train Accuracy: 10.665397644042969,Test Loss: 2666975.25, Test Accuracy: 11.010000228881836
Running Average Epoch time: 57.54741704463959

Time for Epoch:57.619789838790894
Average single batch time this epoch: 0.48387563738048583
Epoch 4, Loss: 2388119.75, Train Accuracy: 10.533520698547363,Test Loss: 2573118.0, Test Accuracy: 10.619999885559082
Running Average Epoch time: 57.22768338521322

Time for Epoch:56.588216066360474
Average single batch time this epoch: 0.47511079168727255
Epoch 5, Loss: 2109181.5, Train Accuracy: 10.476762771606445,Test Loss: 1880270.5, Test Accuracy: 10.1899995803833
Running Average Epoch time: 56.72692137956619

Time for Epoch:55.22463536262512
Average single batch time this epoch: 0.46416499879625106
Average time per Batch: 0.4767301235443506
Average time per Epoch: 56.72692137956619
2020-12-14 17:09:18.436399: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:09:18.940272: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:09:18.940741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:09:18.941640: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:09:18.941790: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:09:18.941911: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:09:18.942029: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:09:18.942153: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:09:18.942271: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:09:18.942406: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:09:18.942430: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:09:18.980349: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:09:18.984955: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7f18000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:09:18.985022: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:09:18.989339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:09:18.989386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:09:19.062716: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:09:19.062819: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:09:19.063059: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:09:19.063088: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:09:19.063105: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:09:19.063141: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:09:19.063183: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:09:19.063208: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:09:19.063223: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f7fac9e5d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:13:54.285921: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:13:54.463717: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:13:54.868561: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov323512/plugins/profile/2020_12_14_17_13_54
2020-12-14 17:13:55.295376: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov323512/plugins/profile/2020_12_14_17_13_54/householder.trace.json.gz
2020-12-14 17:13:55.385880: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:13:55.415280: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:13:55.417461: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov323512/plugins/profile/2020_12_14_17_13_54Dumped tool data for overview_page.pb to all_threads_smirnov323512/plugins/profile/2020_12_14_17_13_54/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov323512/plugins/profile/2020_12_14_17_13_54/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov323512/plugins/profile/2020_12_14_17_13_54/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov323512/plugins/profile/2020_12_14_17_13_54/householder.kernel_stats.pb

Epoch 1, Loss: 0.35388511419296265, Train Accuracy: 89.33460235595703,Test Loss: 0.15180395543575287, Test Accuracy: 95.45000457763672
Time for Epoch:58.42777633666992
Average single batch time this epoch: 0.48836882094032746
Epoch 2, Loss: 0.11582426726818085, Train Accuracy: 96.40258026123047,Test Loss: 0.1152084693312645, Test Accuracy: 96.35000610351562
Running Average Epoch time: 55.88015866279602

Time for Epoch:55.88015866279602
Average single batch time this epoch: 0.46967370489723664
Epoch 3, Loss: 0.07636161893606186, Train Accuracy: 97.62620544433594,Test Loss: 0.09474432468414307, Test Accuracy: 97.12999725341797
Running Average Epoch time: 55.10408926010132

Time for Epoch:54.328019857406616
Average single batch time this epoch: 0.45600010798527646
Epoch 4, Loss: 0.06241883337497711, Train Accuracy: 98.01014709472656,Test Loss: 0.10150130093097687, Test Accuracy: 97.13999938964844
Running Average Epoch time: 54.85781637827555

Time for Epoch:54.36527061462402
Average single batch time this epoch: 0.4574121634165446
Epoch 5, Loss: 0.05147188901901245, Train Accuracy: 98.3390121459961,Test Loss: 0.10723806172609329, Test Accuracy: 97.20999908447266
Running Average Epoch time: 54.18219697475433

Time for Epoch:52.155338764190674
Average single batch time this epoch: 0.4387628930246728
Average time per Batch: 0.4554622173309326
Average time per Epoch: 54.18219697475433
2020-12-14 17:13:59.261253: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:13:59.819180: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:13:59.819622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:13:59.820660: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:13:59.820821: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:13:59.820946: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:13:59.821067: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:13:59.821190: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:13:59.821310: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:13:59.821432: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:13:59.821458: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:13:59.856338: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:13:59.860136: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3a88000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:13:59.860204: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:13:59.865482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:13:59.865519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:13:59.942270: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:13:59.942403: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:13:59.942669: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:13:59.942699: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:13:59.942717: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:13:59.942753: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:13:59.942795: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:13:59.942818: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:13:59.942833: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3b265ced30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:19:12.001887: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:19:12.254598: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:19:12.698638: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov333512/plugins/profile/2020_12_14_17_19_12
2020-12-14 17:19:13.130417: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov333512/plugins/profile/2020_12_14_17_19_12/householder.trace.json.gz
2020-12-14 17:19:13.227148: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:19:13.257615: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:19:13.259722: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov333512/plugins/profile/2020_12_14_17_19_12Dumped tool data for overview_page.pb to all_threads_smirnov333512/plugins/profile/2020_12_14_17_19_12/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov333512/plugins/profile/2020_12_14_17_19_12/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov333512/plugins/profile/2020_12_14_17_19_12/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov333512/plugins/profile/2020_12_14_17_19_12/householder.kernel_stats.pb

Epoch 1, Loss: 3735446528.0, Train Accuracy: 9.944244384765625,Test Loss: 3397484288.0, Test Accuracy: 10.019999504089355
Time for Epoch:62.86986422538757
Average single batch time this epoch: 0.5275405798202906
Epoch 2, Loss: 1812199040.0, Train Accuracy: 9.9893159866333,Test Loss: 1380561792.0, Test Accuracy: 9.9399995803833
Running Average Epoch time: 62.666306495666504

Time for Epoch:62.666306495666504
Average single batch time this epoch: 0.526989749354175
Epoch 3, Loss: 2648053248.0, Train Accuracy: 9.942574501037598,Test Loss: 3987201792.0, Test Accuracy: 9.84999942779541
Running Average Epoch time: 62.022966742515564

Time for Epoch:61.379626989364624
Average single batch time this epoch: 0.5158949652288713
Epoch 4, Loss: 8549221376.0, Train Accuracy: 10.089476585388184,Test Loss: 10248551424.0, Test Accuracy: 9.600000381469727
Running Average Epoch time: 61.65349872907003

Time for Epoch:60.914562702178955
Average single batch time this epoch: 0.5137868192460802
Epoch 5, Loss: 18802057216.0, Train Accuracy: 9.962607383728027,Test Loss: 19018088448.0, Test Accuracy: 9.84999942779541
Running Average Epoch time: 62.282069623470306

Time for Epoch:64.16778230667114
Average single batch time this epoch: 0.5403429402245415
Average time per Batch: 0.524253618513417
Average time per Epoch: 62.282069623470306
2020-12-14 17:19:16.641228: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:19:17.126814: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:19:17.127235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:19:17.128270: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:19:17.128445: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:19:17.128573: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:19:17.128697: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:19:17.128824: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:19:17.128949: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:19:17.129071: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:19:17.129096: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:19:17.164127: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:19:17.168233: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe358000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:19:17.168310: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:19:17.173968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:19:17.174008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:19:17.251714: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:19:17.251861: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:19:17.252107: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:19:17.252137: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:19:17.252155: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:19:17.252190: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:19:17.252256: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:19:17.252283: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:19:17.252300: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fe3f7d97ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:23:17.658867: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:23:17.848362: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:23:18.300474: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov334512/plugins/profile/2020_12_14_17_23_17
2020-12-14 17:23:18.751393: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov334512/plugins/profile/2020_12_14_17_23_17/householder.trace.json.gz
2020-12-14 17:23:18.851917: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:23:18.883412: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2020-12-14 17:23:18.885702: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov334512/plugins/profile/2020_12_14_17_23_17Dumped tool data for overview_page.pb to all_threads_smirnov334512/plugins/profile/2020_12_14_17_23_17/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov334512/plugins/profile/2020_12_14_17_23_17/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov334512/plugins/profile/2020_12_14_17_23_17/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov334512/plugins/profile/2020_12_14_17_23_17/householder.kernel_stats.pb

Epoch 1, Loss: 0.34490829706192017, Train Accuracy: 89.66346740722656,Test Loss: 0.14226345717906952, Test Accuracy: 95.80000305175781
Time for Epoch:48.74331283569336
Average single batch time this epoch: 0.4061095164372371
Epoch 2, Loss: 0.11174362897872925, Train Accuracy: 96.64128875732422,Test Loss: 0.1055484488606453, Test Accuracy: 96.66000366210938
Running Average Epoch time: 49.58590888977051

Time for Epoch:49.58590888977051
Average single batch time this epoch: 0.4173696937724056
Epoch 3, Loss: 0.07297370582818985, Train Accuracy: 97.666259765625,Test Loss: 0.10031305253505707, Test Accuracy: 96.97000122070312
Running Average Epoch time: 48.658581614494324

Time for Epoch:47.73125433921814
Average single batch time this epoch: 0.4003098581591223
Epoch 4, Loss: 0.059221480041742325, Train Accuracy: 98.11031341552734,Test Loss: 0.11149541288614273, Test Accuracy: 96.94000244140625
Running Average Epoch time: 48.31580479939779

Time for Epoch:47.63025116920471
Average single batch time this epoch: 0.4007075158958761
Epoch 5, Loss: 0.04378059506416321, Train Accuracy: 98.61444854736328,Test Loss: 0.12671799957752228, Test Accuracy: 96.68000030517578
Running Average Epoch time: 47.89858913421631

Time for Epoch:46.646942138671875
Average single batch time this epoch: 0.3906483018500173
Average time per Batch: 0.40225884241935533
Average time per Epoch: 47.89858913421631
2020-12-14 17:23:22.341115: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:23:22.868122: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:23:22.868545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:23:22.868921: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:23:22.869099: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:23:22.869268: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:23:22.869438: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:23:22.869588: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:23:22.869740: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:23:22.869889: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:23:22.869917: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:23:22.908229: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:23:22.912590: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fafd8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:23:22.912649: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:23:22.918248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:23:22.918294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:23:22.983063: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:23:22.983185: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:23:22.983409: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:23:22.983433: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:23:22.983470: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:23:22.983499: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:23:22.983533: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:23:22.983553: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:23:22.983564: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fb07a010d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:26:26.225328: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:26:26.428625: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:26:26.847173: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov442512/plugins/profile/2020_12_14_17_26_26
2020-12-14 17:26:27.276068: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov442512/plugins/profile/2020_12_14_17_26_26/householder.trace.json.gz
2020-12-14 17:26:27.370961: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:26:27.400260: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:26:27.402311: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov442512/plugins/profile/2020_12_14_17_26_26Dumped tool data for overview_page.pb to all_threads_smirnov442512/plugins/profile/2020_12_14_17_26_26/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov442512/plugins/profile/2020_12_14_17_26_26/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov442512/plugins/profile/2020_12_14_17_26_26/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov442512/plugins/profile/2020_12_14_17_26_26/householder.kernel_stats.pb

Epoch 1, Loss: 0.3395531475543976, Train Accuracy: 89.83206939697266,Test Loss: 0.13333238661289215, Test Accuracy: 95.99000549316406
Time for Epoch:37.08802342414856
Average single batch time this epoch: 0.31045779611310387
Epoch 2, Loss: 0.10701220482587814, Train Accuracy: 96.76482391357422,Test Loss: 0.10885652899742126, Test Accuracy: 96.77000427246094
Running Average Epoch time: 35.988731145858765

Time for Epoch:35.988731145858765
Average single batch time this epoch: 0.30304832743783283
Epoch 3, Loss: 0.0718170553445816, Train Accuracy: 97.77644348144531,Test Loss: 0.11319044232368469, Test Accuracy: 96.66999816894531
Running Average Epoch time: 35.87328767776489

Time for Epoch:35.75784420967102
Average single batch time this epoch: 0.30054342237293213
Epoch 4, Loss: 0.05884673818945885, Train Accuracy: 98.16539764404297,Test Loss: 0.088636614382267, Test Accuracy: 97.57999420166016
Running Average Epoch time: 36.14163597424825

Time for Epoch:36.678332567214966
Average single batch time this epoch: 0.30817361570831037
Epoch 5, Loss: 0.042728241533041, Train Accuracy: 98.61277770996094,Test Loss: 0.12442812323570251, Test Accuracy: 96.6300048828125
Running Average Epoch time: 36.52211910486221

Time for Epoch:37.6635684967041
Average single batch time this epoch: 0.3176688312465309
Average time per Batch: 0.3073585491914016
Average time per Epoch: 36.52211910486221
2020-12-14 17:26:30.848767: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:26:31.367908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:26:31.368306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:26:31.369084: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:26:31.369200: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:26:31.369297: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:26:31.369393: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:26:31.369492: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:26:31.369605: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:26:31.369701: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:26:31.369719: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:26:31.408151: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:26:31.410974: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f10e8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:26:31.411034: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:26:31.415531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:26:31.415569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:26:31.480566: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:26:31.480677: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:26:31.480908: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:26:31.480932: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:26:31.480947: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:26:31.480974: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:26:31.481022: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:26:31.481044: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:26:31.481074: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f117ffd5ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:31:23.723015: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:31:23.929942: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:31:24.391275: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov444512/plugins/profile/2020_12_14_17_31_24
2020-12-14 17:31:24.861520: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov444512/plugins/profile/2020_12_14_17_31_24/householder.trace.json.gz
2020-12-14 17:31:24.977134: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:31:25.014198: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:31:25.016737: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov444512/plugins/profile/2020_12_14_17_31_24Dumped tool data for overview_page.pb to all_threads_smirnov444512/plugins/profile/2020_12_14_17_31_24/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov444512/plugins/profile/2020_12_14_17_31_24/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov444512/plugins/profile/2020_12_14_17_31_24/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov444512/plugins/profile/2020_12_14_17_31_24/householder.kernel_stats.pb

Epoch 1, Loss: 0.3440379500389099, Train Accuracy: 89.6534423828125,Test Loss: 0.14352436363697052, Test Accuracy: 95.70000457763672
Time for Epoch:58.70983266830444
Average single batch time this epoch: 0.49395134713914657
Epoch 2, Loss: 0.10967583954334259, Train Accuracy: 96.67634582519531,Test Loss: 0.10919053852558136, Test Accuracy: 96.41999816894531
Running Average Epoch time: 58.858471632003784

Time for Epoch:58.858471632003784
Average single batch time this epoch: 0.4961537051404643
Epoch 3, Loss: 0.07421814650297165, Train Accuracy: 97.67628479003906,Test Loss: 0.1131460964679718, Test Accuracy: 96.7300033569336
Running Average Epoch time: 58.23177886009216

Time for Epoch:57.60508608818054
Average single batch time this epoch: 0.48669902279845667
Epoch 4, Loss: 0.06032498553395271, Train Accuracy: 98.12199401855469,Test Loss: 0.10160935670137405, Test Accuracy: 97.18000030517578
Running Average Epoch time: 58.55616601308187

Time for Epoch:59.20494031906128
Average single batch time this epoch: 0.5007169919136243
Epoch 5, Loss: 0.04075261205434799, Train Accuracy: 98.70459747314453,Test Loss: 0.11261288821697235, Test Accuracy: 97.08999633789062
Running Average Epoch time: 58.36847281455994

Time for Epoch:57.80539321899414
Average single batch time this epoch: 0.48893292744954425
Average time per Batch: 0.49312566182552237
Average time per Epoch: 58.36847281455994
2020-12-14 17:31:28.600905: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:31:29.122849: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:31:29.123253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:31:29.124267: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:31:29.124423: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:31:29.124547: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:31:29.124669: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:31:29.124800: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:31:29.124921: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:31:29.125042: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:31:29.125081: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:31:29.160374: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:31:29.165584: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa014000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:31:29.165650: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:31:29.169674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:31:29.169715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:31:29.242185: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:31:29.242300: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:31:29.242608: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:31:29.242639: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:31:29.242657: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:31:29.242693: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:31:29.242737: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:31:29.242761: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:31:29.242775: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa0b70dad30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:36:07.678564: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:36:07.861572: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:36:08.297715: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov552512/plugins/profile/2020_12_14_17_36_07
2020-12-14 17:36:08.734026: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov552512/plugins/profile/2020_12_14_17_36_07/householder.trace.json.gz
2020-12-14 17:36:08.829209: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:36:08.859457: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:36:08.861664: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov552512/plugins/profile/2020_12_14_17_36_07Dumped tool data for overview_page.pb to all_threads_smirnov552512/plugins/profile/2020_12_14_17_36_07/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov552512/plugins/profile/2020_12_14_17_36_07/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov552512/plugins/profile/2020_12_14_17_36_07/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov552512/plugins/profile/2020_12_14_17_36_07/householder.kernel_stats.pb

Epoch 1, Loss: 0.33116355538368225, Train Accuracy: 90.17093658447266,Test Loss: 0.13853229582309723, Test Accuracy: 95.74000549316406
Time for Epoch:58.486374378204346
Average single batch time this epoch: 0.48983560871874166
Epoch 2, Loss: 0.10745637118816376, Train Accuracy: 96.71641540527344,Test Loss: 0.10046486556529999, Test Accuracy: 96.86000061035156
Running Average Epoch time: 56.706324100494385

Time for Epoch:56.706324100494385
Average single batch time this epoch: 0.4757045293465639
Epoch 3, Loss: 0.06857556849718094, Train Accuracy: 97.87159729003906,Test Loss: 0.09742861241102219, Test Accuracy: 97.29000091552734
Running Average Epoch time: 55.7345974445343

Time for Epoch:54.76287078857422
Average single batch time this epoch: 0.4592971822135469
Epoch 4, Loss: 0.058461993932724, Train Accuracy: 98.1537094116211,Test Loss: 0.09703004360198975, Test Accuracy: 97.40999603271484
Running Average Epoch time: 55.15825112660726

Time for Epoch:54.005558490753174
Average single batch time this epoch: 0.4554175454327184
Epoch 5, Loss: 0.04299966245889664, Train Accuracy: 98.67955780029297,Test Loss: 0.09348459541797638, Test Accuracy: 97.55999755859375
Running Average Epoch time: 54.965037763118744

Time for Epoch:54.3853976726532
Average single batch time this epoch: 0.455387908169347
Average time per Batch: 0.4614517912905441
Average time per Epoch: 54.965037763118744
2020-12-14 17:36:12.195648: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:36:12.715372: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:36:12.715876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:36:12.716775: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:36:12.716920: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:36:12.717043: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:36:12.717165: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:36:12.717287: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:36:12.717408: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:36:12.717529: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:36:12.717552: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:36:12.752249: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:36:12.756492: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5b64000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:36:12.756559: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:36:12.760129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:36:12.760167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:36:12.834723: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:36:12.834839: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:36:12.835083: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:36:12.835111: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:36:12.835128: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:36:12.835161: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:36:12.835202: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:36:12.835226: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:36:12.835241: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5c01f6eca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:41:35.694296: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:41:35.943436: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:41:36.395028: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov555512/plugins/profile/2020_12_14_17_41_36
2020-12-14 17:41:36.823478: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov555512/plugins/profile/2020_12_14_17_41_36/householder.trace.json.gz
2020-12-14 17:41:36.914159: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:41:36.943366: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:41:36.945504: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov555512/plugins/profile/2020_12_14_17_41_36Dumped tool data for overview_page.pb to all_threads_smirnov555512/plugins/profile/2020_12_14_17_41_36/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov555512/plugins/profile/2020_12_14_17_41_36/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov555512/plugins/profile/2020_12_14_17_41_36/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov555512/plugins/profile/2020_12_14_17_41_36/householder.kernel_stats.pb

Epoch 1, Loss: 0.345660924911499, Train Accuracy: 89.55828857421875,Test Loss: 0.13696904480457306, Test Accuracy: 95.87000274658203
Time for Epoch:66.19833731651306
Average single batch time this epoch: 0.5565181287944826
Epoch 2, Loss: 0.11019174754619598, Train Accuracy: 96.65464782714844,Test Loss: 0.09810914099216461, Test Accuracy: 96.93000030517578
Running Average Epoch time: 64.92297720909119

Time for Epoch:64.92297720909119
Average single batch time this epoch: 0.5440646196023012
Epoch 3, Loss: 0.07310245931148529, Train Accuracy: 97.718017578125,Test Loss: 0.11010092496871948, Test Accuracy: 96.86000061035156
Running Average Epoch time: 64.41730463504791

Time for Epoch:63.91163206100464
Average single batch time this epoch: 0.5401721917665921
Epoch 4, Loss: 0.059884317219257355, Train Accuracy: 98.13201141357422,Test Loss: 0.09691449254751205, Test Accuracy: 97.2699966430664
Running Average Epoch time: 64.41092403729756

Time for Epoch:64.39816284179688
Average single batch time this epoch: 0.54131759945144
Epoch 5, Loss: 0.047525543719530106, Train Accuracy: 98.49092102050781,Test Loss: 0.11343586444854736, Test Accuracy: 97.06999969482422
Running Average Epoch time: 64.15158301591873

Time for Epoch:63.37355995178223
Average single batch time this epoch: 0.5357448504521296
Average time per Batch: 0.5403248153181157
Average time per Epoch: 64.15158301591873
2020-12-14 17:41:40.359810: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:41:40.891992: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:41:40.892441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:41:40.893278: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:41:40.893418: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:41:40.893557: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:41:40.893677: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:41:40.893803: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:41:40.893925: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:41:40.894046: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:41:40.894070: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:41:40.936147: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:41:40.939055: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f76d8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:41:40.939109: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:41:40.943643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:41:40.943681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:41:41.043741: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:41:41.043888: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:41:41.044181: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:41:41.044229: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:41:41.044248: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:41:41.044284: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:41:41.044326: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:41:41.044350: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:41:41.044365: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f776ec01ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:45:52.176949: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:45:52.327149: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:45:52.548068: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_bini3221024/plugins/profile/2020_12_14_17_45_52
2020-12-14 17:45:52.764315: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_bini3221024/plugins/profile/2020_12_14_17_45_52/householder.trace.json.gz
2020-12-14 17:45:52.808381: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:45:52.823228: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:45:52.825168: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_bini3221024/plugins/profile/2020_12_14_17_45_52Dumped tool data for overview_page.pb to all_threads_bini3221024/plugins/profile/2020_12_14_17_45_52/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_bini3221024/plugins/profile/2020_12_14_17_45_52/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_bini3221024/plugins/profile/2020_12_14_17_45_52/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_bini3221024/plugins/profile/2020_12_14_17_45_52/householder.kernel_stats.pb

Epoch 1, Loss: 0.5370376706123352, Train Accuracy: 84.50801086425781,Test Loss: 0.1307804137468338, Test Accuracy: 96.12000274658203
Time for Epoch:51.0013861656189
Average single batch time this epoch: 0.8515719380872003
Epoch 2, Loss: 0.10360909253358841, Train Accuracy: 96.91204071044922,Test Loss: 0.09831760078668594, Test Accuracy: 96.87999725341797
Running Average Epoch time: 49.0415985584259

Time for Epoch:49.0415985584259
Average single batch time this epoch: 0.820706400377997
Epoch 3, Loss: 0.06891418993473053, Train Accuracy: 97.86671447753906,Test Loss: 0.09237994253635406, Test Accuracy: 97.18000030517578
Running Average Epoch time: 49.67012619972229

Time for Epoch:50.29865384101868
Average single batch time this epoch: 0.8433565271311793
Epoch 4, Loss: 0.04388176649808884, Train Accuracy: 98.66816711425781,Test Loss: 0.11956027895212173, Test Accuracy: 96.62000274658203
Running Average Epoch time: 49.90768154462179

Time for Epoch:50.382792234420776
Average single batch time this epoch: 0.844784769518622
Epoch 5, Loss: 0.034011110663414, Train Accuracy: 98.89715576171875,Test Loss: 0.12617933750152588, Test Accuracy: 96.59000396728516
Running Average Epoch time: 50.01854461431503

Time for Epoch:50.351133823394775
Average single batch time this epoch: 0.8424584577823507
Average time per Batch: 0.8378265387025373
Average time per Epoch: 50.01854461431503
2020-12-14 17:45:56.333678: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:45:56.849006: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:45:56.849492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:45:56.849894: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:45:56.850094: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:45:56.850281: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:45:56.850466: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:45:56.850683: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:45:56.850866: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:45:56.851052: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:45:56.851086: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:45:56.892141: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:45:56.896331: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f98dc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:45:56.896406: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:45:56.900498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:45:56.900530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:45:56.992452: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:45:56.992580: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:45:56.992840: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:45:56.992869: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:45:56.992887: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:45:56.992921: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:45:56.992997: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:45:56.993023: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:45:56.993038: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f997035ad30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:47:38.951696: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:47:39.156306: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:47:39.379278: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_dgemm1024/plugins/profile/2020_12_14_17_47_39
2020-12-14 17:47:39.598242: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_dgemm1024/plugins/profile/2020_12_14_17_47_39/householder.trace.json.gz
2020-12-14 17:47:39.641464: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:47:39.656060: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:47:39.657958: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_dgemm1024/plugins/profile/2020_12_14_17_47_39Dumped tool data for overview_page.pb to all_threads_dgemm1024/plugins/profile/2020_12_14_17_47_39/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_dgemm1024/plugins/profile/2020_12_14_17_47_39/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_dgemm1024/plugins/profile/2020_12_14_17_47_39/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_dgemm1024/plugins/profile/2020_12_14_17_47_39/householder.kernel_stats.pb

Epoch 1, Loss: 0.5344979763031006, Train Accuracy: 84.57367706298828,Test Loss: 0.12802721560001373, Test Accuracy: 96.17000579833984
Time for Epoch:22.056453227996826
Average single batch time this epoch: 0.36622416973114014
Epoch 2, Loss: 0.10222940146923065, Train Accuracy: 96.96255493164062,Test Loss: 0.10170026868581772, Test Accuracy: 96.77999877929688
Running Average Epoch time: 19.976978540420532

Time for Epoch:19.976978540420532
Average single batch time this epoch: 0.3344151685977804
Epoch 3, Loss: 0.06832464039325714, Train Accuracy: 97.84651184082031,Test Loss: 0.08754204958677292, Test Accuracy: 97.19000244140625
Running Average Epoch time: 20.009872555732727

Time for Epoch:20.042766571044922
Average single batch time this epoch: 0.33571145452302076
Epoch 4, Loss: 0.04254328832030296, Train Accuracy: 98.68669128417969,Test Loss: 0.12889622151851654, Test Accuracy: 96.52999877929688
Running Average Epoch time: 19.964385827382404

Time for Epoch:19.873412370681763
Average single batch time this epoch: 0.33033166260554875
Epoch 5, Loss: 0.03658837825059891, Train Accuracy: 98.78266143798828,Test Loss: 0.10114288330078125, Test Accuracy: 97.13999938964844
Running Average Epoch time: 19.961139380931854

Time for Epoch:19.9514000415802
Average single batch time this epoch: 0.3351193378711569
Average time per Batch: 0.3338944058993767
Average time per Epoch: 19.961139380931854
2020-12-14 17:47:43.041186: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:47:43.547986: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:47:43.548478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:47:43.548934: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:43.549124: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:43.549306: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:43.549484: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:43.549668: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:43.549844: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:43.550046: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:43.550081: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:47:43.592068: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:47:43.595153: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3f94000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:47:43.595211: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:47:43.599089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:47:43.599122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:47:43.690869: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:47:43.691003: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:47:43.691299: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:43.691330: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:47:43.691348: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:47:43.691383: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:47:43.691433: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:47:43.691458: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:47:43.691473: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

Traceback (most recent call last):
  File "tensorboard_test.py", line 182, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:97 train_step  *
        predictions = model(images)
    tensorboard_test.py:86 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:67 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2020-12-14 17:47:44.406610: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:47:47.538615: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:47:48.027379: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:47:48.027868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:47:48.028320: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:48.028548: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:48.028742: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:48.028911: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:48.029080: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:48.029248: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:48.029419: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:48.029451: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:47:48.068176: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:47:48.071957: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4d94000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:47:48.072030: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:47:48.076350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:47:48.076395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:47:48.171925: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:47:48.172074: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:47:48.172361: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:47:48.172392: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:47:48.172410: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:47:48.172446: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:47:48.172487: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:47:48.172511: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:47:48.172526: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4e342a2d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:52:33.335335: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:52:33.521624: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:52:33.739341: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_schonhage3331024/plugins/profile/2020_12_14_17_52_33
2020-12-14 17:52:33.959074: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_schonhage3331024/plugins/profile/2020_12_14_17_52_33/householder.trace.json.gz
2020-12-14 17:52:34.003594: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:52:34.018774: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:52:34.020628: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_schonhage3331024/plugins/profile/2020_12_14_17_52_33Dumped tool data for overview_page.pb to all_threads_schonhage3331024/plugins/profile/2020_12_14_17_52_33/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_schonhage3331024/plugins/profile/2020_12_14_17_52_33/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_schonhage3331024/plugins/profile/2020_12_14_17_52_33/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_schonhage3331024/plugins/profile/2020_12_14_17_52_33/householder.kernel_stats.pb

Epoch 1, Loss: 0.5285235047340393, Train Accuracy: 84.70669555664062,Test Loss: 0.1306285560131073, Test Accuracy: 96.20000457763672
Time for Epoch:59.63594603538513
Average single batch time this epoch: 1.0011666191035304
Epoch 2, Loss: 0.10154895484447479, Train Accuracy: 96.95750427246094,Test Loss: 0.09977365285158157, Test Accuracy: 96.95999908447266
Running Average Epoch time: 56.943159341812134

Time for Epoch:56.943159341812134
Average single batch time this epoch: 0.9591436262788444
Epoch 3, Loss: 0.06559032201766968, Train Accuracy: 98.00646209716797,Test Loss: 0.08671946078538895, Test Accuracy: 97.39999389648438
Running Average Epoch time: 56.61246740818024

Time for Epoch:56.28177547454834
Average single batch time this epoch: 0.947817481797317
Epoch 4, Loss: 0.04486807435750961, Train Accuracy: 98.57051086425781,Test Loss: 0.13462553918361664, Test Accuracy: 96.18000030517578
Running Average Epoch time: 56.60742743810018

Time for Epoch:56.59734749794006
Average single batch time this epoch: 0.9528223728311473
Epoch 5, Loss: 0.03563527762889862, Train Accuracy: 98.80118560791016,Test Loss: 0.10937314480543137, Test Accuracy: 97.15999603271484
Running Average Epoch time: 56.36482959985733

Time for Epoch:55.637036085128784
Average single batch time this epoch: 0.9335526597910914
Average time per Batch: 0.9483340351746
Average time per Epoch: 56.36482959985733
2020-12-14 17:52:37.658240: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:52:38.186786: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:52:38.187171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:52:38.187527: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:52:38.187685: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:52:38.187856: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:52:38.188018: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:52:38.188152: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:52:38.188285: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:52:38.188418: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:52:38.188444: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:52:38.232264: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:52:38.235472: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff198000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:52:38.235521: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:52:38.239825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:52:38.239866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:52:38.332964: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:52:38.333123: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:52:38.333428: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:52:38.333458: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:52:38.333496: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:52:38.333531: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:52:38.333599: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:52:38.333627: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:52:38.333642: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ff22c92cca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 17:57:01.076068: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:57:01.300642: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 17:57:01.522559: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2241024/plugins/profile/2020_12_14_17_57_01
2020-12-14 17:57:01.747066: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2241024/plugins/profile/2020_12_14_17_57_01/householder.trace.json.gz
2020-12-14 17:57:01.796725: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 17:57:01.812344: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 17:57:01.814237: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2241024/plugins/profile/2020_12_14_17_57_01Dumped tool data for overview_page.pb to all_threads_smirnov2241024/plugins/profile/2020_12_14_17_57_01/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2241024/plugins/profile/2020_12_14_17_57_01/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2241024/plugins/profile/2020_12_14_17_57_01/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2241024/plugins/profile/2020_12_14_17_57_01/householder.kernel_stats.pb

Epoch 1, Loss: 0.536230206489563, Train Accuracy: 84.54673767089844,Test Loss: 0.1301506906747818, Test Accuracy: 96.21000671386719
Time for Epoch:54.5775842666626
Average single batch time this epoch: 0.9138260956468254
Epoch 2, Loss: 0.10346560180187225, Train Accuracy: 96.91372680664062,Test Loss: 0.10310225933790207, Test Accuracy: 96.79000091552734
Running Average Epoch time: 51.70930552482605

Time for Epoch:51.70930552482605
Average single batch time this epoch: 0.8709390862234707
Epoch 3, Loss: 0.06729811429977417, Train Accuracy: 97.91722869873047,Test Loss: 0.08784995973110199, Test Accuracy: 97.29000091552734
Running Average Epoch time: 51.8148558139801

Time for Epoch:51.920406103134155
Average single batch time this epoch: 0.8732617887957342
Epoch 4, Loss: 0.04158937558531761, Train Accuracy: 98.72879028320312,Test Loss: 0.12912766635417938, Test Accuracy: 96.41999816894531
Running Average Epoch time: 51.8088808854421

Time for Epoch:51.79693102836609
Average single batch time this epoch: 0.8715342406568856
Epoch 5, Loss: 0.03388777747750282, Train Accuracy: 98.8836898803711,Test Loss: 0.10884101688861847, Test Accuracy: 97.25
Running Average Epoch time: 52.01873952150345

Time for Epoch:52.6483154296875
Average single batch time this epoch: 0.8864594122459148
Average time per Batch: 0.8755486319805013
Average time per Epoch: 52.01873952150345
2020-12-14 17:57:05.383607: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 17:57:05.891336: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 17:57:05.891816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 17:57:05.892236: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:57:05.892407: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:57:05.892566: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:57:05.892721: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:57:05.892881: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:57:05.893063: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:57:05.893220: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:57:05.893249: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 17:57:05.936259: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 17:57:05.939587: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff978000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 17:57:05.939637: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 17:57:05.943648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 17:57:05.943682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 17:57:06.037272: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:57:06.037404: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 17:57:06.037683: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 17:57:06.037713: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:57:06.037731: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:57:06.037765: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:57:06.037814: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 17:57:06.037838: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 17:57:06.037875: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ffa12f3aca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:01:48.202213: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:01:48.384360: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:01:48.600411: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2251024/plugins/profile/2020_12_14_18_01_48
2020-12-14 18:01:48.830187: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2251024/plugins/profile/2020_12_14_18_01_48/householder.trace.json.gz
2020-12-14 18:01:48.879838: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:01:48.895488: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:01:48.897507: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2251024/plugins/profile/2020_12_14_18_01_48Dumped tool data for overview_page.pb to all_threads_smirnov2251024/plugins/profile/2020_12_14_18_01_48/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2251024/plugins/profile/2020_12_14_18_01_48/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2251024/plugins/profile/2020_12_14_18_01_48/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2251024/plugins/profile/2020_12_14_18_01_48/householder.kernel_stats.pb

Epoch 1, Loss: 0.6186543107032776, Train Accuracy: 82.07839965820312,Test Loss: 0.1616557538509369, Test Accuracy: 94.80000305175781
Time for Epoch:59.85901951789856
Average single batch time this epoch: 1.006824908585384
Epoch 2, Loss: 0.1301894187927246, Train Accuracy: 96.01966857910156,Test Loss: 0.10830149054527283, Test Accuracy: 96.59000396728516
Running Average Epoch time: 56.71436429023743

Time for Epoch:56.71436429023743
Average single batch time this epoch: 0.9580976839723259
Epoch 3, Loss: 0.08514335006475449, Train Accuracy: 97.3211898803711,Test Loss: 0.09801417589187622, Test Accuracy: 97.1199951171875
Running Average Epoch time: 56.1016321182251

Time for Epoch:55.48889994621277
Average single batch time this epoch: 0.9360644611819037
Epoch 4, Loss: 0.06252104789018631, Train Accuracy: 97.99636840820312,Test Loss: 0.11096242815256119, Test Accuracy: 96.76000213623047
Running Average Epoch time: 56.05023725827535

Time for Epoch:55.947447538375854
Average single batch time this epoch: 0.9419256900918895
Epoch 5, Loss: 0.05211648717522621, Train Accuracy: 98.30785369873047,Test Loss: 0.13716740906238556, Test Accuracy: 96.0300064086914
Running Average Epoch time: 55.56368190050125

Time for Epoch:54.104015827178955
Average single batch time this epoch: 0.9123978450380522
Average time per Batch: 0.9371214200710429
Average time per Epoch: 55.56368190050125
2020-12-14 18:01:52.435090: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:01:52.960787: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:01:52.961268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:01:52.961722: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:01:52.961905: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:01:52.962084: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:01:52.962240: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:01:52.962396: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:01:52.962551: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:01:52.962705: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:01:52.962758: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:01:53.008260: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:01:53.011532: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6b64000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:01:53.011610: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:01:53.016782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:01:53.016828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:01:53.112276: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:01:53.112410: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:01:53.112690: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:01:53.112722: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:01:53.112742: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:01:53.112779: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:01:53.112823: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:01:53.112848: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:01:53.112863: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f6bf9edbca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:06:33.714109: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:06:33.888193: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:06:34.102376: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2721024/plugins/profile/2020_12_14_18_06_33
2020-12-14 18:06:34.317727: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2721024/plugins/profile/2020_12_14_18_06_33/householder.trace.json.gz
2020-12-14 18:06:34.362591: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:06:34.377518: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:06:34.379421: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2721024/plugins/profile/2020_12_14_18_06_33Dumped tool data for overview_page.pb to all_threads_smirnov2721024/plugins/profile/2020_12_14_18_06_33/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2721024/plugins/profile/2020_12_14_18_06_33/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2721024/plugins/profile/2020_12_14_18_06_33/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2721024/plugins/profile/2020_12_14_18_06_33/householder.kernel_stats.pb

Epoch 1, Loss: 390100320.0, Train Accuracy: 10.294316291809082,Test Loss: 421266592.0, Test Accuracy: 10.279999732971191
Time for Epoch:60.88827919960022
Average single batch time this epoch: 1.0164665682562466
Epoch 2, Loss: 377486720.0, Train Accuracy: 11.062095642089844,Test Loss: 314763296.0, Test Accuracy: 11.739999771118164
Running Average Epoch time: 56.31046462059021

Time for Epoch:56.31046462059021
Average single batch time this epoch: 0.9452108226973435
Epoch 3, Loss: 226647040.0, Train Accuracy: 11.366850852966309,Test Loss: 141761552.0, Test Accuracy: 11.729999542236328
Running Average Epoch time: 55.65483593940735

Time for Epoch:54.99920725822449
Average single batch time this epoch: 0.9198882209843603
Epoch 4, Loss: 99325296.0, Train Accuracy: 10.829741477966309,Test Loss: 91280888.0, Test Accuracy: 10.300000190734863
Running Average Epoch time: 55.18929624557495

Time for Epoch:54.258216857910156
Average single batch time this epoch: 0.9099204375826079
Epoch 5, Loss: 72619888.0, Train Accuracy: 10.98969554901123,Test Loss: 58907936.0, Test Accuracy: 10.34000015258789
Running Average Epoch time: 54.914693117141724

Time for Epoch:54.09088373184204
Average single batch time this epoch: 0.9048811567240748
Average time per Batch: 0.9199751594970966
Average time per Epoch: 54.914693117141724
2020-12-14 18:06:37.848769: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:06:38.360635: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:06:38.361133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:06:38.361628: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:06:38.361826: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:06:38.362014: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:06:38.362197: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:06:38.362386: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:06:38.362569: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:06:38.362753: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:06:38.362787: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:06:38.408269: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:06:38.412042: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa518000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:06:38.412112: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:06:38.416330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:06:38.416365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:06:38.511726: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:06:38.511885: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:06:38.512179: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:06:38.512209: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:06:38.512228: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:06:38.512262: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:06:38.512306: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:06:38.512331: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:06:38.512346: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa5ac027ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:10:54.804710: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:10:55.010971: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:10:55.237753: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3231024/plugins/profile/2020_12_14_18_10_55
2020-12-14 18:10:55.457030: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3231024/plugins/profile/2020_12_14_18_10_55/householder.trace.json.gz
2020-12-14 18:10:55.502746: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:10:55.518120: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:10:55.519992: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3231024/plugins/profile/2020_12_14_18_10_55Dumped tool data for overview_page.pb to all_threads_smirnov3231024/plugins/profile/2020_12_14_18_10_55/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3231024/plugins/profile/2020_12_14_18_10_55/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3231024/plugins/profile/2020_12_14_18_10_55/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3231024/plugins/profile/2020_12_14_18_10_55/householder.kernel_stats.pb

Epoch 1, Loss: 0.5853928923606873, Train Accuracy: 82.93540954589844,Test Loss: 0.1443464159965515, Test Accuracy: 95.70999908447266
Time for Epoch:53.358510971069336
Average single batch time this epoch: 0.8906559039806498
Epoch 2, Loss: 0.11914276331663132, Train Accuracy: 96.39850616455078,Test Loss: 0.10295344144105911, Test Accuracy: 96.81999969482422
Running Average Epoch time: 52.695815563201904

Time for Epoch:52.695815563201904
Average single batch time this epoch: 0.8844366936848082
Epoch 3, Loss: 0.07560912519693375, Train Accuracy: 97.67813873291016,Test Loss: 0.0898643285036087, Test Accuracy: 97.11000061035156
Running Average Epoch time: 51.82870900630951

Time for Epoch:50.961602449417114
Average single batch time this epoch: 0.8546845214120273
Epoch 4, Loss: 0.05070041865110397, Train Accuracy: 98.4307632446289,Test Loss: 0.11010799556970596, Test Accuracy: 96.88999938964844
Running Average Epoch time: 50.82602349917094

Time for Epoch:48.8206524848938
Average single batch time this epoch: 0.8165144221536045
Epoch 5, Loss: 0.04094836488366127, Train Accuracy: 98.6883773803711,Test Loss: 0.1779942810535431, Test Accuracy: 95.68000030517578
Running Average Epoch time: 50.71574866771698

Time for Epoch:50.3849241733551
Average single batch time this epoch: 0.8439106489049977
Average time per Batch: 0.8498865715388593
Average time per Epoch: 50.71574866771698
2020-12-14 18:10:59.023114: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:10:59.535250: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:10:59.535636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:10:59.536016: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:10:59.536186: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:10:59.536372: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:10:59.536514: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:10:59.536653: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:10:59.536791: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:10:59.536931: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:10:59.536958: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:10:59.576154: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:10:59.579481: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f359c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:10:59.579537: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:10:59.584365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:10:59.584406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:10:59.679405: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:10:59.679549: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:10:59.679839: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:10:59.679894: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:10:59.679915: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:10:59.679950: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:10:59.679992: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:10:59.680017: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:10:59.680032: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3633ce3d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:15:35.073319: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:15:35.285686: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:15:35.496736: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3331024/plugins/profile/2020_12_14_18_15_35
2020-12-14 18:15:35.717596: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3331024/plugins/profile/2020_12_14_18_15_35/householder.trace.json.gz
2020-12-14 18:15:35.768938: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:15:35.784425: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:15:35.786348: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3331024/plugins/profile/2020_12_14_18_15_35Dumped tool data for overview_page.pb to all_threads_smirnov3331024/plugins/profile/2020_12_14_18_15_35/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3331024/plugins/profile/2020_12_14_18_15_35/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3331024/plugins/profile/2020_12_14_18_15_35/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3331024/plugins/profile/2020_12_14_18_15_35/householder.kernel_stats.pb

Epoch 1, Loss: 20215111680.0, Train Accuracy: 9.763940811157227,Test Loss: 30496442368.0, Test Accuracy: 9.660000801086426
Time for Epoch:58.21296525001526
Average single batch time this epoch: 0.976494472602318
Epoch 2, Loss: 39224791040.0, Train Accuracy: 9.992928504943848,Test Loss: 43676893184.0, Test Accuracy: 9.5600004196167
Running Average Epoch time: 56.52080512046814

Time for Epoch:56.52080512046814
Average single batch time this epoch: 0.9507189454703495
Epoch 3, Loss: 36467568640.0, Train Accuracy: 10.129310607910156,Test Loss: 25944350720.0, Test Accuracy: 9.619999885559082
Running Average Epoch time: 55.446444630622864

Time for Epoch:54.37208414077759
Average single batch time this epoch: 0.9131394213643568
Epoch 4, Loss: 31761467392.0, Train Accuracy: 10.068696022033691,Test Loss: 34449125376.0, Test Accuracy: 10.34000015258789
Running Average Epoch time: 55.09648005167643

Time for Epoch:54.39655089378357
Average single batch time this epoch: 0.9135747243618143
Epoch 5, Loss: 45360685056.0, Train Accuracy: 9.93062973022461,Test Loss: 55933956096.0, Test Accuracy: 9.859999656677246
Running Average Epoch time: 54.27582520246506

Time for Epoch:51.81386065483093
Average single batch time this epoch: 0.8683504112835588
Average time per Batch: 0.9114458756200198
Average time per Epoch: 54.27582520246506
2020-12-14 18:15:39.429844: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:15:39.960221: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:15:39.960614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:15:39.960970: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:15:39.961118: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:15:39.961255: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:15:39.961391: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:15:39.961555: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:15:39.961688: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:15:39.961824: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:15:39.961850: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:15:40.004256: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:15:40.008773: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6794000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:15:40.008879: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:15:40.013086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:15:40.013123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:15:40.112616: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:15:40.112749: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:15:40.113886: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:15:40.113925: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:15:40.113945: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:15:40.113985: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:15:40.114050: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:15:40.114076: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:15:40.114091: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f683338bd30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:19:03.409228: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:19:03.641204: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:19:03.874938: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3341024/plugins/profile/2020_12_14_18_19_03
2020-12-14 18:19:04.110502: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3341024/plugins/profile/2020_12_14_18_19_03/householder.trace.json.gz
2020-12-14 18:19:04.157040: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:19:04.173425: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:19:04.175462: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3341024/plugins/profile/2020_12_14_18_19_03Dumped tool data for overview_page.pb to all_threads_smirnov3341024/plugins/profile/2020_12_14_18_19_03/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3341024/plugins/profile/2020_12_14_18_19_03/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3341024/plugins/profile/2020_12_14_18_19_03/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3341024/plugins/profile/2020_12_14_18_19_03/householder.kernel_stats.pb

Epoch 1, Loss: 0.5640790462493896, Train Accuracy: 83.60553741455078,Test Loss: 0.14192113280296326, Test Accuracy: 95.70000457763672
Time for Epoch:43.519036054611206
Average single batch time this epoch: 0.7240408330128111
Epoch 2, Loss: 0.1084783524274826, Train Accuracy: 96.73693084716797,Test Loss: 0.10374721884727478, Test Accuracy: 96.86000061035156
Running Average Epoch time: 39.78976058959961

Time for Epoch:39.78976058959961
Average single batch time this epoch: 0.6664706139728941
Epoch 3, Loss: 0.07172483205795288, Train Accuracy: 97.71012878417969,Test Loss: 0.09591849893331528, Test Accuracy: 97.1500015258789
Running Average Epoch time: 39.450005531311035

Time for Epoch:39.11025047302246
Average single batch time this epoch: 0.6556210887843165
Epoch 4, Loss: 0.05166999623179436, Train Accuracy: 98.34152221679688,Test Loss: 0.13189862668514252, Test Accuracy: 96.26000213623047
Running Average Epoch time: 39.789253075917564

Time for Epoch:40.467748165130615
Average single batch time this epoch: 0.6799488026520302
Epoch 5, Loss: 0.03462713211774826, Train Accuracy: 98.92073059082031,Test Loss: 0.11953415721654892, Test Accuracy: 96.73999786376953
Running Average Epoch time: 39.931534349918365

Time for Epoch:40.358378171920776
Average single batch time this epoch: 0.6783651236830086
Average time per Batch: 0.6701014072730623
Average time per Epoch: 39.931534349918365
2020-12-14 18:19:07.629551: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:19:08.146923: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:19:08.147303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:19:08.147663: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:19:08.147834: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:19:08.147976: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:19:08.148113: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:19:08.148254: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:19:08.148392: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:19:08.148554: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:19:08.148580: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:19:08.192417: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:19:08.196376: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0808000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:19:08.196427: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:19:08.200656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:19:08.200691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:19:08.298924: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:19:08.299070: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:19:08.299358: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:19:08.299387: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:19:08.299405: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:19:08.299439: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:19:08.299498: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:19:08.299524: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:19:08.299540: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f08a7ee4ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:22:19.897376: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:22:20.095439: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:22:20.314695: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov4421024/plugins/profile/2020_12_14_18_22_20
2020-12-14 18:22:20.529712: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov4421024/plugins/profile/2020_12_14_18_22_20/householder.trace.json.gz
2020-12-14 18:22:20.572998: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:22:20.587368: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:22:20.589229: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov4421024/plugins/profile/2020_12_14_18_22_20Dumped tool data for overview_page.pb to all_threads_smirnov4421024/plugins/profile/2020_12_14_18_22_20/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov4421024/plugins/profile/2020_12_14_18_22_20/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov4421024/plugins/profile/2020_12_14_18_22_20/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov4421024/plugins/profile/2020_12_14_18_22_20/householder.kernel_stats.pb

Epoch 1, Loss: 0.5901598930358887, Train Accuracy: 82.97918701171875,Test Loss: 0.15046000480651855, Test Accuracy: 95.56000518798828
Time for Epoch:39.70146036148071
Average single batch time this epoch: 0.6636224820696074
Epoch 2, Loss: 0.11666661500930786, Train Accuracy: 96.43049621582031,Test Loss: 0.1059480607509613, Test Accuracy: 96.72000122070312
Running Average Epoch time: 38.676645040512085

Time for Epoch:38.676645040512085
Average single batch time this epoch: 0.649789732078026
Epoch 3, Loss: 0.07919611781835556, Train Accuracy: 97.50640106201172,Test Loss: 0.11522095650434494, Test Accuracy: 96.49000549316406
Running Average Epoch time: 38.17412745952606

Time for Epoch:37.67160987854004
Average single batch time this epoch: 0.632499649606902
Epoch 4, Loss: 0.05506962910294533, Train Accuracy: 98.29438018798828,Test Loss: 0.11297869682312012, Test Accuracy: 96.66999816894531
Running Average Epoch time: 38.226091066996254

Time for Epoch:38.330018281936646
Average single batch time this epoch: 0.6442251945364064
Epoch 5, Loss: 0.040606334805488586, Train Accuracy: 98.64291381835938,Test Loss: 0.11251584440469742, Test Accuracy: 96.98999786376953
Running Average Epoch time: 37.960594952106476

Time for Epoch:37.164106607437134
Average single batch time this epoch: 0.6224592513051527
Average time per Batch: 0.6372434568816218
Average time per Epoch: 37.960594952106476
2020-12-14 18:22:24.106793: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:22:24.607242: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:22:24.607678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:22:24.608122: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:22:24.608295: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:22:24.608454: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:22:24.608608: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:22:24.608768: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:22:24.608923: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:22:24.609078: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:22:24.609108: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:22:24.652096: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:22:24.655537: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3ce4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:22:24.655589: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:22:24.659991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:22:24.660027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:22:24.755121: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:22:24.755268: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:22:24.755541: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:22:24.755570: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:22:24.755587: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:22:24.755622: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:22:24.755663: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:22:24.755687: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:22:24.755701: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3d83724ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:26:21.886607: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:26:22.100183: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:26:22.320748: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov4441024/plugins/profile/2020_12_14_18_26_22
2020-12-14 18:26:22.555167: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov4441024/plugins/profile/2020_12_14_18_26_22/householder.trace.json.gz
2020-12-14 18:26:22.606872: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:26:22.623201: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:26:22.625233: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov4441024/plugins/profile/2020_12_14_18_26_22Dumped tool data for overview_page.pb to all_threads_smirnov4441024/plugins/profile/2020_12_14_18_26_22/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov4441024/plugins/profile/2020_12_14_18_26_22/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov4441024/plugins/profile/2020_12_14_18_26_22/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov4441024/plugins/profile/2020_12_14_18_26_22/householder.kernel_stats.pb

Epoch 1, Loss: 0.5910373330116272, Train Accuracy: 82.73841857910156,Test Loss: 0.1493801325559616, Test Accuracy: 95.44000244140625
Time for Epoch:50.18806767463684
Average single batch time this epoch: 0.8373777249763752
Epoch 2, Loss: 0.11595362424850464, Train Accuracy: 96.47258758544922,Test Loss: 0.1033431887626648, Test Accuracy: 96.86000061035156
Running Average Epoch time: 46.44632029533386

Time for Epoch:46.44632029533386
Average single batch time this epoch: 0.7788370971021981
Epoch 3, Loss: 0.07402987033128738, Train Accuracy: 97.70339965820312,Test Loss: 0.10972285270690918, Test Accuracy: 96.69000244140625
Running Average Epoch time: 46.349013805389404

Time for Epoch:46.251707315444946
Average single batch time this epoch: 0.7742612238588005
Epoch 4, Loss: 0.059578098356723785, Train Accuracy: 98.13105773925781,Test Loss: 0.10329465568065643, Test Accuracy: 96.7300033569336
Running Average Epoch time: 46.34297490119934

Time for Epoch:46.330897092819214
Average single batch time this epoch: 0.7796375628175407
Epoch 5, Loss: 0.045756228268146515, Train Accuracy: 98.51326751708984,Test Loss: 0.11933606117963791, Test Accuracy: 96.80000305175781
Running Average Epoch time: 46.71607834100723

Time for Epoch:47.83538866043091
Average single batch time this epoch: 0.8019316648614818
Average time per Batch: 0.7836668871600052
Average time per Epoch: 46.71607834100723
2020-12-14 18:26:26.195330: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:26:26.711897: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:26:26.712409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:26:26.712889: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:26:26.713127: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:26:26.713318: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:26:26.713504: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:26:26.713697: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:26:26.713883: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:26:26.714070: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:26:26.714104: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:26:26.756275: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:26:26.759690: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8ac4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:26:26.759765: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:26:26.763493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:26:26.763522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:26:26.853507: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:26:26.853676: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:26:26.853969: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:26:26.853998: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:26:26.854016: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:26:26.854050: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:26:26.854091: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:26:26.854115: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:26:26.854129: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8b65c7cca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:32:03.222980: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:32:03.318362: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:32:03.563379: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov5521024/plugins/profile/2020_12_14_18_32_03
2020-12-14 18:32:03.792104: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov5521024/plugins/profile/2020_12_14_18_32_03/householder.trace.json.gz
2020-12-14 18:32:03.839671: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:32:03.855291: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:32:03.857271: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov5521024/plugins/profile/2020_12_14_18_32_03Dumped tool data for overview_page.pb to all_threads_smirnov5521024/plugins/profile/2020_12_14_18_32_03/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov5521024/plugins/profile/2020_12_14_18_32_03/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov5521024/plugins/profile/2020_12_14_18_32_03/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov5521024/plugins/profile/2020_12_14_18_32_03/householder.kernel_stats.pb

Epoch 1, Loss: 0.567969560623169, Train Accuracy: 83.72003173828125,Test Loss: 0.1362762749195099, Test Accuracy: 95.79000091552734
Time for Epoch:70.9839837551117
Average single batch time this epoch: 1.1876939617354294
Epoch 2, Loss: 0.11141505837440491, Train Accuracy: 96.6375961303711,Test Loss: 0.10828068852424622, Test Accuracy: 96.52000427246094
Running Average Epoch time: 66.63955402374268

Time for Epoch:66.63955402374268
Average single batch time this epoch: 1.1176183552577579
Epoch 3, Loss: 0.07395928353071213, Train Accuracy: 97.71517944335938,Test Loss: 0.09972285479307175, Test Accuracy: 97.04000091552734
Running Average Epoch time: 66.76128625869751

Time for Epoch:66.88301849365234
Average single batch time this epoch: 1.1197979820185695
Epoch 4, Loss: 0.04825308918952942, Train Accuracy: 98.52000427246094,Test Loss: 0.11781928688287735, Test Accuracy: 96.56999969482422
Running Average Epoch time: 66.42369596163432

Time for Epoch:65.74851536750793
Average single batch time this epoch: 1.09896523376991
Epoch 5, Loss: 0.0339597649872303, Train Accuracy: 98.85506439208984,Test Loss: 0.1298002451658249, Test Accuracy: 96.77000427246094
Running Average Epoch time: 66.33272778987885

Time for Epoch:66.05982327461243
Average single batch time this epoch: 1.107229208124095
Average time per Batch: 1.110902694792583
Average time per Epoch: 66.33272778987885
2020-12-14 18:32:07.394248: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:32:07.896536: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:32:07.896961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:32:07.897369: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:32:07.897532: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:32:07.897684: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:32:07.897856: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:32:07.898007: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:32:07.898151: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:32:07.898300: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:32:07.898330: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:32:07.940159: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:32:07.943887: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fdd30000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:32:07.943936: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:32:07.948757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:32:07.948797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:32:08.048938: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:32:08.049078: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:32:08.049373: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:32:08.049404: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:32:08.049440: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:32:08.049477: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:32:08.049521: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:32:08.049545: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:32:08.049560: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fddcb5d4d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:38:00.296009: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:38:00.477362: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:38:00.704829: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov5551024/plugins/profile/2020_12_14_18_38_00
2020-12-14 18:38:00.940947: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov5551024/plugins/profile/2020_12_14_18_38_00/householder.trace.json.gz
2020-12-14 18:38:00.996319: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:38:01.013070: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:38:01.015134: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov5551024/plugins/profile/2020_12_14_18_38_00Dumped tool data for overview_page.pb to all_threads_smirnov5551024/plugins/profile/2020_12_14_18_38_00/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov5551024/plugins/profile/2020_12_14_18_38_00/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov5551024/plugins/profile/2020_12_14_18_38_00/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov5551024/plugins/profile/2020_12_14_18_38_00/householder.kernel_stats.pb

Epoch 1, Loss: 0.5867878198623657, Train Accuracy: 83.0499038696289,Test Loss: 0.14840549230575562, Test Accuracy: 95.41000366210938
Time for Epoch:74.30162024497986
Average single batch time this epoch: 1.2480257420704282
Epoch 2, Loss: 0.11613557487726212, Train Accuracy: 96.49279022216797,Test Loss: 0.10552967339754105, Test Accuracy: 96.75
Running Average Epoch time: 69.20178127288818

Time for Epoch:69.20178127288818
Average single batch time this epoch: 1.1591204199297676
Epoch 3, Loss: 0.0775146409869194, Train Accuracy: 97.57879638671875,Test Loss: 0.09611823409795761, Test Accuracy: 97.11000061035156
Running Average Epoch time: 69.59235453605652

Time for Epoch:69.98292779922485
Average single batch time this epoch: 1.1704744059464027
Epoch 4, Loss: 0.05555044114589691, Train Accuracy: 98.2421875,Test Loss: 0.1173902377486229, Test Accuracy: 96.72000122070312
Running Average Epoch time: 69.4627018769582

Time for Epoch:69.2033965587616
Average single batch time this epoch: 1.166597921272804
Epoch 5, Loss: 0.04437815770506859, Train Accuracy: 98.53515625,Test Loss: 0.09838169813156128, Test Accuracy: 97.30999755859375
Running Average Epoch time: 69.47400361299515

Time for Epoch:69.50790882110596
Average single batch time this epoch: 1.1717577720510548
Average time per Batch: 1.1669876298000073
Average time per Epoch: 69.47400361299515
2020-12-14 18:38:04.569884: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:38:05.083704: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:38:05.084204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:38:05.084598: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:38:05.084757: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:38:05.084907: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:38:05.085051: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:38:05.085204: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:38:05.085374: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:38:05.085522: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:38:05.085550: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:38:05.128292: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:38:05.130899: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa2c8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:38:05.130974: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:38:05.134771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:38:05.134803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:38:05.281554: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:38:05.281698: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:38:05.281979: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:38:05.282011: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:38:05.282030: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:38:05.282066: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:38:05.282111: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:38:05.282136: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:38:05.282151: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa363ba6ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:46:16.491323: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:46:16.538052: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:46:16.651132: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_bini3222048/plugins/profile/2020_12_14_18_46_16
2020-12-14 18:46:16.766570: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_bini3222048/plugins/profile/2020_12_14_18_46_16/householder.trace.json.gz
2020-12-14 18:46:16.787185: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:46:16.795937: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:46:16.797715: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_bini3222048/plugins/profile/2020_12_14_18_46_16Dumped tool data for overview_page.pb to all_threads_bini3222048/plugins/profile/2020_12_14_18_46_16/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_bini3222048/plugins/profile/2020_12_14_18_46_16/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_bini3222048/plugins/profile/2020_12_14_18_46_16/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_bini3222048/plugins/profile/2020_12_14_18_46_16/householder.kernel_stats.pb

Epoch 1, Loss: 9.172472953796387, Train Accuracy: 54.39116287231445,Test Loss: 0.368252694606781, Test Accuracy: 89.24000549316406
Time for Epoch:100.34621047973633
Average single batch time this epoch: 3.3510786664896997
Epoch 2, Loss: 0.26218530535697937, Train Accuracy: 92.22622680664062,Test Loss: 0.17765480279922485, Test Accuracy: 94.43000030517578
Running Average Epoch time: 97.21231532096863

Time for Epoch:97.21231532096863
Average single batch time this epoch: 3.2492908280471275
Epoch 3, Loss: 0.14330193400382996, Train Accuracy: 95.68460845947266,Test Loss: 0.12300626188516617, Test Accuracy: 96.34000396728516
Running Average Epoch time: 97.98716127872467

Time for Epoch:98.76200723648071
Average single batch time this epoch: 3.3050010204315186
Epoch 4, Loss: 0.09094995260238647, Train Accuracy: 97.19828033447266,Test Loss: 0.10366932302713394, Test Accuracy: 96.75
Running Average Epoch time: 98.14924804369609

Time for Epoch:98.47342157363892
Average single batch time this epoch: 3.2955912639354836
Epoch 5, Loss: 0.060417912900447845, Train Accuracy: 98.19168090820312,Test Loss: 0.09909433871507645, Test Accuracy: 96.8499984741211
Running Average Epoch time: 97.69860237836838

Time for Epoch:96.34666538238525
Average single batch time this epoch: 3.222645060769443
Average time per Batch: 3.268132043295893
Average time per Epoch: 97.69860237836838
2020-12-14 18:46:20.648362: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:46:21.152121: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:46:21.152570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:46:21.153042: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:46:21.153226: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:46:21.153399: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:46:21.153568: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:46:21.153738: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:46:21.153901: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:46:21.154069: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:46:21.154122: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:46:21.196097: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:46:21.199634: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f99e4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:46:21.199701: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:46:21.204285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:46:21.204324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:46:21.351274: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:46:21.351418: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:46:21.351694: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:46:21.351725: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:46:21.351744: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:46:21.351796: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:46:21.351862: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:46:21.351894: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:46:21.351910: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9a7b906ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:49:49.754082: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:49:49.884181: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:49:50.012145: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_dgemm2048/plugins/profile/2020_12_14_18_49_49
2020-12-14 18:49:50.127602: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_dgemm2048/plugins/profile/2020_12_14_18_49_49/householder.trace.json.gz
2020-12-14 18:49:50.146779: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:49:50.155319: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:49:50.157031: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_dgemm2048/plugins/profile/2020_12_14_18_49_49Dumped tool data for overview_page.pb to all_threads_dgemm2048/plugins/profile/2020_12_14_18_49_49/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_dgemm2048/plugins/profile/2020_12_14_18_49_49/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_dgemm2048/plugins/profile/2020_12_14_18_49_49/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_dgemm2048/plugins/profile/2020_12_14_18_49_49/householder.kernel_stats.pb

Epoch 1, Loss: 9.233126640319824, Train Accuracy: 55.07307815551758,Test Loss: 0.34700384736061096, Test Accuracy: 89.95000457763672
Time for Epoch:42.99020433425903
Average single batch time this epoch: 1.4295393187424232
Epoch 2, Loss: 0.25151097774505615, Train Accuracy: 92.49057006835938,Test Loss: 0.16848750412464142, Test Accuracy: 94.80000305175781
Running Average Epoch time: 41.2658531665802

Time for Epoch:41.2658531665802
Average single batch time this epoch: 1.3781247796683476
Epoch 3, Loss: 0.1443209946155548, Train Accuracy: 95.57179260253906,Test Loss: 0.1264682561159134, Test Accuracy: 96.35000610351562
Running Average Epoch time: 41.22237837314606

Time for Epoch:41.178903579711914
Average single batch time this epoch: 1.3727903283875564
Epoch 4, Loss: 0.09175440669059753, Train Accuracy: 97.15618133544922,Test Loss: 0.10663000494241714, Test Accuracy: 96.6500015258789
Running Average Epoch time: 41.23668026924133

Time for Epoch:41.265284061431885
Average single batch time this epoch: 1.3817826468369057
Epoch 5, Loss: 0.0673019140958786, Train Accuracy: 97.92564392089844,Test Loss: 0.14804215729236603, Test Accuracy: 95.42000579833984
Running Average Epoch time: 41.343551099300385

Time for Epoch:41.66416358947754
Average single batch time this epoch: 1.3949468218047043
Average time per Batch: 1.3819111441743785
Average time per Epoch: 41.343551099300385
2020-12-14 18:49:53.905585: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:49:54.388432: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:49:54.388830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:49:54.389223: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:54.389373: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:54.389515: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:54.389653: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:54.389796: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:54.389934: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:54.390074: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:54.390102: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:49:54.432228: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:49:54.435986: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa17c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:49:54.436061: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:49:54.440155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:49:54.440188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:49:54.586661: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:49:54.586797: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:49:54.587086: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:54.587117: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:49:54.587136: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:49:54.587171: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:49:54.587213: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:49:54.587236: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:49:54.587251: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

Traceback (most recent call last):
  File "tensorboard_test.py", line 182, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:97 train_step  *
        predictions = model(images)
    tensorboard_test.py:86 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:67 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2020-12-14 18:49:55.338739: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:49:58.419055: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:49:58.911531: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:49:58.911942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:49:58.912300: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:58.912447: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:58.912584: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:58.912718: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:58.912882: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:58.913017: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:58.913150: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:58.913177: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:49:58.952171: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:49:58.955606: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fdc24000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:49:58.955656: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:49:58.959529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:49:58.959562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:49:59.103245: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:49:59.103392: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:49:59.103667: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:49:59.103697: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:49:59.103715: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:49:59.103749: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:49:59.103834: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:49:59.103862: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:49:59.103878: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fdcb8542d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 18:58:34.997826: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:58:35.058548: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 18:58:35.232762: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_schonhage3332048/plugins/profile/2020_12_14_18_58_35
2020-12-14 18:58:35.349148: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_schonhage3332048/plugins/profile/2020_12_14_18_58_35/householder.trace.json.gz
2020-12-14 18:58:35.368341: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 18:58:35.376500: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 18:58:35.378237: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_schonhage3332048/plugins/profile/2020_12_14_18_58_35Dumped tool data for overview_page.pb to all_threads_schonhage3332048/plugins/profile/2020_12_14_18_58_35/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_schonhage3332048/plugins/profile/2020_12_14_18_58_35/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_schonhage3332048/plugins/profile/2020_12_14_18_58_35/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_schonhage3332048/plugins/profile/2020_12_14_18_58_35/householder.kernel_stats.pb

Epoch 1, Loss: 9.071508407592773, Train Accuracy: 54.31371307373047,Test Loss: 0.3605096638202667, Test Accuracy: 89.84000396728516
Time for Epoch:106.83608531951904
Average single batch time this epoch: 3.5706197393351586
Epoch 2, Loss: 0.25621461868286133, Train Accuracy: 92.3272476196289,Test Loss: 0.1819416880607605, Test Accuracy: 94.3499984741211
Running Average Epoch time: 101.81899666786194

Time for Epoch:101.81899666786194
Average single batch time this epoch: 3.4078430800602355
Epoch 3, Loss: 0.1413019746541977, Train Accuracy: 95.65261840820312,Test Loss: 0.11960181593894958, Test Accuracy: 96.22000122070312
Running Average Epoch time: 102.38241112232208

Time for Epoch:102.94582557678223
Average single batch time this epoch: 3.4481657620134025
Epoch 4, Loss: 0.09017175436019897, Train Accuracy: 97.23868560791016,Test Loss: 0.09604061394929886, Test Accuracy: 97.0199966430664
Running Average Epoch time: 102.33537491162618

Time for Epoch:102.24130249023438
Average single batch time this epoch: 3.418755325777777
Epoch 5, Loss: 0.06320986896753311, Train Accuracy: 98.06707763671875,Test Loss: 0.09614189714193344, Test Accuracy: 97.0
Running Average Epoch time: 102.25201338529587

Time for Epoch:102.00192880630493
Average single batch time this epoch: 3.4149278854501657
Average time per Batch: 3.4224230133253952
Average time per Epoch: 102.25201338529587
2020-12-14 18:58:39.098494: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 18:58:39.607084: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 18:58:39.607476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 18:58:39.607866: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:58:39.608016: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:58:39.608150: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:58:39.608283: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:58:39.608417: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:58:39.608546: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:58:39.608704: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:58:39.608731: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 18:58:39.652292: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 18:58:39.656382: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff730000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 18:58:39.656435: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 18:58:39.660648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 18:58:39.660683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 18:58:39.806412: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:58:39.806558: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 18:58:39.806841: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 18:58:39.806872: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:58:39.806890: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:58:39.806925: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:58:39.806969: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 18:58:39.806993: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 18:58:39.807008: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ff7c3957d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 19:05:40.072612: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:05:40.175634: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 19:05:40.298077: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2242048/plugins/profile/2020_12_14_19_05_40
2020-12-14 19:05:40.413501: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2242048/plugins/profile/2020_12_14_19_05_40/householder.trace.json.gz
2020-12-14 19:05:40.433447: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 19:05:40.441956: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 19:05:40.443790: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2242048/plugins/profile/2020_12_14_19_05_40Dumped tool data for overview_page.pb to all_threads_smirnov2242048/plugins/profile/2020_12_14_19_05_40/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2242048/plugins/profile/2020_12_14_19_05_40/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2242048/plugins/profile/2020_12_14_19_05_40/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2242048/plugins/profile/2020_12_14_19_05_40/householder.kernel_stats.pb

Epoch 1, Loss: 9.225220680236816, Train Accuracy: 54.28172302246094,Test Loss: 0.35500723123550415, Test Accuracy: 89.7300033569336
Time for Epoch:86.22134137153625
Average single batch time this epoch: 2.8949848701213967
Epoch 2, Loss: 0.2539300322532654, Train Accuracy: 92.44511413574219,Test Loss: 0.17543035745620728, Test Accuracy: 94.73999786376953
Running Average Epoch time: 83.33456230163574

Time for Epoch:83.33456230163574
Average single batch time this epoch: 2.803754379009378
Epoch 3, Loss: 0.14257237315177917, Train Accuracy: 95.61388397216797,Test Loss: 0.12130595743656158, Test Accuracy: 96.31999969482422
Running Average Epoch time: 83.3881047964096

Time for Epoch:83.44164729118347
Average single batch time this epoch: 2.8059749109991667
Epoch 4, Loss: 0.08934759348630905, Train Accuracy: 97.28919982910156,Test Loss: 0.09900977462530136, Test Accuracy: 96.98999786376953
Running Average Epoch time: 83.42776068051656

Time for Epoch:83.50707244873047
Average single batch time this epoch: 2.806694376057592
Epoch 5, Loss: 0.05805397406220436, Train Accuracy: 98.25566101074219,Test Loss: 0.0964340940117836, Test Accuracy: 97.01000213623047
Running Average Epoch time: 83.48630005121231

Time for Epoch:83.66191816329956
Average single batch time this epoch: 2.8153095409787934
Average time per Batch: 2.8079333017612327
Average time per Epoch: 83.48630005121231
2020-12-14 19:05:44.227508: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 19:05:44.748108: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 19:05:44.748521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 19:05:44.748901: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:05:44.749054: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:05:44.749198: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:05:44.749340: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:05:44.749488: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:05:44.749630: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:05:44.749773: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:05:44.749800: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 19:05:44.792302: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 19:05:44.795313: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9198000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 19:05:44.795377: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 19:05:44.799799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 19:05:44.799838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 19:05:44.945857: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:05:44.946001: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 19:05:44.946281: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:05:44.946310: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:05:44.946329: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:05:44.946362: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:05:44.946411: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:05:44.946436: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:05:44.946451: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f922d9abd30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 19:13:04.136425: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:13:04.240676: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 19:13:04.373253: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2252048/plugins/profile/2020_12_14_19_13_04
2020-12-14 19:13:04.489411: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2252048/plugins/profile/2020_12_14_19_13_04/householder.trace.json.gz
2020-12-14 19:13:04.508760: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 19:13:04.517347: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 19:13:04.519051: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2252048/plugins/profile/2020_12_14_19_13_04Dumped tool data for overview_page.pb to all_threads_smirnov2252048/plugins/profile/2020_12_14_19_13_04/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2252048/plugins/profile/2020_12_14_19_13_04/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2252048/plugins/profile/2020_12_14_19_13_04/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2252048/plugins/profile/2020_12_14_19_13_04/householder.kernel_stats.pb

Epoch 1, Loss: 8.514557838439941, Train Accuracy: 52.26293182373047,Test Loss: 0.42686334252357483, Test Accuracy: 87.31999969482422
Time for Epoch:91.85321235656738
Average single batch time this epoch: 3.086113420026056
Epoch 2, Loss: 0.3219412565231323, Train Accuracy: 90.20743560791016,Test Loss: 0.21267898380756378, Test Accuracy: 93.23999786376953
Running Average Epoch time: 87.55597162246704

Time for Epoch:87.55597162246704
Average single batch time this epoch: 2.9509065808921027
Epoch 3, Loss: 0.18739661574363708, Train Accuracy: 94.19450378417969,Test Loss: 0.1620745062828064, Test Accuracy: 95.06000518798828
Running Average Epoch time: 86.86263370513916

Time for Epoch:86.16929578781128
Average single batch time this epoch: 2.9027369022369385
Epoch 4, Loss: 0.13787183165550232, Train Accuracy: 95.69976043701172,Test Loss: 0.14472801983356476, Test Accuracy: 95.45999908447266
Running Average Epoch time: 86.8522568543752

Time for Epoch:86.83150315284729
Average single batch time this epoch: 2.9271756944985223
Epoch 5, Loss: 0.10807690024375916, Train Accuracy: 96.64264678955078,Test Loss: 0.11471913754940033, Test Accuracy: 96.54000091552734
Running Average Epoch time: 86.82176673412323

Time for Epoch:86.73029637336731
Average single batch time this epoch: 2.9253642230198302
Average time per Batch: 2.9265458501618484
Average time per Epoch: 86.82176673412323
2020-12-14 19:13:08.115489: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 19:13:08.635974: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 19:13:08.636430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 19:13:08.636843: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:13:08.637034: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:13:08.637194: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:13:08.637351: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:13:08.637512: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:13:08.637668: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:13:08.637825: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:13:08.637855: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 19:13:08.680165: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 19:13:08.683440: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1d7c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 19:13:08.683508: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 19:13:08.688136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 19:13:08.688175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 19:13:08.835904: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:13:08.836061: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 19:13:08.836346: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:13:08.836376: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:13:08.836395: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:13:08.836430: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:13:08.836473: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:13:08.836497: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:13:08.836512: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f1e17ddcca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 19:20:13.345744: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:20:13.411869: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 19:20:13.515053: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2722048/plugins/profile/2020_12_14_19_20_13
2020-12-14 19:20:13.630261: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2722048/plugins/profile/2020_12_14_19_20_13/householder.trace.json.gz
2020-12-14 19:20:13.650381: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 19:20:13.658911: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 19:20:13.660730: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2722048/plugins/profile/2020_12_14_19_20_13Dumped tool data for overview_page.pb to all_threads_smirnov2722048/plugins/profile/2020_12_14_19_20_13/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2722048/plugins/profile/2020_12_14_19_20_13/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2722048/plugins/profile/2020_12_14_19_20_13/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2722048/plugins/profile/2020_12_14_19_20_13/householder.kernel_stats.pb

Epoch 1, Loss: 2281674752.0, Train Accuracy: 10.146147727966309,Test Loss: 2549752832.0, Test Accuracy: 11.079999923706055
Time for Epoch:89.19485020637512
Average single batch time this epoch: 2.9878298414164575
Epoch 2, Loss: 2693953536.0, Train Accuracy: 10.981276512145996,Test Loss: 2947438336.0, Test Accuracy: 10.579999923706055
Running Average Epoch time: 86.38705897331238

Time for Epoch:86.38705897331238
Average single batch time this epoch: 2.890461880585243
Epoch 3, Loss: 2891964672.0, Train Accuracy: 11.499865531921387,Test Loss: 2950712576.0, Test Accuracy: 11.380000114440918
Running Average Epoch time: 84.52572202682495

Time for Epoch:82.66438508033752
Average single batch time this epoch: 2.7681581316323114
Epoch 4, Loss: 2771107584.0, Train Accuracy: 11.720434188842773,Test Loss: 2635362560.0, Test Accuracy: 11.5
Running Average Epoch time: 83.75726358095805

Time for Epoch:82.22034668922424
Average single batch time this epoch: 2.7556771163282723
Epoch 5, Loss: 2444176128.0, Train Accuracy: 12.122844696044922,Test Loss: 2315515136.0, Test Accuracy: 11.59000015258789
Running Average Epoch time: 83.8172442317009

Time for Epoch:83.99718618392944
Average single batch time this epoch: 2.8106091762411185
Average time per Batch: 2.806226576196736
Average time per Epoch: 83.8172442317009
2020-12-14 19:20:17.316658: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 19:20:17.828350: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 19:20:17.828847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 19:20:17.829329: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:20:17.829512: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:20:17.829683: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:20:17.829875: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:20:17.830043: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:20:17.830214: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:20:17.830382: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:20:17.830414: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 19:20:17.872413: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 19:20:17.877649: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3e20000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 19:20:17.877741: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 19:20:17.882315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 19:20:17.882352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 19:20:18.034621: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:20:18.034762: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 19:20:18.035040: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:20:18.035072: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:20:18.035091: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:20:18.035142: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:20:18.035187: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:20:18.035211: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:20:18.035225: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3eb9524ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 19:28:40.366300: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:28:40.411174: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 19:28:40.573857: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3232048/plugins/profile/2020_12_14_19_28_40
2020-12-14 19:28:40.689763: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3232048/plugins/profile/2020_12_14_19_28_40/householder.trace.json.gz
2020-12-14 19:28:40.710480: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 19:28:40.719267: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 19:28:40.721060: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3232048/plugins/profile/2020_12_14_19_28_40Dumped tool data for overview_page.pb to all_threads_smirnov3232048/plugins/profile/2020_12_14_19_28_40/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3232048/plugins/profile/2020_12_14_19_28_40/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3232048/plugins/profile/2020_12_14_19_28_40/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3232048/plugins/profile/2020_12_14_19_28_40/householder.kernel_stats.pb

Epoch 1, Loss: 7.560279369354248, Train Accuracy: 54.87439727783203,Test Loss: 0.3848196268081665, Test Accuracy: 89.0
Time for Epoch:103.43016576766968
Average single batch time this epoch: 3.4565580466697954
Epoch 2, Loss: 0.2697170078754425, Train Accuracy: 91.82212829589844,Test Loss: 0.1821899265050888, Test Accuracy: 94.26000213623047
Running Average Epoch time: 99.61634540557861

Time for Epoch:99.61634540557861
Average single batch time this epoch: 3.338105399033119
Epoch 3, Loss: 0.14945277571678162, Train Accuracy: 95.37142944335938,Test Loss: 0.12282001972198486, Test Accuracy: 96.09000396728516
Running Average Epoch time: 99.55031394958496

Time for Epoch:99.48428249359131
Average single batch time this epoch: 3.32898604458776
Epoch 4, Loss: 0.10114951431751251, Train Accuracy: 96.85479736328125,Test Loss: 0.10936757922172546, Test Accuracy: 96.41000366210938
Running Average Epoch time: 99.75218804677327

Time for Epoch:100.1559362411499
Average single batch time this epoch: 3.3511274025358
Epoch 5, Loss: 0.0776752158999443, Train Accuracy: 97.58384704589844,Test Loss: 0.11484001576900482, Test Accuracy: 96.35000610351562
Running Average Epoch time: 99.71175390481949

Time for Epoch:99.59045147895813
Average single batch time this epoch: 3.3340750069453797
Average time per Batch: 3.338073463275515
Average time per Epoch: 99.71175390481949
2020-12-14 19:28:44.558303: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 19:28:45.087312: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 19:28:45.087706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 19:28:45.088101: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:28:45.088251: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:28:45.088386: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:28:45.088519: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:28:45.088655: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:28:45.088814: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:28:45.088947: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:28:45.088973: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 19:28:45.128100: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 19:28:45.130530: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5420000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 19:28:45.130577: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 19:28:45.134359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 19:28:45.134391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 19:28:45.277802: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:28:45.277949: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 19:28:45.278225: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:28:45.278254: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:28:45.278277: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:28:45.278312: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:28:45.278354: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:28:45.278378: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:28:45.278393: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f54bdc19d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 19:37:18.843825: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:37:18.902995: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 19:37:19.098577: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3332048/plugins/profile/2020_12_14_19_37_18
2020-12-14 19:37:19.215845: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3332048/plugins/profile/2020_12_14_19_37_18/householder.trace.json.gz
2020-12-14 19:37:19.236930: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 19:37:19.245578: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 19:37:19.247372: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3332048/plugins/profile/2020_12_14_19_37_18Dumped tool data for overview_page.pb to all_threads_smirnov3332048/plugins/profile/2020_12_14_19_37_18/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3332048/plugins/profile/2020_12_14_19_37_18/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3332048/plugins/profile/2020_12_14_19_37_18/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3332048/plugins/profile/2020_12_14_19_37_18/householder.kernel_stats.pb

Epoch 1, Loss: 172138790912.0, Train Accuracy: 9.984509468078613,Test Loss: 253355606016.0, Test Accuracy: 10.539999961853027
Time for Epoch:105.98188781738281
Average single batch time this epoch: 3.5383191519770127
Epoch 2, Loss: 369762009088.0, Train Accuracy: 10.226966857910156,Test Loss: 456489730048.0, Test Accuracy: 10.100000381469727
Running Average Epoch time: 102.37313747406006

Time for Epoch:102.37313747406006
Average single batch time this epoch: 3.4245222354757376
Epoch 3, Loss: 577077968896.0, Train Accuracy: 10.183189392089844,Test Loss: 642623733760.0, Test Accuracy: 10.360000610351562
Running Average Epoch time: 102.33164858818054

Time for Epoch:102.29015970230103
Average single batch time this epoch: 3.4252584720480033
Epoch 4, Loss: 741148983296.0, Train Accuracy: 10.00639820098877,Test Loss: 730514391040.0, Test Accuracy: 10.180000305175781
Running Average Epoch time: 102.01265136400859

Time for Epoch:101.37465691566467
Average single batch time this epoch: 3.3912574916050353
Epoch 5, Loss: 732884893696.0, Train Accuracy: 9.928946495056152,Test Loss: 606229561344.0, Test Accuracy: 9.889999389648438
Running Average Epoch time: 101.88510972261429

Time for Epoch:101.5024847984314
Average single batch time this epoch: 3.392846239024195
Average time per Batch: 3.408471109538243
Average time per Epoch: 101.88510972261429
2020-12-14 19:37:22.948923: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 19:37:23.484146: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 19:37:23.484579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 19:37:23.485010: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:37:23.485191: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:37:23.485353: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:37:23.485509: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:37:23.485670: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:37:23.485827: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:37:23.485983: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:37:23.486036: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 19:37:23.528229: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 19:37:23.531945: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fcd04000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 19:37:23.532002: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 19:37:23.536450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 19:37:23.536486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 19:37:23.686859: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:37:23.687003: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 19:37:23.687288: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:37:23.687319: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:37:23.687339: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:37:23.687375: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:37:23.687419: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:37:23.687443: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:37:23.687457: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fcda2461ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 19:45:16.094176: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:45:16.139749: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 19:45:16.299965: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3342048/plugins/profile/2020_12_14_19_45_16
2020-12-14 19:45:16.426370: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3342048/plugins/profile/2020_12_14_19_45_16/householder.trace.json.gz
2020-12-14 19:45:16.448213: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 19:45:16.457554: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 19:45:16.459392: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3342048/plugins/profile/2020_12_14_19_45_16Dumped tool data for overview_page.pb to all_threads_smirnov3342048/plugins/profile/2020_12_14_19_45_16/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3342048/plugins/profile/2020_12_14_19_45_16/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3342048/plugins/profile/2020_12_14_19_45_16/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3342048/plugins/profile/2020_12_14_19_45_16/householder.kernel_stats.pb

Epoch 1, Loss: 8.71695327758789, Train Accuracy: 52.53064727783203,Test Loss: 0.4061957597732544, Test Accuracy: 88.30999755859375
Time for Epoch:97.42097043991089
Average single batch time this epoch: 3.2431060363506448
Epoch 2, Loss: 0.28403735160827637, Train Accuracy: 91.34732055664062,Test Loss: 0.19164273142814636, Test Accuracy: 93.91000366210938
Running Average Epoch time: 93.49949502944946

Time for Epoch:93.49949502944946
Average single batch time this epoch: 3.119841789377147
Epoch 3, Loss: 0.15817849338054657, Train Accuracy: 95.18959045410156,Test Loss: 0.1339838206768036, Test Accuracy: 95.72000122070312
Running Average Epoch time: 93.31113278865814

Time for Epoch:93.12277054786682
Average single batch time this epoch: 3.1029351250878694
Epoch 4, Loss: 0.10787072777748108, Train Accuracy: 96.70494079589844,Test Loss: 0.1204054057598114, Test Accuracy: 96.20000457763672
Running Average Epoch time: 93.59328603744507

Time for Epoch:94.15759253501892
Average single batch time this epoch: 3.1443977109317123
Epoch 5, Loss: 0.08070848137140274, Train Accuracy: 97.4609375,Test Loss: 0.10365808010101318, Test Accuracy: 96.76000213623047
Running Average Epoch time: 93.73293846845627

Time for Epoch:94.15189576148987
Average single batch time this epoch: 3.1215699623370994
Average time per Batch: 3.122186146933457
Average time per Epoch: 93.73293846845627
2020-12-14 19:45:20.375382: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 19:45:20.867720: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 19:45:20.868295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 19:45:20.868755: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:45:20.868917: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:45:20.869070: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:45:20.869220: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:45:20.869375: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:45:20.869525: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:45:20.869677: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:45:20.869705: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 19:45:20.908272: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 19:45:20.912780: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f485c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 19:45:20.912863: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 19:45:20.916363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 19:45:20.916400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 19:45:21.057776: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:45:21.057918: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 19:45:21.058210: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:45:21.058239: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:45:21.058257: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:45:21.058292: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:45:21.058334: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:45:21.058358: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:45:21.058373: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f48f3581ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 19:50:06.840272: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:50:06.937816: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 19:50:07.080476: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov4422048/plugins/profile/2020_12_14_19_50_06
2020-12-14 19:50:07.198893: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov4422048/plugins/profile/2020_12_14_19_50_06/householder.trace.json.gz
2020-12-14 19:50:07.218297: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 19:50:07.226600: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 19:50:07.228361: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov4422048/plugins/profile/2020_12_14_19_50_06Dumped tool data for overview_page.pb to all_threads_smirnov4422048/plugins/profile/2020_12_14_19_50_06/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov4422048/plugins/profile/2020_12_14_19_50_06/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov4422048/plugins/profile/2020_12_14_19_50_06/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov4422048/plugins/profile/2020_12_14_19_50_06/householder.kernel_stats.pb

Epoch 1, Loss: 8.637998580932617, Train Accuracy: 53.15699005126953,Test Loss: 0.39603257179260254, Test Accuracy: 88.4000015258789
Time for Epoch:59.95173001289368
Average single batch time this epoch: 1.9999979775527428
Epoch 2, Loss: 0.2841850817203522, Train Accuracy: 91.41803741455078,Test Loss: 0.19504526257514954, Test Accuracy: 93.69000244140625
Running Average Epoch time: 56.734724044799805

Time for Epoch:56.734724044799805
Average single batch time this epoch: 1.9026385422410637
Epoch 3, Loss: 0.15810605883598328, Train Accuracy: 95.14917755126953,Test Loss: 0.14505629241466522, Test Accuracy: 95.51000213623047
Running Average Epoch time: 56.72799599170685

Time for Epoch:56.72126793861389
Average single batch time this epoch: 1.8935443286238045
Epoch 4, Loss: 0.11123646050691605, Train Accuracy: 96.61065673828125,Test Loss: 0.1355145275592804, Test Accuracy: 95.75
Running Average Epoch time: 56.703251441319786

Time for Epoch:56.653762340545654
Average single batch time this epoch: 1.8963065311826508
Epoch 5, Loss: 0.08958768844604492, Train Accuracy: 97.16460418701172,Test Loss: 0.10501281917095184, Test Accuracy: 96.79000091552734
Running Average Epoch time: 56.444297194480896

Time for Epoch:55.66743445396423
Average single batch time this epoch: 1.861219833637106
Average time per Batch: 1.8884273089211563
Average time per Epoch: 56.444297194480896
2020-12-14 19:50:10.930916: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 19:50:11.416480: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 19:50:11.416881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 19:50:11.417247: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:50:11.417394: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:50:11.417558: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:50:11.417697: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:50:11.417839: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:50:11.417976: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:50:11.418116: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:50:11.418144: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 19:50:11.456182: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 19:50:11.459662: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f46ac000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 19:50:11.459718: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 19:50:11.463665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 19:50:11.463698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 19:50:11.615338: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:50:11.615475: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 19:50:11.615759: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:50:11.615826: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:50:11.615848: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:50:11.615885: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:50:11.615946: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:50:11.615973: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:50:11.615988: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f474a827d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 19:56:21.558501: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:56:21.685126: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 19:56:21.861109: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov4442048/plugins/profile/2020_12_14_19_56_21
2020-12-14 19:56:21.976341: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov4442048/plugins/profile/2020_12_14_19_56_21/householder.trace.json.gz
2020-12-14 19:56:21.997539: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 19:56:22.006357: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 19:56:22.008096: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov4442048/plugins/profile/2020_12_14_19_56_21Dumped tool data for overview_page.pb to all_threads_smirnov4442048/plugins/profile/2020_12_14_19_56_21/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov4442048/plugins/profile/2020_12_14_19_56_21/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov4442048/plugins/profile/2020_12_14_19_56_21/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov4442048/plugins/profile/2020_12_14_19_56_21/householder.kernel_stats.pb

Epoch 1, Loss: 7.945095539093018, Train Accuracy: 53.537513732910156,Test Loss: 0.42248213291168213, Test Accuracy: 86.95999908447266
Time for Epoch:79.47576785087585
Average single batch time this epoch: 2.637570553812487
Epoch 2, Loss: 0.29024824500083923, Train Accuracy: 91.14863586425781,Test Loss: 0.19823426008224487, Test Accuracy: 93.69999694824219
Running Average Epoch time: 74.20122456550598

Time for Epoch:74.20122456550598
Average single batch time this epoch: 2.4633903174564757
Epoch 3, Loss: 0.16686634719371796, Train Accuracy: 94.88146209716797,Test Loss: 0.1438358724117279, Test Accuracy: 95.3499984741211
Running Average Epoch time: 73.75855362415314

Time for Epoch:73.3158826828003
Average single batch time this epoch: 2.4290753479661613
Epoch 4, Loss: 0.118629589676857, Train Accuracy: 96.29916381835938,Test Loss: 0.12066788226366043, Test Accuracy: 95.9800033569336
Running Average Epoch time: 73.5078097184499

Time for Epoch:73.00632190704346
Average single batch time this epoch: 2.426251378552667
Epoch 5, Loss: 0.0927666574716568, Train Accuracy: 97.09556579589844,Test Loss: 0.10668505728244781, Test Accuracy: 96.80999755859375
Running Average Epoch time: 72.60214430093765

Time for Epoch:69.88514804840088
Average single batch time this epoch: 2.3246146563825936
Average time per Batch: 2.4108329250894744
Average time per Epoch: 72.60214430093765
2020-12-14 19:56:25.669617: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 19:56:26.179719: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 19:56:26.180240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 19:56:26.180633: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:56:26.180791: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:56:26.180940: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:56:26.181085: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:56:26.181258: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:56:26.181404: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:56:26.181550: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:56:26.181578: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 19:56:26.220195: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 19:56:26.223845: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9524000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 19:56:26.223893: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 19:56:26.228080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 19:56:26.228115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 19:56:26.376655: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:56:26.376796: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 19:56:26.377081: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 19:56:26.377112: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:56:26.377131: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:56:26.377166: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:56:26.377209: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 19:56:26.377250: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 19:56:26.377266: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f95b81ced30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 20:05:25.325985: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:05:25.452573: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 20:05:25.565730: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov5522048/plugins/profile/2020_12_14_20_05_25
2020-12-14 20:05:25.690499: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov5522048/plugins/profile/2020_12_14_20_05_25/householder.trace.json.gz
2020-12-14 20:05:25.712252: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 20:05:25.721035: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 20:05:25.722844: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov5522048/plugins/profile/2020_12_14_20_05_25Dumped tool data for overview_page.pb to all_threads_smirnov5522048/plugins/profile/2020_12_14_20_05_25/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov5522048/plugins/profile/2020_12_14_20_05_25/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov5522048/plugins/profile/2020_12_14_20_05_25/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov5522048/plugins/profile/2020_12_14_20_05_25/householder.kernel_stats.pb

Epoch 1, Loss: 8.801515579223633, Train Accuracy: 54.64035415649414,Test Loss: 0.3947370648384094, Test Accuracy: 88.25
Time for Epoch:114.19231057167053
Average single batch time this epoch: 3.7718587250545106
Epoch 2, Loss: 0.27595338225364685, Train Accuracy: 91.72279357910156,Test Loss: 0.1900739073753357, Test Accuracy: 93.9800033569336
Running Average Epoch time: 108.35122871398926

Time for Epoch:108.35122871398926
Average single batch time this epoch: 3.598869299066478
Epoch 3, Loss: 0.15029823780059814, Train Accuracy: 95.41183471679688,Test Loss: 0.13512620329856873, Test Accuracy: 95.66000366210938
Running Average Epoch time: 107.18472588062286

Time for Epoch:106.01822304725647
Average single batch time this epoch: 3.5240056350313385
Epoch 4, Loss: 0.10516124218702316, Train Accuracy: 96.70999908447266,Test Loss: 0.11060141772031784, Test Accuracy: 96.54000091552734
Running Average Epoch time: 106.50337982177734

Time for Epoch:105.1406877040863
Average single batch time this epoch: 3.4954065701057173
Epoch 5, Loss: 0.0772668868303299, Train Accuracy: 97.61920928955078,Test Loss: 0.09826327860355377, Test Accuracy: 97.04000091552734
Running Average Epoch time: 106.17417639493942

Time for Epoch:105.18656611442566
Average single batch time this epoch: 3.4952277726140517
Average time per Batch: 3.528377319204396
Average time per Epoch: 106.17417639493942
2020-12-14 20:05:29.823387: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 20:05:30.351829: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 20:05:30.352327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 20:05:30.353140: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:05:30.353276: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:05:30.353398: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:05:30.353518: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:05:30.353660: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:05:30.353779: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:05:30.353915: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:05:30.353939: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 20:05:30.392400: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 20:05:30.396755: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8e2c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 20:05:30.396845: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 20:05:30.401528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 20:05:30.401567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 20:05:30.553693: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:05:30.553832: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 20:05:30.554132: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:05:30.554163: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:05:30.554187: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:05:30.554224: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:05:30.554269: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:05:30.554293: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:05:30.554308: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8ecc1c9ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 20:14:19.483386: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:14:19.526699: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 20:14:19.686870: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov5552048/plugins/profile/2020_12_14_20_14_19
2020-12-14 20:14:19.804801: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov5552048/plugins/profile/2020_12_14_20_14_19/householder.trace.json.gz
2020-12-14 20:14:19.824884: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 20:14:19.833289: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 20:14:19.834970: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov5552048/plugins/profile/2020_12_14_20_14_19Dumped tool data for overview_page.pb to all_threads_smirnov5552048/plugins/profile/2020_12_14_20_14_19/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov5552048/plugins/profile/2020_12_14_20_14_19/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov5552048/plugins/profile/2020_12_14_20_14_19/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov5552048/plugins/profile/2020_12_14_20_14_19/householder.kernel_stats.pb

Epoch 1, Loss: 7.78311824798584, Train Accuracy: 54.387794494628906,Test Loss: 0.41461434960365295, Test Accuracy: 87.95999908447266
Time for Epoch:106.40140390396118
Average single batch time this epoch: 3.5469745849740915
Epoch 2, Loss: 0.2853543758392334, Train Accuracy: 91.3995132446289,Test Loss: 0.1829909235239029, Test Accuracy: 93.98999786376953
Running Average Epoch time: 106.4306800365448

Time for Epoch:106.4306800365448
Average single batch time this epoch: 3.520778886203108
Epoch 3, Loss: 0.15783849358558655, Train Accuracy: 95.14749908447266,Test Loss: 0.1345612108707428, Test Accuracy: 95.75
Running Average Epoch time: 107.359579205513

Time for Epoch:108.2884783744812
Average single batch time this epoch: 3.613607850568048
Epoch 4, Loss: 0.1072009950876236, Train Accuracy: 96.67463684082031,Test Loss: 0.1093672588467598, Test Accuracy: 96.4800033569336
Running Average Epoch time: 105.84691675504048

Time for Epoch:102.82159185409546
Average single batch time this epoch: 3.419076056315981
Epoch 5, Loss: 0.07734362781047821, Train Accuracy: 97.60910034179688,Test Loss: 0.10469826310873032, Test Accuracy: 96.7300033569336
Running Average Epoch time: 105.61963105201721

Time for Epoch:104.93777394294739
Average single batch time this epoch: 3.4904002814457336
Average time per Batch: 3.5109657686332176
Average time per Epoch: 105.61963105201721
2020-12-14 20:14:23.671408: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 20:14:24.195379: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 20:14:24.195808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 20:14:24.196170: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:14:24.196317: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:14:24.196452: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:14:24.196584: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:14:24.196739: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:14:24.196872: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:14:24.197004: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:14:24.197030: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 20:14:24.240091: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 20:14:24.243158: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fbc90000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 20:14:24.243218: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 20:14:24.247321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 20:14:24.247354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 20:14:24.621910: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:14:24.622060: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 20:14:24.622346: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:14:24.622376: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:14:24.622394: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:14:24.622428: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:14:24.622469: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:14:24.622493: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:14:24.622507: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fbd2e164ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 20:24:53.189930: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:24:53.336805: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 20:24:53.396462: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_bini3224096/plugins/profile/2020_12_14_20_24_53
2020-12-14 20:24:53.458376: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_bini3224096/plugins/profile/2020_12_14_20_24_53/householder.trace.json.gz
2020-12-14 20:24:53.466371: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 20:24:53.471475: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 20:24:53.473144: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_bini3224096/plugins/profile/2020_12_14_20_24_53Dumped tool data for overview_page.pb to all_threads_bini3224096/plugins/profile/2020_12_14_20_24_53/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_bini3224096/plugins/profile/2020_12_14_20_24_53/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_bini3224096/plugins/profile/2020_12_14_20_24_53/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_bini3224096/plugins/profile/2020_12_14_20_24_53/householder.kernel_stats.pb

Epoch 1, Loss: 152.579345703125, Train Accuracy: 27.02811050415039,Test Loss: 1.904407024383545, Test Accuracy: 46.72999954223633
Time for Epoch:130.02595376968384
Average single batch time this epoch: 8.878762773105077
Epoch 2, Loss: 0.8285508751869202, Train Accuracy: 74.64948272705078,Test Loss: 0.35899364948272705, Test Accuracy: 89.45000457763672
Running Average Epoch time: 126.78844904899597

Time for Epoch:126.78844904899597
Average single batch time this epoch: 8.687815598079137
Epoch 3, Loss: 0.31593719124794006, Train Accuracy: 90.60407257080078,Test Loss: 0.23303259909152985, Test Accuracy: 92.7699966430664
Running Average Epoch time: 125.32001054286957

Time for Epoch:123.85157203674316
Average single batch time this epoch: 8.49450615474156
Epoch 4, Loss: 0.19708427786827087, Train Accuracy: 94.03250885009766,Test Loss: 0.16521555185317993, Test Accuracy: 94.77999877929688
Running Average Epoch time: 124.47558768590291

Time for Epoch:122.7867419719696
Average single batch time this epoch: 8.416166135243007
Epoch 5, Loss: 0.13522568345069885, Train Accuracy: 95.9228515625,Test Loss: 0.12810690701007843, Test Accuracy: 95.9800033569336
Running Average Epoch time: 124.62408697605133

Time for Epoch:125.06958484649658
Average single batch time this epoch: 8.593053477151054
Average time per Batch: 8.54788534130369
Average time per Epoch: 124.62408697605133
2020-12-14 20:24:57.354836: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 20:24:57.836398: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 20:24:57.836829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 20:24:57.837229: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:24:57.837398: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:24:57.837539: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:24:57.837676: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:24:57.837817: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:24:57.837953: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:24:57.838091: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:24:57.838117: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 20:24:57.876106: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 20:24:57.879761: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ffa24000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 20:24:57.879872: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 20:24:57.883379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 20:24:57.883412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 20:24:58.260029: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:24:58.260184: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 20:24:58.260516: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:24:58.260547: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:24:58.260566: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:24:58.260600: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:24:58.260643: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:24:58.260668: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:24:58.260683: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ffac0da0ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 20:32:12.001370: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:32:12.097642: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 20:32:12.156872: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_dgemm4096/plugins/profile/2020_12_14_20_32_12
2020-12-14 20:32:12.220282: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_dgemm4096/plugins/profile/2020_12_14_20_32_12/householder.trace.json.gz
2020-12-14 20:32:12.228689: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 20:32:12.233824: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 20:32:12.235538: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_dgemm4096/plugins/profile/2020_12_14_20_32_12Dumped tool data for overview_page.pb to all_threads_dgemm4096/plugins/profile/2020_12_14_20_32_12/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_dgemm4096/plugins/profile/2020_12_14_20_32_12/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_dgemm4096/plugins/profile/2020_12_14_20_32_12/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_dgemm4096/plugins/profile/2020_12_14_20_32_12/householder.kernel_stats.pb

Epoch 1, Loss: 165.0225067138672, Train Accuracy: 25.639995574951172,Test Loss: 1.807623028755188, Test Accuracy: 51.689998626708984
Time for Epoch:89.33065676689148
Average single batch time this epoch: 6.04017778805324
Epoch 2, Loss: 0.8610612154006958, Train Accuracy: 73.72174835205078,Test Loss: 0.38656914234161377, Test Accuracy: 88.62000274658203
Running Average Epoch time: 85.57260203361511

Time for Epoch:85.57260203361511
Average single batch time this epoch: 5.820518936429705
Epoch 3, Loss: 0.3326990306377411, Train Accuracy: 90.087890625,Test Loss: 0.24780039489269257, Test Accuracy: 92.45999908447266
Running Average Epoch time: 86.78170680999756

Time for Epoch:87.99081158638
Average single batch time this epoch: 5.989942022732326
Epoch 4, Loss: 0.20602059364318848, Train Accuracy: 93.84416961669922,Test Loss: 0.17247289419174194, Test Accuracy: 94.45999908447266
Running Average Epoch time: 86.28036046028137

Time for Epoch:85.277667760849
Average single batch time this epoch: 5.7854306527546475
Epoch 5, Loss: 0.13740083575248718, Train Accuracy: 95.91936492919922,Test Loss: 0.13231098651885986, Test Accuracy: 95.66000366210938
Running Average Epoch time: 86.09150058031082

Time for Epoch:85.52492094039917
Average single batch time this epoch: 5.823750376701355
Average time per Batch: 5.854910497154509
Average time per Epoch: 86.09150058031082
2020-12-14 20:32:15.575681: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 20:32:16.121022: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 20:32:16.121460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 20:32:16.121876: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:16.122057: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:16.122216: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:16.122402: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:16.122559: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:16.122713: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:16.122869: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:16.122899: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 20:32:16.168305: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 20:32:16.172427: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f01a8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 20:32:16.172540: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 20:32:16.177117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 20:32:16.177154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 20:32:16.553167: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:32:16.553314: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 20:32:16.553585: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:16.553616: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:32:16.553634: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:32:16.553691: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:32:16.553734: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:32:16.553759: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:32:16.553775: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

Traceback (most recent call last):
  File "tensorboard_test.py", line 182, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:97 train_step  *
        predictions = model(images)
    tensorboard_test.py:86 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:67 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2020-12-14 20:32:17.294375: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:32:20.359361: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 20:32:20.869520: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 20:32:20.869896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 20:32:20.870288: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:20.870446: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:20.870599: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:20.870763: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:20.870901: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:20.871035: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:20.871168: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:20.871211: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 20:32:20.912256: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 20:32:20.915222: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7828000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 20:32:20.915278: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 20:32:20.919761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 20:32:20.919819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 20:32:21.299607: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:32:21.299748: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 20:32:21.300064: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:32:21.300096: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:32:21.300115: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:32:21.300150: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:32:21.300192: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:32:21.300216: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:32:21.300231: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f78c1d7dd30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 20:43:14.249574: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:43:14.346457: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 20:43:14.402173: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_schonhage3334096/plugins/profile/2020_12_14_20_43_14
2020-12-14 20:43:14.463865: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_schonhage3334096/plugins/profile/2020_12_14_20_43_14/householder.trace.json.gz
2020-12-14 20:43:14.471756: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 20:43:14.476862: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 20:43:14.478466: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_schonhage3334096/plugins/profile/2020_12_14_20_43_14Dumped tool data for overview_page.pb to all_threads_schonhage3334096/plugins/profile/2020_12_14_20_43_14/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_schonhage3334096/plugins/profile/2020_12_14_20_43_14/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_schonhage3334096/plugins/profile/2020_12_14_20_43_14/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_schonhage3334096/plugins/profile/2020_12_14_20_43_14/householder.kernel_stats.pb

Epoch 1, Loss: 145.45005798339844, Train Accuracy: 29.18526840209961,Test Loss: 1.550832986831665, Test Accuracy: 55.44000244140625
Time for Epoch:135.49247455596924
Average single batch time this epoch: 9.322346908705574
Epoch 2, Loss: 0.727307140827179, Train Accuracy: 77.59661102294922,Test Loss: 0.3747016191482544, Test Accuracy: 89.22000122070312
Running Average Epoch time: 130.72630429267883

Time for Epoch:130.72630429267883
Average single batch time this epoch: 8.998127630778722
Epoch 3, Loss: 0.31377270817756653, Train Accuracy: 90.69998931884766,Test Loss: 0.23588378727436066, Test Accuracy: 92.77999877929688
Running Average Epoch time: 130.7048783302307

Time for Epoch:130.6834523677826
Average single batch time this epoch: 9.000103167125157
Epoch 4, Loss: 0.19706228375434875, Train Accuracy: 94.10051727294922,Test Loss: 0.1619204729795456, Test Accuracy: 94.84000396728516
Running Average Epoch time: 129.74861605962118

Time for Epoch:127.8360915184021
Average single batch time this epoch: 8.801912426948547
Epoch 5, Loss: 0.13493408262729645, Train Accuracy: 95.95075225830078,Test Loss: 0.12775100767612457, Test Accuracy: 95.92000579833984
Running Average Epoch time: 129.3519920706749

Time for Epoch:128.16212010383606
Average single batch time this epoch: 8.815623896462577
Average time per Batch: 8.90394178032875
Average time per Epoch: 129.3519920706749
2020-12-14 20:43:18.323529: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 20:43:18.800979: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 20:43:18.801455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 20:43:18.801891: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:43:18.802083: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:43:18.802243: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:43:18.802400: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:43:18.802562: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:43:18.802718: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:43:18.802876: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:43:18.802906: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 20:43:18.844322: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 20:43:18.847752: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f67e8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 20:43:18.847825: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 20:43:18.852044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 20:43:18.852095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 20:43:19.231913: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:43:19.232056: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 20:43:19.232347: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:43:19.232380: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:43:19.232399: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:43:19.232435: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:43:19.232479: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:43:19.232504: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:43:19.232519: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f6881f4ed30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 20:53:48.199641: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:53:48.328375: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 20:53:48.385279: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2244096/plugins/profile/2020_12_14_20_53_48
2020-12-14 20:53:48.446812: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2244096/plugins/profile/2020_12_14_20_53_48/householder.trace.json.gz
2020-12-14 20:53:48.455064: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 20:53:48.460133: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 20:53:48.461780: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2244096/plugins/profile/2020_12_14_20_53_48Dumped tool data for overview_page.pb to all_threads_smirnov2244096/plugins/profile/2020_12_14_20_53_48/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2244096/plugins/profile/2020_12_14_20_53_48/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2244096/plugins/profile/2020_12_14_20_53_48/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2244096/plugins/profile/2020_12_14_20_53_48/householder.kernel_stats.pb

Epoch 1, Loss: 167.17916870117188, Train Accuracy: 25.01220703125,Test Loss: 2.012709140777588, Test Accuracy: 47.5
Time for Epoch:129.13876700401306
Average single batch time this epoch: 8.858503818511963
Epoch 2, Loss: 0.8643168210983276, Train Accuracy: 74.12806701660156,Test Loss: 0.392147421836853, Test Accuracy: 88.54000091552734
Running Average Epoch time: 126.3086326122284

Time for Epoch:126.3086326122284
Average single batch time this epoch: 8.690867594310216
Epoch 3, Loss: 0.33381912112236023, Train Accuracy: 90.0146484375,Test Loss: 0.24809402227401733, Test Accuracy: 92.3699951171875
Running Average Epoch time: 125.39089357852936

Time for Epoch:124.47315454483032
Average single batch time this epoch: 8.5473552942276
Epoch 4, Loss: 0.20342376828193665, Train Accuracy: 93.83893585205078,Test Loss: 0.1711437702178955, Test Accuracy: 94.55000305175781
Running Average Epoch time: 124.72522226969402

Time for Epoch:123.39387965202332
Average single batch time this epoch: 8.475170271737236
Epoch 5, Loss: 0.13769321143627167, Train Accuracy: 95.90018463134766,Test Loss: 0.1326569765806198, Test Accuracy: 95.61000061035156
Running Average Epoch time: 124.94606441259384

Time for Epoch:125.60859084129333
Average single batch time this epoch: 8.648080400058202
Average time per Batch: 8.590368390083313
Average time per Epoch: 124.94606441259384
2020-12-14 20:53:52.138466: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 20:53:52.652713: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 20:53:52.653117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 20:53:52.653503: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:53:52.653664: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:53:52.653806: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:53:52.653966: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:53:52.654125: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:53:52.654263: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:53:52.654402: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:53:52.654429: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 20:53:52.696055: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 20:53:52.698840: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fcd04000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 20:53:52.698883: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 20:53:52.702667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 20:53:52.702699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 20:53:53.079155: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:53:53.079292: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 20:53:53.079561: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 20:53:53.079609: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:53:53.079630: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:53:53.079665: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:53:53.079726: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 20:53:53.079754: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 20:53:53.079769: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fcda0a12d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 21:05:15.393797: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:05:15.521636: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 21:05:15.579809: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2254096/plugins/profile/2020_12_14_21_05_15
2020-12-14 21:05:15.641327: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2254096/plugins/profile/2020_12_14_21_05_15/householder.trace.json.gz
2020-12-14 21:05:15.649509: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 21:05:15.654401: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 21:05:15.656015: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2254096/plugins/profile/2020_12_14_21_05_15Dumped tool data for overview_page.pb to all_threads_smirnov2254096/plugins/profile/2020_12_14_21_05_15/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2254096/plugins/profile/2020_12_14_21_05_15/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2254096/plugins/profile/2020_12_14_21_05_15/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2254096/plugins/profile/2020_12_14_21_05_15/householder.kernel_stats.pb

Epoch 1, Loss: 140.94752502441406, Train Accuracy: 24.857004165649414,Test Loss: 1.8362091779708862, Test Accuracy: 57.30999755859375
Time for Epoch:142.83172988891602
Average single batch time this epoch: 9.841262834412712
Epoch 2, Loss: 0.8996644020080566, Train Accuracy: 73.95542907714844,Test Loss: 0.5029180645942688, Test Accuracy: 84.44000244140625
Running Average Epoch time: 135.1206910610199

Time for Epoch:135.1206910610199
Average single batch time this epoch: 9.301091858318873
Epoch 3, Loss: 0.4145135283470154, Train Accuracy: 87.29771423339844,Test Loss: 0.32898110151290894, Test Accuracy: 89.84000396728516
Running Average Epoch time: 135.26249861717224

Time for Epoch:135.40430617332458
Average single batch time this epoch: 9.321026035717555
Epoch 4, Loss: 0.2918555736541748, Train Accuracy: 91.00167083740234,Test Loss: 0.24283690750598907, Test Accuracy: 92.33000183105469
Running Average Epoch time: 135.06013369560242

Time for Epoch:134.65540385246277
Average single batch time this epoch: 9.28041671003614
Epoch 5, Loss: 0.22898925840854645, Train Accuracy: 92.81180572509766,Test Loss: 0.21141411364078522, Test Accuracy: 93.48999786376953
Running Average Epoch time: 134.8588017821312

Time for Epoch:134.25480604171753
Average single batch time this epoch: 9.23771858215332
Average time per Batch: 9.285063296556473
Average time per Epoch: 134.8588017821312
2020-12-14 21:05:19.381530: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 21:05:19.895061: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 21:05:19.895476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 21:05:19.895852: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:05:19.896007: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:05:19.896151: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:05:19.896309: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:05:19.896491: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:05:19.896633: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:05:19.896774: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:05:19.896801: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 21:05:19.936349: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 21:05:19.940122: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9f24000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 21:05:19.940178: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 21:05:19.944584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 21:05:19.944623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 21:05:20.322606: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:05:20.322751: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 21:05:20.323022: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:05:20.323051: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:05:20.323069: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:05:20.323102: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:05:20.323167: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:05:20.323216: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:05:20.323232: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9fc410aca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 21:17:34.129390: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:17:34.265009: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 21:17:34.320009: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2724096/plugins/profile/2020_12_14_21_17_34
2020-12-14 21:17:34.380651: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2724096/plugins/profile/2020_12_14_21_17_34/householder.trace.json.gz
2020-12-14 21:17:34.388441: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 21:17:34.393577: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 21:17:34.395182: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2724096/plugins/profile/2020_12_14_21_17_34Dumped tool data for overview_page.pb to all_threads_smirnov2724096/plugins/profile/2020_12_14_21_17_34/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2724096/plugins/profile/2020_12_14_21_17_34/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2724096/plugins/profile/2020_12_14_21_17_34/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2724096/plugins/profile/2020_12_14_21_17_34/householder.kernel_stats.pb

Epoch 1, Loss: 24482844672.0, Train Accuracy: 10.4736328125,Test Loss: 26036326400.0, Test Accuracy: 10.880000114440918
Time for Epoch:154.63922381401062
Average single batch time this epoch: 10.633029920714241
Epoch 2, Loss: 27934425088.0, Train Accuracy: 10.981096267700195,Test Loss: 30034753536.0, Test Accuracy: 11.84000015258789
Running Average Epoch time: 146.71287369728088

Time for Epoch:146.71287369728088
Average single batch time this epoch: 10.087818469320025
Epoch 3, Loss: 30938195968.0, Train Accuracy: 11.429268836975098,Test Loss: 32458594304.0, Test Accuracy: 11.369999885559082
Running Average Epoch time: 146.51568734645844

Time for Epoch:146.318500995636
Average single batch time this epoch: 10.04289720739637
Epoch 4, Loss: 32759162880.0, Train Accuracy: 11.758858680725098,Test Loss: 34542080000.0, Test Accuracy: 11.720000267028809
Running Average Epoch time: 146.30330355962118

Time for Epoch:145.87853598594666
Average single batch time this epoch: 10.018959726606097
Epoch 5, Loss: 33893617664.0, Train Accuracy: 11.826869010925293,Test Loss: 34752491520.0, Test Accuracy: 11.699999809265137
Running Average Epoch time: 144.7801793217659

Time for Epoch:140.21080660820007
Average single batch time this epoch: 9.60857607637133
Average time per Batch: 9.939562869923455
Average time per Epoch: 144.7801793217659
2020-12-14 21:17:38.385181: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 21:17:38.899151: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 21:17:38.899577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 21:17:38.900018: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:17:38.900185: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:17:38.900337: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:17:38.900485: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:17:38.900658: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:17:38.900806: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:17:38.900983: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:17:38.901012: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 21:17:38.940082: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 21:17:38.943747: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f026c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 21:17:38.943853: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 21:17:38.948207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 21:17:38.948246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 21:17:39.323948: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:17:39.324087: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 21:17:39.324379: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:17:39.324409: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:17:39.324428: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:17:39.324461: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:17:39.324509: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:17:39.324534: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:17:39.324549: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f02ff0cbca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 21:28:14.592114: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:28:14.679879: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 21:28:14.734835: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3234096/plugins/profile/2020_12_14_21_28_14
2020-12-14 21:28:14.795798: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3234096/plugins/profile/2020_12_14_21_28_14/householder.trace.json.gz
2020-12-14 21:28:14.803641: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 21:28:14.808754: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 21:28:14.810366: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3234096/plugins/profile/2020_12_14_21_28_14Dumped tool data for overview_page.pb to all_threads_smirnov3234096/plugins/profile/2020_12_14_21_28_14/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3234096/plugins/profile/2020_12_14_21_28_14/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3234096/plugins/profile/2020_12_14_21_28_14/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3234096/plugins/profile/2020_12_14_21_28_14/householder.kernel_stats.pb

Epoch 1, Loss: 145.197021484375, Train Accuracy: 29.792133331298828,Test Loss: 1.9634082317352295, Test Accuracy: 51.209999084472656
Time for Epoch:129.96190118789673
Average single batch time this epoch: 8.943404691559929
Epoch 2, Loss: 0.9000223278999329, Train Accuracy: 72.45919036865234,Test Loss: 0.4996797442436218, Test Accuracy: 84.7699966430664
Running Average Epoch time: 127.35029673576355

Time for Epoch:127.35029673576355
Average single batch time this epoch: 8.764011859893799
Epoch 3, Loss: 0.3877273499965668, Train Accuracy: 88.09989166259766,Test Loss: 0.3009300231933594, Test Accuracy: 90.8499984741211
Running Average Epoch time: 126.90969061851501

Time for Epoch:126.46908450126648
Average single batch time this epoch: 8.710639783314296
Epoch 4, Loss: 0.2576814293861389, Train Accuracy: 92.08984375,Test Loss: 0.21753618121147156, Test Accuracy: 93.19999694824219
Running Average Epoch time: 127.11700105667114

Time for Epoch:127.5316219329834
Average single batch time this epoch: 8.769911868231636
Epoch 5, Loss: 0.1930481493473053, Train Accuracy: 94.04471588134766,Test Loss: 0.1711490899324417, Test Accuracy: 94.41999816894531
Running Average Epoch time: 126.31342536211014

Time for Epoch:123.90269827842712
Average single batch time this epoch: 8.515815104757037
Average time per Batch: 8.690094654049192
Average time per Epoch: 126.31342536211014
2020-12-14 21:28:18.643557: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 21:28:19.157602: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 21:28:19.158117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 21:28:19.158580: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:28:19.158772: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:28:19.158953: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:28:19.159132: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:28:19.159318: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:28:19.159496: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:28:19.159675: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:28:19.159709: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 21:28:19.200250: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 21:28:19.204005: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7800000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 21:28:19.204059: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 21:28:19.208849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 21:28:19.208890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 21:28:19.583231: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:28:19.583370: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 21:28:19.583665: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:28:19.583697: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:28:19.583716: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:28:19.583751: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:28:19.583824: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:28:19.583856: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:28:19.583872: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f789c9aad30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 21:39:19.533039: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:39:19.659656: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 21:39:19.715936: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3334096/plugins/profile/2020_12_14_21_39_19
2020-12-14 21:39:19.777985: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3334096/plugins/profile/2020_12_14_21_39_19/householder.trace.json.gz
2020-12-14 21:39:19.785949: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 21:39:19.791119: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 21:39:19.792766: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3334096/plugins/profile/2020_12_14_21_39_19Dumped tool data for overview_page.pb to all_threads_smirnov3334096/plugins/profile/2020_12_14_21_39_19/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3334096/plugins/profile/2020_12_14_21_39_19/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3334096/plugins/profile/2020_12_14_21_39_19/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3334096/plugins/profile/2020_12_14_21_39_19/householder.kernel_stats.pb

Epoch 1, Loss: 1121441153024.0, Train Accuracy: 9.601701736450195,Test Loss: 1612829163520.0, Test Accuracy: 9.960000038146973
Time for Epoch:134.56998586654663
Average single batch time this epoch: 9.242700065885272
Epoch 2, Loss: 2596085694464.0, Train Accuracy: 9.730748176574707,Test Loss: 3278838956032.0, Test Accuracy: 9.829999923706055
Running Average Epoch time: 132.18370842933655

Time for Epoch:132.18370842933655
Average single batch time this epoch: 9.104962297848292
Epoch 3, Loss: 4251970699264.0, Train Accuracy: 10.091727256774902,Test Loss: 4828893806592.0, Test Accuracy: 9.399999618530273
Running Average Epoch time: 130.84232687950134

Time for Epoch:129.50094532966614
Average single batch time this epoch: 8.886805176734924
Epoch 4, Loss: 5968300605440.0, Train Accuracy: 9.927803993225098,Test Loss: 6397281959936.0, Test Accuracy: 9.929999351501465
Running Average Epoch time: 131.286163965861

Time for Epoch:132.17383813858032
Average single batch time this epoch: 9.10118932383401
Epoch 5, Loss: 7699927400448.0, Train Accuracy: 9.910365104675293,Test Loss: 7854740209664.0, Test Accuracy: 10.460000038146973
Running Average Epoch time: 131.33178108930588

Time for Epoch:131.4686324596405
Average single batch time this epoch: 9.03159316948482
Average time per Batch: 9.031137491975512
Average time per Epoch: 131.33178108930588
2020-12-14 21:39:23.696794: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 21:39:24.211107: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 21:39:24.211536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 21:39:24.211965: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:39:24.212146: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:39:24.212343: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:39:24.212493: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:39:24.212647: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:39:24.212795: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:39:24.212944: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:39:24.212972: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 21:39:24.252146: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 21:39:24.256693: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9218000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 21:39:24.256755: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 21:39:24.260843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 21:39:24.260887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 21:39:24.641984: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:39:24.642134: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 21:39:24.643209: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:39:24.643259: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:39:24.643279: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:39:24.643315: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:39:24.643384: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:39:24.643411: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:39:24.643426: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f92b59bad30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 21:49:08.345446: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:49:08.447289: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 21:49:08.507982: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3344096/plugins/profile/2020_12_14_21_49_08
2020-12-14 21:49:08.572215: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3344096/plugins/profile/2020_12_14_21_49_08/householder.trace.json.gz
2020-12-14 21:49:08.580580: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 21:49:08.585794: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 21:49:08.587510: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3344096/plugins/profile/2020_12_14_21_49_08Dumped tool data for overview_page.pb to all_threads_smirnov3344096/plugins/profile/2020_12_14_21_49_08/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3344096/plugins/profile/2020_12_14_21_49_08/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3344096/plugins/profile/2020_12_14_21_49_08/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3344096/plugins/profile/2020_12_14_21_49_08/householder.kernel_stats.pb

Epoch 1, Loss: 154.0371856689453, Train Accuracy: 25.27727508544922,Test Loss: 1.5722081661224365, Test Accuracy: 52.52000045776367
Time for Epoch:123.49036359786987
Average single batch time this epoch: 8.446600948061262
Epoch 2, Loss: 0.8662818670272827, Train Accuracy: 73.28229522705078,Test Loss: 0.44543060660362244, Test Accuracy: 86.08000183105469
Running Average Epoch time: 115.9694311618805

Time for Epoch:115.9694311618805
Average single batch time this epoch: 7.897444537707737
Epoch 3, Loss: 0.3618992269039154, Train Accuracy: 88.86370086669922,Test Loss: 0.26873090863227844, Test Accuracy: 91.72000122070312
Running Average Epoch time: 115.27118992805481

Time for Epoch:114.57294869422913
Average single batch time this epoch: 7.812640803200858
Epoch 4, Loss: 0.23968514800071716, Train Accuracy: 92.69322204589844,Test Loss: 0.2020360380411148, Test Accuracy: 93.55000305175781
Running Average Epoch time: 115.30319968859355

Time for Epoch:115.36721920967102
Average single batch time this epoch: 7.856381484440395
Epoch 5, Loss: 0.17930348217487335, Train Accuracy: 94.48765563964844,Test Loss: 0.1595587283372879, Test Accuracy: 95.01000213623047
Running Average Epoch time: 115.03902649879456

Time for Epoch:114.24650692939758
Average single batch time this epoch: 7.757770623479571
Average time per Batch: 7.8310593622071405
Average time per Epoch: 115.03902649879456
2020-12-14 21:49:12.356765: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 21:49:12.848596: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 21:49:12.849031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 21:49:12.849468: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:49:12.849635: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:49:12.849799: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:49:12.849942: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:49:12.850109: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:49:12.850252: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:49:12.850397: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:49:12.850425: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 21:49:12.892221: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 21:49:12.894905: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fca7c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 21:49:12.894952: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 21:49:12.898690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 21:49:12.898722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 21:49:13.275403: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:49:13.275539: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 21:49:13.275832: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:49:13.275866: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:49:13.275885: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:49:13.275938: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:49:13.275983: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:49:13.276009: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:49:13.276024: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fcb19b0dd30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 21:57:27.706837: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:57:27.829327: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 21:57:27.888414: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov4424096/plugins/profile/2020_12_14_21_57_27
2020-12-14 21:57:27.950673: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov4424096/plugins/profile/2020_12_14_21_57_27/householder.trace.json.gz
2020-12-14 21:57:27.958718: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 21:57:27.963936: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 21:57:27.965578: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov4424096/plugins/profile/2020_12_14_21_57_27Dumped tool data for overview_page.pb to all_threads_smirnov4424096/plugins/profile/2020_12_14_21_57_27/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov4424096/plugins/profile/2020_12_14_21_57_27/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov4424096/plugins/profile/2020_12_14_21_57_27/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov4424096/plugins/profile/2020_12_14_21_57_27/householder.kernel_stats.pb

Epoch 1, Loss: 153.70848083496094, Train Accuracy: 24.84130859375,Test Loss: 1.6588847637176514, Test Accuracy: 51.19000244140625
Time for Epoch:104.89586353302002
Average single batch time this epoch: 7.16957027571542
Epoch 2, Loss: 0.8848887085914612, Train Accuracy: 72.59521484375,Test Loss: 0.4349702000617981, Test Accuracy: 86.87000274658203
Running Average Epoch time: 98.8818109035492

Time for Epoch:98.8818109035492
Average single batch time this epoch: 6.758451461791992
Epoch 3, Loss: 0.3723296523094177, Train Accuracy: 88.65443420410156,Test Loss: 0.29043614864349365, Test Accuracy: 91.23999786376953
Running Average Epoch time: 98.53124213218689

Time for Epoch:98.18067336082458
Average single batch time this epoch: 6.7284645182745795
Epoch 4, Loss: 0.2529144883155823, Train Accuracy: 92.23109436035156,Test Loss: 0.2128608375787735, Test Accuracy: 93.23999786376953
Running Average Epoch time: 97.91105540593465

Time for Epoch:96.67068195343018
Average single batch time this epoch: 6.618218694414411
Epoch 5, Loss: 0.19392384588718414, Train Accuracy: 93.98542022705078,Test Loss: 0.17860837280750275, Test Accuracy: 94.4000015258789
Running Average Epoch time: 97.36907476186752

Time for Epoch:95.74313282966614
Average single batch time this epoch: 6.540295158113752
Average time per Batch: 6.661357458148684
Average time per Epoch: 97.36907476186752
2020-12-14 21:57:32.154263: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 21:57:32.664666: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 21:57:32.665057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 21:57:32.665396: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:57:32.665539: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:57:32.665674: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:57:32.665807: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:57:32.665940: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:57:32.666072: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:57:32.666230: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:57:32.666256: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 21:57:32.704255: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 21:57:32.708917: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8934000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 21:57:32.708953: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 21:57:32.711699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 21:57:32.711719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 21:57:33.082276: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:57:33.082402: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 21:57:33.082685: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 21:57:33.082715: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:57:33.082734: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:57:33.082767: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:57:33.082809: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 21:57:33.082834: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 21:57:33.082850: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f89d00c7ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 22:10:39.393201: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:10:39.523249: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 22:10:39.577526: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov4444096/plugins/profile/2020_12_14_22_10_39
2020-12-14 22:10:39.639415: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov4444096/plugins/profile/2020_12_14_22_10_39/householder.trace.json.gz
2020-12-14 22:10:39.647170: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 22:10:39.652086: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 22:10:39.653657: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov4444096/plugins/profile/2020_12_14_22_10_39Dumped tool data for overview_page.pb to all_threads_smirnov4444096/plugins/profile/2020_12_14_22_10_39/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov4444096/plugins/profile/2020_12_14_22_10_39/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov4444096/plugins/profile/2020_12_14_22_10_39/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov4444096/plugins/profile/2020_12_14_22_10_39/householder.kernel_stats.pb

Epoch 1, Loss: 151.93362426757812, Train Accuracy: 24.23270034790039,Test Loss: 1.7917566299438477, Test Accuracy: 51.34000015258789
Time for Epoch:163.21745324134827
Average single batch time this epoch: 11.103016427585057
Epoch 2, Loss: 0.963882565498352, Train Accuracy: 70.72230529785156,Test Loss: 0.4625936448574066, Test Accuracy: 85.52999877929688
Running Average Epoch time: 154.42996644973755

Time for Epoch:154.42996644973755
Average single batch time this epoch: 10.52995308807918
Epoch 3, Loss: 0.39615529775619507, Train Accuracy: 87.77030181884766,Test Loss: 0.28467386960983276, Test Accuracy: 91.0
Running Average Epoch time: 155.71844220161438

Time for Epoch:157.0069179534912
Average single batch time this epoch: 10.659604242869786
Epoch 4, Loss: 0.2617952525615692, Train Accuracy: 91.88057708740234,Test Loss: 0.220671609044075, Test Accuracy: 92.95999908447266
Running Average Epoch time: 155.76229095458984

Time for Epoch:155.84998846054077
Average single batch time this epoch: 10.593641076769147
Epoch 5, Loss: 0.19628681242465973, Train Accuracy: 93.96100616455078,Test Loss: 0.17205411195755005, Test Accuracy: 94.5
Running Average Epoch time: 155.76065027713776

Time for Epoch:155.7557282447815
Average single batch time this epoch: 10.58254485470908
Average time per Batch: 10.591435815606797
Average time per Epoch: 155.76065027713776
2020-12-14 22:10:43.624665: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 22:10:44.136432: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 22:10:44.136871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 22:10:44.137286: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:10:44.137472: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:10:44.137635: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:10:44.137794: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:10:44.137954: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:10:44.138112: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:10:44.138271: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:10:44.138328: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 22:10:44.180241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 22:10:44.184045: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f531c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 22:10:44.184110: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 22:10:44.188705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 22:10:44.188742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 22:10:44.563311: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 22:10:44.563458: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 22:10:44.563764: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:10:44.563812: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:10:44.563831: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:10:44.563871: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:10:44.563917: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 22:10:44.563942: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:10:44.563957: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f53b068dca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 22:22:53.523059: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:22:53.622351: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 22:22:53.681966: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov5524096/plugins/profile/2020_12_14_22_22_53
2020-12-14 22:22:53.745494: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov5524096/plugins/profile/2020_12_14_22_22_53/householder.trace.json.gz
2020-12-14 22:22:53.753847: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 22:22:53.759210: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 22:22:53.760905: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov5524096/plugins/profile/2020_12_14_22_22_53Dumped tool data for overview_page.pb to all_threads_smirnov5524096/plugins/profile/2020_12_14_22_22_53/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov5524096/plugins/profile/2020_12_14_22_22_53/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov5524096/plugins/profile/2020_12_14_22_22_53/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov5524096/plugins/profile/2020_12_14_22_22_53/householder.kernel_stats.pb

Epoch 1, Loss: 142.49842834472656, Train Accuracy: 30.365863800048828,Test Loss: 1.2269726991653442, Test Accuracy: 63.08000183105469
Time for Epoch:155.0523178577423
Average single batch time this epoch: 10.535215905734471
Epoch 2, Loss: 0.7517849802970886, Train Accuracy: 77.36991119384766,Test Loss: 0.4184909164905548, Test Accuracy: 87.58000183105469
Running Average Epoch time: 148.3064432144165

Time for Epoch:148.3064432144165
Average single batch time this epoch: 10.042844125202723
Epoch 3, Loss: 0.3426494002342224, Train Accuracy: 89.53334045410156,Test Loss: 0.2560471296310425, Test Accuracy: 92.11000061035156
Running Average Epoch time: 144.10393571853638

Time for Epoch:139.90142822265625
Average single batch time this epoch: 9.480576992034912
Epoch 4, Loss: 0.22245046496391296, Train Accuracy: 93.1640625,Test Loss: 0.18923988938331604, Test Accuracy: 94.19000244140625
Running Average Epoch time: 143.2475938796997

Time for Epoch:141.53491020202637
Average single batch time this epoch: 9.604544724736895
Epoch 5, Loss: 0.1646057516336441, Train Accuracy: 94.94454193115234,Test Loss: 0.14944913983345032, Test Accuracy: 95.1300048828125
Running Average Epoch time: 143.4680961370468

Time for Epoch:144.12960290908813
Average single batch time this epoch: 9.780368498393468
Average time per Batch: 9.727083585092
Average time per Epoch: 143.4680961370468
2020-12-14 22:22:57.729793: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 22:22:58.251227: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 22:22:58.251673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 22:22:58.252138: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:22:58.252353: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:22:58.252529: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:22:58.252683: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:22:58.252838: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:22:58.252990: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:22:58.253143: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:22:58.253172: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 22:22:58.296208: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 22:22:58.300896: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1390000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 22:22:58.300945: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 22:22:58.305199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 22:22:58.305256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 22:22:58.678441: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 22:22:58.678596: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 22:22:58.679695: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:22:58.679732: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:22:58.679751: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:22:58.679803: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:22:58.679860: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 22:22:58.679886: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:22:58.679901: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f142d5dad30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 22:33:49.786926: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:33:49.931643: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 22:33:49.992721: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov5554096/plugins/profile/2020_12_14_22_33_49
2020-12-14 22:33:50.060155: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov5554096/plugins/profile/2020_12_14_22_33_49/householder.trace.json.gz
2020-12-14 22:33:50.068946: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 22:33:50.074808: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 22:33:50.076573: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov5554096/plugins/profile/2020_12_14_22_33_49Dumped tool data for overview_page.pb to all_threads_smirnov5554096/plugins/profile/2020_12_14_22_33_49/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov5554096/plugins/profile/2020_12_14_22_33_49/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov5554096/plugins/profile/2020_12_14_22_33_49/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov5554096/plugins/profile/2020_12_14_22_33_49/householder.kernel_stats.pb

Epoch 1, Loss: 152.7280731201172, Train Accuracy: 22.879465103149414,Test Loss: 1.8937652111053467, Test Accuracy: 45.7599983215332
Time for Epoch:138.27245163917542
Average single batch time this epoch: 9.420722757066999
Epoch 2, Loss: 0.9887098670005798, Train Accuracy: 69.93233489990234,Test Loss: 0.5549722909927368, Test Accuracy: 82.47000122070312
Running Average Epoch time: 133.0475151538849

Time for Epoch:133.0475151538849
Average single batch time this epoch: 9.101887447493416
Epoch 3, Loss: 0.40265464782714844, Train Accuracy: 87.60289001464844,Test Loss: 0.31634363532066345, Test Accuracy: 90.27000427246094
Running Average Epoch time: 130.2998833656311

Time for Epoch:127.55225157737732
Average single batch time this epoch: 8.697430866105217
Epoch 4, Loss: 0.2670395076274872, Train Accuracy: 91.83000946044922,Test Loss: 0.22544965147972107, Test Accuracy: 93.08000183105469
Running Average Epoch time: 128.31613612174988

Time for Epoch:124.34864163398743
Average single batch time this epoch: 8.460804786000933
Epoch 5, Loss: 0.2030555158853531, Train Accuracy: 93.80928802490234,Test Loss: 0.18558166921138763, Test Accuracy: 94.05999755859375
Running Average Epoch time: 128.19665879011154

Time for Epoch:127.83822679519653
Average single batch time this epoch: 8.693262662206378
Average time per Batch: 8.738346440451487
Average time per Epoch: 128.19665879011154
2020-12-14 22:33:54.354230: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 22:33:54.878833: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 22:33:54.879230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 22:33:54.880050: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:33:54.880174: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:33:54.880274: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:33:54.880387: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:33:54.880486: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:33:54.880585: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:33:54.880683: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:33:54.880701: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 22:33:54.920229: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 22:33:54.923989: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0898000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 22:33:54.924071: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 22:33:54.928444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 22:33:54.928489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 22:33:55.980890: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 22:33:55.981018: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 22:33:55.981249: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 22:33:55.981272: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:33:55.981306: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:33:55.981334: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:33:55.981373: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 22:33:55.981393: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 22:33:55.981405: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f09399eaca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 23:05:59.933910: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:05:59.940786: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 23:05:59.973230: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_bini3228192/plugins/profile/2020_12_14_23_05_59
2020-12-14 23:06:00.009054: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_bini3228192/plugins/profile/2020_12_14_23_05_59/householder.trace.json.gz
2020-12-14 23:06:00.013200: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 23:06:00.016369: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 23:06:00.017904: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_bini3228192/plugins/profile/2020_12_14_23_05_59Dumped tool data for overview_page.pb to all_threads_bini3228192/plugins/profile/2020_12_14_23_05_59/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_bini3228192/plugins/profile/2020_12_14_23_05_59/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_bini3228192/plugins/profile/2020_12_14_23_05_59/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_bini3228192/plugins/profile/2020_12_14_23_05_59/householder.kernel_stats.pb

Epoch 1, Loss: 4005.220947265625, Train Accuracy: 17.829240798950195,Test Loss: 383.0576477050781, Test Accuracy: 30.100000381469727
Time for Epoch:393.43127822875977
Average single batch time this epoch: 53.07568553515843
Epoch 2, Loss: 129.66683959960938, Train Accuracy: 29.84270477294922,Test Loss: 9.554815292358398, Test Accuracy: 34.90999984741211
Running Average Epoch time: 382.240291595459

Time for Epoch:382.240291595459
Average single batch time this epoch: 51.508569853646414
Epoch 3, Loss: 4.810723304748535, Train Accuracy: 46.65701675415039,Test Loss: 1.3869004249572754, Test Accuracy: 65.12000274658203
Running Average Epoch time: 381.2488145828247

Time for Epoch:380.25733757019043
Average single batch time this epoch: 51.23895978927612
Epoch 4, Loss: 1.062315583229065, Train Accuracy: 68.8232421875,Test Loss: 0.6099417805671692, Test Accuracy: 80.54999542236328
Running Average Epoch time: 383.2002288500468

Time for Epoch:387.10305738449097
Average single batch time this epoch: 52.26385334559849
Epoch 5, Loss: 0.5561699271202087, Train Accuracy: 82.26318359375,Test Loss: 0.42962148785591125, Test Accuracy: 86.5999984741211
Running Average Epoch time: 382.6207488179207

Time for Epoch:380.88230872154236
Average single batch time this epoch: 51.3849664075034
Average time per Batch: 51.5990873490061
Average time per Epoch: 382.6207488179207
2020-12-14 23:06:03.631790: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 23:06:04.143313: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 23:06:04.143752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 23:06:04.144189: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:06:04.144360: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:06:04.144519: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:06:04.144675: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:06:04.144858: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:06:04.145046: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:06:04.145206: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:06:04.145237: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 23:06:04.188241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 23:06:04.192432: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fded0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 23:06:04.192499: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 23:06:04.197610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 23:06:04.197654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 23:06:05.262051: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 23:06:05.262185: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 23:06:05.263243: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:06:05.263275: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:06:05.263291: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:06:05.263323: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:06:05.263362: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 23:06:05.263382: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:06:05.263408: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fdf62922d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-14 23:29:44.926830: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:29:44.944193: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-14 23:29:44.993685: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_dgemm8192/plugins/profile/2020_12_14_23_29_44
2020-12-14 23:29:45.029585: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_dgemm8192/plugins/profile/2020_12_14_23_29_44/householder.trace.json.gz
2020-12-14 23:29:45.033771: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-14 23:29:45.036921: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-14 23:29:45.038413: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_dgemm8192/plugins/profile/2020_12_14_23_29_44Dumped tool data for overview_page.pb to all_threads_dgemm8192/plugins/profile/2020_12_14_23_29_44/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_dgemm8192/plugins/profile/2020_12_14_23_29_44/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_dgemm8192/plugins/profile/2020_12_14_23_29_44/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_dgemm8192/plugins/profile/2020_12_14_23_29_44/householder.kernel_stats.pb

Epoch 1, Loss: 4174.05322265625, Train Accuracy: 15.251813888549805,Test Loss: 404.1249694824219, Test Accuracy: 29.440000534057617
Time for Epoch:287.5146222114563
Average single batch time this epoch: 38.91233212607248
Epoch 2, Loss: 138.00210571289062, Train Accuracy: 30.45479965209961,Test Loss: 10.41592788696289, Test Accuracy: 34.31999969482422
Running Average Epoch time: 285.5019519329071

Time for Epoch:285.5019519329071
Average single batch time this epoch: 38.618489912578035
Epoch 3, Loss: 5.643022060394287, Train Accuracy: 45.76939010620117,Test Loss: 2.052272319793701, Test Accuracy: 61.119998931884766
Running Average Epoch time: 282.74311006069183

Time for Epoch:279.98426818847656
Average single batch time this epoch: 37.84346866607666
Epoch 4, Loss: 1.3997989892959595, Train Accuracy: 67.94956970214844,Test Loss: 0.8038235306739807, Test Accuracy: 73.32999420166016
Running Average Epoch time: 282.93799980481464

Time for Epoch:283.3277792930603
Average single batch time this epoch: 38.31384604317801
Epoch 5, Loss: 0.6035737991333008, Train Accuracy: 80.50013732910156,Test Loss: 0.5158471465110779, Test Accuracy: 83.81000518798828
Running Average Epoch time: 283.02628713846207

Time for Epoch:283.2911491394043
Average single batch time this epoch: 38.382253646850586
Average time per Batch: 38.289514567170826
Average time per Epoch: 283.02628713846207
2020-12-14 23:29:48.612424: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 23:29:49.123539: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 23:29:49.124117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 23:29:49.124528: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:49.124693: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:49.124846: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:49.124994: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:49.125150: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:49.125302: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:49.125451: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:49.125501: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 23:29:49.168409: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 23:29:49.171304: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5d5c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 23:29:49.171354: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 23:29:49.175175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 23:29:49.175206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 23:29:50.270847: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 23:29:50.270973: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 23:29:50.271224: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:50.271250: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:29:50.271270: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:29:50.271299: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:29:50.271358: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 23:29:50.271379: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:29:50.271392: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

Traceback (most recent call last):
  File "tensorboard_test.py", line 182, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:97 train_step  *
        predictions = model(images)
    tensorboard_test.py:86 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:67 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2020-12-14 23:29:50.937032: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:29:54.062364: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-14 23:29:54.582902: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-14 23:29:54.583290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-14 23:29:54.583639: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:54.583813: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:54.583979: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:54.584111: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:54.584266: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:54.584401: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:54.584533: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:54.584558: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-14 23:29:54.628096: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-14 23:29:54.630897: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f201c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-14 23:29:54.630953: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-14 23:29:54.635342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-14 23:29:54.635381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-14 23:29:55.744945: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 23:29:55.745081: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-14 23:29:55.745793: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-14 23:29:55.745852: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:29:55.745869: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:29:55.745902: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:29:55.745939: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-14 23:29:55.745958: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-14 23:29:55.745970: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f20b2c81d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-15 00:02:51.328305: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:02:51.335088: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-15 00:02:51.368226: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_schonhage3338192/plugins/profile/2020_12_15_00_02_51
2020-12-15 00:02:51.404816: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_schonhage3338192/plugins/profile/2020_12_15_00_02_51/householder.trace.json.gz
2020-12-15 00:02:51.409021: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-15 00:02:51.412251: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-15 00:02:51.413740: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_schonhage3338192/plugins/profile/2020_12_15_00_02_51Dumped tool data for overview_page.pb to all_threads_schonhage3338192/plugins/profile/2020_12_15_00_02_51/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_schonhage3338192/plugins/profile/2020_12_15_00_02_51/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_schonhage3338192/plugins/profile/2020_12_15_00_02_51/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_schonhage3338192/plugins/profile/2020_12_15_00_02_51/householder.kernel_stats.pb

Epoch 1, Loss: 4106.9169921875, Train Accuracy: 16.24755859375,Test Loss: 374.83233642578125, Test Accuracy: 29.969999313354492
Time for Epoch:403.1088910102844
Average single batch time this epoch: 54.45581872122629
Epoch 2, Loss: 120.30723571777344, Train Accuracy: 27.56521987915039,Test Loss: 14.346212387084961, Test Accuracy: 34.09000015258789
Running Average Epoch time: 395.3098340034485

Time for Epoch:395.3098340034485
Average single batch time this epoch: 53.38995279584612
Epoch 3, Loss: 7.313864707946777, Train Accuracy: 46.81222152709961,Test Loss: 2.392169237136841, Test Accuracy: 55.41999816894531
Running Average Epoch time: 393.6163738965988

Time for Epoch:391.92291378974915
Average single batch time this epoch: 52.981347356523784
Epoch 4, Loss: 1.3210963010787964, Train Accuracy: 66.62946319580078,Test Loss: 0.9112746119499207, Test Accuracy: 75.18000030517578
Running Average Epoch time: 393.36908944447833

Time for Epoch:392.8745205402374
Average single batch time this epoch: 53.01351186207363
Epoch 5, Loss: 0.6529561877250671, Train Accuracy: 80.32051849365234,Test Loss: 0.49951180815696716, Test Accuracy: 84.36000061035156
Running Average Epoch time: 393.1095955967903

Time for Epoch:392.3311140537262
Average single batch time this epoch: 53.014489378247944
Average time per Batch: 53.09982534817287
Average time per Epoch: 393.1095955967903
2020-12-15 00:02:56.610473: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-15 00:02:57.111850: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-15 00:02:57.112376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-15 00:02:57.112855: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:02:57.113064: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:02:57.113263: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:02:57.113458: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:02:57.113693: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:02:57.113890: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:02:57.114085: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:02:57.114123: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-15 00:02:57.152060: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-15 00:02:57.155058: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f26b0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-15 00:02:57.155109: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-15 00:02:57.159065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-15 00:02:57.159099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-15 00:02:58.233951: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 00:02:58.234077: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-15 00:02:58.234311: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:02:58.234334: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:02:58.234349: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:02:58.234377: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:02:58.234429: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 00:02:58.234449: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:02:58.234461: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f27436a3d30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-15 00:30:01.505407: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:30:01.519159: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-15 00:30:01.551303: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2248192/plugins/profile/2020_12_15_00_30_01
2020-12-15 00:30:01.586779: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2248192/plugins/profile/2020_12_15_00_30_01/householder.trace.json.gz
2020-12-15 00:30:01.590934: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-15 00:30:01.594264: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-15 00:30:01.595819: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2248192/plugins/profile/2020_12_15_00_30_01Dumped tool data for overview_page.pb to all_threads_smirnov2248192/plugins/profile/2020_12_15_00_30_01/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2248192/plugins/profile/2020_12_15_00_30_01/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2248192/plugins/profile/2020_12_15_00_30_01/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2248192/plugins/profile/2020_12_15_00_30_01/householder.kernel_stats.pb

Epoch 1, Loss: 4222.52783203125, Train Accuracy: 15.26053237915039,Test Loss: 404.78839111328125, Test Accuracy: 28.65999984741211
Time for Epoch:332.9069058895111
Average single batch time this epoch: 45.11044972283499
Epoch 2, Loss: 135.1973114013672, Train Accuracy: 28.28543472290039,Test Loss: 10.689576148986816, Test Accuracy: 34.75
Running Average Epoch time: 327.702805519104

Time for Epoch:327.702805519104
Average single batch time this epoch: 44.50645014217922
Epoch 3, Loss: 5.303117275238037, Train Accuracy: 46.07282257080078,Test Loss: 1.7016865015029907, Test Accuracy: 61.66999816894531
Running Average Epoch time: 322.95677757263184

Time for Epoch:318.21074962615967
Average single batch time this epoch: 43.13142882074629
Epoch 4, Loss: 1.1976240873336792, Train Accuracy: 69.26966857910156,Test Loss: 0.6876544952392578, Test Accuracy: 80.8499984741211
Running Average Epoch time: 323.0432747205098

Time for Epoch:323.21626901626587
Average single batch time this epoch: 43.873951707567485
Epoch 5, Loss: 0.6178165078163147, Train Accuracy: 81.23081970214844,Test Loss: 0.432770699262619, Test Accuracy: 87.05999755859375
Running Average Epoch time: 322.5820001959801

Time for Epoch:321.19817662239075
Average single batch time this epoch: 43.54625153541565
Average time per Batch: 43.76452055147716
Average time per Epoch: 322.5820001959801
2020-12-15 00:30:05.252931: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-15 00:30:05.760981: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-15 00:30:05.761497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-15 00:30:05.761977: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:30:05.762193: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:30:05.762395: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:30:05.762594: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:30:05.762806: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:30:05.763009: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:30:05.763243: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:30:05.763283: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-15 00:30:05.804086: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-15 00:30:05.806776: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff6ac000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-15 00:30:05.806821: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-15 00:30:05.810592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-15 00:30:05.810624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-15 00:30:06.865865: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 00:30:06.866006: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-15 00:30:06.866239: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:30:06.866263: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:30:06.866278: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:30:06.866305: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:30:06.866354: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 00:30:06.866376: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:30:06.866388: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ff7468f0ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-15 00:58:00.453610: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:58:00.473849: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-15 00:58:00.506656: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2258192/plugins/profile/2020_12_15_00_58_00
2020-12-15 00:58:00.542061: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2258192/plugins/profile/2020_12_15_00_58_00/householder.trace.json.gz
2020-12-15 00:58:00.546157: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-15 00:58:00.549281: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-15 00:58:00.550789: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2258192/plugins/profile/2020_12_15_00_58_00Dumped tool data for overview_page.pb to all_threads_smirnov2258192/plugins/profile/2020_12_15_00_58_00/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2258192/plugins/profile/2020_12_15_00_58_00/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2258192/plugins/profile/2020_12_15_00_58_00/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2258192/plugins/profile/2020_12_15_00_58_00/householder.kernel_stats.pb

Epoch 1, Loss: 3715.922607421875, Train Accuracy: 15.250070571899414,Test Loss: 305.51220703125, Test Accuracy: 19.470001220703125
Time for Epoch:345.70803236961365
Average single batch time this epoch: 47.02184779303415
Epoch 2, Loss: 98.46876525878906, Train Accuracy: 23.189870834350586,Test Loss: 9.949336051940918, Test Accuracy: 29.09000015258789
Running Average Epoch time: 332.0568845272064

Time for Epoch:332.0568845272064
Average single batch time this epoch: 45.150834696633474
Epoch 3, Loss: 5.282765865325928, Train Accuracy: 41.34870147705078,Test Loss: 2.295640707015991, Test Accuracy: 57.68000030517578
Running Average Epoch time: 331.1915304660797

Time for Epoch:330.326176404953
Average single batch time this epoch: 44.84792174611773
Epoch 4, Loss: 1.4198600053787231, Train Accuracy: 66.54052734375,Test Loss: 0.7962225079536438, Test Accuracy: 76.6500015258789
Running Average Epoch time: 332.01029388109845

Time for Epoch:333.64782071113586
Average single batch time this epoch: 45.3117892060961
Epoch 5, Loss: 0.7326669692993164, Train Accuracy: 78.91148376464844,Test Loss: 0.5427871942520142, Test Accuracy: 84.19000244140625
Running Average Epoch time: 331.9608764052391

Time for Epoch:331.81262397766113
Average single batch time this epoch: 44.80868904931204
Average time per Batch: 45.02980867453984
Average time per Epoch: 331.9608764052391
2020-12-15 00:58:04.898623: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-15 00:58:05.388917: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-15 00:58:05.389435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-15 00:58:05.389946: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:58:05.390171: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:58:05.390377: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:58:05.390605: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:58:05.390836: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:58:05.391036: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:58:05.391240: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:58:05.391278: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-15 00:58:05.432106: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-15 00:58:05.434660: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f21bc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-15 00:58:05.434705: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-15 00:58:05.438423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-15 00:58:05.438455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-15 00:58:06.543560: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 00:58:06.543691: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-15 00:58:06.543946: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 00:58:06.543972: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:58:06.543987: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:58:06.544015: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:58:06.544049: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 00:58:06.544069: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 00:58:06.544081: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f2256372ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-15 01:29:12.913925: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 01:29:12.920532: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-15 01:29:12.953568: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov2728192/plugins/profile/2020_12_15_01_29_12
2020-12-15 01:29:12.989269: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov2728192/plugins/profile/2020_12_15_01_29_12/householder.trace.json.gz
2020-12-15 01:29:12.993459: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-15 01:29:12.996712: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-15 01:29:12.998208: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov2728192/plugins/profile/2020_12_15_01_29_12Dumped tool data for overview_page.pb to all_threads_smirnov2728192/plugins/profile/2020_12_15_01_29_12/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov2728192/plugins/profile/2020_12_15_01_29_12/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov2728192/plugins/profile/2020_12_15_01_29_12/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov2728192/plugins/profile/2020_12_15_01_29_12/householder.kernel_stats.pb

Epoch 1, Loss: 154341441536.0, Train Accuracy: 10.112653732299805,Test Loss: 152041177088.0, Test Accuracy: 10.329999923706055
Time for Epoch:375.41707491874695
Average single batch time this epoch: 51.1245961529868
Epoch 2, Loss: 152150212608.0, Train Accuracy: 10.810197830200195,Test Loss: 159647875072.0, Test Accuracy: 11.100000381469727
Running Average Epoch time: 372.5284192562103

Time for Epoch:372.5284192562103
Average single batch time this epoch: 50.83027706827436
Epoch 3, Loss: 163111665664.0, Train Accuracy: 11.427525520324707,Test Loss: 175375400960.0, Test Accuracy: 11.59999942779541
Running Average Epoch time: 373.00996446609497

Time for Epoch:373.4915096759796
Average single batch time this epoch: 51.004410879952566
Epoch 4, Loss: 175050031104.0, Train Accuracy: 12.022181510925293,Test Loss: 186164658176.0, Test Accuracy: 12.899999618530273
Running Average Epoch time: 373.5221326351166

Time for Epoch:374.5464689731598
Average single batch time this epoch: 51.129676137651714
Epoch 5, Loss: 185485672448.0, Train Accuracy: 12.081473350524902,Test Loss: 194906341376.0, Test Accuracy: 13.070000648498535
Running Average Epoch time: 372.7298916578293

Time for Epoch:370.3531687259674
Average single batch time this epoch: 50.46824765205383
Average time per Batch: 50.858152934483115
Average time per Epoch: 372.7298916578293
2020-12-15 01:29:17.479388: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-15 01:29:17.965118: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-15 01:29:17.965520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-15 01:29:17.966431: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 01:29:17.966599: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 01:29:17.966721: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 01:29:17.966841: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 01:29:17.966962: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 01:29:17.967078: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 01:29:17.967196: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 01:29:17.967221: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-15 01:29:18.004208: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-15 01:29:18.008326: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fcdc8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-15 01:29:18.008409: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-15 01:29:18.012932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-15 01:29:18.012994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-15 01:29:19.106788: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 01:29:19.106907: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-15 01:29:19.107145: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 01:29:19.107170: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 01:29:19.107186: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 01:29:19.107215: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 01:29:19.107249: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 01:29:19.107268: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 01:29:19.107280: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fce5d9dfca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-15 02:00:39.191742: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 02:00:39.199752: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-15 02:00:39.239979: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3238192/plugins/profile/2020_12_15_02_00_39
2020-12-15 02:00:39.284477: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3238192/plugins/profile/2020_12_15_02_00_39/householder.trace.json.gz
2020-12-15 02:00:39.289561: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-15 02:00:39.293442: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-15 02:00:39.295294: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3238192/plugins/profile/2020_12_15_02_00_39Dumped tool data for overview_page.pb to all_threads_smirnov3238192/plugins/profile/2020_12_15_02_00_39/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3238192/plugins/profile/2020_12_15_02_00_39/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3238192/plugins/profile/2020_12_15_02_00_39/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3238192/plugins/profile/2020_12_15_02_00_39/householder.kernel_stats.pb

Epoch 1, Loss: 3399.41796875, Train Accuracy: 18.18673324584961,Test Loss: 159.40647888183594, Test Accuracy: 29.079999923706055
Time for Epoch:383.1638193130493
Average single batch time this epoch: 51.524751390729634
Epoch 2, Loss: 55.785770416259766, Train Accuracy: 26.39508819580078,Test Loss: 11.06783676147461, Test Accuracy: 23.780000686645508
Running Average Epoch time: 377.5718014240265

Time for Epoch:377.5718014240265
Average single batch time this epoch: 50.91695172446115
Epoch 3, Loss: 4.586575031280518, Train Accuracy: 45.03348159790039,Test Loss: 1.9135982990264893, Test Accuracy: 60.36000061035156
Running Average Epoch time: 375.2967426776886

Time for Epoch:373.0216839313507
Average single batch time this epoch: 50.26733916146414
Epoch 4, Loss: 1.3032909631729126, Train Accuracy: 66.90848541259766,Test Loss: 0.8693203330039978, Test Accuracy: 75.8800048828125
Running Average Epoch time: 373.0772747198741

Time for Epoch:368.638338804245
Average single batch time this epoch: 49.63792177609035
Epoch 5, Loss: 0.6967180967330933, Train Accuracy: 79.83049774169922,Test Loss: 0.4954344630241394, Test Accuracy: 84.97999572753906
Running Average Epoch time: 374.2209421992302

Time for Epoch:377.6519446372986
Average single batch time this epoch: 50.932214566639495
Average time per Batch: 50.43860680716379
Average time per Epoch: 374.2209421992302
2020-12-15 02:00:43.385893: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-15 02:00:43.893279: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-15 02:00:43.893759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-15 02:00:43.894222: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:00:43.894415: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:00:43.894600: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:00:43.894830: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:00:43.895015: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:00:43.895195: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:00:43.895375: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:00:43.895411: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-15 02:00:43.940160: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-15 02:00:43.944113: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4348000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-15 02:00:43.944164: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-15 02:00:43.948429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-15 02:00:43.948464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-15 02:00:45.045702: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 02:00:45.045831: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-15 02:00:45.046090: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:00:45.046117: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 02:00:45.046148: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 02:00:45.046178: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 02:00:45.046232: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 02:00:45.046254: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 02:00:45.046266: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f43e549dd30> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-15 02:32:17.353268: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 02:32:17.361019: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-15 02:32:17.394318: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3338192/plugins/profile/2020_12_15_02_32_17
2020-12-15 02:32:17.430280: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3338192/plugins/profile/2020_12_15_02_32_17/householder.trace.json.gz
2020-12-15 02:32:17.434476: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-15 02:32:17.437781: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-15 02:32:17.439307: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3338192/plugins/profile/2020_12_15_02_32_17Dumped tool data for overview_page.pb to all_threads_smirnov3338192/plugins/profile/2020_12_15_02_32_17/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3338192/plugins/profile/2020_12_15_02_32_17/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3338192/plugins/profile/2020_12_15_02_32_17/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3338192/plugins/profile/2020_12_15_02_32_17/householder.kernel_stats.pb

Epoch 1, Loss: 11497284567040.0, Train Accuracy: 9.706334114074707,Test Loss: 13322667687936.0, Test Accuracy: 9.84999942779541
Time for Epoch:384.8584589958191
Average single batch time this epoch: 51.98426948274885
Epoch 2, Loss: 15387799322624.0, Train Accuracy: 9.514509201049805,Test Loss: 17344167411712.0, Test Accuracy: 10.019999504089355
Running Average Epoch time: 374.7194595336914

Time for Epoch:374.7194595336914
Average single batch time this epoch: 50.40555613381522
Epoch 3, Loss: 23133610311680.0, Train Accuracy: 9.89990234375,Test Loss: 27218759647232.0, Test Accuracy: 10.100000381469727
Running Average Epoch time: 372.08322608470917

Time for Epoch:369.44699263572693
Average single batch time this epoch: 49.763520990099224
Epoch 4, Loss: 33742005469184.0, Train Accuracy: 10.067313194274902,Test Loss: 39364176379904.0, Test Accuracy: 9.610000610351562
Running Average Epoch time: 374.6535251935323

Time for Epoch:379.7941234111786
Average single batch time this epoch: 51.27189026560102
Epoch 5, Loss: 44505927516160.0, Train Accuracy: 10.037667274475098,Test Loss: 48687703130112.0, Test Accuracy: 9.760000228881836
Running Average Epoch time: 376.8533364534378

Time for Epoch:383.4527702331543
Average single batch time this epoch: 51.798043625695364
Average time per Batch: 50.809752753802705
Average time per Epoch: 376.8533364534378
2020-12-15 02:32:22.617128: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-15 02:32:23.127110: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-15 02:32:23.127498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-15 02:32:23.127903: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:32:23.128074: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:32:23.128209: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:32:23.128342: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:32:23.128497: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:32:23.128652: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:32:23.128786: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:32:23.128810: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-15 02:32:23.168168: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-15 02:32:23.170975: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3b44000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-15 02:32:23.171051: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-15 02:32:23.174756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-15 02:32:23.174787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-15 02:32:24.269250: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 02:32:24.269380: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-15 02:32:24.269623: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 02:32:24.269647: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 02:32:24.269663: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 02:32:24.269690: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 02:32:24.269724: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 02:32:24.269744: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 02:32:24.269774: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3bd7ec2ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-15 03:10:24.273309: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:10:24.287003: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-15 03:10:24.328632: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov3348192/plugins/profile/2020_12_15_03_10_24
2020-12-15 03:10:24.364925: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov3348192/plugins/profile/2020_12_15_03_10_24/householder.trace.json.gz
2020-12-15 03:10:24.369271: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-15 03:10:24.372589: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-15 03:10:24.374081: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov3348192/plugins/profile/2020_12_15_03_10_24Dumped tool data for overview_page.pb to all_threads_smirnov3348192/plugins/profile/2020_12_15_03_10_24/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov3348192/plugins/profile/2020_12_15_03_10_24/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov3348192/plugins/profile/2020_12_15_03_10_24/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov3348192/plugins/profile/2020_12_15_03_10_24/householder.kernel_stats.pb

Epoch 1, Loss: 3595.79638671875, Train Accuracy: 15.605817794799805,Test Loss: 224.64312744140625, Test Accuracy: 13.579999923706055
Time for Epoch:465.15705728530884
Average single batch time this epoch: 62.723883288247244
Epoch 2, Loss: 73.14170837402344, Train Accuracy: 23.017229080200195,Test Loss: 9.339612007141113, Test Accuracy: 40.77000045776367
Running Average Epoch time: 455.3017237186432

Time for Epoch:455.3017237186432
Average single batch time this epoch: 61.538882221494404
Epoch 3, Loss: 5.072688579559326, Train Accuracy: 49.94942855834961,Test Loss: 1.5854946374893188, Test Accuracy: 61.5
Running Average Epoch time: 456.0802261829376

Time for Epoch:456.85872864723206
Average single batch time this epoch: 61.67614262444632
Epoch 4, Loss: 1.177960753440857, Train Accuracy: 69.97942352294922,Test Loss: 0.6661118865013123, Test Accuracy: 81.05999755859375
Running Average Epoch time: 454.45496614774066

Time for Epoch:451.2044460773468
Average single batch time this epoch: 60.845798526491436
Epoch 5, Loss: 0.6260524392127991, Train Accuracy: 82.14286041259766,Test Loss: 0.4750007688999176, Test Accuracy: 85.97000122070312
Running Average Epoch time: 453.7020037174225

Time for Epoch:451.4431164264679
Average single batch time this epoch: 60.93673862729754
Average time per Batch: 61.24939049993242
Average time per Epoch: 453.7020037174225
2020-12-15 03:10:29.819896: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-15 03:10:30.330913: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-15 03:10:30.331312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-15 03:10:30.331697: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:10:30.331892: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:10:30.332058: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:10:30.332202: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:10:30.332344: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:10:30.332485: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:10:30.332626: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:10:30.332675: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-15 03:10:30.376225: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-15 03:10:30.379162: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4ee4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-15 03:10:30.379206: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-15 03:10:30.382908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-15 03:10:30.382939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-15 03:10:31.474832: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 03:10:31.474962: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-15 03:10:31.475207: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:10:31.475231: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:10:31.475246: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:10:31.475274: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:10:31.475308: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 03:10:31.475327: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:10:31.475340: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4f87d27ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-15 03:34:15.632352: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:34:15.638686: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-15 03:34:15.671666: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov4428192/plugins/profile/2020_12_15_03_34_15
2020-12-15 03:34:15.707800: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov4428192/plugins/profile/2020_12_15_03_34_15/householder.trace.json.gz
2020-12-15 03:34:15.712013: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-15 03:34:15.715084: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-15 03:34:15.716605: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov4428192/plugins/profile/2020_12_15_03_34_15Dumped tool data for overview_page.pb to all_threads_smirnov4428192/plugins/profile/2020_12_15_03_34_15/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov4428192/plugins/profile/2020_12_15_03_34_15/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov4428192/plugins/profile/2020_12_15_03_34_15/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov4428192/plugins/profile/2020_12_15_03_34_15/householder.kernel_stats.pb

Epoch 1, Loss: 3385.77685546875, Train Accuracy: 17.046247482299805,Test Loss: 181.06739807128906, Test Accuracy: 28.040000915527344
Time for Epoch:290.28287959098816
Average single batch time this epoch: 39.3586904321398
Epoch 2, Loss: 59.97539138793945, Train Accuracy: 33.92682647705078,Test Loss: 7.815206050872803, Test Accuracy: 42.22999954223633
Running Average Epoch time: 283.92835116386414

Time for Epoch:283.92835116386414
Average single batch time this epoch: 38.528886454445974
Epoch 3, Loss: 3.511460542678833, Train Accuracy: 54.58635711669922,Test Loss: 1.6676713228225708, Test Accuracy: 71.21000671386719
Running Average Epoch time: 284.2966902256012

Time for Epoch:284.66502928733826
Average single batch time this epoch: 38.649318661008564
Epoch 4, Loss: 1.1252754926681519, Train Accuracy: 74.04959869384766,Test Loss: 0.6104456782341003, Test Accuracy: 82.45999908447266
Running Average Epoch time: 284.0041051705678

Time for Epoch:283.4189350605011
Average single batch time this epoch: 38.50536830084665
Epoch 5, Loss: 0.5818485021591187, Train Accuracy: 82.53173828125,Test Loss: 0.46150997281074524, Test Accuracy: 85.8699951171875
Running Average Epoch time: 283.45957708358765

Time for Epoch:281.8259928226471
Average single batch time this epoch: 38.30966247831072
Average time per Batch: 38.498308973652975
Average time per Epoch: 283.45957708358765
2020-12-15 03:34:19.900476: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-15 03:34:20.455299: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-15 03:34:20.455748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-15 03:34:20.456210: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:34:20.456387: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:34:20.456549: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:34:20.456709: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:34:20.456895: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:34:20.457056: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:34:20.457215: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:34:20.457246: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-15 03:34:20.500211: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-15 03:34:20.503861: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5e2c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-15 03:34:20.503940: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-15 03:34:20.508376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-15 03:34:20.508414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-15 03:34:21.622732: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 03:34:21.622866: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-15 03:34:21.623117: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:34:21.623142: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:34:21.623157: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:34:21.623184: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:34:21.623223: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 03:34:21.623243: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:34:21.623256: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5ec860dca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
nn_test.sh: line 6: 25263 Segmentation fault      (core dumped) python tensorboard_test.py --layers 4 --nodes ${size} --epochs 5 --bs ${size} --mm ${name} --logdir all_threads_${name}${size}
2020-12-15 03:41:42.411211: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-15 03:41:42.891599: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-15 03:41:42.892153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-15 03:41:42.892626: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:41:42.892821: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:41:42.892992: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:41:42.893159: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:41:42.893348: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:41:42.893513: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:41:42.893681: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:41:42.893713: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-15 03:41:42.936285: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-15 03:41:42.940239: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4090000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-15 03:41:42.940297: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-15 03:41:42.945041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-15 03:41:42.945082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-15 03:41:44.045746: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 03:41:44.045872: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-15 03:41:44.046124: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 03:41:44.046150: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:41:44.046166: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:41:44.046196: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:41:44.046230: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 03:41:44.046249: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 03:41:44.046261: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f41269a0ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-15 04:26:35.694055: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 04:26:35.701420: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-15 04:26:35.732894: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov5528192/plugins/profile/2020_12_15_04_26_35
2020-12-15 04:26:35.768274: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov5528192/plugins/profile/2020_12_15_04_26_35/householder.trace.json.gz
2020-12-15 04:26:35.772337: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-15 04:26:35.775571: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-15 04:26:35.777103: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov5528192/plugins/profile/2020_12_15_04_26_35Dumped tool data for overview_page.pb to all_threads_smirnov5528192/plugins/profile/2020_12_15_04_26_35/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov5528192/plugins/profile/2020_12_15_04_26_35/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov5528192/plugins/profile/2020_12_15_04_26_35/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov5528192/plugins/profile/2020_12_15_04_26_35/householder.kernel_stats.pb

Epoch 1, Loss: 3540.588134765625, Train Accuracy: 18.19021987915039,Test Loss: 195.65892028808594, Test Accuracy: 15.870000839233398
Time for Epoch:549.7884707450867
Average single batch time this epoch: 74.15989981378827
Epoch 2, Loss: 65.1822509765625, Train Accuracy: 27.27225112915039,Test Loss: 7.877898216247559, Test Accuracy: 46.959999084472656
Running Average Epoch time: 534.8259253501892

Time for Epoch:534.8259253501892
Average single batch time this epoch: 72.04612115451268
Epoch 3, Loss: 4.728728294372559, Train Accuracy: 53.12848663330078,Test Loss: 2.6314010620117188, Test Accuracy: 63.150001525878906
Running Average Epoch time: 533.8812553882599

Time for Epoch:532.9365854263306
Average single batch time this epoch: 71.71054220199585
Epoch 4, Loss: 1.4618539810180664, Train Accuracy: 69.27838897705078,Test Loss: 0.8273722529411316, Test Accuracy: 76.54000091552734
Running Average Epoch time: 533.3956067562103

Time for Epoch:532.4243094921112
Average single batch time this epoch: 71.90177089827401
Epoch 5, Loss: 0.6608277559280396, Train Accuracy: 80.33621978759766,Test Loss: 0.48502030968666077, Test Accuracy: 85.13999938964844
Running Average Epoch time: 535.4561677575111

Time for Epoch:541.6378507614136
Average single batch time this epoch: 72.90667830194745
Average time per Batch: 72.14127813918249
Average time per Epoch: 535.4561677575111
2020-12-15 04:26:46.231150: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-15 04:26:46.743412: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-15 04:26:46.743915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2020-12-15 04:26:46.744402: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 04:26:46.744613: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 04:26:46.744850: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 04:26:46.745045: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 04:26:46.745249: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 04:26:46.745421: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 04:26:46.745614: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 04:26:46.745646: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-12-15 04:26:46.788131: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2020-12-15 04:26:46.792272: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f923c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-15 04:26:46.792423: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-15 04:26:46.797807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-15 04:26:46.797855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2020-12-15 04:26:47.903527: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 04:26:47.903658: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2020-12-15 04:26:47.903982: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2020-12-15 04:26:47.904007: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 04:26:47.904023: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 04:26:47.904051: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 04:26:47.904098: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2020-12-15 04:26:47.904120: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 04:26:47.904132: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f92d9ee0ca0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2020-12-15 05:07:20.252195: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2020-12-15 05:07:20.258606: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2020-12-15 05:07:20.293120: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: all_threads_smirnov5558192/plugins/profile/2020_12_15_05_07_20
2020-12-15 05:07:20.330740: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to all_threads_smirnov5558192/plugins/profile/2020_12_15_05_07_20/householder.trace.json.gz
2020-12-15 05:07:20.335100: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2020-12-15 05:07:20.338325: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2020-12-15 05:07:20.339890: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: all_threads_smirnov5558192/plugins/profile/2020_12_15_05_07_20Dumped tool data for overview_page.pb to all_threads_smirnov5558192/plugins/profile/2020_12_15_05_07_20/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to all_threads_smirnov5558192/plugins/profile/2020_12_15_05_07_20/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to all_threads_smirnov5558192/plugins/profile/2020_12_15_05_07_20/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to all_threads_smirnov5558192/plugins/profile/2020_12_15_05_07_20/householder.kernel_stats.pb

Epoch 1, Loss: 3391.331298828125, Train Accuracy: 16.781179428100586,Test Loss: 176.1949920654297, Test Accuracy: 17.56999969482422
Time for Epoch:499.20842838287354
Average single batch time this epoch: 67.40779658726284
Epoch 2, Loss: 61.612098693847656, Train Accuracy: 24.663434982299805,Test Loss: 12.253734588623047, Test Accuracy: 40.02000045776367
Running Average Epoch time: 490.7054193019867

Time for Epoch:490.7054193019867
Average single batch time this epoch: 66.22313155446734
Epoch 3, Loss: 5.015049934387207, Train Accuracy: 48.14278793334961,Test Loss: 1.9086999893188477, Test Accuracy: 61.44999694824219
Running Average Epoch time: 485.4330407381058

Time for Epoch:480.16066217422485
Average single batch time this epoch: 64.80785727500916
Epoch 4, Loss: 1.2092399597167969, Train Accuracy: 70.44677734375,Test Loss: 0.7250220775604248, Test Accuracy: 79.52999877929688
Running Average Epoch time: 484.4136657714844

Time for Epoch:482.3749158382416
Average single batch time this epoch: 65.00909852981567
Epoch 5, Loss: 0.6544936895370483, Train Accuracy: 80.74602508544922,Test Loss: 0.4744532108306885, Test Accuracy: 85.54999542236328
Running Average Epoch time: 483.2760462164879

Time for Epoch:479.8631875514984
Average single batch time this epoch: 64.73273723466056
Average time per Batch: 65.19320614848817
Average time per Epoch: 483.2760462164879
2021-02-22 17:37:36.523320: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-22 17:37:37.108152: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-22 17:37:37.108587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-22 17:37:37.108844: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:37:37.109014: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:37:37.109177: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:37:37.109387: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:37:37.109554: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:37:37.109714: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:37:37.109874: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:37:37.109904: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-22 17:37:37.148179: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-22 17:37:37.148605: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f40a0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-22 17:37:37.148653: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-22 17:37:37.153171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-22 17:37:37.153213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-22 17:37:37.275859: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 17:37:37.275996: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-22 17:37:37.276281: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:37:37.276311: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:37:37.276329: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:37:37.276384: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:37:37.276427: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 17:37:37.276450: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:37:37.276464: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f40d27c15e0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-22 17:39:41.844646: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:39:41.926653: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-22 17:39:42.473473: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: FINAL_1_thread_dgemm512/plugins/profile/2021_02_22_17_39_42
2021-02-22 17:39:42.989652: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to FINAL_1_thread_dgemm512/plugins/profile/2021_02_22_17_39_42/householder.trace.json.gz
2021-02-22 17:39:43.096797: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-22 17:39:43.140567: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-22 17:39:43.143133: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: FINAL_1_thread_dgemm512/plugins/profile/2021_02_22_17_39_42Dumped tool data for overview_page.pb to FINAL_1_thread_dgemm512/plugins/profile/2021_02_22_17_39_42/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to FINAL_1_thread_dgemm512/plugins/profile/2021_02_22_17_39_42/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to FINAL_1_thread_dgemm512/plugins/profile/2021_02_22_17_39_42/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to FINAL_1_thread_dgemm512/plugins/profile/2021_02_22_17_39_42/householder.kernel_stats.pb

Epoch 1, Loss: 0.32327353954315186, Train Accuracy: 90.47476196289062,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:26.08098578453064
Average single batch time this epoch: 0.220285705012134
Epoch 2, Loss: 0.10301115363836288, Train Accuracy: 96.88167572021484,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 24.655914783477783

Time for Epoch:24.655914783477783
Average single batch time this epoch: 0.21009258734874237
Epoch 3, Loss: 0.06551103293895721, Train Accuracy: 97.99179077148438,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 24.621891379356384

Time for Epoch:24.587867975234985
Average single batch time this epoch: 0.20951045068920168
Epoch 4, Loss: 0.057493358850479126, Train Accuracy: 98.17707824707031,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 24.61401875813802

Time for Epoch:24.598273515701294
Average single batch time this epoch: 0.20960956760960767
Epoch 5, Loss: 0.036968130618333817, Train Accuracy: 98.84148406982422,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 24.613074362277985

Time for Epoch:24.610241174697876
Average single batch time this epoch: 0.20970424016316733
Average time per Batch: 0.20972921145267978
Average time per Epoch: 24.613074362277985
2021-02-22 17:39:47.468295: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-22 17:39:48.031677: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-22 17:39:48.032273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-22 17:39:48.032574: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:39:48.032751: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:39:48.032918: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:39:48.033084: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:39:48.033254: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:39:48.033414: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:39:48.033606: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:39:48.033639: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-22 17:39:48.072244: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-22 17:39:48.072706: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f484c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-22 17:39:48.072770: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-22 17:39:48.077772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-22 17:39:48.077817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-22 17:39:48.199694: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 17:39:48.199854: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-22 17:39:48.200139: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:39:48.200169: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:39:48.200188: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:39:48.200223: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:39:48.200266: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 17:39:48.200290: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:39:48.200304: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f487fe58670> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-22 17:40:54.742963: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:40:54.822506: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-22 17:40:55.297954: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: FINAL_12_thread_dgemm512/plugins/profile/2021_02_22_17_40_54
2021-02-22 17:40:55.777687: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to FINAL_12_thread_dgemm512/plugins/profile/2021_02_22_17_40_54/householder.trace.json.gz
2021-02-22 17:40:55.876225: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-22 17:40:55.915120: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-22 17:40:55.917590: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: FINAL_12_thread_dgemm512/plugins/profile/2021_02_22_17_40_54Dumped tool data for overview_page.pb to FINAL_12_thread_dgemm512/plugins/profile/2021_02_22_17_40_54/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to FINAL_12_thread_dgemm512/plugins/profile/2021_02_22_17_40_54/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to FINAL_12_thread_dgemm512/plugins/profile/2021_02_22_17_40_54/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to FINAL_12_thread_dgemm512/plugins/profile/2021_02_22_17_40_54/householder.kernel_stats.pb

Epoch 1, Loss: 0.32327353954315186, Train Accuracy: 90.47476196289062,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:15.118466138839722
Average single batch time this epoch: 0.12639373795599
Epoch 2, Loss: 0.10301115363836288, Train Accuracy: 96.88167572021484,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 12.915931224822998

Time for Epoch:12.915931224822998
Average single batch time this epoch: 0.10980514379648063
Epoch 3, Loss: 0.06551103293895721, Train Accuracy: 97.99179077148438,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 12.997463345527649

Time for Epoch:13.0789954662323
Average single batch time this epoch: 0.11115841172699235
Epoch 4, Loss: 0.057493358850479126, Train Accuracy: 98.17707824707031,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 12.911868015925089

Time for Epoch:12.74067735671997
Average single batch time this epoch: 0.10830334924225114
Epoch 5, Loss: 0.036968130618333817, Train Accuracy: 98.84148406982422,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 12.847110092639923

Time for Epoch:12.652836322784424
Average single batch time this epoch: 0.10755794476240109
Average time per Batch: 0.1092062123820313
Average time per Epoch: 12.847110092639923
2021-02-22 17:41:00.218254: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-22 17:41:00.771345: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-22 17:41:00.771805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-22 17:41:00.772081: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:41:00.772258: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:41:00.772425: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:41:00.772591: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:41:00.772765: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:41:00.772929: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:41:00.773095: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:41:00.773124: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-22 17:41:00.812277: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-22 17:41:00.812697: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f68cc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-22 17:41:00.812734: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-22 17:41:00.816230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-22 17:41:00.816268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-22 17:41:01.096320: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 17:41:01.096468: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-22 17:41:01.096771: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:41:01.096801: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:41:01.096819: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:41:01.096853: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:41:01.096895: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 17:41:01.096919: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:41:01.096934: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f68fe6d2670> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-22 17:47:21.349915: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:47:21.459964: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-22 17:47:21.701307: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: FINAL_1_thread_dgemm1024/plugins/profile/2021_02_22_17_47_21
2021-02-22 17:47:21.952803: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to FINAL_1_thread_dgemm1024/plugins/profile/2021_02_22_17_47_21/householder.trace.json.gz
2021-02-22 17:47:22.001932: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-22 17:47:22.020197: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-22 17:47:22.022608: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: FINAL_1_thread_dgemm1024/plugins/profile/2021_02_22_17_47_21Dumped tool data for overview_page.pb to FINAL_1_thread_dgemm1024/plugins/profile/2021_02_22_17_47_21/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to FINAL_1_thread_dgemm1024/plugins/profile/2021_02_22_17_47_21/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to FINAL_1_thread_dgemm1024/plugins/profile/2021_02_22_17_47_21/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to FINAL_1_thread_dgemm1024/plugins/profile/2021_02_22_17_47_21/householder.kernel_stats.pb

Epoch 1, Loss: 0.5341726541519165, Train Accuracy: 84.60735321044922,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:77.96342587471008
Average single batch time this epoch: 1.3388733863830566
Epoch 2, Loss: 0.10124395787715912, Train Accuracy: 96.98949432373047,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.59893870353699

Time for Epoch:75.59893870353699
Average single batch time this epoch: 1.3021631775231197
Epoch 3, Loss: 0.06716670095920563, Train Accuracy: 97.85997772216797,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.56999385356903

Time for Epoch:75.54104900360107
Average single batch time this epoch: 1.3011537091485386
Epoch 4, Loss: 0.045483194291591644, Train Accuracy: 98.61092376708984,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.5688009262085

Time for Epoch:75.56641507148743
Average single batch time this epoch: 1.3015906235267376
Epoch 5, Loss: 0.03505110740661621, Train Accuracy: 98.85169982910156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 75.56350064277649

Time for Epoch:75.54759979248047
Average single batch time this epoch: 1.3012688571009143
Average time per Batch: 1.3015440918248276
Average time per Epoch: 75.56350064277649
2021-02-22 17:47:26.281875: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-22 17:47:26.847691: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-22 17:47:26.848365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-22 17:47:26.848717: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:47:26.848962: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:47:26.849167: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:47:26.849368: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:47:26.849583: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:47:26.849786: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:47:26.849987: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:47:26.850025: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-22 17:47:26.892353: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-22 17:47:26.892825: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fec98000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-22 17:47:26.892901: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-22 17:47:26.897312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-22 17:47:26.897354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-22 17:47:27.174201: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 17:47:27.174331: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-22 17:47:27.174607: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:47:27.174639: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:47:27.174659: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:47:27.174694: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:47:27.174739: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 17:47:27.174764: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:47:27.174779: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7feccc3aa5e0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-22 17:49:58.588484: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:49:58.716901: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-22 17:49:58.961276: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: FINAL_12_thread_dgemm1024/plugins/profile/2021_02_22_17_49_58
2021-02-22 17:49:59.209055: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to FINAL_12_thread_dgemm1024/plugins/profile/2021_02_22_17_49_58/householder.trace.json.gz
2021-02-22 17:49:59.257697: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-22 17:49:59.275969: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-22 17:49:59.278279: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: FINAL_12_thread_dgemm1024/plugins/profile/2021_02_22_17_49_58Dumped tool data for overview_page.pb to FINAL_12_thread_dgemm1024/plugins/profile/2021_02_22_17_49_58/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to FINAL_12_thread_dgemm1024/plugins/profile/2021_02_22_17_49_58/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to FINAL_12_thread_dgemm1024/plugins/profile/2021_02_22_17_49_58/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to FINAL_12_thread_dgemm1024/plugins/profile/2021_02_22_17_49_58/householder.kernel_stats.pb

Epoch 1, Loss: 0.5341726541519165, Train Accuracy: 84.60735321044922,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:32.003185510635376
Average single batch time this epoch: 0.5460336043916899
Epoch 2, Loss: 0.10124395787715912, Train Accuracy: 96.98949432373047,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.752803325653076

Time for Epoch:29.752803325653076
Average single batch time this epoch: 0.5116700221752298
Epoch 3, Loss: 0.06716670095920563, Train Accuracy: 97.85997772216797,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.784517288208008

Time for Epoch:29.81623125076294
Average single batch time this epoch: 0.5127727122142397
Epoch 4, Loss: 0.045483194291591644, Train Accuracy: 98.61092376708984,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.81187152862549

Time for Epoch:29.86658000946045
Average single batch time this epoch: 0.5136375098392881
Epoch 5, Loss: 0.03505110740661621, Train Accuracy: 98.85169982910156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 29.843815624713898

Time for Epoch:29.939647912979126
Average single batch time this epoch: 0.5148328583816002
Average time per Batch: 0.5132282756525894
Average time per Epoch: 29.843815624713898
2021-02-22 17:50:03.476092: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-22 17:50:04.011282: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-22 17:50:04.011738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-22 17:50:04.012604: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:50:04.012750: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:50:04.012879: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:50:04.013042: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:50:04.013171: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:50:04.013292: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:50:04.013418: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:50:04.013440: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-22 17:50:04.052209: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-22 17:50:04.052711: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fcc1c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-22 17:50:04.052803: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-22 17:50:04.057851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-22 17:50:04.057896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-22 17:50:04.922900: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 17:50:04.923032: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-22 17:50:04.923325: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 17:50:04.923354: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:50:04.923372: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:50:04.923426: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:50:04.923469: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 17:50:04.923493: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 17:50:04.923508: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fcc4ee49670> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-22 18:11:12.288533: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 18:11:12.405731: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-22 18:11:12.539391: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: FINAL_1_thread_dgemm2048/plugins/profile/2021_02_22_18_11_12
2021-02-22 18:11:12.678780: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to FINAL_1_thread_dgemm2048/plugins/profile/2021_02_22_18_11_12/householder.trace.json.gz
2021-02-22 18:11:12.702517: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-22 18:11:12.712358: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-22 18:11:12.714614: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: FINAL_1_thread_dgemm2048/plugins/profile/2021_02_22_18_11_12Dumped tool data for overview_page.pb to FINAL_1_thread_dgemm2048/plugins/profile/2021_02_22_18_11_12/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to FINAL_1_thread_dgemm2048/plugins/profile/2021_02_22_18_11_12/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to FINAL_1_thread_dgemm2048/plugins/profile/2021_02_22_18_11_12/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to FINAL_1_thread_dgemm2048/plugins/profile/2021_02_22_18_11_12/householder.kernel_stats.pb

Epoch 1, Loss: 9.23232650756836, Train Accuracy: 55.11348342895508,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:254.8357093334198
Average single batch time this epoch: 8.776774381769114
Epoch 2, Loss: 0.25126567482948303, Train Accuracy: 92.50404357910156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 252.514803647995

Time for Epoch:252.514803647995
Average single batch time this epoch: 8.704845724434689
Epoch 3, Loss: 0.14506620168685913, Train Accuracy: 95.60714721679688,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 252.70158410072327

Time for Epoch:252.88836455345154
Average single batch time this epoch: 8.71769017186658
Epoch 4, Loss: 0.09291068464517593, Train Accuracy: 97.13092803955078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 252.8977995713552

Time for Epoch:253.29023051261902
Average single batch time this epoch: 8.731593510200238
Epoch 5, Loss: 0.06734994053840637, Train Accuracy: 97.93070220947266,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 253.12364065647125

Time for Epoch:253.80116391181946
Average single batch time this epoch: 8.749172572431894
Average time per Batch: 8.72582549473335
Average time per Epoch: 253.12364065647125
2021-02-22 18:11:17.269548: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-22 18:11:17.795265: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-22 18:11:17.795699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-22 18:11:17.796019: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:11:17.796217: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:11:17.796406: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:11:17.796573: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:11:17.796744: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:11:17.796960: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:11:17.797126: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:11:17.797197: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-22 18:11:17.836227: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-22 18:11:17.836579: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9c20000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-22 18:11:17.836617: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-22 18:11:17.839030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-22 18:11:17.839055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-22 18:11:18.703111: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 18:11:18.703245: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-22 18:11:18.703549: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:11:18.703579: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 18:11:18.703598: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 18:11:18.703669: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 18:11:18.703716: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 18:11:18.703741: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 18:11:18.703756: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9c54d135e0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-22 18:17:18.313095: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 18:17:18.418307: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-22 18:17:18.542272: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: FINAL_12_thread_dgemm2048/plugins/profile/2021_02_22_18_17_18
2021-02-22 18:17:18.675716: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to FINAL_12_thread_dgemm2048/plugins/profile/2021_02_22_18_17_18/householder.trace.json.gz
2021-02-22 18:17:18.697360: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-22 18:17:18.706946: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-02-22 18:17:18.709157: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: FINAL_12_thread_dgemm2048/plugins/profile/2021_02_22_18_17_18Dumped tool data for overview_page.pb to FINAL_12_thread_dgemm2048/plugins/profile/2021_02_22_18_17_18/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to FINAL_12_thread_dgemm2048/plugins/profile/2021_02_22_18_17_18/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to FINAL_12_thread_dgemm2048/plugins/profile/2021_02_22_18_17_18/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to FINAL_12_thread_dgemm2048/plugins/profile/2021_02_22_18_17_18/householder.kernel_stats.pb

Epoch 1, Loss: 9.23232650756836, Train Accuracy: 55.11348342895508,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:75.40506029129028
Average single batch time this epoch: 2.5894146869922507
Epoch 2, Loss: 0.25126567482948303, Train Accuracy: 92.50404357910156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.77607893943787

Time for Epoch:71.77607893943787
Average single batch time this epoch: 2.4725107735600966
Epoch 3, Loss: 0.14506620168685913, Train Accuracy: 95.60714721679688,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.20528280735016

Time for Epoch:70.63448667526245
Average single batch time this epoch: 2.4331245504576584
Epoch 4, Loss: 0.09291068464517593, Train Accuracy: 97.13092803955078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.06967504819234

Time for Epoch:70.79845952987671
Average single batch time this epoch: 2.438786103807647
Epoch 5, Loss: 0.06734994053840637, Train Accuracy: 97.93070220947266,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 71.04226702451706

Time for Epoch:70.96004295349121
Average single batch time this epoch: 2.444289906271573
Average time per Batch: 2.447177833524244
Average time per Epoch: 71.04226702451706
2021-02-22 18:17:23.252864: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-22 18:17:23.816141: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-22 18:17:23.816757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-22 18:17:23.817368: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:17:23.817525: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:17:23.817653: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:17:23.817779: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:17:23.817912: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:17:23.818034: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:17:23.818158: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:17:23.818201: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-22 18:17:23.852234: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-22 18:17:23.852651: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f98e0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-22 18:17:23.852719: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-22 18:17:23.856494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-22 18:17:23.856533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-22 18:17:26.993034: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 18:17:26.993304: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-22 18:17:26.993713: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 18:17:26.993764: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 18:17:26.993795: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 18:17:26.993898: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 18:17:26.994000: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 18:17:26.994041: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 18:17:26.994066: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9913f675e0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-22 19:33:56.799583: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 19:33:56.904445: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-22 19:33:56.974879: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: FINAL_1_thread_dgemm4096/plugins/profile/2021_02_22_19_33_56
2021-02-22 19:33:57.049796: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to FINAL_1_thread_dgemm4096/plugins/profile/2021_02_22_19_33_56/householder.trace.json.gz
2021-02-22 19:33:57.060220: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-22 19:33:57.065262: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-22 19:33:57.067287: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: FINAL_1_thread_dgemm4096/plugins/profile/2021_02_22_19_33_56Dumped tool data for overview_page.pb to FINAL_1_thread_dgemm4096/plugins/profile/2021_02_22_19_33_56/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to FINAL_1_thread_dgemm4096/plugins/profile/2021_02_22_19_33_56/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to FINAL_1_thread_dgemm4096/plugins/profile/2021_02_22_19_33_56/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to FINAL_1_thread_dgemm4096/plugins/profile/2021_02_22_19_33_56/householder.kernel_stats.pb

Epoch 1, Loss: 165.1659393310547, Train Accuracy: 25.48653793334961,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:920.0666575431824
Average single batch time this epoch: 65.69552808148521
Epoch 2, Loss: 0.8463029265403748, Train Accuracy: 74.00599670410156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 916.6999270915985

Time for Epoch:916.6999270915985
Average single batch time this epoch: 65.47316711289542
Epoch 3, Loss: 0.33098104596138, Train Accuracy: 90.06696319580078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 917.0553086996078

Time for Epoch:917.4106903076172
Average single batch time this epoch: 65.52405531065804
Epoch 4, Loss: 0.20475950837135315, Train Accuracy: 93.94182586669922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 917.2385711669922

Time for Epoch:917.6050961017609
Average single batch time this epoch: 65.5379193850926
Epoch 5, Loss: 0.1382189244031906, Train Accuracy: 95.84786224365234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 917.4257141947746

Time for Epoch:917.987143278122
Average single batch time this epoch: 65.56514142240796
Average time per Batch: 65.52507080776351
Average time per Epoch: 917.4257141947746
2021-02-22 19:34:01.265683: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-22 19:34:01.791318: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-22 19:34:01.791767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-22 19:34:01.792092: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:34:01.792322: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:34:01.792509: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:34:01.792719: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:34:01.792918: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:34:01.793106: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:34:01.793292: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:34:01.793327: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-22 19:34:01.836218: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-22 19:34:01.836621: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f76f4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-22 19:34:01.837323: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-22 19:34:01.841046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-22 19:34:01.841077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-22 19:34:04.982303: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 19:34:04.982449: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-22 19:34:04.982754: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:34:04.982784: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 19:34:04.982808: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 19:34:04.982842: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 19:34:04.982902: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 19:34:04.982930: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 19:34:04.982946: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f7727ddb5e0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-22 19:51:57.782356: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 19:51:57.876656: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-22 19:51:57.945887: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: FINAL_12_thread_dgemm4096/plugins/profile/2021_02_22_19_51_57
2021-02-22 19:51:58.019183: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to FINAL_12_thread_dgemm4096/plugins/profile/2021_02_22_19_51_57/householder.trace.json.gz
2021-02-22 19:51:58.028995: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-22 19:51:58.033948: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-22 19:51:58.035929: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: FINAL_12_thread_dgemm4096/plugins/profile/2021_02_22_19_51_57Dumped tool data for overview_page.pb to FINAL_12_thread_dgemm4096/plugins/profile/2021_02_22_19_51_57/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to FINAL_12_thread_dgemm4096/plugins/profile/2021_02_22_19_51_57/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to FINAL_12_thread_dgemm4096/plugins/profile/2021_02_22_19_51_57/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to FINAL_12_thread_dgemm4096/plugins/profile/2021_02_22_19_51_57/householder.kernel_stats.pb

Epoch 1, Loss: 165.1659393310547, Train Accuracy: 25.48653793334961,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:214.22915768623352
Average single batch time this epoch: 15.27994099685124
Epoch 2, Loss: 0.8463029265403748, Train Accuracy: 74.00599670410156,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 209.10246515274048

Time for Epoch:209.10246515274048
Average single batch time this epoch: 14.930896946362086
Epoch 3, Loss: 0.33098104596138, Train Accuracy: 90.06696319580078,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 208.85465908050537

Time for Epoch:208.60685300827026
Average single batch time this epoch: 14.895131758281163
Epoch 4, Loss: 0.20475950837135315, Train Accuracy: 93.94182586669922,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 213.00392818450928

Time for Epoch:221.3024663925171
Average single batch time this epoch: 15.802318930625916
Epoch 5, Loss: 0.1382189244031906, Train Accuracy: 95.84786224365234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 214.6339145898819

Time for Epoch:219.52387380599976
Average single batch time this epoch: 15.675257580620903
Average time per Batch: 15.325901303972516
Average time per Epoch: 214.6339145898819
2021-02-22 19:52:02.265049: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-22 19:52:02.832802: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-22 19:52:02.833248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-22 19:52:02.834213: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:52:02.834376: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:52:02.834511: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:52:02.834654: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:52:02.834786: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:52:02.834912: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:52:02.835038: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:52:02.835068: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-22 19:52:02.868218: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-22 19:52:02.868585: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd4b4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-22 19:52:02.868622: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-22 19:52:02.871093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-22 19:52:02.871118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-22 19:52:15.081951: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 19:52:15.082114: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-22 19:52:15.082963: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-22 19:52:15.082992: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 19:52:15.083045: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 19:52:15.083117: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 19:52:15.083193: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-22 19:52:15.083220: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-22 19:52:15.083235: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd4e7ee15e0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-23 00:38:27.909082: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-23 00:38:27.916395: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-23 00:38:27.957302: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: FINAL_1_thread_dgemm8192/plugins/profile/2021_02_23_00_38_27
2021-02-23 00:38:27.999390: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to FINAL_1_thread_dgemm8192/plugins/profile/2021_02_23_00_38_27/householder.trace.json.gz
2021-02-23 00:38:28.004552: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-23 00:38:28.007346: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.006 ms

2021-02-23 00:38:28.009229: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: FINAL_1_thread_dgemm8192/plugins/profile/2021_02_23_00_38_27Dumped tool data for overview_page.pb to FINAL_1_thread_dgemm8192/plugins/profile/2021_02_23_00_38_27/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to FINAL_1_thread_dgemm8192/plugins/profile/2021_02_23_00_38_27/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to FINAL_1_thread_dgemm8192/plugins/profile/2021_02_23_00_38_27/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to FINAL_1_thread_dgemm8192/plugins/profile/2021_02_23_00_38_27/householder.kernel_stats.pb

Epoch 1, Loss: 4174.49755859375, Train Accuracy: 15.253557205200195,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:3438.2758662700653
Average single batch time this epoch: 491.1373051575252
Epoch 2, Loss: 138.0056915283203, Train Accuracy: 30.46875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3434.05766582489

Time for Epoch:3434.05766582489
Average single batch time this epoch: 490.56865324292863
Epoch 3, Loss: 5.650033473968506, Train Accuracy: 45.7275390625,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3433.647369146347

Time for Epoch:3433.237072467804
Average single batch time this epoch: 490.45152875355313
Epoch 4, Loss: 1.3960411548614502, Train Accuracy: 68.02803802490234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3433.56795668602

Time for Epoch:3433.4091317653656
Average single batch time this epoch: 490.4759397166116
Epoch 5, Loss: 0.6027077436447144, Train Accuracy: 80.60302734375,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 3433.6290466189384

Time for Epoch:3433.812316417694
Average single batch time this epoch: 490.53356616837635
Average time per Batch: 490.5074219703675
Average time per Epoch: 3433.6290466189384
2021-02-23 00:38:32.424459: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-02-23 00:38:32.979973: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-23 00:38:32.980548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-02-23 00:38:32.981269: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-23 00:38:32.981423: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-23 00:38:32.981548: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-23 00:38:32.981672: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-23 00:38:32.981804: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-23 00:38:32.981944: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-23 00:38:32.982070: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-23 00:38:32.982094: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-02-23 00:38:33.016323: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-02-23 00:38:33.016705: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f455c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-23 00:38:33.016755: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-23 00:38:33.020286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-23 00:38:33.020327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-02-23 00:38:45.218472: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-23 00:38:45.218679: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-02-23 00:38:45.219567: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-02-23 00:38:45.219599: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-23 00:38:45.219632: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-23 00:38:45.219680: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-23 00:38:45.219732: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-02-23 00:38:45.219757: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-23 00:38:45.219785: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f458f2225e0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-02-23 01:26:41.277108: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-02-23 01:26:41.284497: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-02-23 01:26:41.326192: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: FINAL_12_thread_dgemm8192/plugins/profile/2021_02_23_01_26_41
2021-02-23 01:26:41.368287: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to FINAL_12_thread_dgemm8192/plugins/profile/2021_02_23_01_26_41/householder.trace.json.gz
2021-02-23 01:26:41.373506: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-02-23 01:26:41.376341: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-02-23 01:26:41.378218: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: FINAL_12_thread_dgemm8192/plugins/profile/2021_02_23_01_26_41Dumped tool data for overview_page.pb to FINAL_12_thread_dgemm8192/plugins/profile/2021_02_23_01_26_41/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to FINAL_12_thread_dgemm8192/plugins/profile/2021_02_23_01_26_41/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to FINAL_12_thread_dgemm8192/plugins/profile/2021_02_23_01_26_41/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to FINAL_12_thread_dgemm8192/plugins/profile/2021_02_23_01_26_41/householder.kernel_stats.pb

Epoch 1, Loss: 4174.49755859375, Train Accuracy: 15.253557205200195,Test Loss: 0.0, Test Accuracy: 0.0
Time for Epoch:581.3529980182648
Average single batch time this epoch: 83.00257870129177
Epoch 2, Loss: 138.0056915283203, Train Accuracy: 30.46875,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 582.973616361618

Time for Epoch:582.973616361618
Average single batch time this epoch: 83.27100423404148
Epoch 3, Loss: 5.650033473968506, Train Accuracy: 45.7275390625,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 576.7393735647202

Time for Epoch:570.5051307678223
Average single batch time this epoch: 81.49022381646293
Epoch 4, Loss: 1.3960411548614502, Train Accuracy: 68.02803802490234,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 574.0648041566213

Time for Epoch:568.7156653404236
Average single batch time this epoch: 81.23467806407383
Epoch 5, Loss: 0.6027077436447144, Train Accuracy: 80.60302734375,Test Loss: 0.0, Test Accuracy: 0.0
Running Average Epoch time: 573.6675161123276

Time for Epoch:572.4756519794464
Average single batch time this epoch: 81.77148175239563
Average time per Batch: 81.94184696674347
Average time per Epoch: 573.6675161123276
