2021-03-04 00:00:51.279621: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:00:51.811333: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:00:51.811800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:00:51.812084: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:00:51.812272: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:00:51.812441: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:00:51.812626: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:00:51.812810: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:00:51.812971: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:00:51.813134: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:00:51.813164: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:00:51.852245: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:00:51.852644: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9168000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:00:51.852682: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:00:51.856127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:00:51.856167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:00:51.960567: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:00:51.960704: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:00:51.960983: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:00:51.961012: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:00:51.961031: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:00:51.961064: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:00:51.961113: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:00:51.961138: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:00:51.961153: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f919d4e24c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:02:15.847584: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:02:15.944735: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:02:16.431035: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_bini322512/plugins/profile/2021_03_04_00_02_16
2021-03-04 00:02:16.928033: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_bini322512/plugins/profile/2021_03_04_00_02_16/householder.trace.json.gz
2021-03-04 00:02:17.026662: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:02:17.064337: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:02:17.066765: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_bini322512/plugins/profile/2021_03_04_00_02_16Dumped tool data for overview_page.pb to PAPER_6_threads_bini322512/plugins/profile/2021_03_04_00_02_16/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_bini322512/plugins/profile/2021_03_04_00_02_16/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_bini322512/plugins/profile/2021_03_04_00_02_16/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_bini322512/plugins/profile/2021_03_04_00_02_16/householder.kernel_stats.pb

Time for Epoch:18.275855541229248
Average single batch time this epoch: 0.15619777206681731
Running Average Epoch time: 16.580363988876343

Time for Epoch:16.580363988876343
Average single batch time this epoch: 0.1417068334726187
Running Average Epoch time: 16.41240644454956

Time for Epoch:16.24444890022278
Average single batch time this epoch: 0.13883563799735826
Running Average Epoch time: 16.380338271458943

Time for Epoch:16.31620192527771
Average single batch time this epoch: 0.1394487894498385
Running Average Epoch time: 16.398238480091095

Time for Epoch:16.45193910598755
Average single batch time this epoch: 0.14060861228877664
Average time per Batch: 0.14014996830214801
Average time per Epoch: 16.398238480091095
batch size 512
epochs 5
nodes 512
num layers 4
algorithm bini322
num threads 6
total time 85.3811821937561
2021-03-04 00:02:21.343603: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:02:21.895386: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:02:21.895852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:02:21.896136: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:02:21.896341: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:02:21.896545: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:02:21.896726: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:02:21.896910: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:02:21.897097: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:02:21.897262: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:02:21.897292: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:02:21.936180: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:02:21.936621: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4bfc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:02:21.936671: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:02:21.941305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:02:21.941349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:02:22.046793: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:02:22.046932: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:02:22.047232: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:02:22.047283: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:02:22.047303: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:02:22.047338: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:02:22.047397: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:02:22.047424: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:02:22.047439: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4c31084430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:03:32.228806: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:03:32.303885: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:03:32.784332: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_dgemm512/plugins/profile/2021_03_04_00_03_32
2021-03-04 00:03:33.261428: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_dgemm512/plugins/profile/2021_03_04_00_03_32/householder.trace.json.gz
2021-03-04 00:03:33.357198: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:03:33.395146: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 00:03:33.397582: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_dgemm512/plugins/profile/2021_03_04_00_03_32Dumped tool data for overview_page.pb to PAPER_6_threads_dgemm512/plugins/profile/2021_03_04_00_03_32/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_dgemm512/plugins/profile/2021_03_04_00_03_32/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_dgemm512/plugins/profile/2021_03_04_00_03_32/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_dgemm512/plugins/profile/2021_03_04_00_03_32/householder.kernel_stats.pb

Time for Epoch:15.10547423362732
Average single batch time this epoch: 0.1291007832584218
Running Average Epoch time: 13.636683940887451

Time for Epoch:13.636683940887451
Average single batch time this epoch: 0.11654762936453535
Running Average Epoch time: 13.710986971855164

Time for Epoch:13.785290002822876
Average single batch time this epoch: 0.11781768513540937
Running Average Epoch time: 13.75930635134379

Time for Epoch:13.855945110321045
Average single batch time this epoch: 0.11842161162286742
Running Average Epoch time: 13.76514220237732

Time for Epoch:13.782649755477905
Average single batch time this epoch: 0.11779519431611411
Average time per Batch: 0.11764553010973157
Average time per Epoch: 13.76514220237732
batch size 512
epochs 5
nodes 512
num layers 4
algorithm dgemm
num threads 6
total time 71.70198392868042
2021-03-04 00:03:37.696483: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:03:38.256166: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:03:38.256763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:03:38.257120: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:38.257333: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:38.257544: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:38.257751: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:38.257954: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:38.258183: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:38.258385: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:38.258423: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:03:38.300431: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:03:38.300883: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0584000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:03:38.300940: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:03:38.305954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:03:38.306000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:03:38.409692: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:03:38.409836: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:03:38.410140: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:38.410171: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:03:38.410190: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:03:38.410226: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:03:38.410267: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:03:38.410291: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:03:38.410305: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-04 00:03:39.091114: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:03:43.061586: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:03:43.616042: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:03:43.616620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:03:43.617090: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:43.617228: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:43.617353: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:43.617476: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:43.617605: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:43.617728: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:43.617852: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:43.617876: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:03:43.656328: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:03:43.656819: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe8d0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:03:43.656957: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:03:43.662605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:03:43.662652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:03:43.764445: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:03:43.764569: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:03:43.764850: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:03:43.764881: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:03:43.764899: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:03:43.764934: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:03:43.764983: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:03:43.765007: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:03:43.765022: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fe902891430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:05:08.171746: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:05:08.265273: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:05:08.744907: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_schonhage333512/plugins/profile/2021_03_04_00_05_08
2021-03-04 00:05:09.250350: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_schonhage333512/plugins/profile/2021_03_04_00_05_08/householder.trace.json.gz
2021-03-04 00:05:09.347403: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:05:09.385378: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 00:05:09.387843: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_schonhage333512/plugins/profile/2021_03_04_00_05_08Dumped tool data for overview_page.pb to PAPER_6_threads_schonhage333512/plugins/profile/2021_03_04_00_05_08/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_schonhage333512/plugins/profile/2021_03_04_00_05_08/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_schonhage333512/plugins/profile/2021_03_04_00_05_08/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_schonhage333512/plugins/profile/2021_03_04_00_05_08/householder.kernel_stats.pb

Time for Epoch:17.858501195907593
Average single batch time this epoch: 0.15262987267257822
Running Average Epoch time: 16.77544641494751

Time for Epoch:16.77544641494751
Average single batch time this epoch: 0.14337292491880238
Running Average Epoch time: 16.633108735084534

Time for Epoch:16.490771055221558
Average single batch time this epoch: 0.14093934368883443
Running Average Epoch time: 16.64107584953308

Time for Epoch:16.657010078430176
Average single batch time this epoch: 0.1423595338805109
Running Average Epoch time: 16.63255923986435

Time for Epoch:16.607009410858154
Average single batch time this epoch: 0.1419336571652665
Average time per Batch: 0.14215136491335356
Average time per Epoch: 16.63255923986435
batch size 512
epochs 5
nodes 512
num layers 4
algorithm schonhage333
num threads 6
total time 85.91587352752686
2021-03-04 00:05:13.677699: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:05:14.207210: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:05:14.207656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:05:14.207942: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:05:14.208125: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:05:14.208309: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:05:14.208528: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:05:14.208718: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:05:14.208879: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:05:14.209043: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:05:14.209073: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:05:14.248320: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:05:14.248753: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2c08000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:05:14.248802: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:05:14.253437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:05:14.253480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:05:14.358754: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:05:14.358891: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:05:14.359157: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:05:14.359185: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:05:14.359225: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:05:14.359260: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:05:14.359302: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:05:14.359326: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:05:14.359341: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f2c3a27b430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:06:28.265205: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:06:28.379118: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:06:28.843428: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov224512/plugins/profile/2021_03_04_00_06_28
2021-03-04 00:06:29.318008: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov224512/plugins/profile/2021_03_04_00_06_28/householder.trace.json.gz
2021-03-04 00:06:29.414524: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:06:29.465571: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 00:06:29.468187: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov224512/plugins/profile/2021_03_04_00_06_28Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov224512/plugins/profile/2021_03_04_00_06_28/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov224512/plugins/profile/2021_03_04_00_06_28/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov224512/plugins/profile/2021_03_04_00_06_28/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov224512/plugins/profile/2021_03_04_00_06_28/householder.kernel_stats.pb

Time for Epoch:15.996467590332031
Average single batch time this epoch: 0.13671580339089417
Running Average Epoch time: 14.26647138595581

Time for Epoch:14.26647138595581
Average single batch time this epoch: 0.12193040562491132
Running Average Epoch time: 14.272016644477844

Time for Epoch:14.277561902999878
Average single batch time this epoch: 0.12202526157737797
Running Average Epoch time: 14.347948710123697

Time for Epoch:14.499812841415405
Average single batch time this epoch: 0.12392463643326719
Running Average Epoch time: 14.473840892314911

Time for Epoch:14.85151743888855
Average single batch time this epoch: 0.12692872886983758
Average time per Batch: 0.12370225812634851
Average time per Epoch: 14.473840892314911
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov224
num threads 6
total time 75.41119694709778
2021-03-04 00:06:33.795327: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:06:34.319303: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:06:34.319747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:06:34.320045: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:06:34.320227: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:06:34.320389: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:06:34.320558: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:06:34.320722: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:06:34.320882: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:06:34.321094: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:06:34.321152: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:06:34.356100: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:06:34.356435: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7538000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:06:34.356485: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:06:34.359647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:06:34.359680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:06:34.463118: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:06:34.463235: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:06:34.463516: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:06:34.463559: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:06:34.463582: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:06:34.463651: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:06:34.463697: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:06:34.463721: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:06:34.463736: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f756df834c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:07:52.004166: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:07:52.091417: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:07:52.611085: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov225512/plugins/profile/2021_03_04_00_07_52
2021-03-04 00:07:53.121744: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov225512/plugins/profile/2021_03_04_00_07_52/householder.trace.json.gz
2021-03-04 00:07:53.227041: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:07:53.266128: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:07:53.268564: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov225512/plugins/profile/2021_03_04_00_07_52Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov225512/plugins/profile/2021_03_04_00_07_52/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov225512/plugins/profile/2021_03_04_00_07_52/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov225512/plugins/profile/2021_03_04_00_07_52/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov225512/plugins/profile/2021_03_04_00_07_52/householder.kernel_stats.pb

Time for Epoch:16.916481733322144
Average single batch time this epoch: 0.14457954504551032
Running Average Epoch time: 15.20539379119873

Time for Epoch:15.20539379119873
Average single batch time this epoch: 0.12995579507615831
Running Average Epoch time: 15.197043299674988

Time for Epoch:15.188692808151245
Average single batch time this epoch: 0.12981296196962014
Running Average Epoch time: 15.163315375645956

Time for Epoch:15.09585952758789
Average single batch time this epoch: 0.1290194234277448
Running Average Epoch time: 15.152606546878815

Time for Epoch:15.120480060577393
Average single batch time this epoch: 0.1292299409197946
Average time per Batch: 0.12950453034832946
Average time per Epoch: 15.152606546878815
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov225
num threads 6
total time 79.02168321609497
2021-03-04 00:07:57.612245: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:07:58.135890: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:07:58.136492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:07:58.136874: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:07:58.137093: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:07:58.137300: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:07:58.137509: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:07:58.137714: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:07:58.137914: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:07:58.138117: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:07:58.138154: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:07:58.180252: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:07:58.180684: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc920000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:07:58.180749: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:07:58.185407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:07:58.185455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:07:58.287694: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:07:58.287841: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:07:58.288141: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:07:58.288172: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:07:58.288191: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:07:58.288227: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:07:58.288270: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:07:58.288293: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:07:58.288308: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc952ed7430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:09:18.132256: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:09:18.240112: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:09:18.749771: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov272512/plugins/profile/2021_03_04_00_09_18
2021-03-04 00:09:19.252924: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov272512/plugins/profile/2021_03_04_00_09_18/householder.trace.json.gz
2021-03-04 00:09:19.356216: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:09:19.394548: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:09:19.396980: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov272512/plugins/profile/2021_03_04_00_09_18Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov272512/plugins/profile/2021_03_04_00_09_18/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov272512/plugins/profile/2021_03_04_00_09_18/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov272512/plugins/profile/2021_03_04_00_09_18/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov272512/plugins/profile/2021_03_04_00_09_18/householder.kernel_stats.pb

Time for Epoch:16.83185577392578
Average single batch time this epoch: 0.1438557694100926
Running Average Epoch time: 16.16770911216736

Time for Epoch:16.16770911216736
Average single batch time this epoch: 0.13817688542553502
Running Average Epoch time: 15.944104552268982

Time for Epoch:15.720499992370605
Average single batch time this epoch: 0.13435737291971842
Running Average Epoch time: 15.801229317982992

Time for Epoch:15.51547884941101
Average single batch time this epoch: 0.13260522255530724
Running Average Epoch time: 15.749329388141632

Time for Epoch:15.593629598617554
Average single batch time this epoch: 0.13327294333368286
Average time per Batch: 0.1346031060585609
Average time per Epoch: 15.749329388141632
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov272
num threads 6
total time 81.32523250579834
2021-03-04 00:09:23.683192: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:09:24.248974: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:09:24.249429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:09:24.249727: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:09:24.249911: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:09:24.250096: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:09:24.250322: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:09:24.250518: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:09:24.250681: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:09:24.250847: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:09:24.250879: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:09:24.292355: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:09:24.292787: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f98a4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:09:24.292837: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:09:24.297474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:09:24.297518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:09:24.400895: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:09:24.401027: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:09:24.401304: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:09:24.401333: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:09:24.401373: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:09:24.401409: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:09:24.401457: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:09:24.401482: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:09:24.401497: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f98d9f32430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:10:46.671902: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:10:46.785486: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:10:47.275697: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov323512/plugins/profile/2021_03_04_00_10_46
2021-03-04 00:10:47.774446: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov323512/plugins/profile/2021_03_04_00_10_46/householder.trace.json.gz
2021-03-04 00:10:47.874589: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:10:47.912140: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:10:47.914558: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov323512/plugins/profile/2021_03_04_00_10_46Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov323512/plugins/profile/2021_03_04_00_10_46/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov323512/plugins/profile/2021_03_04_00_10_46/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov323512/plugins/profile/2021_03_04_00_10_46/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov323512/plugins/profile/2021_03_04_00_10_46/householder.kernel_stats.pb

Time for Epoch:18.18425440788269
Average single batch time this epoch: 0.15541430212493634
Running Average Epoch time: 15.996355295181274

Time for Epoch:15.996355295181274
Average single batch time this epoch: 0.13671495568039072
Running Average Epoch time: 15.976266622543335

Time for Epoch:15.956177949905396
Average single batch time this epoch: 0.13637149435842139
Running Average Epoch time: 15.977156003316244

Time for Epoch:15.97893476486206
Average single batch time this epoch: 0.13656596444610858
Running Average Epoch time: 16.01695078611374

Time for Epoch:16.136335134506226
Average single batch time this epoch: 0.13791100999228975
Average time per Batch: 0.1368908561193026
Average time per Epoch: 16.01695078611374
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov323
num threads 6
total time 83.81179237365723
2021-03-04 00:10:52.196685: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:10:52.755608: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:10:52.756244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:10:52.756597: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:10:52.756816: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:10:52.757021: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:10:52.757230: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:10:52.757436: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:10:52.757638: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:10:52.757867: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:10:52.757904: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:10:52.800203: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:10:52.800627: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5bbc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:10:52.800685: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:10:52.805049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:10:52.805088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:10:52.903121: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:10:52.903256: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:10:52.903532: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:10:52.903563: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:10:52.903582: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:10:52.903618: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:10:52.903660: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:10:52.903683: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:10:52.903698: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5bf195d4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:12:16.841637: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:12:16.963304: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:12:17.478891: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov333512/plugins/profile/2021_03_04_00_12_17
2021-03-04 00:12:18.018316: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov333512/plugins/profile/2021_03_04_00_12_17/householder.trace.json.gz
2021-03-04 00:12:18.122581: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:12:18.161321: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:12:18.163950: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov333512/plugins/profile/2021_03_04_00_12_17Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov333512/plugins/profile/2021_03_04_00_12_17/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov333512/plugins/profile/2021_03_04_00_12_17/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov333512/plugins/profile/2021_03_04_00_12_17/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov333512/plugins/profile/2021_03_04_00_12_17/householder.kernel_stats.pb

Time for Epoch:18.419864654541016
Average single batch time this epoch: 0.15742814031421629
Running Average Epoch time: 16.65980553627014

Time for Epoch:16.65980553627014
Average single batch time this epoch: 0.14238495908231816
Running Average Epoch time: 16.49426555633545

Time for Epoch:16.328725576400757
Average single batch time this epoch: 0.13955551538711938
Running Average Epoch time: 16.421036958694458

Time for Epoch:16.274579763412476
Average single batch time this epoch: 0.13909268379211426
Running Average Epoch time: 16.375260412693024

Time for Epoch:16.23793077468872
Average single batch time this epoch: 0.1387797869168795
Average time per Batch: 0.13995323629460782
Average time per Epoch: 16.375260412693024
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov333
num threads 6
total time 85.44260573387146
2021-03-04 00:12:22.454011: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:12:23.009304: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:12:23.009749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:12:23.010076: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:12:23.010256: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:12:23.010436: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:12:23.010629: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:12:23.010822: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:12:23.010985: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:12:23.011148: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:12:23.011178: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:12:23.052246: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:12:23.052673: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe224000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:12:23.052755: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:12:23.057361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:12:23.057404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:12:23.163183: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:12:23.163305: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:12:23.163564: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:12:23.163593: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:12:23.163611: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:12:23.163646: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:12:23.163703: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:12:23.163729: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:12:23.163744: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fe25852d430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:13:48.001266: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:13:48.097019: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:13:48.577352: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov334512/plugins/profile/2021_03_04_00_13_48
2021-03-04 00:13:49.062600: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov334512/plugins/profile/2021_03_04_00_13_48/householder.trace.json.gz
2021-03-04 00:13:49.157479: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:13:49.194925: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 00:13:49.197376: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov334512/plugins/profile/2021_03_04_00_13_48Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov334512/plugins/profile/2021_03_04_00_13_48/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov334512/plugins/profile/2021_03_04_00_13_48/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov334512/plugins/profile/2021_03_04_00_13_48/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov334512/plugins/profile/2021_03_04_00_13_48/householder.kernel_stats.pb

Time for Epoch:18.29817485809326
Average single batch time this epoch: 0.15638795469561192
Running Average Epoch time: 16.630217790603638

Time for Epoch:16.630217790603638
Average single batch time this epoch: 0.14213266128148788
Running Average Epoch time: 16.644465923309326

Time for Epoch:16.658714056015015
Average single batch time this epoch: 0.142376284314017
Running Average Epoch time: 16.63293480873108

Time for Epoch:16.609872579574585
Average single batch time this epoch: 0.14195888674157298
Running Average Epoch time: 16.630489885807037

Time for Epoch:16.623155117034912
Average single batch time this epoch: 0.14207247791127262
Average time per Batch: 0.14213507756208763
Average time per Epoch: 16.630489885807037
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov334
num threads 6
total time 86.37393832206726
2021-03-04 00:13:53.492093: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:13:54.043836: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:13:54.044276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:13:54.044544: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:13:54.044729: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:13:54.044899: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:13:54.045099: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:13:54.045269: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:13:54.045436: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:13:54.045606: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:13:54.045638: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:13:54.084148: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:13:54.084583: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8244000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:13:54.084649: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:13:54.088926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:13:54.088963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:13:54.197328: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:13:54.197448: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:13:54.197725: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:13:54.197758: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:13:54.197792: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:13:54.197831: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:13:54.197875: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:13:54.197899: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:13:54.197914: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f82767d4430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:15:06.584997: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:15:06.675695: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:15:07.159292: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov442512/plugins/profile/2021_03_04_00_15_06
2021-03-04 00:15:07.631145: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov442512/plugins/profile/2021_03_04_00_15_06/householder.trace.json.gz
2021-03-04 00:15:07.729236: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:15:07.766403: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:15:07.768957: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov442512/plugins/profile/2021_03_04_00_15_06Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov442512/plugins/profile/2021_03_04_00_15_06/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov442512/plugins/profile/2021_03_04_00_15_06/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov442512/plugins/profile/2021_03_04_00_15_06/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov442512/plugins/profile/2021_03_04_00_15_06/householder.kernel_stats.pb

Time for Epoch:15.811038494110107
Average single batch time this epoch: 0.1351309433961526
Running Average Epoch time: 13.915585279464722

Time for Epoch:13.915585279464722
Average single batch time this epoch: 0.11893225327516213
Running Average Epoch time: 13.949761271476746

Time for Epoch:13.98393726348877
Average single batch time this epoch: 0.1195162524524917
Running Average Epoch time: 14.048173824946085

Time for Epoch:14.244998931884766
Average single batch time this epoch: 0.12174755691463111
Running Average Epoch time: 14.13881778717041

Time for Epoch:14.410749673843384
Average single batch time this epoch: 0.123163420929868
Average time per Batch: 0.12083987089303823
Average time per Epoch: 14.13881778717041
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov442
num threads 6
total time 73.88405132293701
2021-03-04 00:15:12.181116: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:15:12.700171: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:15:12.700772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:15:12.701123: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:15:12.701341: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:15:12.701545: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:15:12.701754: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:15:12.701958: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:15:12.702157: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:15:12.702387: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:15:12.702425: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:15:12.744273: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:15:12.744688: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f491c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:15:12.744737: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:15:12.749308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:15:12.749353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:15:12.849387: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:15:12.849514: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:15:12.849791: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:15:12.849823: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:15:12.849847: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:15:12.849883: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:15:12.849925: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:15:12.849949: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:15:12.849964: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f494fe30430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:16:31.386553: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:16:31.481499: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:16:31.966267: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov444512/plugins/profile/2021_03_04_00_16_31
2021-03-04 00:16:32.471455: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov444512/plugins/profile/2021_03_04_00_16_31/householder.trace.json.gz
2021-03-04 00:16:32.569165: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:16:32.607494: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 00:16:32.609927: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov444512/plugins/profile/2021_03_04_00_16_31Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov444512/plugins/profile/2021_03_04_00_16_31/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov444512/plugins/profile/2021_03_04_00_16_31/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov444512/plugins/profile/2021_03_04_00_16_31/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov444512/plugins/profile/2021_03_04_00_16_31/householder.kernel_stats.pb

Time for Epoch:16.82000422477722
Average single batch time this epoch: 0.14375351025508
Running Average Epoch time: 15.482283353805542

Time for Epoch:15.482283353805542
Average single batch time this epoch: 0.13232049982771915
Running Average Epoch time: 15.409052610397339

Time for Epoch:15.335821866989136
Average single batch time this epoch: 0.13106854756673178
Running Average Epoch time: 15.401658376057943

Time for Epoch:15.38686990737915
Average single batch time this epoch: 0.1315048393021282
Running Average Epoch time: 15.424535691738129

Time for Epoch:15.493167638778687
Average single batch time this epoch: 0.13241353809324086
Average time per Batch: 0.131826856197455
Average time per Epoch: 15.424535691738129
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov444
num threads 6
total time 80.00197434425354
2021-03-04 00:16:36.883674: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:16:37.447408: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:16:37.447887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:16:37.448222: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:16:37.448414: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:16:37.448598: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:16:37.448793: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:16:37.448985: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:16:37.449147: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:16:37.449311: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:16:37.449341: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:16:37.488196: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:16:37.488576: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff6d8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:16:37.488668: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:16:37.493474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:16:37.493512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:16:37.597482: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:16:37.597624: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:16:37.597925: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:16:37.597955: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:16:37.597978: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:16:37.598014: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:16:37.598056: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:16:37.598080: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:16:37.598095: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ff70bbb04c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:18:01.894413: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:18:02.009238: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:18:02.523983: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov552512/plugins/profile/2021_03_04_00_18_02
2021-03-04 00:18:03.033517: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov552512/plugins/profile/2021_03_04_00_18_02/householder.trace.json.gz
2021-03-04 00:18:03.139452: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:18:03.178003: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 00:18:03.180469: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov552512/plugins/profile/2021_03_04_00_18_02Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov552512/plugins/profile/2021_03_04_00_18_02/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov552512/plugins/profile/2021_03_04_00_18_02/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov552512/plugins/profile/2021_03_04_00_18_02/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov552512/plugins/profile/2021_03_04_00_18_02/householder.kernel_stats.pb

Time for Epoch:17.622718334197998
Average single batch time this epoch: 0.15061595297267294
Running Average Epoch time: 16.607816219329834

Time for Epoch:16.607816219329834
Average single batch time this epoch: 0.14194107870770317
Running Average Epoch time: 16.620280981063843

Time for Epoch:16.63274574279785
Average single batch time this epoch: 0.1421539049882155
Running Average Epoch time: 16.623171885808308

Time for Epoch:16.62895369529724
Average single batch time this epoch: 0.14212163289388022
Running Average Epoch time: 16.663889169692993

Time for Epoch:16.786041021347046
Average single batch time this epoch: 0.14346425553672335
Average time per Batch: 0.14242021803163057
Average time per Epoch: 16.663889169692993
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov552
num threads 6
total time 85.82615971565247
2021-03-04 00:18:07.484499: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:18:08.035881: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:18:08.036326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:18:08.036634: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:18:08.036822: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:18:08.037012: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:18:08.037242: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:18:08.037441: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:18:08.037610: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:18:08.037782: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:18:08.037813: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:18:08.076234: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:18:08.076752: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7faa54000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:18:08.076826: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:18:08.081518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:18:08.081562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:18:08.184833: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:18:08.184965: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:18:08.185238: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:18:08.185267: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:18:08.185287: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:18:08.185342: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:18:08.185386: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:18:08.185410: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:18:08.185426: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7faa89f68430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:19:37.977946: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:19:38.086676: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:19:38.665836: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov555512/plugins/profile/2021_03_04_00_19_38
2021-03-04 00:19:39.163403: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov555512/plugins/profile/2021_03_04_00_19_38/householder.trace.json.gz
2021-03-04 00:19:39.287856: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:19:39.328303: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 00:19:39.330993: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov555512/plugins/profile/2021_03_04_00_19_38Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov555512/plugins/profile/2021_03_04_00_19_38/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov555512/plugins/profile/2021_03_04_00_19_38/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov555512/plugins/profile/2021_03_04_00_19_38/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov555512/plugins/profile/2021_03_04_00_19_38/householder.kernel_stats.pb

Time for Epoch:18.973825216293335
Average single batch time this epoch: 0.16216403398758325
Running Average Epoch time: 17.75497841835022

Time for Epoch:17.75497841835022
Average single batch time this epoch: 0.15174607741527069
Running Average Epoch time: 17.780797362327576

Time for Epoch:17.80661630630493
Average single batch time this epoch: 0.15218712122012407
Running Average Epoch time: 17.705222527186077

Time for Epoch:17.554072856903076
Average single batch time this epoch: 0.15002723229237092
Running Average Epoch time: 17.69868016242981

Time for Epoch:17.67905306816101
Average single batch time this epoch: 0.1510955064724653
Average time per Batch: 0.15126398435005775
Average time per Epoch: 17.69868016242981
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov555
num threads 6
total time 91.31681203842163
2021-03-04 00:19:43.645756: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:19:44.167226: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:19:44.167665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:19:44.167971: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:19:44.168151: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:19:44.168320: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:19:44.168485: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:19:44.168649: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:19:44.168808: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:19:44.169034: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:19:44.169064: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:19:44.208385: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:19:44.208779: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff720000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:19:44.208828: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:19:44.212071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:19:44.212112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:19:44.475840: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:19:44.475974: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:19:44.476251: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:19:44.476280: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:19:44.476298: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:19:44.476367: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:19:44.476427: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:19:44.476454: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:19:44.476470: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ff7548c5430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:22:42.562576: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:22:42.605095: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:22:42.834027: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_bini3221024/plugins/profile/2021_03_04_00_22_42
2021-03-04 00:22:43.078754: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_bini3221024/plugins/profile/2021_03_04_00_22_42/householder.trace.json.gz
2021-03-04 00:22:43.126948: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:22:43.145627: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:22:43.147925: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_bini3221024/plugins/profile/2021_03_04_00_22_42Dumped tool data for overview_page.pb to PAPER_6_threads_bini3221024/plugins/profile/2021_03_04_00_22_42/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_bini3221024/plugins/profile/2021_03_04_00_22_42/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_bini3221024/plugins/profile/2021_03_04_00_22_42/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_bini3221024/plugins/profile/2021_03_04_00_22_42/householder.kernel_stats.pb

Time for Epoch:37.471779584884644
Average single batch time this epoch: 0.6460573344395079
Running Average Epoch time: 35.09693694114685

Time for Epoch:35.09693694114685
Average single batch time this epoch: 0.6051124211015373
Running Average Epoch time: 35.07451641559601

Time for Epoch:35.052095890045166
Average single batch time this epoch: 0.6043396941546736
Running Average Epoch time: 35.13570292790731

Time for Epoch:35.25807595252991
Average single batch time this epoch: 0.6078912060836266
Running Average Epoch time: 35.14926880598068

Time for Epoch:35.189966440200806
Average single batch time this epoch: 0.6067167314989813
Average time per Batch: 0.6060150132097047
Average time per Epoch: 35.14926880598068
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm bini322
num threads 6
total time 179.73833680152893
2021-03-04 00:22:47.501062: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:22:48.055692: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:22:48.056267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:22:48.056620: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:22:48.056845: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:22:48.057054: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:22:48.057264: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:22:48.057475: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:22:48.057683: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:22:48.057887: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:22:48.057927: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:22:48.096366: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:22:48.096778: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9d54000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:22:48.096842: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:22:48.101510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:22:48.101558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:22:48.356460: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:22:48.356615: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:22:48.356939: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:22:48.356971: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:22:48.356996: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:22:48.357033: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:22:48.357077: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:22:48.357101: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:22:48.357115: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9d89bb04c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:25:40.394881: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:25:40.527385: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:25:40.769692: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_dgemm1024/plugins/profile/2021_03_04_00_25_40
2021-03-04 00:25:41.008878: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_dgemm1024/plugins/profile/2021_03_04_00_25_40/householder.trace.json.gz
2021-03-04 00:25:41.056366: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:25:41.074245: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:25:41.076501: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_dgemm1024/plugins/profile/2021_03_04_00_25_40Dumped tool data for overview_page.pb to PAPER_6_threads_dgemm1024/plugins/profile/2021_03_04_00_25_40/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_dgemm1024/plugins/profile/2021_03_04_00_25_40/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_dgemm1024/plugins/profile/2021_03_04_00_25_40/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_dgemm1024/plugins/profile/2021_03_04_00_25_40/householder.kernel_stats.pb

Time for Epoch:35.84873127937317
Average single batch time this epoch: 0.6180747747421265
Running Average Epoch time: 33.673375606536865

Time for Epoch:33.673375606536865
Average single batch time this epoch: 0.5805688562064335
Running Average Epoch time: 33.87302088737488

Time for Epoch:34.07266616821289
Average single batch time this epoch: 0.5874528144967968
Running Average Epoch time: 33.956932385762535

Time for Epoch:34.12475538253784
Average single batch time this epoch: 0.58835127024815
Running Average Epoch time: 34.04389536380768

Time for Epoch:34.304784297943115
Average single batch time this epoch: 0.5914551348521792
Average time per Batch: 0.5869570189508898
Average time per Epoch: 34.04389536380768
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm dgemm
num threads 6
total time 173.69347047805786
2021-03-04 00:25:45.256119: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:25:45.789184: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:25:45.789654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:25:45.790506: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:45.790670: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:45.790804: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:45.790955: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:45.791090: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:45.791219: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:45.791348: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:45.791378: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:25:45.824259: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:25:45.824691: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f29f0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:25:45.824755: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:25:45.828265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:25:45.828302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:25:46.094567: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:25:46.094649: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:25:46.094860: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:46.094905: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:25:46.094928: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:25:46.094983: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:25:46.095049: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:25:46.095076: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:25:46.095092: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-04 00:25:46.828711: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:25:50.817168: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:25:51.371722: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:25:51.372197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:25:51.372424: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:51.372631: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:51.372827: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:51.373028: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:51.373207: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:51.373379: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:51.373555: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:51.373636: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:25:51.412161: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:25:51.412588: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1f78000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:25:51.412637: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:25:51.417256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:25:51.417299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:25:51.674549: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:25:51.674681: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:25:51.674964: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:25:51.674993: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:25:51.675012: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:25:51.675046: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:25:51.675104: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:25:51.675131: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:25:51.675146: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f1fad22b4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:28:48.261509: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:28:48.398297: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:28:48.648026: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_schonhage3331024/plugins/profile/2021_03_04_00_28_48
2021-03-04 00:28:48.898571: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_schonhage3331024/plugins/profile/2021_03_04_00_28_48/householder.trace.json.gz
2021-03-04 00:28:48.948238: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:28:48.966427: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 00:28:48.968767: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_schonhage3331024/plugins/profile/2021_03_04_00_28_48Dumped tool data for overview_page.pb to PAPER_6_threads_schonhage3331024/plugins/profile/2021_03_04_00_28_48/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_schonhage3331024/plugins/profile/2021_03_04_00_28_48/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_schonhage3331024/plugins/profile/2021_03_04_00_28_48/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_schonhage3331024/plugins/profile/2021_03_04_00_28_48/householder.kernel_stats.pb

Time for Epoch:36.76938223838806
Average single batch time this epoch: 0.633947413543175
Running Average Epoch time: 35.271690130233765

Time for Epoch:35.271690130233765
Average single batch time this epoch: 0.6081269650623716
Running Average Epoch time: 35.13152289390564

Time for Epoch:34.991355657577515
Average single batch time this epoch: 0.6032941629146708
Running Average Epoch time: 35.01820397377014

Time for Epoch:34.791566133499146
Average single batch time this epoch: 0.5998498900183316
Running Average Epoch time: 34.95091438293457

Time for Epoch:34.749045610427856
Average single batch time this epoch: 0.5991166460103002
Average time per Batch: 0.6025969160014185
Average time per Epoch: 34.95091438293457
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm schonhage333
num threads 6
total time 178.26868605613708
2021-03-04 00:28:53.166699: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:28:53.707340: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:28:53.707814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:28:53.708604: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:28:53.708779: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:28:53.708913: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:28:53.709043: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:28:53.709173: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:28:53.709296: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:28:53.709421: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:28:53.709446: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:28:53.744206: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:28:53.744635: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f41f8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:28:53.744708: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:28:53.748388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:28:53.748431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:28:54.010733: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:28:54.010867: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:28:54.011106: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:28:54.011137: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:28:54.011156: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:28:54.011191: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:28:54.011233: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:28:54.011256: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:28:54.011271: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f422def94c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:31:45.861244: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:31:45.988895: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:31:46.286127: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2241024/plugins/profile/2021_03_04_00_31_46
2021-03-04 00:31:46.541654: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2241024/plugins/profile/2021_03_04_00_31_46/householder.trace.json.gz
2021-03-04 00:31:46.594949: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:31:46.619733: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:31:46.622157: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2241024/plugins/profile/2021_03_04_00_31_46Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2241024/plugins/profile/2021_03_04_00_31_46/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2241024/plugins/profile/2021_03_04_00_31_46/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2241024/plugins/profile/2021_03_04_00_31_46/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2241024/plugins/profile/2021_03_04_00_31_46/householder.kernel_stats.pb

Time for Epoch:35.48885464668274
Average single batch time this epoch: 0.6118695982571306
Running Average Epoch time: 33.610639810562134

Time for Epoch:33.610639810562134
Average single batch time this epoch: 0.5794884911898909
Running Average Epoch time: 33.60790753364563

Time for Epoch:33.605175256729126
Average single batch time this epoch: 0.5793943816217882
Running Average Epoch time: 33.76099650065104

Time for Epoch:34.067174434661865
Average single batch time this epoch: 0.5873594201844314
Running Average Epoch time: 34.08662390708923

Time for Epoch:35.06350612640381
Average single batch time this epoch: 0.6045361551745184
Average time per Batch: 0.5876946120426573
Average time per Epoch: 34.08662390708923
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov224
num threads 6
total time 173.511638879776
2021-03-04 00:31:50.872339: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:31:51.415527: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:31:51.416122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:31:51.416439: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:31:51.416639: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:31:51.416832: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:31:51.417021: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:31:51.417240: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:31:51.417427: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:31:51.417614: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:31:51.417650: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:31:51.456304: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:31:51.456743: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fdccc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:31:51.456800: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:31:51.461796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:31:51.461839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:31:51.722887: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:31:51.723042: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:31:51.723355: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:31:51.723386: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:31:51.723406: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:31:51.723442: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:31:51.723503: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:31:51.723530: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:31:51.723545: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fdd0001c430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:34:52.306845: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:34:52.451733: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:34:52.701440: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2251024/plugins/profile/2021_03_04_00_34_52
2021-03-04 00:34:52.958725: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2251024/plugins/profile/2021_03_04_00_34_52/householder.trace.json.gz
2021-03-04 00:34:53.009402: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:34:53.028052: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:34:53.030327: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2251024/plugins/profile/2021_03_04_00_34_52Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2251024/plugins/profile/2021_03_04_00_34_52/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2251024/plugins/profile/2021_03_04_00_34_52/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2251024/plugins/profile/2021_03_04_00_34_52/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2251024/plugins/profile/2021_03_04_00_34_52/householder.kernel_stats.pb

Time for Epoch:37.01072955131531
Average single batch time this epoch: 0.6381089317387548
Running Average Epoch time: 35.54108691215515

Time for Epoch:35.54108691215515
Average single batch time this epoch: 0.6127694023066553
Running Average Epoch time: 35.796797037124634

Time for Epoch:36.052507162094116
Average single batch time this epoch: 0.6215874491066768
Running Average Epoch time: 36.06518371899923

Time for Epoch:36.60195708274841
Average single batch time this epoch: 0.6310603947475039
Running Average Epoch time: 35.8890141248703

Time for Epoch:35.36050534248352
Average single batch time this epoch: 0.609656153054073
Average time per Batch: 0.6187683498037273
Average time per Epoch: 35.8890141248703
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov225
num threads 6
total time 182.2400722503662
2021-03-04 00:34:57.193261: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:34:57.743700: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:34:57.744213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:34:57.744828: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:34:57.744984: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:34:57.745108: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:34:57.745230: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:34:57.745361: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:34:57.745483: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:34:57.745624: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:34:57.745676: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:34:57.780250: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:34:57.780628: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f39ec000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:34:57.780677: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:34:57.783899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:34:57.783941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:34:58.047625: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:34:58.047758: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:34:58.048051: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:34:58.048096: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:34:58.048118: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:34:58.048185: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:34:58.048253: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:34:58.048280: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:34:58.048296: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3a1f535430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:38:00.390035: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:38:00.426912: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:38:00.663768: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2721024/plugins/profile/2021_03_04_00_38_00
2021-03-04 00:38:00.905719: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2721024/plugins/profile/2021_03_04_00_38_00/householder.trace.json.gz
2021-03-04 00:38:00.952974: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:38:00.971204: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:38:00.973469: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2721024/plugins/profile/2021_03_04_00_38_00Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2721024/plugins/profile/2021_03_04_00_38_00/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2721024/plugins/profile/2021_03_04_00_38_00/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2721024/plugins/profile/2021_03_04_00_38_00/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2721024/plugins/profile/2021_03_04_00_38_00/householder.kernel_stats.pb

Time for Epoch:38.37312173843384
Average single batch time this epoch: 0.6615974697573431
Running Average Epoch time: 36.3940110206604

Time for Epoch:36.3940110206604
Average single batch time this epoch: 0.6274760673786032
Running Average Epoch time: 36.17000424861908

Time for Epoch:35.94599747657776
Average single batch time this epoch: 0.6197517575888798
Running Average Epoch time: 36.006312211354576

Time for Epoch:35.67892813682556
Average single batch time this epoch: 0.6151471672386959
Running Average Epoch time: 35.98849272727966

Time for Epoch:35.93503427505493
Average single batch time this epoch: 0.6195630122875345
Average time per Batch: 0.6204845011234283
Average time per Epoch: 35.98849272727966
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov272
num threads 6
total time 184.02126955986023
2021-03-04 00:38:05.302640: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:38:05.847740: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:38:05.848282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:38:05.848578: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:38:05.848772: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:38:05.848939: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:38:05.849101: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:38:05.849276: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:38:05.849440: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:38:05.849603: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:38:05.849634: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:38:05.888275: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:38:05.888694: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f923c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:38:05.888734: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:38:05.892386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:38:05.892425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:38:06.151547: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:38:06.151721: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:38:06.152048: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:38:06.152081: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:38:06.152100: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:38:06.152135: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:38:06.152179: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:38:06.152203: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:38:06.152218: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f926e6a8430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:41:04.054508: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:41:04.204452: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:41:04.457231: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3231024/plugins/profile/2021_03_04_00_41_04
2021-03-04 00:41:04.714016: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3231024/plugins/profile/2021_03_04_00_41_04/householder.trace.json.gz
2021-03-04 00:41:04.766011: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:41:04.784590: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:41:04.786911: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3231024/plugins/profile/2021_03_04_00_41_04Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3231024/plugins/profile/2021_03_04_00_41_04/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3231024/plugins/profile/2021_03_04_00_41_04/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3231024/plugins/profile/2021_03_04_00_41_04/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3231024/plugins/profile/2021_03_04_00_41_04/householder.kernel_stats.pb

Time for Epoch:37.45481848716736
Average single batch time this epoch: 0.6457635945287244
Running Average Epoch time: 35.39337110519409

Time for Epoch:35.39337110519409
Average single batch time this epoch: 0.6102223642941179
Running Average Epoch time: 35.26140105724335

Time for Epoch:35.1294310092926
Average single batch time this epoch: 0.6056728445250412
Running Average Epoch time: 35.16447766621908

Time for Epoch:34.97063088417053
Average single batch time this epoch: 0.6029340275402727
Running Average Epoch time: 35.1083967089653

Time for Epoch:34.94015383720398
Average single batch time this epoch: 0.6024091367063851
Average time per Batch: 0.6053095932664542
Average time per Epoch: 35.1083967089653
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov323
num threads 6
total time 179.5522689819336
2021-03-04 00:41:08.957879: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:41:09.507356: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:41:09.507833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:41:09.508476: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:41:09.508641: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:41:09.508766: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:41:09.508909: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:41:09.509063: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:41:09.509202: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:41:09.509326: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:41:09.509348: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:41:09.548249: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:41:09.548686: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f55d0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:41:09.548742: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:41:09.553772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:41:09.553815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:41:09.817671: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:41:09.817811: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:41:09.818101: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:41:09.818131: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:41:09.818155: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:41:09.818191: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:41:09.818255: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:41:09.818281: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:41:09.818296: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f56022504c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:44:05.257585: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:44:05.313943: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:44:05.544524: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3331024/plugins/profile/2021_03_04_00_44_05
2021-03-04 00:44:05.790198: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3331024/plugins/profile/2021_03_04_00_44_05/householder.trace.json.gz
2021-03-04 00:44:05.837797: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:44:05.855803: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:44:05.858111: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3331024/plugins/profile/2021_03_04_00_44_05Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3331024/plugins/profile/2021_03_04_00_44_05/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3331024/plugins/profile/2021_03_04_00_44_05/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3331024/plugins/profile/2021_03_04_00_44_05/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3331024/plugins/profile/2021_03_04_00_44_05/householder.kernel_stats.pb

Time for Epoch:36.06554365158081
Average single batch time this epoch: 0.6218130794064752
Running Average Epoch time: 35.10664248466492

Time for Epoch:35.10664248466492
Average single batch time this epoch: 0.6052799265960167
Running Average Epoch time: 35.071493268013

Time for Epoch:35.036344051361084
Average single batch time this epoch: 0.604067929859819
Running Average Epoch time: 34.99945743878683

Time for Epoch:34.85538578033447
Average single batch time this epoch: 0.6009484735028497
Running Average Epoch time: 34.839177906513214

Time for Epoch:34.35833930969238
Average single batch time this epoch: 0.5923789123008991
Average time per Batch: 0.6006688105648961
Average time per Epoch: 34.839177906513214
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov333
num threads 6
total time 177.1149411201477
2021-03-04 00:44:10.082224: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:44:10.635350: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:44:10.635816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:44:10.636672: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:44:10.636830: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:44:10.636971: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:44:10.637105: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:44:10.637243: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:44:10.637378: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:44:10.637509: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:44:10.637549: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:44:10.672236: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:44:10.672670: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6888000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:44:10.672733: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:44:10.677071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:44:10.677117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:44:10.942365: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:44:10.942448: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:44:10.942658: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:44:10.942687: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:44:10.942706: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:44:10.942740: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:44:10.942782: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:44:10.942808: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:44:10.942823: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f68bbe944c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:47:07.674045: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:47:07.812849: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:47:08.073487: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3341024/plugins/profile/2021_03_04_00_47_07
2021-03-04 00:47:08.332051: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3341024/plugins/profile/2021_03_04_00_47_07/householder.trace.json.gz
2021-03-04 00:47:08.389539: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:47:08.409163: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:47:08.411489: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3341024/plugins/profile/2021_03_04_00_47_07Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3341024/plugins/profile/2021_03_04_00_47_07/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3341024/plugins/profile/2021_03_04_00_47_07/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3341024/plugins/profile/2021_03_04_00_47_07/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3341024/plugins/profile/2021_03_04_00_47_07/householder.kernel_stats.pb

Time for Epoch:36.83610820770264
Average single batch time this epoch: 0.6350971460342407
Running Average Epoch time: 35.75704598426819

Time for Epoch:35.75704598426819
Average single batch time this epoch: 0.616493899246742
Running Average Epoch time: 35.517016649246216

Time for Epoch:35.27698731422424
Average single batch time this epoch: 0.6082169762973128
Running Average Epoch time: 35.24084440867106

Time for Epoch:34.68849992752075
Average single batch time this epoch: 0.5980721095512653
Running Average Epoch time: 34.96891576051712

Time for Epoch:34.1531298160553
Average single batch time this epoch: 0.588842379635778
Average time per Batch: 0.6029063411827745
Average time per Epoch: 34.96891576051712
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov334
num threads 6
total time 178.4058539867401
2021-03-04 00:47:12.664699: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:47:13.215290: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:47:13.215711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:47:13.215976: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:47:13.216144: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:47:13.216279: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:47:13.216411: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:47:13.216551: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:47:13.216685: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:47:13.216817: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:47:13.216843: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:47:13.256326: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:47:13.256758: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe6e0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:47:13.256818: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:47:13.261547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:47:13.261592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:47:13.522175: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:47:13.522351: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:47:13.522665: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:47:13.522697: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:47:13.522716: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:47:13.522754: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:47:13.522798: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:47:13.522823: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:47:13.522837: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fe71577a4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:50:03.055729: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:50:03.112964: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:50:03.340051: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov4421024/plugins/profile/2021_03_04_00_50_03
2021-03-04 00:50:03.581633: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov4421024/plugins/profile/2021_03_04_00_50_03/householder.trace.json.gz
2021-03-04 00:50:03.628757: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:50:03.646771: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:50:03.649071: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov4421024/plugins/profile/2021_03_04_00_50_03Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov4421024/plugins/profile/2021_03_04_00_50_03/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov4421024/plugins/profile/2021_03_04_00_50_03/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov4421024/plugins/profile/2021_03_04_00_50_03/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov4421024/plugins/profile/2021_03_04_00_50_03/householder.kernel_stats.pb

Time for Epoch:35.38605237007141
Average single batch time this epoch: 0.610095110432855
Running Average Epoch time: 33.839460611343384

Time for Epoch:33.839460611343384
Average single batch time this epoch: 0.5834309355965976
Running Average Epoch time: 33.72723436355591

Time for Epoch:33.61500811576843
Average single batch time this epoch: 0.5795614267217701
Running Average Epoch time: 33.66558186213175

Time for Epoch:33.54227685928345
Average single batch time this epoch: 0.5783074600943203
Running Average Epoch time: 33.53292274475098

Time for Epoch:33.13494539260864
Average single batch time this epoch: 0.5712838049592643
Average time per Batch: 0.5781459068429882
Average time per Epoch: 33.53292274475098
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov442
num threads 6
total time 171.1898317337036
2021-03-04 00:50:07.925487: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:50:08.475382: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:50:08.476057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:50:08.476618: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:50:08.476769: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:50:08.476896: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:50:08.477019: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:50:08.477169: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:50:08.477293: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:50:08.477417: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:50:08.477440: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:50:08.508366: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:50:08.508752: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f417c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:50:08.508800: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:50:08.512309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:50:08.512350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:50:08.774285: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:50:08.774554: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:50:08.774955: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:50:08.775005: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:50:08.775036: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:50:08.775144: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:50:08.775274: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:50:08.775317: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:50:08.775341: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f41aff3d430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:53:00.843941: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:53:00.978419: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:53:01.248569: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov4441024/plugins/profile/2021_03_04_00_53_01
2021-03-04 00:53:01.504560: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov4441024/plugins/profile/2021_03_04_00_53_01/householder.trace.json.gz
2021-03-04 00:53:01.595686: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:53:01.626831: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 00:53:01.629319: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov4441024/plugins/profile/2021_03_04_00_53_01Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov4441024/plugins/profile/2021_03_04_00_53_01/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov4441024/plugins/profile/2021_03_04_00_53_01/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov4441024/plugins/profile/2021_03_04_00_53_01/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov4441024/plugins/profile/2021_03_04_00_53_01/householder.kernel_stats.pb

Time for Epoch:35.78308582305908
Average single batch time this epoch: 0.6169409094185665
Running Average Epoch time: 34.235595703125

Time for Epoch:34.235595703125
Average single batch time this epoch: 0.5902610976120521
Running Average Epoch time: 34.15427005290985

Time for Epoch:34.0729444026947
Average single batch time this epoch: 0.5874570361499128
Running Average Epoch time: 34.110591888427734

Time for Epoch:34.0232355594635
Average single batch time this epoch: 0.5866008421470379
Running Average Epoch time: 34.06657713651657

Time for Epoch:33.93453288078308
Average single batch time this epoch: 0.585071325302124
Average time per Batch: 0.5873475753027817
Average time per Epoch: 34.06657713651657
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov444
num threads 6
total time 173.71502542495728
2021-03-04 00:53:05.829108: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:53:06.379271: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:53:06.379741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:53:06.382845: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:53:06.382997: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:53:06.383129: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:53:06.383256: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:53:06.383387: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:53:06.383511: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:53:06.383634: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:53:06.383674: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:53:06.416144: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:53:06.416467: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1b78000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:53:06.416507: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:53:06.419092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:53:06.419118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:53:06.688630: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:53:06.688786: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:53:06.689077: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:53:06.689107: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:53:06.689126: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:53:06.689160: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:53:06.689204: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:53:06.689228: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:53:06.689243: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f1bad0d5430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 00:56:37.467479: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:56:37.622733: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 00:56:37.895063: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov5521024/plugins/profile/2021_03_04_00_56_37
2021-03-04 00:56:38.154569: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov5521024/plugins/profile/2021_03_04_00_56_37/householder.trace.json.gz
2021-03-04 00:56:38.208021: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 00:56:38.226811: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 00:56:38.229373: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov5521024/plugins/profile/2021_03_04_00_56_37Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov5521024/plugins/profile/2021_03_04_00_56_37/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov5521024/plugins/profile/2021_03_04_00_56_37/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov5521024/plugins/profile/2021_03_04_00_56_37/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov5521024/plugins/profile/2021_03_04_00_56_37/householder.kernel_stats.pb

Time for Epoch:44.1310498714447
Average single batch time this epoch: 0.760872614794764
Running Average Epoch time: 42.35183763504028

Time for Epoch:42.35183763504028
Average single batch time this epoch: 0.7301968459425301
Running Average Epoch time: 42.05385112762451

Time for Epoch:41.75586462020874
Average single batch time this epoch: 0.7199220410708723
Running Average Epoch time: 41.74921131134033

Time for Epoch:41.13993167877197
Average single batch time this epoch: 0.7093033626161772
Running Average Epoch time: 41.65724581480026

Time for Epoch:41.381349325180054
Average single batch time this epoch: 0.7134657604941006
Average time per Batch: 0.7182220025309201
Average time per Epoch: 41.65724581480026
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov552
num threads 6
total time 212.4438123703003
2021-03-04 00:56:42.458087: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 00:56:43.019819: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 00:56:43.020265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 00:56:43.020526: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:56:43.020693: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:56:43.020836: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:56:43.020973: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:56:43.021116: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:56:43.021251: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:56:43.021390: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:56:43.021416: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 00:56:43.064398: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 00:56:43.064915: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa938000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 00:56:43.065000: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 00:56:43.070472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 00:56:43.070522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 00:56:43.329378: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:56:43.329529: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 00:56:43.329840: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 00:56:43.329872: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:56:43.329891: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:56:43.329927: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:56:43.329970: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 00:56:43.329994: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 00:56:43.330008: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa96ad894c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 01:00:19.282532: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:00:19.436009: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 01:00:19.699095: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov5551024/plugins/profile/2021_03_04_01_00_19
2021-03-04 01:00:19.958499: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov5551024/plugins/profile/2021_03_04_01_00_19/householder.trace.json.gz
2021-03-04 01:00:20.010102: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 01:00:20.028985: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 01:00:20.031394: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov5551024/plugins/profile/2021_03_04_01_00_19Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov5551024/plugins/profile/2021_03_04_01_00_19/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov5551024/plugins/profile/2021_03_04_01_00_19/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov5551024/plugins/profile/2021_03_04_01_00_19/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov5551024/plugins/profile/2021_03_04_01_00_19/householder.kernel_stats.pb

Time for Epoch:44.7896294593811
Average single batch time this epoch: 0.7722260664249289
Running Average Epoch time: 42.7569465637207

Time for Epoch:42.7569465637207
Average single batch time this epoch: 0.7371812647786634
Running Average Epoch time: 42.87930357456207

Time for Epoch:43.00166058540344
Average single batch time this epoch: 0.7413999171092592
Running Average Epoch time: 42.72520685195923

Time for Epoch:42.41701340675354
Average single batch time this epoch: 0.7313208949976954
Running Average Epoch time: 42.786835849285126

Time for Epoch:42.97172284126282
Average single batch time this epoch: 0.7408846452318388
Average time per Batch: 0.7376966805293642
Average time per Epoch: 42.786835849285126
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov555
num threads 6
total time 217.6238076686859
2021-03-04 01:00:24.262210: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 01:00:24.803323: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 01:00:24.803802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 01:00:24.804085: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:00:24.804275: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:00:24.804443: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:00:24.804627: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:00:24.804839: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:00:24.804998: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:00:24.805161: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:00:24.805208: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 01:00:24.844242: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 01:00:24.844629: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff538000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 01:00:24.844667: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 01:00:24.848115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 01:00:24.848152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 01:00:25.694987: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:00:25.695135: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 01:00:25.695426: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:00:25.695470: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:00:25.695492: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:00:25.695527: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:00:25.695575: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:00:25.695622: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:00:25.695639: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ff56b221430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 01:08:40.612006: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:08:40.739786: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 01:08:40.871350: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_bini3222048/plugins/profile/2021_03_04_01_08_40
2021-03-04 01:08:41.005151: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_bini3222048/plugins/profile/2021_03_04_01_08_40/householder.trace.json.gz
2021-03-04 01:08:41.027957: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 01:08:41.037424: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 01:08:41.039612: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_bini3222048/plugins/profile/2021_03_04_01_08_40Dumped tool data for overview_page.pb to PAPER_6_threads_bini3222048/plugins/profile/2021_03_04_01_08_40/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_bini3222048/plugins/profile/2021_03_04_01_08_40/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_bini3222048/plugins/profile/2021_03_04_01_08_40/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_bini3222048/plugins/profile/2021_03_04_01_08_40/householder.kernel_stats.pb

Time for Epoch:101.69840502738953
Average single batch time this epoch: 3.506829935928871
Running Average Epoch time: 97.942209482193

Time for Epoch:97.942209482193
Average single batch time this epoch: 3.3773087633067163
Running Average Epoch time: 97.99128270149231

Time for Epoch:98.04035592079163
Average single batch time this epoch: 3.3806936247595427
Running Average Epoch time: 97.83253200848897

Time for Epoch:97.5150306224823
Average single batch time this epoch: 3.362578975743261
Running Average Epoch time: 98.30074489116669

Time for Epoch:99.70538353919983
Average single batch time this epoch: 3.4381075069822113
Average time per Batch: 3.389672217697933
Average time per Epoch: 98.30074489116669
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm bini322
num threads 6
total time 497.16718792915344
2021-03-04 01:08:45.480291: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 01:08:46.019816: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 01:08:46.020433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 01:08:46.020786: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:08:46.021010: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:08:46.021217: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:08:46.021428: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:08:46.021632: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:08:46.021830: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:08:46.022036: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:08:46.022099: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 01:08:46.064354: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 01:08:46.064801: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fdbe8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 01:08:46.064870: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 01:08:46.070013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 01:08:46.070061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 01:08:46.886775: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:08:46.886929: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 01:08:46.887230: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:08:46.887261: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:08:46.887281: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:08:46.887317: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:08:46.887359: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:08:46.887382: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:08:46.887396: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fdc1a1be4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 01:16:02.072491: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:16:02.182259: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 01:16:02.312056: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_dgemm2048/plugins/profile/2021_03_04_01_16_02
2021-03-04 01:16:02.448422: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_dgemm2048/plugins/profile/2021_03_04_01_16_02/householder.trace.json.gz
2021-03-04 01:16:02.470514: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 01:16:02.480080: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 01:16:02.482214: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_dgemm2048/plugins/profile/2021_03_04_01_16_02Dumped tool data for overview_page.pb to PAPER_6_threads_dgemm2048/plugins/profile/2021_03_04_01_16_02/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_dgemm2048/plugins/profile/2021_03_04_01_16_02/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_dgemm2048/plugins/profile/2021_03_04_01_16_02/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_dgemm2048/plugins/profile/2021_03_04_01_16_02/householder.kernel_stats.pb

Time for Epoch:88.89351010322571
Average single batch time this epoch: 3.065280766322695
Running Average Epoch time: 86.3244321346283

Time for Epoch:86.3244321346283
Average single batch time this epoch: 2.976690744531566
Running Average Epoch time: 86.57736301422119

Time for Epoch:86.83029389381409
Average single batch time this epoch: 2.9941367363107614
Running Average Epoch time: 86.4715530872345

Time for Epoch:86.25993323326111
Average single batch time this epoch: 2.974470557837651
Running Average Epoch time: 86.56933176517487

Time for Epoch:86.86266779899597
Average single batch time this epoch: 2.9952533409513276
Average time per Batch: 2.9851378449078267
Average time per Epoch: 86.56933176517487
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm dgemm
num threads 6
total time 437.3916506767273
2021-03-04 01:16:06.790076: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 01:16:07.348996: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 01:16:07.349472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 01:16:07.349908: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:07.350091: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:07.350255: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:07.350398: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:07.350543: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:07.350670: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:07.350799: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:07.350834: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 01:16:07.388199: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 01:16:07.388657: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc428000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 01:16:07.388726: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 01:16:07.393781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 01:16:07.393824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 01:16:08.246689: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:16:08.246833: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 01:16:08.247118: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:08.247167: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:16:08.247187: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:16:08.247221: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:16:08.247263: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:16:08.247286: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:16:08.247301: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-04 01:16:08.976589: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:16:12.967283: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 01:16:13.515826: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 01:16:13.516268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 01:16:13.516536: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:13.516710: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:13.516875: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:13.517038: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:13.517211: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:13.517399: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:13.517564: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:13.517595: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 01:16:13.556282: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 01:16:13.556732: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0c7c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 01:16:13.556782: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 01:16:13.561378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 01:16:13.561421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 01:16:14.406573: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:16:14.406728: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 01:16:14.407025: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:16:14.407057: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:16:14.407076: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:16:14.407111: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:16:14.407155: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:16:14.407179: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:16:14.407194: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f0caf2e9430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 01:24:38.170719: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:24:38.211840: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 01:24:38.342712: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_schonhage3332048/plugins/profile/2021_03_04_01_24_38
2021-03-04 01:24:38.475470: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_schonhage3332048/plugins/profile/2021_03_04_01_24_38/householder.trace.json.gz
2021-03-04 01:24:38.497747: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 01:24:38.507171: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 01:24:38.509382: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_schonhage3332048/plugins/profile/2021_03_04_01_24_38Dumped tool data for overview_page.pb to PAPER_6_threads_schonhage3332048/plugins/profile/2021_03_04_01_24_38/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_schonhage3332048/plugins/profile/2021_03_04_01_24_38/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_schonhage3332048/plugins/profile/2021_03_04_01_24_38/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_schonhage3332048/plugins/profile/2021_03_04_01_24_38/householder.kernel_stats.pb

Time for Epoch:104.75437331199646
Average single batch time this epoch: 3.6122066727999984
Running Average Epoch time: 100.9819107055664

Time for Epoch:100.9819107055664
Average single batch time this epoch: 3.4821245999171815
Running Average Epoch time: 100.60422134399414

Time for Epoch:100.22653198242188
Average single batch time this epoch: 3.45607747702763
Running Average Epoch time: 99.69026637077332

Time for Epoch:97.86235642433167
Average single batch time this epoch: 3.374554856070157
Running Average Epoch time: 99.74862360954285

Time for Epoch:99.92369532585144
Average single batch time this epoch: 3.4456354256333976
Average time per Batch: 3.4395980896620917
Average time per Epoch: 99.74862360954285
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm schonhage333
num threads 6
total time 506.0054488182068
2021-03-04 01:24:42.790382: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 01:24:43.317627: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 01:24:43.318180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 01:24:43.318704: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:24:43.318870: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:24:43.318996: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:24:43.319143: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:24:43.319280: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:24:43.319416: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:24:43.319540: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:24:43.319563: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 01:24:43.356358: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 01:24:43.356791: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7350000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 01:24:43.356838: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 01:24:43.361291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 01:24:43.361335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 01:24:44.200189: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:24:44.200333: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 01:24:44.200631: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:24:44.200660: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:24:44.200679: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:24:44.200713: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:24:44.200776: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:24:44.200803: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:24:44.200818: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f73835d4430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 01:31:51.210915: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:31:51.457499: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 01:31:51.579362: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2242048/plugins/profile/2021_03_04_01_31_51
2021-03-04 01:31:51.706653: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2242048/plugins/profile/2021_03_04_01_31_51/householder.trace.json.gz
2021-03-04 01:31:51.726878: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 01:31:51.736164: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 01:31:51.738425: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2242048/plugins/profile/2021_03_04_01_31_51Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2242048/plugins/profile/2021_03_04_01_31_51/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2242048/plugins/profile/2021_03_04_01_31_51/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2242048/plugins/profile/2021_03_04_01_31_51/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2242048/plugins/profile/2021_03_04_01_31_51/householder.kernel_stats.pb

Time for Epoch:87.51938366889954
Average single batch time this epoch: 3.0179003929269723
Running Average Epoch time: 84.27937912940979

Time for Epoch:84.27937912940979
Average single batch time this epoch: 2.906177783834523
Running Average Epoch time: 84.86417257785797

Time for Epoch:85.44896602630615
Average single batch time this epoch: 2.9465081116248824
Running Average Epoch time: 84.75414697329204

Time for Epoch:84.53409576416016
Average single batch time this epoch: 2.9149608200994033
Running Average Epoch time: 84.86925894021988

Time for Epoch:85.21459484100342
Average single batch time this epoch: 2.9384257217933394
Average time per Batch: 2.926518109338037
Average time per Epoch: 84.86925894021988
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov224
num threads 6
total time 429.23924684524536
2021-03-04 01:31:56.270587: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 01:31:56.820123: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 01:31:56.820559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 01:31:56.820808: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:31:56.820990: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:31:56.821190: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:31:56.821363: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:31:56.821542: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:31:56.821714: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:31:56.821886: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:31:56.821917: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 01:31:56.860342: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 01:31:56.860809: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8a68000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 01:31:56.860883: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 01:31:56.865378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 01:31:56.865417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 01:31:57.707785: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:31:57.707938: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 01:31:57.708261: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:31:57.708310: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:31:57.708331: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:31:57.708367: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:31:57.708410: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:31:57.708434: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:31:57.708449: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8a9d86e4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 01:39:25.497356: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:39:25.542347: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 01:39:25.668296: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2252048/plugins/profile/2021_03_04_01_39_25
2021-03-04 01:39:25.801077: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2252048/plugins/profile/2021_03_04_01_39_25/householder.trace.json.gz
2021-03-04 01:39:25.822796: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 01:39:25.832155: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 01:39:25.834261: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2252048/plugins/profile/2021_03_04_01_39_25Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2252048/plugins/profile/2021_03_04_01_39_25/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2252048/plugins/profile/2021_03_04_01_39_25/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2252048/plugins/profile/2021_03_04_01_39_25/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2252048/plugins/profile/2021_03_04_01_39_25/householder.kernel_stats.pb

Time for Epoch:92.54912114143372
Average single batch time this epoch: 3.191336418020314
Running Average Epoch time: 88.30249428749084

Time for Epoch:88.30249428749084
Average single batch time this epoch: 3.044903566097391
Running Average Epoch time: 87.93951261043549

Time for Epoch:87.57653093338013
Average single batch time this epoch: 3.0198702894408127
Running Average Epoch time: 88.78647343317668

Time for Epoch:90.48039507865906
Average single batch time this epoch: 3.120003313853823
Running Average Epoch time: 88.80578243732452

Time for Epoch:88.86370944976807
Average single batch time this epoch: 3.0642539468304864
Average time per Batch: 3.0622577790556282
Average time per Epoch: 88.80578243732452
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov225
num threads 6
total time 450.02649116516113
2021-03-04 01:39:30.265144: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 01:39:30.821134: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 01:39:30.821618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 01:39:30.822313: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:39:30.822463: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:39:30.822589: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:39:30.822712: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:39:30.822838: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:39:30.822991: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:39:30.823137: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:39:30.823160: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 01:39:30.860185: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 01:39:30.860568: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa694000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 01:39:30.860616: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 01:39:30.863878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 01:39:30.863919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 01:39:31.711431: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:39:31.711562: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 01:39:31.711856: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:39:31.711887: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:39:31.711905: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:39:31.711974: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:39:31.712040: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:39:31.712066: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:39:31.712082: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa6c7e684c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 01:46:55.526040: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:46:55.727637: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 01:46:55.883333: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2722048/plugins/profile/2021_03_04_01_46_55
2021-03-04 01:46:56.016959: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2722048/plugins/profile/2021_03_04_01_46_55/householder.trace.json.gz
2021-03-04 01:46:56.040053: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 01:46:56.049622: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 01:46:56.051930: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2722048/plugins/profile/2021_03_04_01_46_55Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2722048/plugins/profile/2021_03_04_01_46_55/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2722048/plugins/profile/2021_03_04_01_46_55/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2722048/plugins/profile/2021_03_04_01_46_55/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2722048/plugins/profile/2021_03_04_01_46_55/householder.kernel_stats.pb

Time for Epoch:90.46334886550903
Average single batch time this epoch: 3.119415102333858
Running Average Epoch time: 88.13383722305298

Time for Epoch:88.13383722305298
Average single batch time this epoch: 3.0390905676216913
Running Average Epoch time: 88.28413677215576

Time for Epoch:88.43443632125854
Average single batch time this epoch: 3.049453644916929
Running Average Epoch time: 87.99638923009236

Time for Epoch:87.42089414596558
Average single batch time this epoch: 3.0145048026380867
Running Average Epoch time: 88.33379983901978

Time for Epoch:89.346031665802
Average single batch time this epoch: 3.080883683829472
Average time per Batch: 3.0459831747515445
Average time per Epoch: 88.33379983901978
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov272
num threads 6
total time 446.08354210853577
2021-03-04 01:47:00.351465: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 01:47:00.915429: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 01:47:00.915959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 01:47:00.916196: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:47:00.916380: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:47:00.916577: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:47:00.916771: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:47:00.916949: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:47:00.917121: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:47:00.917297: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:47:00.917329: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 01:47:00.956388: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 01:47:00.956788: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff6c4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 01:47:00.956825: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 01:47:00.960384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 01:47:00.960421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 01:47:01.807703: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:47:01.807868: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 01:47:01.808165: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:47:01.808194: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:47:01.808213: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:47:01.808247: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:47:01.808296: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:47:01.808320: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:47:01.808336: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ff6f8ff34c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 01:55:15.844134: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:55:15.955452: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 01:55:16.073983: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3232048/plugins/profile/2021_03_04_01_55_15
2021-03-04 01:55:16.201020: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3232048/plugins/profile/2021_03_04_01_55_15/householder.trace.json.gz
2021-03-04 01:55:16.220542: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 01:55:16.229808: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 01:55:16.232061: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3232048/plugins/profile/2021_03_04_01_55_15Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3232048/plugins/profile/2021_03_04_01_55_15/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3232048/plugins/profile/2021_03_04_01_55_15/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3232048/plugins/profile/2021_03_04_01_55_15/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3232048/plugins/profile/2021_03_04_01_55_15/householder.kernel_stats.pb

Time for Epoch:101.69496846199036
Average single batch time this epoch: 3.506710701975329
Running Average Epoch time: 97.92352890968323

Time for Epoch:97.92352890968323
Average single batch time this epoch: 3.3766635204183646
Running Average Epoch time: 98.01619708538055

Time for Epoch:98.10886526107788
Average single batch time this epoch: 3.3830547086123763
Running Average Epoch time: 97.7766805489858

Time for Epoch:97.29764747619629
Average single batch time this epoch: 3.3550835560108054
Running Average Epoch time: 98.08176267147064

Time for Epoch:98.99700903892517
Average single batch time this epoch: 3.413679936836506
Average time per Batch: 3.382120430469513
Average time per Epoch: 98.08176267147064
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov323
num threads 6
total time 496.31162881851196
2021-03-04 01:55:20.639358: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 01:55:21.199562: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 01:55:21.200313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 01:55:21.200820: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:55:21.200976: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:55:21.201125: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:55:21.201256: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:55:21.201394: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:55:21.201523: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:55:21.201655: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:55:21.201680: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 01:55:21.240209: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 01:55:21.240661: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f87a8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 01:55:21.240725: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 01:55:21.246162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 01:55:21.246214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 01:55:22.065160: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:55:22.065311: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 01:55:22.065607: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 01:55:22.065656: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:55:22.065677: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:55:22.065713: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:55:22.065764: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 01:55:22.065790: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 01:55:22.065805: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f87db611430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 02:03:43.456394: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:03:43.657292: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 02:03:43.787390: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3332048/plugins/profile/2021_03_04_02_03_43
2021-03-04 02:03:43.918817: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3332048/plugins/profile/2021_03_04_02_03_43/householder.trace.json.gz
2021-03-04 02:03:43.943697: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 02:03:43.953300: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 02:03:43.955516: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3332048/plugins/profile/2021_03_04_02_03_43Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3332048/plugins/profile/2021_03_04_02_03_43/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3332048/plugins/profile/2021_03_04_02_03_43/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3332048/plugins/profile/2021_03_04_02_03_43/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3332048/plugins/profile/2021_03_04_02_03_43/householder.kernel_stats.pb

Time for Epoch:101.76219129562378
Average single batch time this epoch: 3.509027900366948
Running Average Epoch time: 97.94900608062744

Time for Epoch:97.94900608062744
Average single batch time this epoch: 3.3775434000738738
Running Average Epoch time: 98.5918208360672

Time for Epoch:99.23463559150696
Average single batch time this epoch: 3.421875238418579
Running Average Epoch time: 99.36010559399922

Time for Epoch:100.89667510986328
Average single batch time this epoch: 3.479185597649936
Running Average Epoch time: 99.90360069274902

Time for Epoch:101.53408598899841
Average single batch time this epoch: 3.5011644281190017
Average time per Batch: 3.4449421660653474
Average time per Epoch: 99.90360069274902
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov333
num threads 6
total time 503.6147675514221
2021-03-04 02:03:48.327545: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 02:03:48.888633: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 02:03:48.889218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 02:03:48.889778: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:03:48.889937: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:03:48.890064: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:03:48.890188: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:03:48.890320: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:03:48.890461: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:03:48.890586: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:03:48.890610: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 02:03:48.924305: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 02:03:48.924737: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3db0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 02:03:48.924799: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 02:03:48.928797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 02:03:48.928840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 02:03:49.791352: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:03:49.791493: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 02:03:49.792376: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:03:49.792409: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:03:49.792450: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:03:49.792490: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:03:49.792541: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:03:49.792566: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:03:49.792581: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3de5fe1430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 02:12:13.590247: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:12:13.755886: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 02:12:13.887987: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3342048/plugins/profile/2021_03_04_02_12_13
2021-03-04 02:12:14.014187: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3342048/plugins/profile/2021_03_04_02_12_13/householder.trace.json.gz
2021-03-04 02:12:14.035001: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 02:12:14.044286: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 02:12:14.046454: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3342048/plugins/profile/2021_03_04_02_12_13Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3342048/plugins/profile/2021_03_04_02_12_13/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3342048/plugins/profile/2021_03_04_02_12_13/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3342048/plugins/profile/2021_03_04_02_12_13/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3342048/plugins/profile/2021_03_04_02_12_13/householder.kernel_stats.pb

Time for Epoch:103.44818758964539
Average single batch time this epoch: 3.567166196888891
Running Average Epoch time: 98.99684500694275

Time for Epoch:98.99684500694275
Average single batch time this epoch: 3.4136746176357926
Running Average Epoch time: 98.65273535251617

Time for Epoch:98.3086256980896
Average single batch time this epoch: 3.3899447342445113
Running Average Epoch time: 100.0362499554952

Time for Epoch:102.80327916145325
Average single batch time this epoch: 3.5449288384667756
Running Average Epoch time: 100.08322864770889

Time for Epoch:100.22416472434998
Average single batch time this epoch: 3.4559946060180664
Average time per Batch: 3.4511356990912865
Average time per Epoch: 100.08322864770889
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov334
num threads 6
total time 506.0711214542389
2021-03-04 02:12:18.662432: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 02:12:19.215273: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 02:12:19.215757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 02:12:19.216059: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:12:19.216241: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:12:19.216434: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:12:19.216624: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:12:19.216799: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:12:19.216967: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:12:19.217136: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:12:19.217168: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 02:12:19.256177: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 02:12:19.256554: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f04cc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 02:12:19.256603: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 02:12:19.261240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 02:12:19.261285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 02:12:20.110985: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:12:20.111111: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 02:12:20.111407: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:12:20.111437: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:12:20.111455: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:12:20.111491: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:12:20.111556: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:12:20.111583: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:12:20.111598: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f0500403430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 02:19:11.998443: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:19:12.068085: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 02:19:12.185865: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov4422048/plugins/profile/2021_03_04_02_19_12
2021-03-04 02:19:12.311031: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov4422048/plugins/profile/2021_03_04_02_19_12/householder.trace.json.gz
2021-03-04 02:19:12.330580: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 02:19:12.339888: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 02:19:12.341980: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov4422048/plugins/profile/2021_03_04_02_19_12Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov4422048/plugins/profile/2021_03_04_02_19_12/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov4422048/plugins/profile/2021_03_04_02_19_12/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov4422048/plugins/profile/2021_03_04_02_19_12/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov4422048/plugins/profile/2021_03_04_02_19_12/householder.kernel_stats.pb

Time for Epoch:85.22834253311157
Average single batch time this epoch: 2.9388977905799605
Running Average Epoch time: 82.22409725189209

Time for Epoch:82.22409725189209
Average single batch time this epoch: 2.835305427682811
Running Average Epoch time: 81.89019680023193

Time for Epoch:81.55629634857178
Average single batch time this epoch: 2.8122775636870285
Running Average Epoch time: 82.2838966846466

Time for Epoch:83.07129645347595
Average single batch time this epoch: 2.8645179189484695
Running Average Epoch time: 81.66096180677414

Time for Epoch:79.79215717315674
Average single batch time this epoch: 2.7514455976157355
Average time per Batch: 2.815886626983511
Average time per Epoch: 81.66096180677414
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov442
num threads 6
total time 414.1629078388214
2021-03-04 02:19:16.656752: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 02:19:17.215477: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 02:19:17.215982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 02:19:17.216856: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:19:17.217013: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:19:17.217147: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:19:17.217291: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:19:17.217419: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:19:17.217547: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:19:17.217673: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:19:17.217704: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 02:19:17.252241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 02:19:17.252656: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7bf4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 02:19:17.252735: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 02:19:17.256836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 02:19:17.256883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 02:19:18.123097: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:19:18.123236: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 02:19:18.124047: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:19:18.124101: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:19:18.124135: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:19:18.124205: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:19:18.124274: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:19:18.124300: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:19:18.124316: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f7c26f8b4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 02:26:11.206242: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:26:11.446393: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 02:26:11.581345: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov4442048/plugins/profile/2021_03_04_02_26_11
2021-03-04 02:26:11.717382: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov4442048/plugins/profile/2021_03_04_02_26_11/householder.trace.json.gz
2021-03-04 02:26:11.742996: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 02:26:11.752693: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 02:26:11.754811: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov4442048/plugins/profile/2021_03_04_02_26_11Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov4442048/plugins/profile/2021_03_04_02_26_11/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov4442048/plugins/profile/2021_03_04_02_26_11/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov4442048/plugins/profile/2021_03_04_02_26_11/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov4442048/plugins/profile/2021_03_04_02_26_11/householder.kernel_stats.pb

Time for Epoch:84.97059845924377
Average single batch time this epoch: 2.9300103927480765
Running Average Epoch time: 82.18775486946106

Time for Epoch:82.18775486946106
Average single batch time this epoch: 2.834051148644809
Running Average Epoch time: 81.88895452022552

Time for Epoch:81.59015417098999
Average single batch time this epoch: 2.8134452556741647
Running Average Epoch time: 81.89128343264262

Time for Epoch:81.8959412574768
Average single batch time this epoch: 2.8239890295883705
Running Average Epoch time: 82.02423638105392

Time for Epoch:82.42309522628784
Average single batch time this epoch: 2.8421679447437156
Average time per Batch: 2.828413344662765
Average time per Epoch: 82.02423638105392
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov444
num threads 6
total time 415.36602568626404
2021-03-04 02:26:15.991461: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 02:26:16.523219: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 02:26:16.523673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 02:26:16.524344: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:26:16.524499: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:26:16.524624: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:26:16.524748: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:26:16.524875: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:26:16.525015: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:26:16.525138: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:26:16.525161: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 02:26:16.560366: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 02:26:16.560739: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3b84000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 02:26:16.560801: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 02:26:16.564052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 02:26:16.564094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 02:26:17.395172: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:26:17.395304: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 02:26:17.395597: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:26:17.395627: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:26:17.395645: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:26:17.395714: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:26:17.395759: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:26:17.395808: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:26:17.395827: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3bb71f54c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 02:34:49.918823: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:34:50.048035: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 02:34:50.167432: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov5522048/plugins/profile/2021_03_04_02_34_50
2021-03-04 02:34:50.296055: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov5522048/plugins/profile/2021_03_04_02_34_50/householder.trace.json.gz
2021-03-04 02:34:50.315972: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 02:34:50.325259: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 02:34:50.327356: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov5522048/plugins/profile/2021_03_04_02_34_50Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov5522048/plugins/profile/2021_03_04_02_34_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov5522048/plugins/profile/2021_03_04_02_34_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov5522048/plugins/profile/2021_03_04_02_34_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov5522048/plugins/profile/2021_03_04_02_34_50/householder.kernel_stats.pb

Time for Epoch:104.90817046165466
Average single batch time this epoch: 3.617513212664374
Running Average Epoch time: 101.76706290245056

Time for Epoch:101.76706290245056
Average single batch time this epoch: 3.509199389095964
Running Average Epoch time: 101.75409090518951

Time for Epoch:101.74111890792847
Average single batch time this epoch: 3.508306223770668
Running Average Epoch time: 101.83917315800984

Time for Epoch:102.00933766365051
Average single batch time this epoch: 3.517554365355393
Running Average Epoch time: 101.9000916481018

Time for Epoch:102.08284711837769
Average single batch time this epoch: 3.520088031374175
Average time per Batch: 3.51378700239905
Average time per Epoch: 101.9000916481018
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov552
num threads 6
total time 514.7556512355804
2021-03-04 02:34:55.028850: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 02:34:55.553544: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 02:34:55.554176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 02:34:55.554531: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:34:55.554748: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:34:55.554957: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:34:55.555163: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:34:55.555376: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:34:55.555575: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:34:55.555880: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:34:55.555945: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 02:34:55.596308: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 02:34:55.596719: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0aec000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 02:34:55.596760: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 02:34:55.600694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 02:34:55.600739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 02:34:56.429770: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:34:56.429929: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 02:34:56.430226: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:34:56.430258: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:34:56.430278: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:34:56.430314: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:34:56.430358: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:34:56.430382: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:34:56.430397: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f0b1edcb4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 02:43:46.633195: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:43:46.749507: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 02:43:46.883912: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov5552048/plugins/profile/2021_03_04_02_43_46
2021-03-04 02:43:47.016810: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov5552048/plugins/profile/2021_03_04_02_43_46/householder.trace.json.gz
2021-03-04 02:43:47.039837: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 02:43:47.049475: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 02:43:47.051664: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov5552048/plugins/profile/2021_03_04_02_43_46Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov5552048/plugins/profile/2021_03_04_02_43_46/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov5552048/plugins/profile/2021_03_04_02_43_46/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov5552048/plugins/profile/2021_03_04_02_43_46/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov5552048/plugins/profile/2021_03_04_02_43_46/householder.kernel_stats.pb

Time for Epoch:109.12496829032898
Average single batch time this epoch: 3.7629177488129715
Running Average Epoch time: 104.5972204208374

Time for Epoch:104.5972204208374
Average single batch time this epoch: 3.6067917840234163
Running Average Epoch time: 104.62374782562256

Time for Epoch:104.65027523040771
Average single batch time this epoch: 3.6086197639333792
Running Average Epoch time: 104.32395013173421

Time for Epoch:103.72435474395752
Average single batch time this epoch: 3.576693115563228
Running Average Epoch time: 105.26570516824722

Time for Epoch:108.09097027778625
Average single batch time this epoch: 3.7272623736282875
Average time per Batch: 3.629841759287078
Average time per Epoch: 105.26570516824722
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov555
num threads 6
total time 532.411972284317
2021-03-04 02:43:51.720003: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 02:43:52.249175: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 02:43:52.249623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 02:43:52.249938: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:43:52.250122: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:43:52.250309: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:43:52.250522: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:43:52.250708: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:43:52.250871: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:43:52.251037: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:43:52.251068: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 02:43:52.292247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 02:43:52.292711: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f46e4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 02:43:52.292781: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 02:43:52.298270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 02:43:52.298317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 02:43:55.433609: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:43:55.433755: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 02:43:55.434031: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 02:43:55.434081: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:43:55.434101: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:43:55.434135: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:43:55.434177: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 02:43:55.434201: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 02:43:55.434215: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4718d8c430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 03:05:50.070399: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:05:50.197450: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 03:05:50.260650: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_bini3224096/plugins/profile/2021_03_04_03_05_50
2021-03-04 03:05:50.327818: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_bini3224096/plugins/profile/2021_03_04_03_05_50/householder.trace.json.gz
2021-03-04 03:05:50.336543: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 03:05:50.341188: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 03:05:50.343196: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_bini3224096/plugins/profile/2021_03_04_03_05_50Dumped tool data for overview_page.pb to PAPER_6_threads_bini3224096/plugins/profile/2021_03_04_03_05_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_bini3224096/plugins/profile/2021_03_04_03_05_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_bini3224096/plugins/profile/2021_03_04_03_05_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_bini3224096/plugins/profile/2021_03_04_03_05_50/householder.kernel_stats.pb

Time for Epoch:271.5304911136627
Average single batch time this epoch: 19.395015682492936
Running Average Epoch time: 257.1451370716095

Time for Epoch:257.1451370716095
Average single batch time this epoch: 18.367495230266027
Running Average Epoch time: 256.48651790618896

Time for Epoch:255.82789874076843
Average single batch time this epoch: 18.27340735707964
Running Average Epoch time: 260.3485263983409

Time for Epoch:268.07254338264465
Average single batch time this epoch: 19.14802098274231
Running Average Epoch time: 260.77328956127167

Time for Epoch:262.0475790500641
Average single batch time this epoch: 18.717665144375392
Average time per Batch: 18.62664717861584
Average time per Epoch: 260.77328956127167
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm bini322
num threads 6
total time 1319.179547548294
2021-03-04 03:05:54.613210: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 03:05:55.167577: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 03:05:55.168287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 03:05:55.168773: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:05:55.168915: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:05:55.169051: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:05:55.169179: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:05:55.169310: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:05:55.169435: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:05:55.169579: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:05:55.169604: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 03:05:55.208181: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 03:05:55.208656: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9254000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 03:05:55.208713: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 03:05:55.213780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 03:05:55.213826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 03:05:58.352179: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 03:05:58.352333: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 03:05:58.352622: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:05:58.352653: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:05:58.352672: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:05:58.352708: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:05:58.352751: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 03:05:58.352775: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:05:58.352789: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9286b48430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 03:28:51.485403: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:28:51.604236: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 03:28:51.665701: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_dgemm4096/plugins/profile/2021_03_04_03_28_51
2021-03-04 03:28:51.729562: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_dgemm4096/plugins/profile/2021_03_04_03_28_51/householder.trace.json.gz
2021-03-04 03:28:51.737987: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 03:28:51.742619: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 03:28:51.744650: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_dgemm4096/plugins/profile/2021_03_04_03_28_51Dumped tool data for overview_page.pb to PAPER_6_threads_dgemm4096/plugins/profile/2021_03_04_03_28_51/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_dgemm4096/plugins/profile/2021_03_04_03_28_51/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_dgemm4096/plugins/profile/2021_03_04_03_28_51/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_dgemm4096/plugins/profile/2021_03_04_03_28_51/householder.kernel_stats.pb

Time for Epoch:275.78964400291443
Average single batch time this epoch: 19.69923940726689
Running Average Epoch time: 274.5253653526306

Time for Epoch:274.5253653526306
Average single batch time this epoch: 19.60892927646637
Running Average Epoch time: 275.1179200410843

Time for Epoch:275.71047472953796
Average single batch time this epoch: 19.69358456134796
Running Average Epoch time: 274.34793043136597

Time for Epoch:272.8079512119293
Average single batch time this epoch: 19.48626036303384
Running Average Epoch time: 274.33249747753143

Time for Epoch:274.28619861602783
Average single batch time this epoch: 19.591847351619176
Average time per Batch: 19.595155388116837
Average time per Epoch: 274.33249747753143
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm dgemm
num threads 6
total time 1377.6814913749695
2021-03-04 03:28:55.973504: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 03:28:56.536571: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 03:28:56.537151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 03:28:56.537662: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:28:56.537806: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:28:56.537946: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:28:56.538088: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:28:56.538228: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:28:56.538353: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:28:56.538476: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:28:56.538500: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 03:28:56.576325: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 03:28:56.576804: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0d0c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 03:28:56.576872: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 03:28:56.581935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 03:28:56.581978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 03:28:59.725377: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 03:28:59.725521: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 03:28:59.725801: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:28:59.725830: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:28:59.725848: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:28:59.725882: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:28:59.725924: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 03:28:59.725949: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:28:59.725964: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-04 03:29:00.477191: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:29:04.424694: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 03:29:04.976406: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 03:29:04.977017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 03:29:04.977395: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:29:04.977618: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:29:04.977833: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:29:04.978043: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:29:04.978292: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:29:04.978501: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:29:04.978710: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:29:04.978748: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 03:29:05.020274: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 03:29:05.020667: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2924000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 03:29:05.020704: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 03:29:05.024161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 03:29:05.024201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 03:29:08.157465: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 03:29:08.157619: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 03:29:08.157913: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:29:08.157944: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:29:08.157963: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:29:08.158015: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:29:08.158067: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 03:29:08.158092: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:29:08.158107: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f29581524c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 03:50:54.769396: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:50:54.904262: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 03:50:54.972125: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_schonhage3334096/plugins/profile/2021_03_04_03_50_54
2021-03-04 03:50:55.040897: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_schonhage3334096/plugins/profile/2021_03_04_03_50_54/householder.trace.json.gz
2021-03-04 03:50:55.050380: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 03:50:55.055182: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 03:50:55.057146: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_schonhage3334096/plugins/profile/2021_03_04_03_50_54Dumped tool data for overview_page.pb to PAPER_6_threads_schonhage3334096/plugins/profile/2021_03_04_03_50_54/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_schonhage3334096/plugins/profile/2021_03_04_03_50_54/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_schonhage3334096/plugins/profile/2021_03_04_03_50_54/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_schonhage3334096/plugins/profile/2021_03_04_03_50_54/householder.kernel_stats.pb

Time for Epoch:266.1887061595917
Average single batch time this epoch: 19.013461232185364
Running Average Epoch time: 259.7758014202118

Time for Epoch:259.7758014202118
Average single batch time this epoch: 18.555396710123336
Running Average Epoch time: 258.0296723842621

Time for Epoch:256.2835433483124
Average single batch time this epoch: 18.30595076084137
Running Average Epoch time: 258.88223481178284

Time for Epoch:260.58735966682434
Average single batch time this epoch: 18.61336358955928
Running Average Epoch time: 260.102288544178

Time for Epoch:263.7624497413635
Average single batch time this epoch: 18.840153881481715
Average time per Batch: 18.578716235501425
Average time per Epoch: 260.102288544178
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm schonhage333
num threads 6
total time 1311.1455206871033
2021-03-04 03:50:59.323881: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 03:50:59.877144: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 03:50:59.877650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 03:50:59.878314: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:50:59.878455: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:50:59.878602: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:50:59.878743: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:50:59.878886: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:50:59.879012: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:50:59.879154: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:50:59.879178: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 03:50:59.916327: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 03:50:59.916758: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc398000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 03:50:59.916808: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 03:50:59.921458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 03:50:59.921502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 03:51:03.064148: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 03:51:03.064287: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 03:51:03.064571: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 03:51:03.064602: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:51:03.064621: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:51:03.064656: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:51:03.064705: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 03:51:03.064730: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 03:51:03.064746: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc3cbc03430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 04:12:58.993992: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:12:59.122133: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 04:12:59.184264: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2244096/plugins/profile/2021_03_04_04_12_59
2021-03-04 04:12:59.248801: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2244096/plugins/profile/2021_03_04_04_12_59/householder.trace.json.gz
2021-03-04 04:12:59.257298: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 04:12:59.261972: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 04:12:59.263995: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2244096/plugins/profile/2021_03_04_04_12_59Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2244096/plugins/profile/2021_03_04_04_12_59/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2244096/plugins/profile/2021_03_04_04_12_59/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2244096/plugins/profile/2021_03_04_04_12_59/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2244096/plugins/profile/2021_03_04_04_12_59/householder.kernel_stats.pb

Time for Epoch:262.2067358493805
Average single batch time this epoch: 18.72903231212071
Running Average Epoch time: 258.44772267341614

Time for Epoch:258.44772267341614
Average single batch time this epoch: 18.460535730634415
Running Average Epoch time: 258.25964415073395

Time for Epoch:258.07156562805176
Average single batch time this epoch: 18.433666518756322
Running Average Epoch time: 261.19135967890423

Time for Epoch:267.05479073524475
Average single batch time this epoch: 19.075320737702505
Running Average Epoch time: 263.4267399907112

Time for Epoch:270.1328809261322
Average single batch time this epoch: 19.295184510094778
Average time per Batch: 18.816176874297007
Average time per Epoch: 263.4267399907112
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov224
num threads 6
total time 1320.4987547397614
2021-03-04 04:13:03.470364: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 04:13:03.991190: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 04:13:03.991625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 04:13:03.991924: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:13:03.992149: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:13:03.992873: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:13:03.993026: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:13:03.993152: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:13:03.993281: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:13:03.993404: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:13:03.993429: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 04:13:04.024295: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 04:13:04.024685: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa7e8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 04:13:04.024734: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 04:13:04.028011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 04:13:04.028067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 04:13:07.165241: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 04:13:07.165377: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 04:13:07.166175: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:13:07.166208: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:13:07.166227: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:13:07.166261: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:13:07.166302: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 04:13:07.166325: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:13:07.166341: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa81c579430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 04:35:05.577177: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:35:05.705794: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 04:35:05.769775: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2254096/plugins/profile/2021_03_04_04_35_05
2021-03-04 04:35:05.836077: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2254096/plugins/profile/2021_03_04_04_35_05/householder.trace.json.gz
2021-03-04 04:35:05.844954: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 04:35:05.849661: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 04:35:05.851627: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2254096/plugins/profile/2021_03_04_04_35_05Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2254096/plugins/profile/2021_03_04_04_35_05/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2254096/plugins/profile/2021_03_04_04_35_05/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2254096/plugins/profile/2021_03_04_04_35_05/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2254096/plugins/profile/2021_03_04_04_35_05/householder.kernel_stats.pb

Time for Epoch:265.1878900527954
Average single batch time this epoch: 18.94197412899562
Running Average Epoch time: 256.22566294670105

Time for Epoch:256.22566294670105
Average single batch time this epoch: 18.301816088812693
Running Average Epoch time: 261.6729438304901

Time for Epoch:267.1202247142792
Average single batch time this epoch: 19.079999446868896
Running Average Epoch time: 263.525118748347

Time for Epoch:267.22946858406067
Average single batch time this epoch: 19.087802852903092
Running Average Epoch time: 263.30235916376114

Time for Epoch:262.63408041000366
Average single batch time this epoch: 18.759559903826034
Average time per Batch: 18.807294573102677
Average time per Epoch: 263.30235916376114
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov225
num threads 6
total time 1322.9177384376526
2021-03-04 04:35:10.132253: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 04:35:10.651629: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 04:35:10.652314: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 04:35:10.652779: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:35:10.652927: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:35:10.653061: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:35:10.653191: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:35:10.653341: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:35:10.653468: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:35:10.653597: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:35:10.653621: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 04:35:10.692296: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 04:35:10.692825: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fee38000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 04:35:10.692906: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 04:35:10.697969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 04:35:10.698015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 04:35:13.848590: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 04:35:13.848738: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 04:35:13.849023: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:35:13.849054: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:35:13.849074: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:35:13.849127: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:35:13.849171: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 04:35:13.849195: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:35:13.849210: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fee6d4aa4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 04:59:08.288580: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:59:08.440217: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 04:59:08.508904: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2724096/plugins/profile/2021_03_04_04_59_08
2021-03-04 04:59:08.577617: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2724096/plugins/profile/2021_03_04_04_59_08/householder.trace.json.gz
2021-03-04 04:59:08.587327: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 04:59:08.592169: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 04:59:08.594161: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2724096/plugins/profile/2021_03_04_04_59_08Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2724096/plugins/profile/2021_03_04_04_59_08/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2724096/plugins/profile/2021_03_04_04_59_08/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2724096/plugins/profile/2021_03_04_04_59_08/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2724096/plugins/profile/2021_03_04_04_59_08/householder.kernel_stats.pb

Time for Epoch:278.4254484176636
Average single batch time this epoch: 19.887503487723215
Running Average Epoch time: 290.343621969223

Time for Epoch:290.343621969223
Average single batch time this epoch: 20.738806554249354
Running Average Epoch time: 290.8160854578018

Time for Epoch:291.2885489463806
Average single batch time this epoch: 20.806299703461782
Running Average Epoch time: 289.8179244995117

Time for Epoch:287.8216025829315
Average single batch time this epoch: 20.55866083077022
Running Average Epoch time: 288.999791264534

Time for Epoch:286.54539155960083
Average single batch time this epoch: 20.467503581728256
Average time per Batch: 20.642817667552404
Average time per Epoch: 288.999791264534
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov272
num threads 6
total time 1438.9646821022034
2021-03-04 04:59:12.872417: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 04:59:13.432735: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 04:59:13.433334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 04:59:13.433945: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:59:13.434104: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:59:13.434238: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:59:13.434368: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:59:13.434505: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:59:13.434633: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:59:13.434781: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:59:13.434805: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 04:59:13.472266: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 04:59:13.472770: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd6f4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 04:59:13.472851: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 04:59:13.477913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 04:59:13.477959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 04:59:16.619603: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 04:59:16.619758: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 04:59:16.620059: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 04:59:16.620092: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:59:16.620112: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:59:16.620148: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:59:16.620192: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 04:59:16.620215: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 04:59:16.620230: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd727c1b4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 05:20:53.234379: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 05:20:53.319357: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 05:20:53.381643: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3234096/plugins/profile/2021_03_04_05_20_53
2021-03-04 05:20:53.448605: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3234096/plugins/profile/2021_03_04_05_20_53/householder.trace.json.gz
2021-03-04 05:20:53.457307: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 05:20:53.461958: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 05:20:53.463980: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3234096/plugins/profile/2021_03_04_05_20_53Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3234096/plugins/profile/2021_03_04_05_20_53/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3234096/plugins/profile/2021_03_04_05_20_53/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3234096/plugins/profile/2021_03_04_05_20_53/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3234096/plugins/profile/2021_03_04_05_20_53/householder.kernel_stats.pb

Time for Epoch:264.4049289226532
Average single batch time this epoch: 18.886042594909668
Running Average Epoch time: 262.0839412212372

Time for Epoch:262.0839412212372
Average single batch time this epoch: 18.72025852543967
Running Average Epoch time: 263.6608316898346

Time for Epoch:265.237722158432
Average single batch time this epoch: 18.94553073814937
Running Average Epoch time: 262.91362229983014

Time for Epoch:261.41920351982117
Average single batch time this epoch: 18.672780019896372
Running Average Epoch time: 258.04834747314453

Time for Epoch:243.45252299308777
Average single batch time this epoch: 17.38945244039808
Average time per Batch: 18.432005430970875
Average time per Epoch: 258.04834747314453
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov323
num threads 6
total time 1301.1707332134247
2021-03-04 05:20:57.706794: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 05:20:58.259843: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 05:20:58.260350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 05:20:58.261012: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:20:58.261178: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:20:58.261312: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:20:58.261439: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:20:58.261571: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:20:58.261695: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:20:58.261821: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:20:58.261845: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 05:20:58.296288: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 05:20:58.296734: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc300000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 05:20:58.296805: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 05:20:58.301109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 05:20:58.301170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 05:21:01.448224: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 05:21:01.448362: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 05:21:01.448645: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:21:01.448674: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 05:21:01.448694: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 05:21:01.448728: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 05:21:01.448770: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 05:21:01.448794: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 05:21:01.448809: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc333464430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 05:42:25.417328: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 05:42:25.570343: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 05:42:25.636451: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3334096/plugins/profile/2021_03_04_05_42_25
2021-03-04 05:42:25.704179: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3334096/plugins/profile/2021_03_04_05_42_25/householder.trace.json.gz
2021-03-04 05:42:25.713479: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 05:42:25.718222: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 05:42:25.720325: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3334096/plugins/profile/2021_03_04_05_42_25Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3334096/plugins/profile/2021_03_04_05_42_25/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3334096/plugins/profile/2021_03_04_05_42_25/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3334096/plugins/profile/2021_03_04_05_42_25/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3334096/plugins/profile/2021_03_04_05_42_25/householder.kernel_stats.pb

Time for Epoch:261.35792660713196
Average single batch time this epoch: 18.668401956558228
Running Average Epoch time: 257.72205662727356

Time for Epoch:257.72205662727356
Average single batch time this epoch: 18.408699001584733
Running Average Epoch time: 253.78228294849396

Time for Epoch:249.84250926971436
Average single batch time this epoch: 17.84587335586548
Running Average Epoch time: 253.89211281140646

Time for Epoch:254.11177253723145
Average single batch time this epoch: 18.150822349957057
Running Average Epoch time: 255.64886838197708

Time for Epoch:260.91913509368896
Average single batch time this epoch: 18.637059024402074
Average time per Batch: 18.260613432952336
Average time per Epoch: 255.64886838197708
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov333
num threads 6
total time 1288.5299730300903
2021-03-04 05:42:30.009456: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 05:42:30.541080: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 05:42:30.541540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 05:42:30.542192: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:42:30.542335: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:42:30.542464: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:42:30.542588: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:42:30.542735: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:42:30.542859: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:42:30.542984: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:42:30.543008: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 05:42:30.580411: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 05:42:30.580903: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fbd14000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 05:42:30.580970: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 05:42:30.585351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 05:42:30.585389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 05:42:33.718383: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 05:42:33.718535: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 05:42:33.718823: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 05:42:33.718855: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 05:42:33.718875: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 05:42:33.718927: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 05:42:33.718971: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 05:42:33.718995: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 05:42:33.719010: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fbd4774e4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 06:04:01.731006: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:04:01.837574: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 06:04:01.899503: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3344096/plugins/profile/2021_03_04_06_04_01
2021-03-04 06:04:01.964752: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3344096/plugins/profile/2021_03_04_06_04_01/householder.trace.json.gz
2021-03-04 06:04:01.973416: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 06:04:01.978069: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 06:04:01.980031: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3344096/plugins/profile/2021_03_04_06_04_01Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3344096/plugins/profile/2021_03_04_06_04_01/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3344096/plugins/profile/2021_03_04_06_04_01/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3344096/plugins/profile/2021_03_04_06_04_01/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3344096/plugins/profile/2021_03_04_06_04_01/householder.kernel_stats.pb

Time for Epoch:265.2473282814026
Average single batch time this epoch: 18.94620876652854
Running Average Epoch time: 252.93515634536743

Time for Epoch:252.93515634536743
Average single batch time this epoch: 18.066771950040543
Running Average Epoch time: 254.6065193414688

Time for Epoch:256.2778823375702
Average single batch time this epoch: 18.305542162486486
Running Average Epoch time: 253.3972380956014

Time for Epoch:250.97867560386658
Average single batch time this epoch: 17.927023223468236
Running Average Epoch time: 255.68682026863098

Time for Epoch:262.5555667877197
Average single batch time this epoch: 18.75393956048148
Average time per Batch: 18.263319224119186
Average time per Epoch: 255.68682026863098
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov334
num threads 6
total time 1292.534866809845
2021-03-04 06:04:06.242830: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 06:04:06.811353: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 06:04:06.811824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 06:04:06.812724: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:04:06.812879: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:04:06.813014: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:04:06.813143: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:04:06.813275: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:04:06.813400: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:04:06.813540: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:04:06.813566: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 06:04:06.848257: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 06:04:06.848720: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd9c4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 06:04:06.848784: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 06:04:06.852765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 06:04:06.852808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 06:04:09.999553: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 06:04:09.999701: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 06:04:09.999989: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:04:10.000021: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:04:10.000041: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:04:10.000076: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:04:10.000119: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 06:04:10.000142: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:04:10.000158: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd9f7d0a4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 06:24:29.093872: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:24:29.226895: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 06:24:29.289892: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov4424096/plugins/profile/2021_03_04_06_24_29
2021-03-04 06:24:29.354422: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov4424096/plugins/profile/2021_03_04_06_24_29/householder.trace.json.gz
2021-03-04 06:24:29.363149: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 06:24:29.367840: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 06:24:29.369937: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov4424096/plugins/profile/2021_03_04_06_24_29Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov4424096/plugins/profile/2021_03_04_06_24_29/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov4424096/plugins/profile/2021_03_04_06_24_29/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov4424096/plugins/profile/2021_03_04_06_24_29/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov4424096/plugins/profile/2021_03_04_06_24_29/householder.kernel_stats.pb

Time for Epoch:249.5058469772339
Average single batch time this epoch: 17.82182730947222
Running Average Epoch time: 241.86256194114685

Time for Epoch:241.86256194114685
Average single batch time this epoch: 17.27587957041604
Running Average Epoch time: 240.51715862751007

Time for Epoch:239.1717553138733
Average single batch time this epoch: 17.0836808851787
Running Average Epoch time: 242.6209452946981

Time for Epoch:246.8285186290741
Average single batch time this epoch: 17.630586436816625
Running Average Epoch time: 242.39316034317017

Time for Epoch:241.70980548858643
Average single batch time this epoch: 17.2649667263031
Average time per Batch: 17.31377840467862
Average time per Epoch: 242.39316034317017
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov442
num threads 6
total time 1223.6789863109589
2021-03-04 06:24:33.628726: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 06:24:34.191348: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 06:24:34.191813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 06:24:34.192446: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:24:34.192643: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:24:34.192773: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:24:34.192901: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:24:34.193033: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:24:34.193175: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:24:34.193343: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:24:34.193367: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 06:24:34.228338: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 06:24:34.228740: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4328000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 06:24:34.228806: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 06:24:34.232500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 06:24:34.232558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 06:24:37.394915: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 06:24:37.395043: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 06:24:37.395837: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:24:37.395868: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:24:37.395890: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:24:37.395959: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:24:37.396010: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 06:24:37.396034: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:24:37.396050: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f435a2ad430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 06:44:57.914425: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:44:58.036580: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 06:44:58.098757: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov4444096/plugins/profile/2021_03_04_06_44_58
2021-03-04 06:44:58.165196: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov4444096/plugins/profile/2021_03_04_06_44_58/householder.trace.json.gz
2021-03-04 06:44:58.173873: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 06:44:58.178529: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 06:44:58.180515: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov4444096/plugins/profile/2021_03_04_06_44_58Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov4444096/plugins/profile/2021_03_04_06_44_58/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov4444096/plugins/profile/2021_03_04_06_44_58/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov4444096/plugins/profile/2021_03_04_06_44_58/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov4444096/plugins/profile/2021_03_04_06_44_58/householder.kernel_stats.pb

Time for Epoch:250.24966311454773
Average single batch time this epoch: 17.87495734010424
Running Average Epoch time: 240.87519145011902

Time for Epoch:240.87519145011902
Average single batch time this epoch: 17.205357755933488
Running Average Epoch time: 241.37091159820557

Time for Epoch:241.86663174629211
Average single batch time this epoch: 17.276172041893005
Running Average Epoch time: 241.05906446774802

Time for Epoch:240.43537020683289
Average single batch time this epoch: 17.173939653805324
Running Average Epoch time: 242.56371355056763

Time for Epoch:247.0776607990265
Average single batch time this epoch: 17.648383106504166
Average time per Batch: 17.325963139533997
Average time per Epoch: 242.56371355056763
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov444
num threads 6
total time 1225.1108150482178
2021-03-04 06:45:02.493308: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 06:45:03.043284: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 06:45:03.043734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 06:45:03.044347: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:45:03.044509: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:45:03.044639: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:45:03.044768: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:45:03.044922: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:45:03.045049: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:45:03.045194: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:45:03.045231: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 06:45:03.080300: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 06:45:03.080676: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5d14000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 06:45:03.080726: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 06:45:03.083960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 06:45:03.084003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 06:45:06.257116: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 06:45:06.257244: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 06:45:06.258033: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 06:45:06.258062: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:45:06.258084: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:45:06.258173: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:45:06.258219: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 06:45:06.258244: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 06:45:06.258260: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5d48a2f430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 07:06:17.734148: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 07:06:17.859014: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 07:06:17.922249: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov5524096/plugins/profile/2021_03_04_07_06_17
2021-03-04 07:06:17.987916: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov5524096/plugins/profile/2021_03_04_07_06_17/householder.trace.json.gz
2021-03-04 07:06:17.996779: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 07:06:18.001522: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 07:06:18.003528: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov5524096/plugins/profile/2021_03_04_07_06_17Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov5524096/plugins/profile/2021_03_04_07_06_17/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov5524096/plugins/profile/2021_03_04_07_06_17/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov5524096/plugins/profile/2021_03_04_07_06_17/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov5524096/plugins/profile/2021_03_04_07_06_17/householder.kernel_stats.pb

Time for Epoch:258.8322160243988
Average single batch time this epoch: 18.487993819372996
Running Average Epoch time: 252.6966245174408

Time for Epoch:252.6966245174408
Average single batch time this epoch: 18.04973988873618
Running Average Epoch time: 255.33593893051147

Time for Epoch:257.97525334358215
Average single batch time this epoch: 18.42678633758
Running Average Epoch time: 254.70968580245972

Time for Epoch:253.4571795463562
Average single batch time this epoch: 18.104066916874476
Running Average Epoch time: 253.15734511613846

Time for Epoch:248.50032305717468
Average single batch time this epoch: 17.75000470025199
Average time per Batch: 18.08264946086066
Average time per Epoch: 253.15734511613846
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov552
num threads 6
total time 1276.066576719284
2021-03-04 07:06:22.336500: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 07:06:22.897293: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 07:06:22.897872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 07:06:22.898332: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:06:22.898485: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:06:22.898619: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:06:22.898748: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:06:22.898883: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:06:22.899010: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:06:22.899157: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:06:22.899182: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 07:06:22.936410: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 07:06:22.936906: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f317c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 07:06:22.936980: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 07:06:22.941428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 07:06:22.941470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 07:06:26.082518: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 07:06:26.082671: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 07:06:26.082956: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:06:26.082988: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 07:06:26.083007: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 07:06:26.083044: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 07:06:26.083088: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 07:06:26.083112: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 07:06:26.083127: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f31afc67430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 07:27:35.962892: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 07:27:36.080332: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 07:27:36.141457: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov5554096/plugins/profile/2021_03_04_07_27_36
2021-03-04 07:27:36.205671: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov5554096/plugins/profile/2021_03_04_07_27_36/householder.trace.json.gz
2021-03-04 07:27:36.214071: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 07:27:36.218635: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 07:27:36.220646: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov5554096/plugins/profile/2021_03_04_07_27_36Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov5554096/plugins/profile/2021_03_04_07_27_36/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov5554096/plugins/profile/2021_03_04_07_27_36/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov5554096/plugins/profile/2021_03_04_07_27_36/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov5554096/plugins/profile/2021_03_04_07_27_36/householder.kernel_stats.pb

Time for Epoch:253.4357409477234
Average single batch time this epoch: 18.10253119468689
Running Average Epoch time: 248.0659544467926

Time for Epoch:248.0659544467926
Average single batch time this epoch: 17.71897825172969
Running Average Epoch time: 251.73352587223053

Time for Epoch:255.40109729766846
Average single batch time this epoch: 18.24291239465986
Running Average Epoch time: 253.9217083454132

Time for Epoch:258.29807329177856
Average single batch time this epoch: 18.449840205056326
Running Average Epoch time: 254.10719937086105

Time for Epoch:254.6636724472046
Average single batch time this epoch: 18.19023850985936
Average time per Batch: 18.15049234032631
Average time per Epoch: 254.10719937086105
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov555
num threads 6
total time 1274.4274635314941
2021-03-04 07:27:40.515555: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 07:27:41.067815: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 07:27:41.068317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 07:27:41.068983: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:27:41.069144: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:27:41.069285: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:27:41.069424: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:27:41.069564: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:27:41.069687: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:27:41.069811: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:27:41.069835: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 07:27:41.108325: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 07:27:41.108763: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe958000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 07:27:41.108830: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 07:27:41.113885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 07:27:41.113948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 07:27:53.219197: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 07:27:53.219350: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 07:27:53.220146: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 07:27:53.220183: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 07:27:53.220202: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 07:27:53.220238: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 07:27:53.220303: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 07:27:53.220329: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 07:27:53.220345: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fe98c34d430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 08:41:35.030892: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 08:41:35.037179: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 08:41:35.072011: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_bini3228192/plugins/profile/2021_03_04_08_41_35
2021-03-04 08:41:35.107290: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_bini3228192/plugins/profile/2021_03_04_08_41_35/householder.trace.json.gz
2021-03-04 08:41:35.111581: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 08:41:35.114201: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 08:41:35.116151: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_bini3228192/plugins/profile/2021_03_04_08_41_35Dumped tool data for overview_page.pb to PAPER_6_threads_bini3228192/plugins/profile/2021_03_04_08_41_35/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_bini3228192/plugins/profile/2021_03_04_08_41_35/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_bini3228192/plugins/profile/2021_03_04_08_41_35/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_bini3228192/plugins/profile/2021_03_04_08_41_35/householder.kernel_stats.pb

Time for Epoch:889.5344710350037
Average single batch time this epoch: 127.07633127485003
Running Average Epoch time: 885.3219645023346

Time for Epoch:885.3219645023346
Average single batch time this epoch: 126.47454493386405
Running Average Epoch time: 880.9458776712418

Time for Epoch:876.5697908401489
Average single batch time this epoch: 125.22423216274807
Running Average Epoch time: 881.8302804629008

Time for Epoch:883.5990860462189
Average single batch time this epoch: 126.22841695376805
Running Average Epoch time: 883.0655599832535

Time for Epoch:886.7713985443115
Average single batch time this epoch: 126.68160278456551
Average time per Batch: 126.15219920873642
Average time per Epoch: 883.0655599832535
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm bini322
num threads 6
total time 4435.343993425369
2021-03-04 08:41:39.525281: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 08:41:40.083643: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 08:41:40.084267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 08:41:40.084850: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 08:41:40.085009: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 08:41:40.085141: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 08:41:40.085271: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 08:41:40.085416: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 08:41:40.085543: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 08:41:40.085672: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 08:41:40.085697: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 08:41:40.120178: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 08:41:40.120605: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7384000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 08:41:40.120658: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 08:41:40.124311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 08:41:40.124362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 08:41:52.357466: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 08:41:52.357667: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 08:41:52.358519: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 08:41:52.358552: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 08:41:52.358586: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 08:41:52.358634: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 08:41:52.358699: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 08:41:52.358725: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 08:41:52.358740: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f73b83094c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 09:50:41.527541: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 09:50:41.534617: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 09:50:41.569336: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_dgemm8192/plugins/profile/2021_03_04_09_50_41
2021-03-04 09:50:41.604661: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_dgemm8192/plugins/profile/2021_03_04_09_50_41/householder.trace.json.gz
2021-03-04 09:50:41.608938: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 09:50:41.611555: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 09:50:41.613427: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_dgemm8192/plugins/profile/2021_03_04_09_50_41Dumped tool data for overview_page.pb to PAPER_6_threads_dgemm8192/plugins/profile/2021_03_04_09_50_41/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_dgemm8192/plugins/profile/2021_03_04_09_50_41/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_dgemm8192/plugins/profile/2021_03_04_09_50_41/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_dgemm8192/plugins/profile/2021_03_04_09_50_41/householder.kernel_stats.pb

Time for Epoch:830.6778264045715
Average single batch time this epoch: 118.66823526791164
Running Average Epoch time: 823.2999756336212

Time for Epoch:823.2999756336212
Average single batch time this epoch: 117.61425982202802
Running Average Epoch time: 824.4081462621689

Time for Epoch:825.5163168907166
Average single batch time this epoch: 117.93088132994515
Running Average Epoch time: 824.2181968688965

Time for Epoch:823.8382980823517
Average single batch time this epoch: 117.69116486821856
Running Average Epoch time: 824.6195502877235

Time for Epoch:825.8236105442047
Average single batch time this epoch: 117.97478004864284
Average time per Batch: 117.80277151720864
Average time per Epoch: 824.6195502877235
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm dgemm
num threads 6
total time 4142.804166793823
2021-03-04 09:50:45.963749: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 09:50:46.519763: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 09:50:46.520280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 09:50:46.520602: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:50:46.520813: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:50:46.521028: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:50:46.521242: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:50:46.521463: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:50:46.521651: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:50:46.521843: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:50:46.521909: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 09:50:46.564189: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 09:50:46.564589: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb870000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 09:50:46.565168: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 09:50:46.568879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 09:50:46.568909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 09:50:58.843287: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 09:50:58.843461: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 09:50:58.844330: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:50:58.844365: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 09:50:58.844398: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 09:50:58.844446: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 09:50:58.844494: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 09:50:58.844519: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 09:50:58.844534: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-04 09:50:59.642366: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 09:51:03.678205: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 09:51:04.231685: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 09:51:04.232327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 09:51:04.232782: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:51:04.232934: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:51:04.233078: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:51:04.233203: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:51:04.233334: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:51:04.233458: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:51:04.233582: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:51:04.233606: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 09:51:04.272164: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 09:51:04.272616: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f7a68000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 09:51:04.272691: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 09:51:04.277007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 09:51:04.277053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 09:51:16.534966: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 09:51:16.535164: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 09:51:16.536055: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 09:51:16.536106: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 09:51:16.536142: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 09:51:16.536190: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 09:51:16.536241: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 09:51:16.536266: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 09:51:16.536282: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f7a9c35a430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 11:03:52.413757: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 11:03:52.420530: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 11:03:52.457206: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_schonhage3338192/plugins/profile/2021_03_04_11_03_52
2021-03-04 11:03:52.493621: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_schonhage3338192/plugins/profile/2021_03_04_11_03_52/householder.trace.json.gz
2021-03-04 11:03:52.498198: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 11:03:52.500888: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 11:03:52.502770: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_schonhage3338192/plugins/profile/2021_03_04_11_03_52Dumped tool data for overview_page.pb to PAPER_6_threads_schonhage3338192/plugins/profile/2021_03_04_11_03_52/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_schonhage3338192/plugins/profile/2021_03_04_11_03_52/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_schonhage3338192/plugins/profile/2021_03_04_11_03_52/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_schonhage3338192/plugins/profile/2021_03_04_11_03_52/householder.kernel_stats.pb

Time for Epoch:882.4808745384216
Average single batch time this epoch: 126.06866921697345
Running Average Epoch time: 871.1387436389923

Time for Epoch:871.1387436389923
Average single batch time this epoch: 124.44836289542062
Running Average Epoch time: 867.4568922519684

Time for Epoch:863.7750408649445
Average single batch time this epoch: 123.39640780857631
Running Average Epoch time: 869.7970760663351

Time for Epoch:874.4774436950684
Average single batch time this epoch: 124.92532355444771
Running Average Epoch time: 868.3451899886131

Time for Epoch:863.9895317554474
Average single batch time this epoch: 123.42705307688031
Average time per Batch: 124.04928683383123
Average time per Epoch: 868.3451899886131
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm schonhage333
num threads 6
total time 4369.546405553818
2021-03-04 11:03:56.914275: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 11:03:57.471344: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 11:03:57.471829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 11:03:57.472392: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 11:03:57.472549: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 11:03:57.472691: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 11:03:57.472828: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 11:03:57.472970: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 11:03:57.473110: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 11:03:57.473234: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 11:03:57.473257: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 11:03:57.512244: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 11:03:57.512659: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb9b0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 11:03:57.512713: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 11:03:57.517331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 11:03:57.517374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 11:04:09.589926: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 11:04:09.590079: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 11:04:09.590893: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 11:04:09.590923: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 11:04:09.590945: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 11:04:09.590981: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 11:04:09.591023: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 11:04:09.591047: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 11:04:09.591083: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fb9e506d4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 12:08:24.147462: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 12:08:24.156468: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 12:08:24.193403: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2248192/plugins/profile/2021_03_04_12_08_24
2021-03-04 12:08:24.229991: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2248192/plugins/profile/2021_03_04_12_08_24/householder.trace.json.gz
2021-03-04 12:08:24.234576: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 12:08:24.237233: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 12:08:24.239149: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2248192/plugins/profile/2021_03_04_12_08_24Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2248192/plugins/profile/2021_03_04_12_08_24/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2248192/plugins/profile/2021_03_04_12_08_24/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2248192/plugins/profile/2021_03_04_12_08_24/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2248192/plugins/profile/2021_03_04_12_08_24/householder.kernel_stats.pb

Time for Epoch:780.6796631813049
Average single batch time this epoch: 111.52563987459455
Running Average Epoch time: 770.787134885788

Time for Epoch:770.787134885788
Average single batch time this epoch: 110.11242348807198
Running Average Epoch time: 770.4195202589035

Time for Epoch:770.051905632019
Average single batch time this epoch: 110.00739022663662
Running Average Epoch time: 766.5883259773254

Time for Epoch:758.9259374141693
Average single batch time this epoch: 108.41796776226589
Running Average Epoch time: 768.4657732248306

Time for Epoch:774.0981149673462
Average single batch time this epoch: 110.58542091505868
Average time per Batch: 109.78080059800828
Average time per Epoch: 768.4657732248306
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov224
num threads 6
total time 3868.0524401664734
2021-03-04 12:08:28.677954: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 12:08:29.232679: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 12:08:29.233308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 12:08:29.233880: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 12:08:29.234033: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 12:08:29.234167: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 12:08:29.234299: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 12:08:29.234430: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 12:08:29.234565: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 12:08:29.234695: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 12:08:29.234721: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 12:08:29.272398: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 12:08:29.272968: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6884000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 12:08:29.273051: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 12:08:29.278602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 12:08:29.278653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 12:08:41.514383: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 12:08:41.514580: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 12:08:41.515435: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 12:08:41.515483: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 12:08:41.515509: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 12:08:41.515554: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 12:08:41.515601: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 12:08:41.515626: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 12:08:41.515641: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f68b79fc4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 13:12:43.621940: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 13:12:43.628952: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 13:12:43.664895: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2258192/plugins/profile/2021_03_04_13_12_43
2021-03-04 13:12:43.700197: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2258192/plugins/profile/2021_03_04_13_12_43/householder.trace.json.gz
2021-03-04 13:12:43.704597: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 13:12:43.707195: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 13:12:43.709072: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2258192/plugins/profile/2021_03_04_13_12_43Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2258192/plugins/profile/2021_03_04_13_12_43/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2258192/plugins/profile/2021_03_04_13_12_43/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2258192/plugins/profile/2021_03_04_13_12_43/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2258192/plugins/profile/2021_03_04_13_12_43/householder.kernel_stats.pb

Time for Epoch:778.9736263751984
Average single batch time this epoch: 111.28192441804069
Running Average Epoch time: 770.2064998149872

Time for Epoch:770.2064998149872
Average single batch time this epoch: 110.02947759628296
Running Average Epoch time: 770.1676156520844

Time for Epoch:770.1287314891815
Average single batch time this epoch: 110.01836906160626
Running Average Epoch time: 769.1022197405497

Time for Epoch:766.9714279174805
Average single batch time this epoch: 109.56732610293797
Running Average Epoch time: 765.7796847820282

Time for Epoch:755.8120799064636
Average single batch time this epoch: 107.97313339369637
Average time per Batch: 109.3970765386309
Average time per Epoch: 765.7796847820282
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov225
num threads 6
total time 3855.7543621063232
2021-03-04 13:12:48.095009: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 13:12:48.651386: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 13:12:48.651882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 13:12:48.652477: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 13:12:48.652618: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 13:12:48.652783: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 13:12:48.652927: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 13:12:48.653060: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 13:12:48.653187: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 13:12:48.653317: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 13:12:48.653340: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 13:12:48.692341: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 13:12:48.692827: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6080000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 13:12:48.692893: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 13:12:48.698366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 13:12:48.698413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 13:13:00.786902: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 13:13:00.787054: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 13:13:00.787876: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 13:13:00.787934: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 13:13:00.787958: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 13:13:00.787993: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 13:13:00.788035: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 13:13:00.788059: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 13:13:00.788074: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f60b27444c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 14:19:41.003141: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 14:19:41.012206: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 14:19:41.047365: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov2728192/plugins/profile/2021_03_04_14_19_41
2021-03-04 14:19:41.081846: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov2728192/plugins/profile/2021_03_04_14_19_41/householder.trace.json.gz
2021-03-04 14:19:41.086068: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 14:19:41.088703: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 14:19:41.090552: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov2728192/plugins/profile/2021_03_04_14_19_41Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov2728192/plugins/profile/2021_03_04_14_19_41/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov2728192/plugins/profile/2021_03_04_14_19_41/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov2728192/plugins/profile/2021_03_04_14_19_41/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov2728192/plugins/profile/2021_03_04_14_19_41/householder.kernel_stats.pb

Time for Epoch:810.1574852466583
Average single batch time this epoch: 115.73675857271466
Running Average Epoch time: 791.0635893344879

Time for Epoch:791.0635893344879
Average single batch time this epoch: 113.00906014442444
Running Average Epoch time: 792.3686035871506

Time for Epoch:793.6736178398132
Average single batch time this epoch: 113.38192129135132
Running Average Epoch time: 795.8226730028788

Time for Epoch:802.7308118343353
Average single batch time this epoch: 114.67580444472176
Running Average Epoch time: 797.5104139447212

Time for Epoch:802.5736367702484
Average single batch time this epoch: 114.65335215841021
Average time per Batch: 113.93003450972692
Average time per Epoch: 797.5104139447212
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov272
num threads 6
total time 4013.7364032268524
2021-03-04 14:19:45.496840: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 14:19:46.049185: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 14:19:46.049631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 14:19:46.050478: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 14:19:46.050640: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 14:19:46.050774: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 14:19:46.050902: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 14:19:46.051040: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 14:19:46.051182: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 14:19:46.051309: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 14:19:46.051334: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 14:19:46.084302: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 14:19:46.084758: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f588c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 14:19:46.084823: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 14:19:46.088429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 14:19:46.088472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 14:19:58.367098: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 14:19:58.367280: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 14:19:58.368119: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 14:19:58.368156: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 14:19:58.368175: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 14:19:58.368220: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 14:19:58.368268: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 14:19:58.368293: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 14:19:58.368328: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f58be4b84c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 15:32:16.946630: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 15:32:16.953651: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 15:32:16.986804: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3238192/plugins/profile/2021_03_04_15_32_16
2021-03-04 15:32:17.022500: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3238192/plugins/profile/2021_03_04_15_32_16/householder.trace.json.gz
2021-03-04 15:32:17.026796: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 15:32:17.029423: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 15:32:17.031312: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3238192/plugins/profile/2021_03_04_15_32_16Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3238192/plugins/profile/2021_03_04_15_32_16/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3238192/plugins/profile/2021_03_04_15_32_16/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3238192/plugins/profile/2021_03_04_15_32_16/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3238192/plugins/profile/2021_03_04_15_32_16/householder.kernel_stats.pb

Time for Epoch:869.0945422649384
Average single batch time this epoch: 124.15633967944554
Running Average Epoch time: 867.1858508586884

Time for Epoch:867.1858508586884
Average single batch time this epoch: 123.8836669921875
Running Average Epoch time: 865.554605960846

Time for Epoch:863.9233610630035
Average single batch time this epoch: 123.41759892872402
Running Average Epoch time: 868.4935392538706

Time for Epoch:874.37140583992
Average single batch time this epoch: 124.91018060275486
Running Average Epoch time: 867.3670005202293

Time for Epoch:863.9873843193054
Average single batch time this epoch: 123.42674377986363
Average time per Batch: 123.9095475758825
Average time per Epoch: 867.3670005202293
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov323
num threads 6
total time 4352.2798862457275
2021-03-04 15:32:21.439635: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 15:32:21.993450: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 15:32:21.994083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 15:32:21.994634: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 15:32:21.994795: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 15:32:21.994921: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 15:32:21.995044: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 15:32:21.995173: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 15:32:21.995295: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 15:32:21.995417: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 15:32:21.995443: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 15:32:22.028293: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 15:32:22.028677: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4cf0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 15:32:22.028727: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 15:32:22.032250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 15:32:22.032292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 15:32:34.270445: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 15:32:34.270645: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 15:32:34.271524: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 15:32:34.271559: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 15:32:34.271579: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 15:32:34.271622: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 15:32:34.271670: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 15:32:34.271694: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 15:32:34.271709: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4d225344c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 16:43:31.444413: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 16:43:31.453214: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 16:43:31.488178: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3338192/plugins/profile/2021_03_04_16_43_31
2021-03-04 16:43:31.523675: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3338192/plugins/profile/2021_03_04_16_43_31/householder.trace.json.gz
2021-03-04 16:43:31.528093: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 16:43:31.530703: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 16:43:31.532572: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3338192/plugins/profile/2021_03_04_16_43_31Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3338192/plugins/profile/2021_03_04_16_43_31/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3338192/plugins/profile/2021_03_04_16_43_31/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3338192/plugins/profile/2021_03_04_16_43_31/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3338192/plugins/profile/2021_03_04_16_43_31/householder.kernel_stats.pb

Time for Epoch:854.9071533679962
Average single batch time this epoch: 122.12956762313843
Running Average Epoch time: 846.8175346851349

Time for Epoch:846.8175346851349
Average single batch time this epoch: 120.97391060420445
Running Average Epoch time: 845.8977464437485

Time for Epoch:844.9779582023621
Average single batch time this epoch: 120.71111301013401
Running Average Epoch time: 848.8461114565531

Time for Epoch:854.7428414821625
Average single batch time this epoch: 122.10609933308193
Running Average Epoch time: 850.5628126859665

Time for Epoch:855.7129163742065
Average single batch time this epoch: 122.24467631748745
Average time per Batch: 121.50894981622696
Average time per Epoch: 850.5628126859665
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov333
num threads 6
total time 4270.804925203323
2021-03-04 16:43:35.912350: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 16:43:36.476777: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 16:43:36.477256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 16:43:36.478809: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 16:43:36.478983: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 16:43:36.479214: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 16:43:36.479422: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 16:43:36.479614: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 16:43:36.479815: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 16:43:36.480008: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 16:43:36.480043: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 16:43:36.520342: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 16:43:36.520806: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc48c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 16:43:36.520856: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 16:43:36.525539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 16:43:36.525581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 16:43:48.630114: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 16:43:48.630280: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 16:43:48.631161: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 16:43:48.631215: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 16:43:48.631238: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 16:43:48.631280: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 16:43:48.631329: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 16:43:48.631353: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 16:43:48.631368: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc4bed784c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 17:54:43.352450: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 17:54:43.358949: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 17:54:43.403043: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov3348192/plugins/profile/2021_03_04_17_54_43
2021-03-04 17:54:43.438042: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov3348192/plugins/profile/2021_03_04_17_54_43/householder.trace.json.gz
2021-03-04 17:54:43.442513: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 17:54:43.445198: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 17:54:43.447085: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov3348192/plugins/profile/2021_03_04_17_54_43Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov3348192/plugins/profile/2021_03_04_17_54_43/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov3348192/plugins/profile/2021_03_04_17_54_43/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov3348192/plugins/profile/2021_03_04_17_54_43/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov3348192/plugins/profile/2021_03_04_17_54_43/householder.kernel_stats.pb

Time for Epoch:853.1597142219543
Average single batch time this epoch: 121.87993349347796
Running Average Epoch time: 853.0736572742462

Time for Epoch:853.0736572742462
Average single batch time this epoch: 121.86763869013105
Running Average Epoch time: 850.9756487607956

Time for Epoch:848.877640247345
Average single batch time this epoch: 121.26820870808193
Running Average Epoch time: 850.1665063699087

Time for Epoch:848.5482215881348
Average single batch time this epoch: 121.2211502279554
Running Average Epoch time: 850.386511027813

Time for Epoch:851.0465250015259
Average single batch time this epoch: 121.57805068152291
Average time per Batch: 121.48376207692283
Average time per Epoch: 850.386511027813
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov334
num threads 6
total time 4268.261449098587
2021-03-04 17:54:47.816048: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 17:54:48.375289: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 17:54:48.375746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 17:54:48.376030: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 17:54:48.376233: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 17:54:48.376421: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 17:54:48.376616: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 17:54:48.376792: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 17:54:48.376992: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 17:54:48.377160: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 17:54:48.377190: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 17:54:48.416323: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 17:54:48.416754: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc62c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 17:54:48.416804: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 17:54:48.421444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 17:54:48.421489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 17:55:00.492133: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 17:55:00.492285: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 17:55:00.493123: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 17:55:00.493156: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 17:55:00.493182: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 17:55:00.493218: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 17:55:00.493285: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 17:55:00.493311: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 17:55:00.493349: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc660d91430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 18:56:00.225835: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 18:56:00.233830: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 18:56:00.269942: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov4428192/plugins/profile/2021_03_04_18_56_00
2021-03-04 18:56:00.304835: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov4428192/plugins/profile/2021_03_04_18_56_00/householder.trace.json.gz
2021-03-04 18:56:00.309138: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 18:56:00.311725: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 18:56:00.313616: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov4428192/plugins/profile/2021_03_04_18_56_00Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov4428192/plugins/profile/2021_03_04_18_56_00/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov4428192/plugins/profile/2021_03_04_18_56_00/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov4428192/plugins/profile/2021_03_04_18_56_00/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov4428192/plugins/profile/2021_03_04_18_56_00/householder.kernel_stats.pb

Time for Epoch:737.2448992729187
Average single batch time this epoch: 105.32067264829364
Running Average Epoch time: 735.1065044403076

Time for Epoch:735.1065044403076
Average single batch time this epoch: 105.01518988609314
Running Average Epoch time: 732.6480398178101

Time for Epoch:730.1895751953125
Average single batch time this epoch: 104.31277183123997
Running Average Epoch time: 732.873008886973

Time for Epoch:733.3229470252991
Average single batch time this epoch: 104.76039787701198
Running Average Epoch time: 730.617928981781

Time for Epoch:723.8526892662048
Average single batch time this epoch: 103.40750193595886
Average time per Batch: 104.37396538257599
Average time per Epoch: 730.617928981781
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov442
num threads 6
total time 3673.2305076122284
2021-03-04 18:56:04.767522: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 18:56:05.331977: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 18:56:05.332598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 18:56:05.333147: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 18:56:05.333333: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 18:56:05.333461: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 18:56:05.333586: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 18:56:05.333715: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 18:56:05.333839: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 18:56:05.333963: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 18:56:05.333986: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 18:56:05.368186: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 18:56:05.368621: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f210c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 18:56:05.368694: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 18:56:05.373009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 18:56:05.373056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 18:56:17.653887: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 18:56:17.654089: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 18:56:17.654977: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 18:56:17.655010: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 18:56:17.655044: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 18:56:17.655092: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 18:56:17.655139: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 18:56:17.655163: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 18:56:17.655178: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f21416c7430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 19:57:18.370870: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 19:57:18.377182: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 19:57:18.412057: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov4448192/plugins/profile/2021_03_04_19_57_18
2021-03-04 19:57:18.446866: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov4448192/plugins/profile/2021_03_04_19_57_18/householder.trace.json.gz
2021-03-04 19:57:18.451178: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 19:57:18.453845: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 19:57:18.455731: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov4448192/plugins/profile/2021_03_04_19_57_18Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov4448192/plugins/profile/2021_03_04_19_57_18/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov4448192/plugins/profile/2021_03_04_19_57_18/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov4448192/plugins/profile/2021_03_04_19_57_18/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov4448192/plugins/profile/2021_03_04_19_57_18/householder.kernel_stats.pb

Time for Epoch:740.8495097160339
Average single batch time this epoch: 105.83561614581517
Running Average Epoch time: 733.4649338722229

Time for Epoch:733.4649338722229
Average single batch time this epoch: 104.78067575182233
Running Average Epoch time: 731.7906141281128

Time for Epoch:730.1162943840027
Average single batch time this epoch: 104.30230007852826
Running Average Epoch time: 730.4113816420237

Time for Epoch:727.6529166698456
Average single batch time this epoch: 103.95038771629333
Running Average Epoch time: 729.9621565937996

Time for Epoch:728.6144814491272
Average single batch time this epoch: 104.08775503294808
Average time per Batch: 104.280279644898
Average time per Epoch: 729.9621565937996
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov444
num threads 6
total time 3674.4029195308685
2021-03-04 19:57:22.892861: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 19:57:23.427626: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 19:57:23.428178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 19:57:23.428801: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 19:57:23.428947: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 19:57:23.429116: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 19:57:23.429259: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 19:57:23.429391: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 19:57:23.429516: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 19:57:23.429645: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 19:57:23.429668: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 19:57:23.468318: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 19:57:23.468820: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7eff24000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 19:57:23.468904: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 19:57:23.473980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 19:57:23.474023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 19:57:35.579581: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 19:57:35.579728: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 19:57:35.580552: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 19:57:35.580605: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 19:57:35.580623: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 19:57:35.580657: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 19:57:35.580713: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 19:57:35.580738: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 19:57:35.580752: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7eff596434c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 21:10:50.165631: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 21:10:50.173617: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 21:10:50.210674: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov5528192/plugins/profile/2021_03_04_21_10_50
2021-03-04 21:10:50.247025: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov5528192/plugins/profile/2021_03_04_21_10_50/householder.trace.json.gz
2021-03-04 21:10:50.251648: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 21:10:50.254340: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 21:10:50.256236: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov5528192/plugins/profile/2021_03_04_21_10_50Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov5528192/plugins/profile/2021_03_04_21_10_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov5528192/plugins/profile/2021_03_04_21_10_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov5528192/plugins/profile/2021_03_04_21_10_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov5528192/plugins/profile/2021_03_04_21_10_50/householder.kernel_stats.pb

Time for Epoch:886.9895102977753
Average single batch time this epoch: 126.71275537354606
Running Average Epoch time: 879.2884542942047

Time for Epoch:879.2884542942047
Average single batch time this epoch: 125.61260506084987
Running Average Epoch time: 877.2866388559341

Time for Epoch:875.2848234176636
Average single batch time this epoch: 125.0406652518681
Running Average Epoch time: 876.732703367869

Time for Epoch:875.6248323917389
Average single batch time this epoch: 125.08923636163983
Running Average Epoch time: 876.8946025967598

Time for Epoch:877.380300283432
Average single batch time this epoch: 125.34001520701817
Average time per Batch: 125.27063047034399
Average time per Epoch: 876.8946025967598
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov552
num threads 6
total time 4408.090520858765
2021-03-04 21:10:54.675242: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 21:10:55.231889: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 21:10:55.232550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 21:10:55.232986: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 21:10:55.233167: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 21:10:55.233294: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 21:10:55.233418: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 21:10:55.233542: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 21:10:55.233688: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 21:10:55.233814: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 21:10:55.233840: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 21:10:55.264295: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 21:10:55.264660: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6ca4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 21:10:55.264709: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 21:10:55.268265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 21:10:55.268307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 21:11:07.504808: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 21:11:07.505011: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 21:11:07.505869: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 21:11:07.505915: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 21:11:07.505940: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 21:11:07.505987: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 21:11:07.506044: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 21:11:07.506068: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 21:11:07.506099: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f6cd73334c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:20:50.539402: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:20:50.548093: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:20:50.583843: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_6_threads_smirnov5558192/plugins/profile/2021_03_04_22_20_50
2021-03-04 22:20:50.619083: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_6_threads_smirnov5558192/plugins/profile/2021_03_04_22_20_50/householder.trace.json.gz
2021-03-04 22:20:50.623498: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:20:50.626121: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 22:20:50.628018: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_6_threads_smirnov5558192/plugins/profile/2021_03_04_22_20_50Dumped tool data for overview_page.pb to PAPER_6_threads_smirnov5558192/plugins/profile/2021_03_04_22_20_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_6_threads_smirnov5558192/plugins/profile/2021_03_04_22_20_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_6_threads_smirnov5558192/plugins/profile/2021_03_04_22_20_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_6_threads_smirnov5558192/plugins/profile/2021_03_04_22_20_50/householder.kernel_stats.pb

Time for Epoch:841.5791049003601
Average single batch time this epoch: 120.22555882590157
Running Average Epoch time: 831.4478344917297

Time for Epoch:831.4478344917297
Average single batch time this epoch: 118.77823489052909
Running Average Epoch time: 831.8499945402145

Time for Epoch:832.2521545886993
Average single batch time this epoch: 118.89313646725246
Running Average Epoch time: 834.3277806440989

Time for Epoch:839.2833528518677
Average single batch time this epoch: 119.8975943837847
Running Average Epoch time: 835.3595036268234

Time for Epoch:838.454672574997
Average single batch time this epoch: 119.77921329225812
Average time per Batch: 119.33704475845609
Average time per Epoch: 835.3595036268234
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov555
num threads 6
total time 4196.6636164188385
2021-03-04 22:20:55.306492: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:20:55.827339: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:20:55.827807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:20:55.828451: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:20:55.828623: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:20:55.828769: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:20:55.828912: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:20:55.829065: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:20:55.829192: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:20:55.829320: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:20:55.829343: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:20:55.868283: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:20:55.868682: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe5bc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:20:55.868719: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:20:55.872237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:20:55.872274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:20:55.976558: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:20:55.976703: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:20:55.976980: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:20:55.977010: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:20:55.977029: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:20:55.977063: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:20:55.977105: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:20:55.977129: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:20:55.977144: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fe5f17f64c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:23:03.554042: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:23:03.691306: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:23:04.176449: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_bini322512/plugins/profile/2021_03_04_22_23_03
2021-03-04 22:23:04.657066: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_bini322512/plugins/profile/2021_03_04_22_23_03/householder.trace.json.gz
2021-03-04 22:23:04.750695: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:23:04.787747: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 22:23:04.790186: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_bini322512/plugins/profile/2021_03_04_22_23_03Dumped tool data for overview_page.pb to PAPER_12_threads_bini322512/plugins/profile/2021_03_04_22_23_03/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_bini322512/plugins/profile/2021_03_04_22_23_03/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_bini322512/plugins/profile/2021_03_04_22_23_03/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_bini322512/plugins/profile/2021_03_04_22_23_03/householder.kernel_stats.pb

Time for Epoch:26.96435856819153
Average single batch time this epoch: 0.23045747300498506
Running Average Epoch time: 25.548938512802124

Time for Epoch:25.548938512802124
Average single batch time this epoch: 0.21836053204332662
Running Average Epoch time: 25.31776452064514

Time for Epoch:25.08659052848816
Average single batch time this epoch: 0.21440894175798464
Running Average Epoch time: 25.209636131922405

Time for Epoch:24.99337935447693
Average single batch time this epoch: 0.2136126277793167
Running Average Epoch time: 25.148868024349213

Time for Epoch:24.96656370162964
Average single batch time this epoch: 0.21338341174981532
Average time per Batch: 0.21494137833261082
Average time per Epoch: 25.148868024349213
batch size 512
epochs 5
nodes 512
num layers 4
algorithm bini322
num threads 12
total time 129.07126235961914
2021-03-04 22:23:09.121407: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:23:09.651323: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:23:09.651764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:23:09.652109: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:23:09.652299: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:23:09.652519: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:23:09.652711: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:23:09.652902: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:23:09.653071: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:23:09.653241: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:23:09.653271: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:23:09.692250: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:23:09.692664: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8a04000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:23:09.692701: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:23:09.696226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:23:09.696263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:23:09.798328: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:23:09.798468: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:23:09.798740: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:23:09.798791: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:23:09.798811: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:23:09.798845: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:23:09.798887: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:23:09.798910: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:23:09.798925: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8a366384c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:24:16.354181: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:24:16.434295: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:24:16.917360: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_dgemm512/plugins/profile/2021_03_04_22_24_16
2021-03-04 22:24:17.401207: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_dgemm512/plugins/profile/2021_03_04_22_24_16/householder.trace.json.gz
2021-03-04 22:24:17.497438: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:24:17.536074: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 22:24:17.538567: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_dgemm512/plugins/profile/2021_03_04_22_24_16Dumped tool data for overview_page.pb to PAPER_12_threads_dgemm512/plugins/profile/2021_03_04_22_24_16/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_dgemm512/plugins/profile/2021_03_04_22_24_16/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_dgemm512/plugins/profile/2021_03_04_22_24_16/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_dgemm512/plugins/profile/2021_03_04_22_24_16/householder.kernel_stats.pb

Time for Epoch:14.0642569065094
Average single batch time this epoch: 0.1202022071577545
Running Average Epoch time: 12.982914686203003

Time for Epoch:12.982914686203003
Average single batch time this epoch: 0.110960018940461
Running Average Epoch time: 13.036679983139038

Time for Epoch:13.090445280075073
Average single batch time this epoch: 0.11187818519070618
Running Average Epoch time: 13.079261620839437

Time for Epoch:13.164424896240234
Average single batch time this epoch: 0.11251049367790548
Running Average Epoch time: 13.118439793586731

Time for Epoch:13.235974311828613
Average single batch time this epoch: 0.11312191710512862
Average time per Batch: 0.11211765372855031
Average time per Epoch: 13.118439793586731
batch size 512
epochs 5
nodes 512
num layers 4
algorithm dgemm
num threads 12
total time 68.0463354587555
2021-03-04 22:24:21.856650: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:24:22.420941: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:24:22.421509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:24:22.421838: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:22.422042: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:22.422234: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:22.422424: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:22.422610: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:22.422821: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:22.423009: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:22.423044: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:24:22.464278: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:24:22.464731: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f32d8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:24:22.464789: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:24:22.469851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:24:22.469896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:24:22.574789: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:24:22.574937: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:24:22.575243: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:22.575274: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:24:22.575292: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:24:22.575328: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:24:22.575372: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:24:22.575395: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:24:22.575426: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-04 22:24:23.264586: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:24:27.247182: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:24:27.803094: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:24:27.803541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:24:27.803849: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:27.804027: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:27.804193: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:27.804356: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:27.804527: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:27.804689: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:27.804854: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:27.804886: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:24:27.844343: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:24:27.844818: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2d28000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:24:27.844907: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:24:27.849561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:24:27.849604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:24:27.949878: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:24:27.950002: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:24:27.950282: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:24:27.950313: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:24:27.950332: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:24:27.950368: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:24:27.950417: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:24:27.950441: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:24:27.950456: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f2d5ca83430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:26:37.286508: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:26:37.433504: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:26:37.924733: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_schonhage333512/plugins/profile/2021_03_04_22_26_37
2021-03-04 22:26:38.414721: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_schonhage333512/plugins/profile/2021_03_04_22_26_37/householder.trace.json.gz
2021-03-04 22:26:38.511570: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:26:38.549164: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 22:26:38.551580: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_schonhage333512/plugins/profile/2021_03_04_22_26_37Dumped tool data for overview_page.pb to PAPER_12_threads_schonhage333512/plugins/profile/2021_03_04_22_26_37/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_schonhage333512/plugins/profile/2021_03_04_22_26_37/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_schonhage333512/plugins/profile/2021_03_04_22_26_37/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_schonhage333512/plugins/profile/2021_03_04_22_26_37/householder.kernel_stats.pb

Time for Epoch:26.95328712463379
Average single batch time this epoch: 0.2303626231658153
Running Average Epoch time: 25.497169733047485

Time for Epoch:25.497169733047485
Average single batch time this epoch: 0.21791820037059295
Running Average Epoch time: 25.59511649608612

Time for Epoch:25.693063259124756
Average single batch time this epoch: 0.2195921535165901
Running Average Epoch time: 25.684402306874592

Time for Epoch:25.862973928451538
Average single batch time this epoch: 0.22104402688833383
Running Average Epoch time: 25.59137374162674

Time for Epoch:25.31228804588318
Average single batch time this epoch: 0.2163376808166504
Average time per Batch: 0.21872301539804181
Average time per Epoch: 25.59137374162674
batch size 512
epochs 5
nodes 512
num layers 4
algorithm schonhage333
num threads 12
total time 130.82700872421265
2021-03-04 22:26:42.828367: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:26:43.371216: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:26:43.371645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:26:43.371962: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:26:43.372145: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:26:43.372336: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:26:43.372550: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:26:43.372743: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:26:43.372910: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:26:43.373164: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:26:43.373198: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:26:43.412319: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:26:43.412775: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9424000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:26:43.412825: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:26:43.417496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:26:43.417540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:26:43.521239: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:26:43.521353: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:26:43.521637: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:26:43.521667: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:26:43.521706: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:26:43.521742: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:26:43.521785: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:26:43.521809: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:26:43.521824: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f94564d5430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:28:30.650562: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:28:30.793792: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:28:31.289571: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov224512/plugins/profile/2021_03_04_22_28_30
2021-03-04 22:28:31.786970: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov224512/plugins/profile/2021_03_04_22_28_30/householder.trace.json.gz
2021-03-04 22:28:31.916970: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:28:31.960550: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 22:28:31.963049: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov224512/plugins/profile/2021_03_04_22_28_30Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov224512/plugins/profile/2021_03_04_22_28_30/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov224512/plugins/profile/2021_03_04_22_28_30/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov224512/plugins/profile/2021_03_04_22_28_30/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov224512/plugins/profile/2021_03_04_22_28_30/householder.kernel_stats.pb

Time for Epoch:22.63253688812256
Average single batch time this epoch: 0.19343448704124516
Running Average Epoch time: 21.260042428970337

Time for Epoch:21.260042428970337
Average single batch time this epoch: 0.18170380796122754
Running Average Epoch time: 21.449944257736206

Time for Epoch:21.639846086502075
Average single batch time this epoch: 0.18495012144757134
Running Average Epoch time: 21.452444235483807

Time for Epoch:21.457444190979004
Average single batch time this epoch: 0.18339109828329495
Running Average Epoch time: 21.119653284549713

Time for Epoch:20.121280431747437
Average single batch time this epoch: 0.1719712090288472
Average time per Batch: 0.18050405918023527
Average time per Epoch: 21.119653284549713
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov224
num threads 12
total time 108.63535475730896
2021-03-04 22:28:36.331510: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:28:36.891702: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:28:36.892222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:28:36.892540: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:28:36.892740: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:28:36.892950: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:28:36.893159: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:28:36.893373: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:28:36.893558: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:28:36.893778: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:28:36.893813: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:28:36.936371: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:28:36.936853: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0420000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:28:36.936946: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:28:36.941429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:28:36.941467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:28:37.043076: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:28:37.043203: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:28:37.043484: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:28:37.043514: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:28:37.043533: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:28:37.043567: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:28:37.043610: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:28:37.043634: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:28:37.043649: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f0452dbf4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:30:31.319184: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:30:31.456362: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:30:31.937551: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov225512/plugins/profile/2021_03_04_22_30_31
2021-03-04 22:30:32.424638: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov225512/plugins/profile/2021_03_04_22_30_31/householder.trace.json.gz
2021-03-04 22:30:32.530210: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:30:32.570230: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 22:30:32.572756: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov225512/plugins/profile/2021_03_04_22_30_31Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov225512/plugins/profile/2021_03_04_22_30_31/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov225512/plugins/profile/2021_03_04_22_30_31/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov225512/plugins/profile/2021_03_04_22_30_31/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov225512/plugins/profile/2021_03_04_22_30_31/householder.kernel_stats.pb

Time for Epoch:24.42411756515503
Average single batch time this epoch: 0.20874648420219746
Running Average Epoch time: 22.70124650001526

Time for Epoch:22.70124650001526
Average single batch time this epoch: 0.19402198302440155
Running Average Epoch time: 22.701372385025024

Time for Epoch:22.70149827003479
Average single batch time this epoch: 0.19402415120703542
Running Average Epoch time: 22.404672384262085

Time for Epoch:21.811272382736206
Average single batch time this epoch: 0.18641530754219773
Running Average Epoch time: 22.45849323272705

Time for Epoch:22.61995577812195
Average single batch time this epoch: 0.19332714569874299
Average time per Batch: 0.19194714686809441
Average time per Epoch: 22.45849323272705
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov225
num threads 12
total time 115.81135773658752
2021-03-04 22:30:36.802704: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:30:37.353054: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:30:37.353567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:30:37.353906: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:30:37.354120: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:30:37.354321: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:30:37.354524: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:30:37.354736: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:30:37.354939: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:30:37.355141: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:30:37.355178: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:30:37.388245: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:30:37.388639: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8798000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:30:37.388719: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:30:37.392430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:30:37.392472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:30:37.494442: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:30:37.494544: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:30:37.494791: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:30:37.494820: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:30:37.494838: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:30:37.494873: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:30:37.494914: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:30:37.494937: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:30:37.494952: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f87ccf8c4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:32:38.536025: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:32:38.673978: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:32:39.166567: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov272512/plugins/profile/2021_03_04_22_32_38
2021-03-04 22:32:39.650685: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov272512/plugins/profile/2021_03_04_22_32_38/householder.trace.json.gz
2021-03-04 22:32:39.760194: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:32:39.800857: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 22:32:39.803268: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov272512/plugins/profile/2021_03_04_22_32_38Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov272512/plugins/profile/2021_03_04_22_32_38/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov272512/plugins/profile/2021_03_04_22_32_38/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov272512/plugins/profile/2021_03_04_22_32_38/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov272512/plugins/profile/2021_03_04_22_32_38/householder.kernel_stats.pb

Time for Epoch:25.095996141433716
Average single batch time this epoch: 0.21448627496377015
Running Average Epoch time: 24.02748966217041

Time for Epoch:24.02748966217041
Average single batch time this epoch: 0.20535713587051782
Running Average Epoch time: 23.978861451148987

Time for Epoch:23.930233240127563
Average single batch time this epoch: 0.20452664856217864
Running Average Epoch time: 23.94274131457011

Time for Epoch:23.870501041412354
Average single batch time this epoch: 0.20401526108766213
Running Average Epoch time: 23.982122838497162

Time for Epoch:24.10026741027832
Average single batch time this epoch: 0.205979891312428
Average time per Batch: 0.20496973420819664
Average time per Epoch: 23.982122838497162
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov272
num threads 12
total time 122.5291519165039
2021-03-04 22:32:44.122114: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:32:44.659507: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:32:44.660091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:32:44.660411: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:32:44.660607: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:32:44.660795: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:32:44.661006: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:32:44.661197: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:32:44.661380: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:32:44.661565: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:32:44.661600: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:32:44.700303: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:32:44.700696: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe9f4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:32:44.700733: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:32:44.704242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:32:44.704281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:32:44.804051: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:32:44.804175: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:32:44.804449: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:32:44.804481: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:32:44.804516: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:32:44.804553: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:32:44.804603: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:32:44.804628: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:32:44.804644: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fea284c34c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:34:44.560957: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:34:44.705333: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:34:45.199207: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov323512/plugins/profile/2021_03_04_22_34_44
2021-03-04 22:34:45.698885: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov323512/plugins/profile/2021_03_04_22_34_44/householder.trace.json.gz
2021-03-04 22:34:45.825810: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:34:45.866325: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 22:34:45.868838: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov323512/plugins/profile/2021_03_04_22_34_44Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov323512/plugins/profile/2021_03_04_22_34_44/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov323512/plugins/profile/2021_03_04_22_34_44/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov323512/plugins/profile/2021_03_04_22_34_44/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov323512/plugins/profile/2021_03_04_22_34_44/householder.kernel_stats.pb

Time for Epoch:25.361306190490723
Average single batch time this epoch: 0.21675427550943488
Running Average Epoch time: 23.781513690948486

Time for Epoch:23.781513690948486
Average single batch time this epoch: 0.2032543838533581
Running Average Epoch time: 23.277461886405945

Time for Epoch:22.773410081863403
Average single batch time this epoch: 0.19463782228975215
Running Average Epoch time: 23.43234634399414

Time for Epoch:23.742115259170532
Average single batch time this epoch: 0.20291747394789997
Running Average Epoch time: 23.5914266705513

Time for Epoch:24.06866765022278
Average single batch time this epoch: 0.2057086606310983
Average time per Batch: 0.20162958518052712
Average time per Epoch: 23.5914266705513
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov323
num threads 12
total time 121.22940278053284
2021-03-04 22:34:50.307584: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:34:50.871138: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:34:50.871598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:34:50.871930: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:34:50.872111: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:34:50.872273: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:34:50.872437: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:34:50.872599: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:34:50.872763: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:34:50.872955: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:34:50.873005: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:34:50.912192: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:34:50.912638: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3834000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:34:50.912705: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:34:50.915946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:34:50.915988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:34:51.020116: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:34:51.020224: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:34:51.020503: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:34:51.020533: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:34:51.020551: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:34:51.020627: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:34:51.020678: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:34:51.020703: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:34:51.020718: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3866c024c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:36:56.470016: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:36:56.607738: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:36:57.101186: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov333512/plugins/profile/2021_03_04_22_36_56
2021-03-04 22:36:57.577322: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov333512/plugins/profile/2021_03_04_22_36_56/householder.trace.json.gz
2021-03-04 22:36:57.675203: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:36:57.712722: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 22:36:57.715342: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov333512/plugins/profile/2021_03_04_22_36_56Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov333512/plugins/profile/2021_03_04_22_36_56/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov333512/plugins/profile/2021_03_04_22_36_56/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov333512/plugins/profile/2021_03_04_22_36_56/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov333512/plugins/profile/2021_03_04_22_36_56/householder.kernel_stats.pb

Time for Epoch:26.613873720169067
Average single batch time this epoch: 0.22746252198504585
Running Average Epoch time: 24.484472274780273

Time for Epoch:24.484472274780273
Average single batch time this epoch: 0.2092623873653575
Running Average Epoch time: 24.138025760650635

Time for Epoch:23.791579246520996
Average single batch time this epoch: 0.20334021454183465
Running Average Epoch time: 24.496607303619385

Time for Epoch:25.213770389556885
Average single batch time this epoch: 0.21549597153296837
Running Average Epoch time: 24.704370319843292

Time for Epoch:25.327659368515015
Average single batch time this epoch: 0.21646822415865385
Average time per Batch: 0.2111416993997036
Average time per Epoch: 24.704370319843292
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov333
num threads 12
total time 126.97806811332703
2021-03-04 22:37:02.070918: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:37:02.624268: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:37:02.624768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:37:02.625064: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:37:02.625238: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:37:02.625405: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:37:02.625568: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:37:02.625738: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:37:02.625900: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:37:02.626065: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:37:02.626096: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:37:02.664381: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:37:02.664884: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f99ec000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:37:02.664951: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:37:02.669383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:37:02.669420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:37:02.768144: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:37:02.768272: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:37:02.768546: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:37:02.768578: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:37:02.768596: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:37:02.768631: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:37:02.768674: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:37:02.768698: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:37:02.768713: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f9a2023e430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:39:06.518319: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:39:06.662799: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:39:07.149610: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov334512/plugins/profile/2021_03_04_22_39_06
2021-03-04 22:39:07.619935: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov334512/plugins/profile/2021_03_04_22_39_06/householder.trace.json.gz
2021-03-04 22:39:07.730699: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:39:07.768172: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 22:39:07.770610: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov334512/plugins/profile/2021_03_04_22_39_06Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov334512/plugins/profile/2021_03_04_22_39_06/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov334512/plugins/profile/2021_03_04_22_39_06/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov334512/plugins/profile/2021_03_04_22_39_06/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov334512/plugins/profile/2021_03_04_22_39_06/householder.kernel_stats.pb

Time for Epoch:26.102949857711792
Average single batch time this epoch: 0.22309441444201347
Running Average Epoch time: 24.540027141571045

Time for Epoch:24.540027141571045
Average single batch time this epoch: 0.20973347802447456
Running Average Epoch time: 24.520856142044067

Time for Epoch:24.50168514251709
Average single batch time this epoch: 0.20940924505902153
Running Average Epoch time: 24.471787373224895

Time for Epoch:24.373649835586548
Average single batch time this epoch: 0.2083149567628518
Running Average Epoch time: 24.40747457742691

Time for Epoch:24.21453619003296
Average single batch time this epoch: 0.20695536564557981
Average time per Batch: 0.20860326137298194
Average time per Epoch: 24.40747457742691
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov334
num threads 12
total time 125.23639011383057
2021-03-04 22:39:12.057217: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:39:12.615282: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:39:12.615725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:39:12.616029: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:39:12.616211: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:39:12.616404: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:39:12.616621: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:39:12.616818: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:39:12.616985: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:39:12.617156: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:39:12.617186: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:39:12.656300: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:39:12.656721: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f55b8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:39:12.656758: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:39:12.660263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:39:12.660302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:39:12.763051: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:39:12.763184: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:39:12.763453: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:39:12.763482: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:39:12.763521: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:39:12.763557: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:39:12.763599: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:39:12.763622: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:39:12.763638: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f55ed2764c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:40:59.096411: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:40:59.248171: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:40:59.739999: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov442512/plugins/profile/2021_03_04_22_40_59
2021-03-04 22:41:00.226484: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov442512/plugins/profile/2021_03_04_22_40_59/householder.trace.json.gz
2021-03-04 22:41:00.323716: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:41:00.361548: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 22:41:00.364010: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov442512/plugins/profile/2021_03_04_22_40_59Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov442512/plugins/profile/2021_03_04_22_40_59/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov442512/plugins/profile/2021_03_04_22_40_59/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov442512/plugins/profile/2021_03_04_22_40_59/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov442512/plugins/profile/2021_03_04_22_40_59/householder.kernel_stats.pb

Time for Epoch:22.208105087280273
Average single batch time this epoch: 0.18980709915487176
Running Average Epoch time: 21.320895671844482

Time for Epoch:21.320895671844482
Average single batch time this epoch: 0.18222415345346826
Running Average Epoch time: 21.261601209640503

Time for Epoch:21.202306747436523
Average single batch time this epoch: 0.18121058716733232
Running Average Epoch time: 21.201355298360188

Time for Epoch:21.08086347579956
Average single batch time this epoch: 0.18017267365740913
Running Average Epoch time: 21.02713680267334

Time for Epoch:20.504481315612793
Average single batch time this epoch: 0.1752468867179675
Average time per Batch: 0.1797135752490443
Average time per Epoch: 21.02713680267334
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov442
num threads 12
total time 107.8613064289093
2021-03-04 22:41:04.672611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:41:05.239294: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:41:05.239740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:41:05.240098: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:41:05.240290: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:41:05.240455: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:41:05.240621: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:41:05.240808: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:41:05.240970: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:41:05.241183: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:41:05.241234: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:41:05.276234: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:41:05.276587: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa5c8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:41:05.276636: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:41:05.279918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:41:05.279954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:41:05.385591: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:41:05.385702: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:41:05.385966: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:41:05.385995: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:41:05.386018: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:41:05.386088: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:41:05.386134: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:41:05.386159: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:41:05.386174: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa5fbe71430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:43:03.515237: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:43:03.674426: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:43:04.207406: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov444512/plugins/profile/2021_03_04_22_43_03
2021-03-04 22:43:04.720395: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov444512/plugins/profile/2021_03_04_22_43_03/householder.trace.json.gz
2021-03-04 22:43:04.827057: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:43:04.866052: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 22:43:04.868521: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov444512/plugins/profile/2021_03_04_22_43_03Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov444512/plugins/profile/2021_03_04_22_43_03/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov444512/plugins/profile/2021_03_04_22_43_03/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov444512/plugins/profile/2021_03_04_22_43_03/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov444512/plugins/profile/2021_03_04_22_43_03/householder.kernel_stats.pb

Time for Epoch:24.652122735977173
Average single batch time this epoch: 0.21069577412727553
Running Average Epoch time: 23.411982774734497

Time for Epoch:23.411982774734497
Average single batch time this epoch: 0.20009625875032866
Running Average Epoch time: 23.362001299858093

Time for Epoch:23.31201982498169
Average single batch time this epoch: 0.19924265910417605
Running Average Epoch time: 23.346969763437908

Time for Epoch:23.316906690597534
Average single batch time this epoch: 0.199284698209192
Running Average Epoch time: 23.36493992805481

Time for Epoch:23.418850421905518
Average single batch time this epoch: 0.20015508700639772
Average time per Batch: 0.19969467576752362
Average time per Epoch: 23.36493992805481
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov444
num threads 12
total time 119.66317629814148
2021-03-04 22:43:09.201667: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:43:09.725161: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:43:09.725631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:43:09.725895: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:43:09.726067: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:43:09.726254: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:43:09.726436: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:43:09.726605: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:43:09.726766: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:43:09.726926: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:43:09.726957: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:43:09.768376: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:43:09.768790: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fcddc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:43:09.768828: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:43:09.772351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:43:09.772389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:43:09.875136: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:43:09.875271: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:43:09.875546: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:43:09.875575: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:43:09.875594: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:43:09.875629: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:43:09.875687: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:43:09.875713: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:43:09.875729: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fce10eab4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:45:10.742861: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:45:10.881729: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:45:11.389861: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov552512/plugins/profile/2021_03_04_22_45_10
2021-03-04 22:45:11.876227: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov552512/plugins/profile/2021_03_04_22_45_10/householder.trace.json.gz
2021-03-04 22:45:11.974310: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:45:12.012411: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 22:45:12.014882: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov552512/plugins/profile/2021_03_04_22_45_10Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov552512/plugins/profile/2021_03_04_22_45_10/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov552512/plugins/profile/2021_03_04_22_45_10/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov552512/plugins/profile/2021_03_04_22_45_10/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov552512/plugins/profile/2021_03_04_22_45_10/householder.kernel_stats.pb

Time for Epoch:25.640361070632935
Average single batch time this epoch: 0.2191422372801691
Running Average Epoch time: 23.556902408599854

Time for Epoch:23.556902408599854
Average single batch time this epoch: 0.20133510817829361
Running Average Epoch time: 23.864930748939514

Time for Epoch:24.172959089279175
Average single batch time this epoch: 0.20660019939781255
Running Average Epoch time: 23.785283883412678

Time for Epoch:23.62599015235901
Average single batch time this epoch: 0.20192575658488476
Running Average Epoch time: 23.802618622779846

Time for Epoch:23.854622840881348
Average single batch time this epoch: 0.20387975986187273
Average time per Batch: 0.2034352060057159
Average time per Epoch: 23.802618622779846
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov552
num threads 12
total time 122.35199069976807
2021-03-04 22:45:16.302433: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:45:16.855400: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:45:16.855872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:45:16.856139: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:45:16.856315: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:45:16.856502: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:45:16.856714: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:45:16.856903: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:45:16.857066: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:45:16.857231: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:45:16.857261: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:45:16.896220: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:45:16.896733: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fca54000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:45:16.896816: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:45:16.901280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:45:16.901318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:45:17.004491: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:45:17.004633: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:45:17.004929: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:45:17.004959: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:45:17.005002: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:45:17.005038: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:45:17.005079: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:45:17.005103: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:45:17.005118: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fca885a6430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:47:29.994857: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:47:30.122117: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:47:30.592574: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov555512/plugins/profile/2021_03_04_22_47_30
2021-03-04 22:47:31.075931: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov555512/plugins/profile/2021_03_04_22_47_30/householder.trace.json.gz
2021-03-04 22:47:31.173440: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:47:31.210918: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 22:47:31.213411: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov555512/plugins/profile/2021_03_04_22_47_30Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov555512/plugins/profile/2021_03_04_22_47_30/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov555512/plugins/profile/2021_03_04_22_47_30/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov555512/plugins/profile/2021_03_04_22_47_30/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov555512/plugins/profile/2021_03_04_22_47_30/householder.kernel_stats.pb

Time for Epoch:27.816487550735474
Average single batch time this epoch: 0.2377410077641153
Running Average Epoch time: 26.509971618652344

Time for Epoch:26.509971618652344
Average single batch time this epoch: 0.22657451874170548
Running Average Epoch time: 26.259943962097168

Time for Epoch:26.009916305541992
Average single batch time this epoch: 0.22230111431871724
Running Average Epoch time: 26.350274801254272

Time for Epoch:26.53093647956848
Average single batch time this epoch: 0.2267536892850175
Running Average Epoch time: 26.28911966085434

Time for Epoch:26.10565423965454
Average single batch time this epoch: 0.22311907548170823
Average time per Batch: 0.2246870994567871
Average time per Epoch: 26.28911966085434
batch size 512
epochs 5
nodes 512
num layers 4
algorithm smirnov555
num threads 12
total time 134.4991590976715
2021-03-04 22:47:35.570385: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:47:36.135651: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:47:36.136290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:47:36.136664: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:47:36.136893: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:47:36.137107: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:47:36.137320: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:47:36.137525: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:47:36.137726: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:47:36.137965: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:47:36.138005: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:47:36.180237: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:47:36.180697: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f61ec000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:47:36.180759: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:47:36.185467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:47:36.185514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:47:36.448059: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:47:36.448212: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:47:36.448496: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:47:36.448527: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:47:36.448546: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:47:36.448581: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:47:36.448623: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:47:36.448649: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:47:36.448664: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f621f8d8430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:51:35.244304: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:51:35.416588: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:51:35.660334: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_bini3221024/plugins/profile/2021_03_04_22_51_35
2021-03-04 22:51:35.903994: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_bini3221024/plugins/profile/2021_03_04_22_51_35/householder.trace.json.gz
2021-03-04 22:51:35.951852: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:51:35.970343: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 22:51:35.972641: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_bini3221024/plugins/profile/2021_03_04_22_51_35Dumped tool data for overview_page.pb to PAPER_12_threads_bini3221024/plugins/profile/2021_03_04_22_51_35/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_bini3221024/plugins/profile/2021_03_04_22_51_35/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_bini3221024/plugins/profile/2021_03_04_22_51_35/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_bini3221024/plugins/profile/2021_03_04_22_51_35/householder.kernel_stats.pb

Time for Epoch:50.23083519935608
Average single batch time this epoch: 0.8660403942239696
Running Average Epoch time: 47.60134482383728

Time for Epoch:47.60134482383728
Average single batch time this epoch: 0.8207053439370517
Running Average Epoch time: 47.34265983104706

Time for Epoch:47.083974838256836
Average single batch time this epoch: 0.8117843208641842
Running Average Epoch time: 47.17086656888326

Time for Epoch:46.827280044555664
Average single batch time this epoch: 0.8073610478434069
Running Average Epoch time: 47.13767033815384

Time for Epoch:47.038081645965576
Average single batch time this epoch: 0.8109950813753851
Average time per Batch: 0.812711448505007
Average time per Epoch: 47.13767033815384
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm bini322
num threads 12
total time 240.47868752479553
2021-03-04 22:51:40.183944: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:51:40.716751: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:51:40.717284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:51:40.717836: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:51:40.717988: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:51:40.718134: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:51:40.718288: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:51:40.718430: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:51:40.718554: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:51:40.718683: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:51:40.718707: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:51:40.756312: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:51:40.756732: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fefc0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:51:40.756770: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:51:40.760230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:51:40.760267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:51:41.020987: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:51:41.021122: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:51:41.021397: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:51:41.021427: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:51:41.021446: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:51:41.021480: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:51:41.021522: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:51:41.021546: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:51:41.021562: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7feff246e430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:54:13.633956: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:54:13.856254: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:54:14.094962: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_dgemm1024/plugins/profile/2021_03_04_22_54_13
2021-03-04 22:54:14.335122: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_dgemm1024/plugins/profile/2021_03_04_22_54_13/householder.trace.json.gz
2021-03-04 22:54:14.382234: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:54:14.400105: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 22:54:14.402545: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_dgemm1024/plugins/profile/2021_03_04_22_54_13Dumped tool data for overview_page.pb to PAPER_12_threads_dgemm1024/plugins/profile/2021_03_04_22_54_13/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_dgemm1024/plugins/profile/2021_03_04_22_54_13/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_dgemm1024/plugins/profile/2021_03_04_22_54_13/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_dgemm1024/plugins/profile/2021_03_04_22_54_13/householder.kernel_stats.pb

Time for Epoch:33.004846811294556
Average single batch time this epoch: 0.5690420126092846
Running Average Epoch time: 30.241798162460327

Time for Epoch:30.241798162460327
Average single batch time this epoch: 0.5214034483350557
Running Average Epoch time: 30.020827651023865

Time for Epoch:29.799857139587402
Average single batch time this epoch: 0.5137831054884812
Running Average Epoch time: 29.897913138071697

Time for Epoch:29.65208411216736
Average single batch time this epoch: 0.5112358701640162
Running Average Epoch time: 29.897867381572723

Time for Epoch:29.897730112075806
Average single batch time this epoch: 0.515471339225769
Average time per Batch: 0.5154734408033305
Average time per Epoch: 29.897867381572723
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm dgemm
num threads 12
total time 154.2640416622162
2021-03-04 22:54:18.604152: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:54:19.140299: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:54:19.140797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:54:19.141519: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:19.141676: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:19.141814: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:19.141967: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:19.142099: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:19.142229: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:19.142364: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:19.142389: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:54:19.180199: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:54:19.180579: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4f9c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:54:19.180623: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:54:19.184821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:54:19.184863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:54:19.446677: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:54:19.446828: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:54:19.447125: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:19.447156: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:54:19.447192: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:54:19.447230: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:54:19.447275: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:54:19.447300: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:54:19.447315: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-04 22:54:20.135994: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:54:24.093335: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:54:24.615714: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:54:24.616249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:54:24.616801: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:24.616971: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:24.617120: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:24.617265: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:24.617407: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:24.617538: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:24.617670: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:24.617710: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:54:24.652310: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:54:24.652767: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f239c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:54:24.652853: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:54:24.656663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:54:24.656707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:54:24.931273: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:54:24.931376: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:54:24.931629: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:54:24.931659: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:54:24.931678: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:54:24.931713: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:54:24.931762: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:54:24.931804: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:54:24.931821: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f23cea024c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 22:58:16.967987: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:58:17.179944: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 22:58:17.444593: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_schonhage3331024/plugins/profile/2021_03_04_22_58_17
2021-03-04 22:58:17.702322: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_schonhage3331024/plugins/profile/2021_03_04_22_58_17/householder.trace.json.gz
2021-03-04 22:58:17.760901: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 22:58:17.780298: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 22:58:17.782556: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_schonhage3331024/plugins/profile/2021_03_04_22_58_17Dumped tool data for overview_page.pb to PAPER_12_threads_schonhage3331024/plugins/profile/2021_03_04_22_58_17/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_schonhage3331024/plugins/profile/2021_03_04_22_58_17/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_schonhage3331024/plugins/profile/2021_03_04_22_58_17/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_schonhage3331024/plugins/profile/2021_03_04_22_58_17/householder.kernel_stats.pb

Time for Epoch:48.00422430038452
Average single batch time this epoch: 0.8276514637059179
Running Average Epoch time: 45.73201370239258

Time for Epoch:45.73201370239258
Average single batch time this epoch: 0.7884769604123872
Running Average Epoch time: 45.890475153923035

Time for Epoch:46.04893660545349
Average single batch time this epoch: 0.793940387923142
Running Average Epoch time: 46.01300883293152

Time for Epoch:46.258076190948486
Average single batch time this epoch: 0.7975453919377821
Running Average Epoch time: 46.003454983234406

Time for Epoch:45.974793434143066
Average single batch time this epoch: 0.79266200394466
Average time per Batch: 0.7931561860544929
Average time per Epoch: 46.003454983234406
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm schonhage333
num threads 12
total time 233.68869948387146
2021-03-04 22:58:21.982107: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 22:58:22.535919: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 22:58:22.536454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 22:58:22.536766: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:58:22.537012: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:58:22.537215: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:58:22.537441: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:58:22.537672: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:58:22.537880: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:58:22.538080: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:58:22.538119: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 22:58:22.580179: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 22:58:22.580694: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f600c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 22:58:22.580782: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 22:58:22.585869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 22:58:22.585933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 22:58:22.849565: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:58:22.849693: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 22:58:22.849991: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 22:58:22.850019: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:58:22.850038: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:58:22.850072: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:58:22.850119: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 22:58:22.850145: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 22:58:22.850160: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f6040c224c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:01:44.881227: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:01:44.966503: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:01:45.203423: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2241024/plugins/profile/2021_03_04_23_01_44
2021-03-04 23:01:45.450208: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2241024/plugins/profile/2021_03_04_23_01_44/householder.trace.json.gz
2021-03-04 23:01:45.498889: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:01:45.517201: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 23:01:45.519414: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2241024/plugins/profile/2021_03_04_23_01_44Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2241024/plugins/profile/2021_03_04_23_01_44/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2241024/plugins/profile/2021_03_04_23_01_44/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2241024/plugins/profile/2021_03_04_23_01_44/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2241024/plugins/profile/2021_03_04_23_01_44/householder.kernel_stats.pb

Time for Epoch:42.04991436004639
Average single batch time this epoch: 0.7249914243303496
Running Average Epoch time: 39.99909853935242

Time for Epoch:39.99909853935242
Average single batch time this epoch: 0.6896334927657555
Running Average Epoch time: 40.00473773479462

Time for Epoch:40.010376930236816
Average single batch time this epoch: 0.6898285027208
Running Average Epoch time: 39.96484883626302

Time for Epoch:39.88507103919983
Average single batch time this epoch: 0.687668331738176
Running Average Epoch time: 39.99182200431824

Time for Epoch:40.07274150848389
Average single batch time this epoch: 0.6909038116191996
Average time per Batch: 0.6895085347109827
Average time per Epoch: 39.99182200431824
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov224
num threads 12
total time 203.71585083007812
2021-03-04 23:01:49.839979: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:01:50.388269: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:01:50.388868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:01:50.389466: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:01:50.389615: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:01:50.389743: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:01:50.389868: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:01:50.390016: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:01:50.390140: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:01:50.390264: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:01:50.390288: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:01:50.428274: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:01:50.428752: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fac04000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:01:50.428821: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:01:50.433894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:01:50.433943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:01:50.696295: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:01:50.696443: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:01:50.696730: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:01:50.696762: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:01:50.696783: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:01:50.696836: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:01:50.696879: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:01:50.696903: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:01:50.696919: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fac3927b430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:05:23.746758: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:05:23.828740: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:05:24.062185: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2251024/plugins/profile/2021_03_04_23_05_23
2021-03-04 23:05:24.302412: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2251024/plugins/profile/2021_03_04_23_05_23/householder.trace.json.gz
2021-03-04 23:05:24.349591: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:05:24.368075: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 23:05:24.370407: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2251024/plugins/profile/2021_03_04_23_05_23Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2251024/plugins/profile/2021_03_04_23_05_23/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2251024/plugins/profile/2021_03_04_23_05_23/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2251024/plugins/profile/2021_03_04_23_05_23/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2251024/plugins/profile/2021_03_04_23_05_23/householder.kernel_stats.pb

Time for Epoch:43.99179148674011
Average single batch time this epoch: 0.7584704900610035
Running Average Epoch time: 42.334017753601074

Time for Epoch:42.334017753601074
Average single batch time this epoch: 0.7298894092954439
Running Average Epoch time: 42.41781568527222

Time for Epoch:42.50161361694336
Average single batch time this epoch: 0.7327790342528244
Running Average Epoch time: 42.36292584737142

Time for Epoch:42.253146171569824
Average single batch time this epoch: 0.7284954169700886
Running Average Epoch time: 42.26024180650711

Time for Epoch:41.952189683914185
Average single batch time this epoch: 0.7233065078998434
Average time per Batch: 0.72861759210455
Average time per Epoch: 42.26024180650711
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov225
num threads 12
total time 214.70311450958252
2021-03-04 23:05:28.624313: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:05:29.147946: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:05:29.148550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:05:29.148906: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:05:29.149124: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:05:29.149329: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:05:29.149532: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:05:29.149744: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:05:29.149946: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:05:29.150149: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:05:29.150216: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:05:29.192253: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:05:29.192687: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fbcb8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:05:29.192749: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:05:29.198243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:05:29.198292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:05:29.454690: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:05:29.454854: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:05:29.455151: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:05:29.455184: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:05:29.455208: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:05:29.455244: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:05:29.455287: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:05:29.455310: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:05:29.455325: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fbcea1b1430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:09:29.136258: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:09:29.324956: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:09:29.580454: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2721024/plugins/profile/2021_03_04_23_09_29
2021-03-04 23:09:29.837421: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2721024/plugins/profile/2021_03_04_23_09_29/householder.trace.json.gz
2021-03-04 23:09:29.890274: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:09:29.909176: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 23:09:29.911499: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2721024/plugins/profile/2021_03_04_23_09_29Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2721024/plugins/profile/2021_03_04_23_09_29/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2721024/plugins/profile/2021_03_04_23_09_29/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2721024/plugins/profile/2021_03_04_23_09_29/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2721024/plugins/profile/2021_03_04_23_09_29/householder.kernel_stats.pb

Time for Epoch:49.37952923774719
Average single batch time this epoch: 0.8513619488683241
Running Average Epoch time: 48.00634264945984

Time for Epoch:48.00634264945984
Average single batch time this epoch: 0.827688270601733
Running Average Epoch time: 47.48537027835846

Time for Epoch:46.96439790725708
Average single batch time this epoch: 0.8097236608636791
Running Average Epoch time: 47.592627922693886

Time for Epoch:47.807143211364746
Average single batch time this epoch: 0.8242528397461464
Running Average Epoch time: 47.571473717689514

Time for Epoch:47.50801110267639
Average single batch time this epoch: 0.8190960884094238
Average time per Batch: 0.8201902149052456
Average time per Epoch: 47.571473717689514
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov272
num threads 12
total time 241.31830978393555
2021-03-04 23:09:34.097409: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:09:34.643293: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:09:34.643735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:09:34.644574: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:09:34.644754: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:09:34.644888: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:09:34.645025: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:09:34.645161: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:09:34.645295: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:09:34.645424: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:09:34.645452: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:09:34.680217: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:09:34.680685: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa6f8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:09:34.680748: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:09:34.684765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:09:34.684823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:09:34.953794: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:09:34.953876: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:09:34.954078: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:09:34.954108: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:09:34.954127: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:09:34.954162: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:09:34.954205: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:09:34.954231: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:09:34.954246: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa72c4e94c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:13:24.215949: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:13:24.352881: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:13:24.612196: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3231024/plugins/profile/2021_03_04_23_13_24
2021-03-04 23:13:24.858782: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3231024/plugins/profile/2021_03_04_23_13_24/householder.trace.json.gz
2021-03-04 23:13:24.916858: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:13:24.935891: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 23:13:24.938272: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3231024/plugins/profile/2021_03_04_23_13_24Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3231024/plugins/profile/2021_03_04_23_13_24/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3231024/plugins/profile/2021_03_04_23_13_24/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3231024/plugins/profile/2021_03_04_23_13_24/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3231024/plugins/profile/2021_03_04_23_13_24/householder.kernel_stats.pb

Time for Epoch:47.21078014373779
Average single batch time this epoch: 0.8139704835825953
Running Average Epoch time: 45.35929465293884

Time for Epoch:45.35929465293884
Average single batch time this epoch: 0.7820497011316234
Running Average Epoch time: 45.5421838760376

Time for Epoch:45.72507309913635
Average single batch time this epoch: 0.7883558232208778
Running Average Epoch time: 45.404537995656334

Time for Epoch:45.1292462348938
Average single batch time this epoch: 0.7780829339191832
Running Average Epoch time: 45.50830417871475

Time for Epoch:45.819602727890015
Average single batch time this epoch: 0.7899861089114485
Average time per Batch: 0.7846186417957832
Average time per Epoch: 45.50830417871475
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov323
num threads 12
total time 230.9344129562378
2021-03-04 23:13:29.257071: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:13:29.809295: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:13:29.809740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:13:29.810008: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:13:29.810183: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:13:29.810372: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:13:29.810556: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:13:29.810769: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:13:29.810930: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:13:29.811096: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:13:29.811126: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:13:29.852245: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:13:29.852679: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fefac000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:13:29.852741: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:13:29.857433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:13:29.857476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:13:30.121755: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:13:30.121889: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:13:30.122161: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:13:30.122190: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:13:30.122209: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:13:30.122265: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:13:30.122308: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:13:30.122333: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:13:30.122349: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fefe1b0b4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:17:23.887763: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:17:24.083609: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:17:24.329216: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3331024/plugins/profile/2021_03_04_23_17_24
2021-03-04 23:17:24.574727: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3331024/plugins/profile/2021_03_04_23_17_24/householder.trace.json.gz
2021-03-04 23:17:24.623768: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:17:24.642242: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 23:17:24.644612: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3331024/plugins/profile/2021_03_04_23_17_24Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3331024/plugins/profile/2021_03_04_23_17_24/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3331024/plugins/profile/2021_03_04_23_17_24/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3331024/plugins/profile/2021_03_04_23_17_24/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3331024/plugins/profile/2021_03_04_23_17_24/householder.kernel_stats.pb

Time for Epoch:48.495463848114014
Average single batch time this epoch: 0.8361210535312521
Running Average Epoch time: 46.056464195251465

Time for Epoch:46.056464195251465
Average single batch time this epoch: 0.7940704164833858
Running Average Epoch time: 46.150227665901184

Time for Epoch:46.2439911365509
Average single batch time this epoch: 0.7973036807158898
Running Average Epoch time: 46.17282541592916

Time for Epoch:46.21802091598511
Average single batch time this epoch: 0.7968561731535813
Running Average Epoch time: 46.31376904249191

Time for Epoch:46.736599922180176
Average single batch time this epoch: 0.8057967794352564
Average time per Batch: 0.7985067624470282
Average time per Epoch: 46.31376904249191
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov333
num threads 12
total time 235.45433068275452
2021-03-04 23:17:28.864169: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:17:29.417286: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:17:29.417767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:17:29.418348: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:17:29.418520: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:17:29.418646: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:17:29.418769: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:17:29.418901: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:17:29.419027: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:17:29.419167: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:17:29.419219: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:17:29.456207: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:17:29.456618: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8a74000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:17:29.456686: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:17:29.460673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:17:29.460720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:17:29.718099: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:17:29.718205: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:17:29.718462: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:17:29.718505: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:17:29.718527: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:17:29.718593: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:17:29.718651: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:17:29.718677: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:17:29.718692: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8aa66c44c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:20:54.159758: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:20:54.300795: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:20:54.557863: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3341024/plugins/profile/2021_03_04_23_20_54
2021-03-04 23:20:54.823061: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3341024/plugins/profile/2021_03_04_23_20_54/householder.trace.json.gz
2021-03-04 23:20:54.874795: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:20:54.893588: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 23:20:54.895990: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3341024/plugins/profile/2021_03_04_23_20_54Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3341024/plugins/profile/2021_03_04_23_20_54/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3341024/plugins/profile/2021_03_04_23_20_54/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3341024/plugins/profile/2021_03_04_23_20_54/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3341024/plugins/profile/2021_03_04_23_20_54/householder.kernel_stats.pb

Time for Epoch:41.891132831573486
Average single batch time this epoch: 0.722254231058318
Running Average Epoch time: 40.73568892478943

Time for Epoch:40.73568892478943
Average single batch time this epoch: 0.702333532530686
Running Average Epoch time: 40.632184624671936

Time for Epoch:40.52868032455444
Average single batch time this epoch: 0.6987645626068115
Running Average Epoch time: 40.62059632937113

Time for Epoch:40.59741973876953
Average single batch time this epoch: 0.6999494207316431
Running Average Epoch time: 40.633845925331116

Time for Epoch:40.67359471321106
Average single batch time this epoch: 0.7012626014906784
Average time per Batch: 0.7005775293399548
Average time per Epoch: 40.633845925331116
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov334
num threads 12
total time 206.1169469356537
2021-03-04 23:20:59.166736: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:20:59.707906: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:20:59.708431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:20:59.708747: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:20:59.708992: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:20:59.709220: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:20:59.709445: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:20:59.709651: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:20:59.709849: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:20:59.710053: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:20:59.710091: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:20:59.752297: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:20:59.752676: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fcb14000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:20:59.752714: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:20:59.756233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:20:59.756290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:21:00.014469: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:21:00.014600: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:21:00.014884: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:21:00.014913: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:21:00.014932: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:21:00.014968: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:21:00.015010: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:21:00.015034: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:21:00.015049: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fcb483be430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:24:37.834636: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:24:38.013944: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:24:38.256474: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov4421024/plugins/profile/2021_03_04_23_24_38
2021-03-04 23:24:38.500430: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov4421024/plugins/profile/2021_03_04_23_24_38/householder.trace.json.gz
2021-03-04 23:24:38.548191: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:24:38.566327: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 23:24:38.568658: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov4421024/plugins/profile/2021_03_04_23_24_38Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov4421024/plugins/profile/2021_03_04_23_24_38/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov4421024/plugins/profile/2021_03_04_23_24_38/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov4421024/plugins/profile/2021_03_04_23_24_38/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov4421024/plugins/profile/2021_03_04_23_24_38/householder.kernel_stats.pb

Time for Epoch:44.64622664451599
Average single batch time this epoch: 0.7697545947699711
Running Average Epoch time: 43.55308771133423

Time for Epoch:43.55308771133423
Average single batch time this epoch: 0.7509081117038069
Running Average Epoch time: 43.35473394393921

Time for Epoch:43.15638017654419
Average single batch time this epoch: 0.7440686842490887
Running Average Epoch time: 43.37952574094137

Time for Epoch:43.42910933494568
Average single batch time this epoch: 0.7487706891421614
Running Average Epoch time: 43.28948491811752

Time for Epoch:43.019362449645996
Average single batch time this epoch: 0.7417065439553097
Average time per Batch: 0.7463635072625916
Average time per Epoch: 43.28948491811752
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov442
num threads 12
total time 219.49329733848572
2021-03-04 23:24:42.799398: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:24:43.336660: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:24:43.337168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:24:43.337729: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:24:43.337910: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:24:43.338035: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:24:43.338158: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:24:43.338303: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:24:43.338424: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:24:43.338549: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:24:43.338586: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:24:43.372386: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:24:43.372791: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f01e4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:24:43.372857: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:24:43.376547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:24:43.376589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:24:43.638967: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:24:43.639098: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:24:43.639379: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:24:43.639423: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:24:43.639445: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:24:43.639531: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:24:43.639596: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:24:43.639623: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:24:43.639639: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f0216c834c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:28:11.294836: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:28:11.435153: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:28:11.691547: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov4441024/plugins/profile/2021_03_04_23_28_11
2021-03-04 23:28:11.951666: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov4441024/plugins/profile/2021_03_04_23_28_11/householder.trace.json.gz
2021-03-04 23:28:12.002956: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:28:12.021693: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 23:28:12.024049: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov4441024/plugins/profile/2021_03_04_23_28_11Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov4441024/plugins/profile/2021_03_04_23_28_11/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov4441024/plugins/profile/2021_03_04_23_28_11/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov4441024/plugins/profile/2021_03_04_23_28_11/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov4441024/plugins/profile/2021_03_04_23_28_11/householder.kernel_stats.pb

Time for Epoch:43.25685906410217
Average single batch time this epoch: 0.74580128028475
Running Average Epoch time: 41.55962514877319

Time for Epoch:41.55962514877319
Average single batch time this epoch: 0.7165389348720682
Running Average Epoch time: 41.24237084388733

Time for Epoch:40.925116539001465
Average single batch time this epoch: 0.7055996039818073
Running Average Epoch time: 41.19409592946371

Time for Epoch:41.097546100616455
Average single batch time this epoch: 0.7085728069831585
Running Average Epoch time: 41.095691323280334

Time for Epoch:40.800477504730225
Average single batch time this epoch: 0.7034505071311161
Average time per Batch: 0.7085404632420376
Average time per Epoch: 41.095691323280334
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov444
num threads 12
total time 209.30835700035095
2021-03-04 23:28:16.401435: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:28:16.940921: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:28:16.941503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:28:16.941829: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:28:16.942025: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:28:16.942215: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:28:16.942401: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:28:16.942593: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:28:16.942789: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:28:16.943004: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:28:16.943040: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:28:16.984348: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:28:16.984751: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0c40000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:28:16.984789: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:28:16.988455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:28:16.988495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:28:17.249510: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:28:17.249661: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:28:17.249952: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:28:17.249983: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:28:17.250003: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:28:17.250039: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:28:17.250083: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:28:17.250108: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:28:17.250124: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f0c75bb1430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:32:40.036028: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:32:40.237055: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:32:40.504435: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov5521024/plugins/profile/2021_03_04_23_32_40
2021-03-04 23:32:40.765026: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov5521024/plugins/profile/2021_03_04_23_32_40/householder.trace.json.gz
2021-03-04 23:32:40.818212: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:32:40.837043: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 23:32:40.839342: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov5521024/plugins/profile/2021_03_04_23_32_40Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov5521024/plugins/profile/2021_03_04_23_32_40/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov5521024/plugins/profile/2021_03_04_23_32_40/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov5521024/plugins/profile/2021_03_04_23_32_40/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov5521024/plugins/profile/2021_03_04_23_32_40/householder.kernel_stats.pb

Time for Epoch:53.93853497505188
Average single batch time this epoch: 0.9299658372484404
Running Average Epoch time: 52.257298707962036

Time for Epoch:52.257298707962036
Average single batch time this epoch: 0.9009805547780004
Running Average Epoch time: 52.48282241821289

Time for Epoch:52.708346128463745
Average single batch time this epoch: 0.9087570330192303
Running Average Epoch time: 52.327947537104286

Time for Epoch:52.018197774887085
Average single batch time this epoch: 0.8968585071892574
Running Average Epoch time: 52.20783054828644

Time for Epoch:51.847479581832886
Average single batch time this epoch: 0.8939142062746245
Average time per Batch: 0.9001275753152782
Average time per Epoch: 52.20783054828644
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov552
num threads 12
total time 264.4419460296631
2021-03-04 23:32:45.048495: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:32:45.600255: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:32:45.600789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:32:45.601127: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:32:45.601373: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:32:45.601603: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:32:45.601826: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:32:45.602063: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:32:45.602269: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:32:45.602471: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:32:45.602509: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:32:45.644320: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:32:45.644718: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5db4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:32:45.644756: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:32:45.648326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:32:45.648383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:32:45.911526: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:32:45.911649: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:32:45.911939: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:32:45.911970: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:32:45.911989: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:32:45.912024: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:32:45.912084: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:32:45.912111: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:32:45.912127: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5de7e104c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:37:18.827291: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:37:18.895274: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:37:19.178196: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov5551024/plugins/profile/2021_03_04_23_37_18
2021-03-04 23:37:19.423666: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov5551024/plugins/profile/2021_03_04_23_37_18/householder.trace.json.gz
2021-03-04 23:37:19.470927: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:37:19.489122: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.002 ms

2021-03-04 23:37:19.491393: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov5551024/plugins/profile/2021_03_04_23_37_18Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov5551024/plugins/profile/2021_03_04_23_37_18/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov5551024/plugins/profile/2021_03_04_23_37_18/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov5551024/plugins/profile/2021_03_04_23_37_18/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov5551024/plugins/profile/2021_03_04_23_37_18/householder.kernel_stats.pb

Time for Epoch:55.33399415016174
Average single batch time this epoch: 0.9540274883138722
Running Average Epoch time: 54.803438663482666

Time for Epoch:54.803438663482666
Average single batch time this epoch: 0.9448801690134508
Running Average Epoch time: 54.5670131444931

Time for Epoch:54.33058762550354
Average single batch time this epoch: 0.9367278649889189
Running Average Epoch time: 54.44526743888855

Time for Epoch:54.20177602767944
Average single batch time this epoch: 0.9345068027233255
Running Average Epoch time: 54.391642689704895

Time for Epoch:54.23076844215393
Average single batch time this epoch: 0.9350069226889774
Average time per Batch: 0.9377804398536682
Average time per Epoch: 54.391642689704895
batch size 1024
epochs 5
nodes 1024
num layers 4
algorithm smirnov555
num threads 12
total time 274.58604311943054
2021-03-04 23:37:23.745849: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:37:24.289863: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:37:24.290343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:37:24.290957: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:37:24.291117: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:37:24.291243: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:37:24.291368: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:37:24.291510: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:37:24.291632: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:37:24.291756: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:37:24.291795: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:37:24.324226: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:37:24.324778: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc7cc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:37:24.324862: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:37:24.331362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:37:24.331408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:37:25.178960: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:37:25.179111: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:37:25.179388: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:37:25.179418: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:37:25.179437: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:37:25.179490: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:37:25.179534: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:37:25.179558: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:37:25.179573: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc7fe6df4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:46:36.507895: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:46:36.537561: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:46:36.666688: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_bini3222048/plugins/profile/2021_03_04_23_46_36
2021-03-04 23:46:36.801465: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_bini3222048/plugins/profile/2021_03_04_23_46_36/householder.trace.json.gz
2021-03-04 23:46:36.823591: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:46:36.833041: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 23:46:36.835150: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_bini3222048/plugins/profile/2021_03_04_23_46_36Dumped tool data for overview_page.pb to PAPER_12_threads_bini3222048/plugins/profile/2021_03_04_23_46_36/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_bini3222048/plugins/profile/2021_03_04_23_46_36/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_bini3222048/plugins/profile/2021_03_04_23_46_36/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_bini3222048/plugins/profile/2021_03_04_23_46_36/householder.kernel_stats.pb

Time for Epoch:118.6915762424469
Average single batch time this epoch: 4.092800033503566
Running Average Epoch time: 108.22121977806091

Time for Epoch:108.22121977806091
Average single batch time this epoch: 3.731755026455583
Running Average Epoch time: 108.11283051967621

Time for Epoch:108.0044412612915
Average single batch time this epoch: 3.7242798065317086
Running Average Epoch time: 108.1725058555603

Time for Epoch:108.29185652732849
Average single batch time this epoch: 3.734191080619549
Running Average Epoch time: 108.15551286935806

Time for Epoch:108.10453391075134
Average single batch time this epoch: 3.7277310881121406
Average time per Batch: 3.7294892504297454
Average time per Epoch: 108.15551286935806
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm bini322
num threads 12
total time 553.5628187656403
2021-03-04 23:46:41.550599: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:46:42.102669: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:46:42.103032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:46:42.103226: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:46:42.103363: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:46:42.103503: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:46:42.103652: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:46:42.103808: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:46:42.103935: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:46:42.104059: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:46:42.104102: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:46:42.144121: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:46:42.144426: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd8b8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:46:42.144463: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:46:42.147844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:46:42.147873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:46:42.996558: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:46:42.996698: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:46:42.997009: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:46:42.997039: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:46:42.997058: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:46:42.997093: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:46:42.997153: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:46:42.997181: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:46:42.997197: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd8ed1ab430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-04 23:52:59.067628: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:52:59.205714: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-04 23:52:59.323601: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_dgemm2048/plugins/profile/2021_03_04_23_52_59
2021-03-04 23:52:59.447117: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_dgemm2048/plugins/profile/2021_03_04_23_52_59/householder.trace.json.gz
2021-03-04 23:52:59.466505: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-04 23:52:59.475680: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-04 23:52:59.477827: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_dgemm2048/plugins/profile/2021_03_04_23_52_59Dumped tool data for overview_page.pb to PAPER_12_threads_dgemm2048/plugins/profile/2021_03_04_23_52_59/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_dgemm2048/plugins/profile/2021_03_04_23_52_59/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_dgemm2048/plugins/profile/2021_03_04_23_52_59/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_dgemm2048/plugins/profile/2021_03_04_23_52_59/householder.kernel_stats.pb

Time for Epoch:75.95559978485107
Average single batch time this epoch: 2.6191489367649474
Running Average Epoch time: 73.84461569786072

Time for Epoch:73.84461569786072
Average single batch time this epoch: 2.546357343936789
Running Average Epoch time: 75.10326182842255

Time for Epoch:76.36190795898438
Average single batch time this epoch: 2.633159982747045
Running Average Epoch time: 74.75823036829631

Time for Epoch:74.06816744804382
Average single batch time this epoch: 2.554064997311296
Running Average Epoch time: 75.0251789689064

Time for Epoch:75.8260247707367
Average single batch time this epoch: 2.6146794680891365
Average time per Batch: 2.587065448021067
Average time per Epoch: 75.0251789689064
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm dgemm
num threads 12
total time 378.3436117172241
2021-03-04 23:53:04.220116: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:53:04.775343: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:53:04.775811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:53:04.776102: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:04.776319: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:04.776512: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:04.776703: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:04.776893: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:04.777062: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:04.777232: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:04.777264: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:53:04.816322: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:53:04.816735: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5034000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:53:04.816772: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:53:04.820329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:53:04.820387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:53:05.671741: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:53:05.671899: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:53:05.672198: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:05.672229: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:53:05.672247: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:53:05.672280: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:53:05.672322: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:53:05.672345: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:53:05.672360: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-04 23:53:06.390673: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:53:10.392758: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-04 23:53:10.947364: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-04 23:53:10.947846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-04 23:53:10.948157: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:10.948358: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:10.948534: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:10.948707: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:10.948887: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:10.949092: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:10.949289: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:10.949340: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-04 23:53:10.988248: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-04 23:53:10.988605: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc3a4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-04 23:53:10.988642: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-04 23:53:10.991060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-04 23:53:10.991085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-04 23:53:11.842158: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:53:11.842268: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-04 23:53:11.842539: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-04 23:53:11.842568: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:53:11.842586: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:53:11.842654: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:53:11.842728: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-04 23:53:11.842755: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-04 23:53:11.842792: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc3d7ee64c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 00:02:18.873879: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:02:18.940895: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 00:02:19.077784: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_schonhage3332048/plugins/profile/2021_03_05_00_02_18
2021-03-05 00:02:19.211511: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_schonhage3332048/plugins/profile/2021_03_05_00_02_18/householder.trace.json.gz
2021-03-05 00:02:19.233797: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 00:02:19.243437: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 00:02:19.245581: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_schonhage3332048/plugins/profile/2021_03_05_00_02_18Dumped tool data for overview_page.pb to PAPER_12_threads_schonhage3332048/plugins/profile/2021_03_05_00_02_18/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_schonhage3332048/plugins/profile/2021_03_05_00_02_18/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_schonhage3332048/plugins/profile/2021_03_05_00_02_18/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_schonhage3332048/plugins/profile/2021_03_05_00_02_18/householder.kernel_stats.pb

Time for Epoch:110.77124238014221
Average single batch time this epoch: 3.8196877611094506
Running Average Epoch time: 108.99511170387268

Time for Epoch:108.99511170387268
Average single batch time this epoch: 3.7584438159548004
Running Average Epoch time: 108.785804271698

Time for Epoch:108.57649683952332
Average single batch time this epoch: 3.744009486560164
Running Average Epoch time: 108.76204975446065

Time for Epoch:108.71454071998596
Average single batch time this epoch: 3.748770179419682
Running Average Epoch time: 109.06148195266724

Time for Epoch:109.95977854728699
Average single batch time this epoch: 3.791708132316326
Average time per Batch: 3.7607329035627433
Average time per Epoch: 109.06148195266724
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm schonhage333
num threads 12
total time 549.3058059215546
2021-03-05 00:02:24.039318: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 00:02:24.583560: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 00:02:24.584027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 00:02:24.584298: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:02:24.584472: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:02:24.584638: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:02:24.584801: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:02:24.584968: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:02:24.585129: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:02:24.585291: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:02:24.585344: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 00:02:24.624251: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 00:02:24.624677: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fdeb8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 00:02:24.624715: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 00:02:24.628197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 00:02:24.628234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 00:02:25.475376: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:02:25.475534: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 00:02:25.475845: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:02:25.475878: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:02:25.475899: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:02:25.475934: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:02:25.475978: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:02:25.476001: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:02:25.476016: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fdeed8194c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 00:09:57.817845: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:09:58.141497: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 00:09:58.261286: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2242048/plugins/profile/2021_03_05_00_09_58
2021-03-05 00:09:58.389275: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2242048/plugins/profile/2021_03_05_00_09_58/householder.trace.json.gz
2021-03-05 00:09:58.409043: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 00:09:58.418217: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 00:09:58.420328: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2242048/plugins/profile/2021_03_05_00_09_58Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2242048/plugins/profile/2021_03_05_00_09_58/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2242048/plugins/profile/2021_03_05_00_09_58/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2242048/plugins/profile/2021_03_05_00_09_58/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2242048/plugins/profile/2021_03_05_00_09_58/householder.kernel_stats.pb

Time for Epoch:93.27106928825378
Average single batch time this epoch: 3.2162325135592758
Running Average Epoch time: 90.24164724349976

Time for Epoch:90.24164724349976
Average single batch time this epoch: 3.1117719370743324
Running Average Epoch time: 89.76909625530243

Time for Epoch:89.2965452671051
Average single batch time this epoch: 3.079182945448777
Running Average Epoch time: 89.66620214780171

Time for Epoch:89.4604139328003
Average single batch time this epoch: 3.084834304349176
Running Average Epoch time: 89.76408338546753

Time for Epoch:90.05772709846497
Average single batch time this epoch: 3.1054304879287193
Average time per Batch: 3.095304918700251
Average time per Epoch: 89.76408338546753
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov224
num threads 12
total time 454.573264837265
2021-03-05 00:10:02.631529: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 00:10:03.191392: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 00:10:03.191889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 00:10:03.192217: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:10:03.192430: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:10:03.192643: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:10:03.192825: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:10:03.193010: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:10:03.193210: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:10:03.193391: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:10:03.193442: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 00:10:03.232323: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 00:10:03.232735: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f0108000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 00:10:03.232784: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 00:10:03.236036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 00:10:03.236078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 00:10:04.085597: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:10:04.085704: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 00:10:04.085973: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:10:04.086037: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:10:04.086060: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:10:04.086125: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:10:04.086171: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:10:04.086194: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:10:04.086209: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f013ba554c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 00:17:47.599997: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:17:47.626196: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 00:17:47.746998: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2252048/plugins/profile/2021_03_05_00_17_47
2021-03-05 00:17:47.872052: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2252048/plugins/profile/2021_03_05_00_17_47/householder.trace.json.gz
2021-03-05 00:17:47.893767: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 00:17:47.903146: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 00:17:47.905270: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2252048/plugins/profile/2021_03_05_00_17_47Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2252048/plugins/profile/2021_03_05_00_17_47/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2252048/plugins/profile/2021_03_05_00_17_47/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2252048/plugins/profile/2021_03_05_00_17_47/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2252048/plugins/profile/2021_03_05_00_17_47/householder.kernel_stats.pb

Time for Epoch:94.96603798866272
Average single batch time this epoch: 3.27468204498291
Running Average Epoch time: 92.99913454055786

Time for Epoch:92.99913454055786
Average single batch time this epoch: 3.206859251548504
Running Average Epoch time: 92.54963958263397

Time for Epoch:92.10014462471008
Average single batch time this epoch: 3.1758599034671127
Running Average Epoch time: 92.23642039299011

Time for Epoch:91.60998201370239
Average single batch time this epoch: 3.1589583775092818
Running Average Epoch time: 92.1337149143219

Time for Epoch:91.82559847831726
Average single batch time this epoch: 3.166392499002917
Average time per Batch: 3.1770175078819536
Average time per Epoch: 92.1337149143219
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov225
num threads 12
total time 465.7913134098053
2021-03-05 00:17:52.311211: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 00:17:52.867271: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 00:17:52.867719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 00:17:52.868429: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:17:52.868594: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:17:52.868741: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:17:52.868879: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:17:52.869009: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:17:52.869148: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:17:52.869274: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:17:52.869297: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 00:17:52.908332: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 00:17:52.908841: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc42c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 00:17:52.908928: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 00:17:52.913696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 00:17:52.913736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 00:17:53.767440: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:17:53.767583: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 00:17:53.767886: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:17:53.767918: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:17:53.767937: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:17:53.767971: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:17:53.768014: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:17:53.768039: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:17:53.768075: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc45ef5f4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 00:25:35.734699: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:25:35.772228: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 00:25:35.905675: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2722048/plugins/profile/2021_03_05_00_25_35
2021-03-05 00:25:36.039867: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2722048/plugins/profile/2021_03_05_00_25_35/householder.trace.json.gz
2021-03-05 00:25:36.063147: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 00:25:36.072603: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 00:25:36.074811: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2722048/plugins/profile/2021_03_05_00_25_35Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2722048/plugins/profile/2021_03_05_00_25_35/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2722048/plugins/profile/2021_03_05_00_25_35/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2722048/plugins/profile/2021_03_05_00_25_35/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2722048/plugins/profile/2021_03_05_00_25_35/householder.kernel_stats.pb

Time for Epoch:94.37497639656067
Average single batch time this epoch: 3.2542992378103324
Running Average Epoch time: 91.90014696121216

Time for Epoch:91.90014696121216
Average single batch time this epoch: 3.168963539189306
Running Average Epoch time: 92.33049011230469

Time for Epoch:92.76083326339722
Average single batch time this epoch: 3.1986401656578325
Running Average Epoch time: 92.0340617497762

Time for Epoch:91.44120502471924
Average single batch time this epoch: 3.1531378318523537
Running Average Epoch time: 91.89418429136276

Time for Epoch:91.47455191612244
Average single batch time this epoch: 3.1542875109047723
Average time per Batch: 3.168757261901066
Average time per Epoch: 91.89418429136276
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov272
num threads 12
total time 464.2494270801544
2021-03-05 00:25:40.502086: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 00:25:41.052583: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 00:25:41.053149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 00:25:41.053514: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:25:41.053735: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:25:41.053949: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:25:41.054157: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:25:41.054372: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:25:41.054578: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:25:41.054785: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:25:41.054852: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 00:25:41.096281: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 00:25:41.096709: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5f8c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 00:25:41.096760: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 00:25:41.101388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 00:25:41.101432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 00:25:41.949707: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:25:41.949860: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 00:25:41.950160: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:25:41.950192: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:25:41.950211: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:25:41.950247: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:25:41.950290: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:25:41.950315: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:25:41.950330: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5fc042f4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 00:34:31.228357: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:34:31.364949: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 00:34:31.494126: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3232048/plugins/profile/2021_03_05_00_34_31
2021-03-05 00:34:31.627402: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3232048/plugins/profile/2021_03_05_00_34_31/householder.trace.json.gz
2021-03-05 00:34:31.649714: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 00:34:31.659157: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 00:34:31.661335: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3232048/plugins/profile/2021_03_05_00_34_31Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3232048/plugins/profile/2021_03_05_00_34_31/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3232048/plugins/profile/2021_03_05_00_34_31/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3232048/plugins/profile/2021_03_05_00_34_31/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3232048/plugins/profile/2021_03_05_00_34_31/householder.kernel_stats.pb

Time for Epoch:107.67425656318665
Average single batch time this epoch: 3.712892877644506
Running Average Epoch time: 105.19581532478333

Time for Epoch:105.19581532478333
Average single batch time this epoch: 3.6274310227098137
Running Average Epoch time: 105.50625586509705

Time for Epoch:105.81669640541077
Average single batch time this epoch: 3.648840073881478
Running Average Epoch time: 105.38553849856059

Time for Epoch:105.14410376548767
Average single batch time this epoch: 3.6256484738711654
Running Average Epoch time: 105.39717358350754

Time for Epoch:105.43207883834839
Average single batch time this epoch: 3.6355779664269807
Average time per Batch: 3.6343743842223595
Average time per Epoch: 105.39717358350754
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov323
num threads 12
total time 531.5364236831665
2021-03-05 00:34:36.387709: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 00:34:36.951812: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 00:34:36.952280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 00:34:36.952578: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:34:36.952782: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:34:36.952992: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:34:36.953168: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:34:36.953353: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:34:36.953530: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:34:36.953728: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:34:36.953781: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 00:34:36.992261: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 00:34:36.992634: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6ad4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 00:34:36.992699: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 00:34:36.996195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 00:34:36.996238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 00:34:37.846932: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:34:37.847046: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 00:34:37.847318: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:34:37.847385: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:34:37.847409: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:34:37.847474: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:34:37.847552: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:34:37.847578: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:34:37.847593: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f6b0660e4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 00:43:39.540904: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:43:39.597359: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 00:43:39.726104: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3332048/plugins/profile/2021_03_05_00_43_39
2021-03-05 00:43:39.862766: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3332048/plugins/profile/2021_03_05_00_43_39/householder.trace.json.gz
2021-03-05 00:43:39.885103: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 00:43:39.894639: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 00:43:39.896774: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3332048/plugins/profile/2021_03_05_00_43_39Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3332048/plugins/profile/2021_03_05_00_43_39/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3332048/plugins/profile/2021_03_05_00_43_39/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3332048/plugins/profile/2021_03_05_00_43_39/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3332048/plugins/profile/2021_03_05_00_43_39/householder.kernel_stats.pb

Time for Epoch:110.0866847038269
Average single batch time this epoch: 3.7960832036774734
Running Average Epoch time: 109.35532975196838

Time for Epoch:109.35532975196838
Average single batch time this epoch: 3.7708633274867616
Running Average Epoch time: 108.63380253314972

Time for Epoch:107.91227531433105
Average single batch time this epoch: 3.721104457460601
Running Average Epoch time: 107.90160298347473

Time for Epoch:106.43720388412476
Average single batch time this epoch: 3.670239538981997
Running Average Epoch time: 107.89801865816116

Time for Epoch:107.88726568222046
Average single batch time this epoch: 3.720240149004706
Average time per Batch: 3.7206118682335165
Average time per Epoch: 107.89801865816116
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov333
num threads 12
total time 543.9686448574066
2021-03-05 00:43:44.213565: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 00:43:44.772942: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 00:43:44.773432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 00:43:44.774204: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:43:44.774369: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:43:44.774501: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:43:44.774628: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:43:44.774762: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:43:44.774904: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:43:44.775039: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:43:44.775065: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 00:43:44.808165: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 00:43:44.808588: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff00c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 00:43:44.808638: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 00:43:44.812025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 00:43:44.812068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 00:43:45.677729: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:43:45.677843: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 00:43:45.678632: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:43:45.678666: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:43:45.678698: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:43:45.678768: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:43:45.678822: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:43:45.678847: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:43:45.678882: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7ff03fda04c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 00:52:35.971815: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:52:36.043105: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 00:52:36.174676: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3342048/plugins/profile/2021_03_05_00_52_36
2021-03-05 00:52:36.309893: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3342048/plugins/profile/2021_03_05_00_52_36/householder.trace.json.gz
2021-03-05 00:52:36.333553: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 00:52:36.343320: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 00:52:36.345471: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3342048/plugins/profile/2021_03_05_00_52_36Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3342048/plugins/profile/2021_03_05_00_52_36/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3342048/plugins/profile/2021_03_05_00_52_36/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3342048/plugins/profile/2021_03_05_00_52_36/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3342048/plugins/profile/2021_03_05_00_52_36/householder.kernel_stats.pb

Time for Epoch:107.93733668327332
Average single batch time this epoch: 3.7219603390529237
Running Average Epoch time: 104.82491612434387

Time for Epoch:104.82491612434387
Average single batch time this epoch: 3.614642957161213
Running Average Epoch time: 104.99815821647644

Time for Epoch:105.17140030860901
Average single batch time this epoch: 3.626590342357241
Running Average Epoch time: 105.32948287328084

Time for Epoch:105.99213218688965
Average single batch time this epoch: 3.654892477495917
Running Average Epoch time: 105.58276265859604

Time for Epoch:106.34260201454163
Average single batch time this epoch: 3.666977816614611
Average time per Batch: 3.6407758984072456
Average time per Epoch: 105.58276265859604
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov334
num threads 12
total time 532.5825116634369
2021-03-05 00:52:40.688662: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 00:52:41.239353: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 00:52:41.239827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 00:52:41.240420: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:52:41.240576: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:52:41.240717: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:52:41.240855: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:52:41.241000: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:52:41.241122: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:52:41.241247: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:52:41.241286: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 00:52:41.280234: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 00:52:41.280678: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1c50000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 00:52:41.280746: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 00:52:41.285823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 00:52:41.285867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 00:52:42.138213: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:52:42.138355: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 00:52:42.138671: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:52:42.138700: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:52:42.138718: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:52:42.138753: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:52:42.138800: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:52:42.138825: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:52:42.138840: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f1c82714430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 00:59:50.764295: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:59:50.856882: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 00:59:51.001775: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov4422048/plugins/profile/2021_03_05_00_59_50
2021-03-05 00:59:51.132109: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov4422048/plugins/profile/2021_03_05_00_59_50/householder.trace.json.gz
2021-03-05 00:59:51.152343: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 00:59:51.161775: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 00:59:51.163927: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov4422048/plugins/profile/2021_03_05_00_59_50Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov4422048/plugins/profile/2021_03_05_00_59_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov4422048/plugins/profile/2021_03_05_00_59_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov4422048/plugins/profile/2021_03_05_00_59_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov4422048/plugins/profile/2021_03_05_00_59_50/householder.kernel_stats.pb

Time for Epoch:87.92156982421875
Average single batch time this epoch: 3.0317687906067947
Running Average Epoch time: 86.06203365325928

Time for Epoch:86.06203365325928
Average single batch time this epoch: 2.967648818575103
Running Average Epoch time: 86.03268480300903

Time for Epoch:86.00333595275879
Average single batch time this epoch: 2.965624587289218
Running Average Epoch time: 85.26133855183919

Time for Epoch:83.71864604949951
Average single batch time this epoch: 2.886842727661133
Running Average Epoch time: 85.17234843969345

Time for Epoch:84.90537810325623
Average single batch time this epoch: 2.92776448973294
Average time per Batch: 2.9369701558145986
Average time per Epoch: 85.17234843969345
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov442
num threads 12
total time 430.89213848114014
2021-03-05 00:59:55.475787: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 00:59:56.000281: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 00:59:56.000759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 00:59:56.001432: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:59:56.001589: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:59:56.001732: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:59:56.001855: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:59:56.001985: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:59:56.002108: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:59:56.002232: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:59:56.002256: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 00:59:56.036240: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 00:59:56.036694: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7effe8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 00:59:56.036761: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 00:59:56.041118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 00:59:56.041165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 00:59:56.906806: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:59:56.906941: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 00:59:56.907732: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 00:59:56.907794: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:59:56.907834: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:59:56.907874: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:59:56.907917: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 00:59:56.907942: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 00:59:56.907957: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f001b11e430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 01:07:28.093711: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:07:28.160687: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 01:07:28.319098: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov4442048/plugins/profile/2021_03_05_01_07_28
2021-03-05 01:07:28.445262: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov4442048/plugins/profile/2021_03_05_01_07_28/householder.trace.json.gz
2021-03-05 01:07:28.467531: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 01:07:28.477083: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 01:07:28.479216: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov4442048/plugins/profile/2021_03_05_01_07_28Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov4442048/plugins/profile/2021_03_05_01_07_28/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov4442048/plugins/profile/2021_03_05_01_07_28/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov4442048/plugins/profile/2021_03_05_01_07_28/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov4442048/plugins/profile/2021_03_05_01_07_28/householder.kernel_stats.pb

Time for Epoch:93.09268188476562
Average single batch time this epoch: 3.2100813471037766
Running Average Epoch time: 89.94626951217651

Time for Epoch:89.94626951217651
Average single batch time this epoch: 3.1015874764014937
Running Average Epoch time: 89.52449023723602

Time for Epoch:89.10271096229553
Average single batch time this epoch: 3.0725002782098176
Running Average Epoch time: 89.47201792399089

Time for Epoch:89.36707329750061
Average single batch time this epoch: 3.081616656533603
Running Average Epoch time: 89.51999354362488

Time for Epoch:89.66392040252686
Average single batch time this epoch: 3.0918504123030037
Average time per Batch: 3.0868887058619796
Average time per Epoch: 89.51999354362488
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov444
num threads 12
total time 453.4246015548706
2021-03-05 01:07:32.891972: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 01:07:33.448732: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 01:07:33.449342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 01:07:33.449891: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:07:33.450067: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:07:33.450194: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:07:33.450319: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:07:33.450450: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:07:33.450591: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:07:33.450716: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:07:33.450741: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 01:07:33.488241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 01:07:33.488725: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2a98000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 01:07:33.488806: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 01:07:33.493917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 01:07:33.493960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 01:07:34.344227: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 01:07:34.344384: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 01:07:34.344671: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:07:34.344703: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:07:34.344723: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:07:34.344758: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:07:34.344801: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 01:07:34.344824: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:07:34.344856: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f2aca9b5430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 01:16:21.389241: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:16:21.474889: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 01:16:21.604613: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov5522048/plugins/profile/2021_03_05_01_16_21
2021-03-05 01:16:21.738478: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov5522048/plugins/profile/2021_03_05_01_16_21/householder.trace.json.gz
2021-03-05 01:16:21.760745: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 01:16:21.770592: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 01:16:21.772734: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov5522048/plugins/profile/2021_03_05_01_16_21Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov5522048/plugins/profile/2021_03_05_01_16_21/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov5522048/plugins/profile/2021_03_05_01_16_21/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov5522048/plugins/profile/2021_03_05_01_16_21/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov5522048/plugins/profile/2021_03_05_01_16_21/householder.kernel_stats.pb

Time for Epoch:108.31721878051758
Average single batch time this epoch: 3.7350651806798476
Running Average Epoch time: 104.75301694869995

Time for Epoch:104.75301694869995
Average single batch time this epoch: 3.612162631133507
Running Average Epoch time: 104.90008080005646

Time for Epoch:105.04714465141296
Average single batch time this epoch: 3.62230633045065
Running Average Epoch time: 104.5752507050832

Time for Epoch:103.92559051513672
Average single batch time this epoch: 3.5836333241955987
Running Average Epoch time: 104.67819803953171

Time for Epoch:104.9870400428772
Average single batch time this epoch: 3.6202348511794518
Average time per Batch: 3.609584284239802
Average time per Epoch: 104.67819803953171
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov552
num threads 12
total time 529.304701089859
2021-03-05 01:16:26.134728: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 01:16:26.691756: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 01:16:26.692450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 01:16:26.692962: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:16:26.693114: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:16:26.693247: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:16:26.693375: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:16:26.693506: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:16:26.693630: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:16:26.693760: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:16:26.693799: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 01:16:26.732319: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 01:16:26.732784: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe9e8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 01:16:26.732823: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 01:16:26.736720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 01:16:26.736761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 01:16:27.587198: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 01:16:27.587361: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 01:16:27.587656: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:16:27.587688: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:16:27.587708: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:16:27.587745: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:16:27.587807: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 01:16:27.587836: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:16:27.587851: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fea1ba9e430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 01:26:00.632013: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:26:00.768564: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 01:26:00.897256: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov5552048/plugins/profile/2021_03_05_01_26_00
2021-03-05 01:26:01.030478: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov5552048/plugins/profile/2021_03_05_01_26_00/householder.trace.json.gz
2021-03-05 01:26:01.052927: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 01:26:01.062426: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 01:26:01.064696: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov5552048/plugins/profile/2021_03_05_01_26_00Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov5552048/plugins/profile/2021_03_05_01_26_00/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov5552048/plugins/profile/2021_03_05_01_26_00/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov5552048/plugins/profile/2021_03_05_01_26_00/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov5552048/plugins/profile/2021_03_05_01_26_00/householder.kernel_stats.pb

Time for Epoch:117.29920482635498
Average single batch time this epoch: 4.044788327710382
Running Average Epoch time: 114.31240057945251

Time for Epoch:114.31240057945251
Average single batch time this epoch: 3.9417974208963327
Running Average Epoch time: 113.94238793849945

Time for Epoch:113.57237529754639
Average single batch time this epoch: 3.9162787897833464
Running Average Epoch time: 114.06480757395427

Time for Epoch:114.30964684486389
Average single batch time this epoch: 3.941702226112629
Running Average Epoch time: 113.93230056762695

Time for Epoch:113.53477954864502
Average single batch time this epoch: 3.9149813898678483
Average time per Batch: 3.928689956665039
Average time per Epoch: 113.93230056762695
batch size 2048
epochs 5
nodes 2048
num layers 4
algorithm smirnov555
num threads 12
total time 575.2949132919312
2021-03-05 01:26:05.750432: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 01:26:06.291459: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 01:26:06.291931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 01:26:06.292225: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:26:06.292413: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:26:06.292647: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:26:06.292840: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:26:06.293030: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:26:06.293197: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:26:06.293368: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:26:06.293399: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 01:26:06.332358: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 01:26:06.332787: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8910000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 01:26:06.332836: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 01:26:06.337469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 01:26:06.337512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 01:26:09.478155: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 01:26:09.478299: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 01:26:09.478578: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:26:09.478629: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:26:09.478650: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:26:09.478685: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:26:09.478729: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 01:26:09.478753: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:26:09.478769: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8943cc84c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 01:46:27.738142: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:46:27.867357: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 01:46:27.929886: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_bini3224096/plugins/profile/2021_03_05_01_46_27
2021-03-05 01:46:27.994448: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_bini3224096/plugins/profile/2021_03_05_01_46_27/householder.trace.json.gz
2021-03-05 01:46:28.002911: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 01:46:28.007513: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 01:46:28.009568: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_bini3224096/plugins/profile/2021_03_05_01_46_27Dumped tool data for overview_page.pb to PAPER_12_threads_bini3224096/plugins/profile/2021_03_05_01_46_27/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_bini3224096/plugins/profile/2021_03_05_01_46_27/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_bini3224096/plugins/profile/2021_03_05_01_46_27/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_bini3224096/plugins/profile/2021_03_05_01_46_27/householder.kernel_stats.pb

Time for Epoch:255.61283612251282
Average single batch time this epoch: 18.258038537842886
Running Average Epoch time: 248.75739288330078

Time for Epoch:248.75739288330078
Average single batch time this epoch: 17.768364991460526
Running Average Epoch time: 246.56504690647125

Time for Epoch:244.37270092964172
Average single batch time this epoch: 17.455172726086207
Running Average Epoch time: 242.78717239697775

Time for Epoch:235.23142337799072
Average single batch time this epoch: 16.80222409112113
Running Average Epoch time: 240.65785211324692

Time for Epoch:234.26989126205444
Average single batch time this epoch: 16.73354252747127
Average time per Batch: 17.189826084034785
Average time per Epoch: 240.65785211324692
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm bini322
num threads 12
total time 1222.8146533966064
2021-03-05 01:46:32.304801: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 01:46:32.839975: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 01:46:32.840614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 01:46:32.841115: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:46:32.841279: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:46:32.841404: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:46:32.841530: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:46:32.841657: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:46:32.841801: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:46:32.841927: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:46:32.841951: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 01:46:32.876192: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 01:46:32.876533: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc5b8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 01:46:32.876583: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 01:46:32.880095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 01:46:32.880137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 01:46:36.070683: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 01:46:36.070881: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 01:46:36.071725: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 01:46:36.071757: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:46:36.071808: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:46:36.071861: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:46:36.071916: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 01:46:36.071940: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 01:46:36.071971: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc5eb982430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 02:04:44.152601: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:04:44.263866: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 02:04:44.330628: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_dgemm4096/plugins/profile/2021_03_05_02_04_44
2021-03-05 02:04:44.399300: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_dgemm4096/plugins/profile/2021_03_05_02_04_44/householder.trace.json.gz
2021-03-05 02:04:44.408910: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 02:04:44.413609: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 02:04:44.415589: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_dgemm4096/plugins/profile/2021_03_05_02_04_44Dumped tool data for overview_page.pb to PAPER_12_threads_dgemm4096/plugins/profile/2021_03_05_02_04_44/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_dgemm4096/plugins/profile/2021_03_05_02_04_44/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_dgemm4096/plugins/profile/2021_03_05_02_04_44/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_dgemm4096/plugins/profile/2021_03_05_02_04_44/householder.kernel_stats.pb

Time for Epoch:219.65842199325562
Average single batch time this epoch: 15.689866883414131
Running Average Epoch time: 219.70355606079102

Time for Epoch:219.70355606079102
Average single batch time this epoch: 15.693089502198356
Running Average Epoch time: 215.1593532562256

Time for Epoch:210.61515045166016
Average single batch time this epoch: 15.043919665472847
Running Average Epoch time: 216.88842233022055

Time for Epoch:220.34656047821045
Average single batch time this epoch: 15.73901881490435
Running Average Epoch time: 217.102155148983

Time for Epoch:217.74335360527039
Average single batch time this epoch: 15.553074462073189
Average time per Batch: 15.507275611162186
Average time per Epoch: 217.102155148983
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm dgemm
num threads 12
total time 1092.6484506130219
2021-03-05 02:04:48.621464: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 02:04:49.167266: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 02:04:49.167702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 02:04:49.168374: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:49.168523: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:49.168647: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:49.168772: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:49.168897: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:49.169035: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:49.169160: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:49.169214: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 02:04:49.204310: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 02:04:49.204673: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f19f4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 02:04:49.204742: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 02:04:49.208747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 02:04:49.208791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 02:04:52.365619: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 02:04:52.365742: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 02:04:52.366517: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:52.366561: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:04:52.366584: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:04:52.366649: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:04:52.366694: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 02:04:52.366718: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:04:52.366733: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-05 02:04:53.179819: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:04:57.165805: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 02:04:57.723243: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 02:04:57.723664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 02:04:57.723921: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:57.724112: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:57.724273: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:57.724460: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:57.724625: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:57.724806: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:57.724966: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:04:57.724996: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 02:04:57.760294: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 02:04:57.760641: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1cb8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 02:04:57.760679: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 02:04:57.763125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 02:04:57.763150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 02:05:00.940456: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 02:05:00.940578: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 02:05:00.941413: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:05:00.941478: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:05:00.941504: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:05:00.941577: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:05:00.941645: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 02:05:00.941671: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:05:00.941687: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f1cea6de4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 02:25:35.298863: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:25:35.440859: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 02:25:35.507211: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_schonhage3334096/plugins/profile/2021_03_05_02_25_35
2021-03-05 02:25:35.574219: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_schonhage3334096/plugins/profile/2021_03_05_02_25_35/householder.trace.json.gz
2021-03-05 02:25:35.583476: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 02:25:35.588415: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 02:25:35.590406: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_schonhage3334096/plugins/profile/2021_03_05_02_25_35Dumped tool data for overview_page.pb to PAPER_12_threads_schonhage3334096/plugins/profile/2021_03_05_02_25_35/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_schonhage3334096/plugins/profile/2021_03_05_02_25_35/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_schonhage3334096/plugins/profile/2021_03_05_02_25_35/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_schonhage3334096/plugins/profile/2021_03_05_02_25_35/householder.kernel_stats.pb

Time for Epoch:253.7354121208191
Average single batch time this epoch: 18.123938696725027
Running Average Epoch time: 246.45102286338806

Time for Epoch:246.45102286338806
Average single batch time this epoch: 17.603628822735377
Running Average Epoch time: 247.1875822544098

Time for Epoch:247.92414164543152
Average single batch time this epoch: 17.708850417818343
Running Average Epoch time: 246.5451991558075

Time for Epoch:245.2604329586029
Average single batch time this epoch: 17.518581049782888
Running Average Epoch time: 245.1520870923996

Time for Epoch:240.9727509021759
Average single batch time this epoch: 17.212323359080724
Average time per Batch: 17.510845912354334
Average time per Epoch: 245.1520870923996
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm schonhage333
num threads 12
total time 1238.959177494049
2021-03-05 02:25:39.941152: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 02:25:40.467603: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 02:25:40.468262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 02:25:40.468971: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:25:40.469125: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:25:40.469251: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:25:40.469375: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:25:40.469505: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:25:40.469646: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:25:40.469770: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:25:40.469795: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 02:25:40.504364: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 02:25:40.504792: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f74f0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 02:25:40.504854: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 02:25:40.508835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 02:25:40.508878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 02:25:43.701165: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 02:25:43.701352: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 02:25:43.702202: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:25:43.702237: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:25:43.702271: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:25:43.702319: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:25:43.702369: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 02:25:43.702394: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:25:43.702409: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f752318e430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 02:44:14.723553: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:44:14.847059: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 02:44:14.917018: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2244096/plugins/profile/2021_03_05_02_44_14
2021-03-05 02:44:14.986330: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2244096/plugins/profile/2021_03_05_02_44_14/householder.trace.json.gz
2021-03-05 02:44:14.996006: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 02:44:15.000873: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 02:44:15.002880: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2244096/plugins/profile/2021_03_05_02_44_14Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2244096/plugins/profile/2021_03_05_02_44_14/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2244096/plugins/profile/2021_03_05_02_44_14/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2244096/plugins/profile/2021_03_05_02_44_14/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2244096/plugins/profile/2021_03_05_02_44_14/householder.kernel_stats.pb

Time for Epoch:230.0695025920868
Average single batch time this epoch: 16.433516127722605
Running Average Epoch time: 220.34744143486023

Time for Epoch:220.34744143486023
Average single batch time this epoch: 15.739087428365435
Running Average Epoch time: 222.53225100040436

Time for Epoch:224.7170605659485
Average single batch time this epoch: 16.051204698426382
Running Average Epoch time: 221.83670949935913

Time for Epoch:220.44562649726868
Average single batch time this epoch: 15.746100766318184
Running Average Epoch time: 220.23443764448166

Time for Epoch:215.42762207984924
Average single batch time this epoch: 15.387675285339355
Average time per Batch: 15.73101704461234
Average time per Epoch: 220.23443764448166
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov224
num threads 12
total time 1115.5918295383453
2021-03-05 02:44:19.266840: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 02:44:19.795731: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 02:44:19.796267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 02:44:19.796894: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:44:19.797039: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:44:19.797188: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:44:19.797326: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:44:19.797455: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:44:19.797578: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:44:19.797704: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:44:19.797728: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 02:44:19.836294: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 02:44:19.836814: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f4cc8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 02:44:19.836911: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 02:44:19.842407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 02:44:19.842456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 02:44:22.987269: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 02:44:22.987411: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 02:44:22.987691: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 02:44:22.987720: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:44:22.987739: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:44:22.987788: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:44:22.987837: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 02:44:22.987861: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 02:44:22.987877: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4cfabee4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 03:03:54.947560: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:03:55.072025: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 03:03:55.138179: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2254096/plugins/profile/2021_03_05_03_03_55
2021-03-05 03:03:55.206578: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2254096/plugins/profile/2021_03_05_03_03_55/householder.trace.json.gz
2021-03-05 03:03:55.216043: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 03:03:55.220827: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 03:03:55.222865: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2254096/plugins/profile/2021_03_05_03_03_55Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2254096/plugins/profile/2021_03_05_03_03_55/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2254096/plugins/profile/2021_03_05_03_03_55/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2254096/plugins/profile/2021_03_05_03_03_55/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2254096/plugins/profile/2021_03_05_03_03_55/householder.kernel_stats.pb

Time for Epoch:246.43379998207092
Average single batch time this epoch: 17.602392043386185
Running Average Epoch time: 234.63504910469055

Time for Epoch:234.63504910469055
Average single batch time this epoch: 16.75962802342006
Running Average Epoch time: 233.4091637134552

Time for Epoch:232.18327832221985
Average single batch time this epoch: 16.584500551223755
Running Average Epoch time: 232.46901218096414

Time for Epoch:230.58870911598206
Average single batch time this epoch: 16.470607451030187
Running Average Epoch time: 231.37809431552887

Time for Epoch:228.10534071922302
Average single batch time this epoch: 16.293221354484558
Average time per Batch: 16.52698934503964
Average time per Epoch: 231.37809431552887
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov225
num threads 12
total time 1176.5084190368652
2021-03-05 03:03:59.513111: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 03:04:00.039579: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 03:04:00.040357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 03:04:00.040778: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:04:00.040928: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:04:00.041072: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:04:00.041198: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:04:00.041329: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:04:00.041452: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:04:00.041577: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:04:00.041601: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 03:04:00.080301: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 03:04:00.080809: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f544c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 03:04:00.080894: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 03:04:00.086356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 03:04:00.086406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 03:04:03.234429: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 03:04:03.234584: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 03:04:03.234872: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:04:03.234921: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:04:03.234941: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:04:03.234977: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:04:03.235021: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 03:04:03.235044: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:04:03.235059: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5481d584c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 03:27:20.617194: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:27:20.726445: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 03:27:20.793805: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2724096/plugins/profile/2021_03_05_03_27_20
2021-03-05 03:27:20.858724: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2724096/plugins/profile/2021_03_05_03_27_20/householder.trace.json.gz
2021-03-05 03:27:20.867610: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 03:27:20.872370: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 03:27:20.874388: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2724096/plugins/profile/2021_03_05_03_27_20Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2724096/plugins/profile/2021_03_05_03_27_20/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2724096/plugins/profile/2021_03_05_03_27_20/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2724096/plugins/profile/2021_03_05_03_27_20/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2724096/plugins/profile/2021_03_05_03_27_20/householder.kernel_stats.pb

Time for Epoch:288.06773114204407
Average single batch time this epoch: 20.57623861517225
Running Average Epoch time: 276.4764840602875

Time for Epoch:276.4764840602875
Average single batch time this epoch: 19.74829420021602
Running Average Epoch time: 275.6914829015732

Time for Epoch:274.9064817428589
Average single batch time this epoch: 19.636150888034276
Running Average Epoch time: 276.84960039456683

Time for Epoch:279.1658353805542
Average single batch time this epoch: 19.94038779394967
Running Average Epoch time: 277.3243764638901

Time for Epoch:278.74870467185974
Average single batch time this epoch: 19.910595553261892
Average time per Batch: 19.808857108865467
Average time per Epoch: 277.3243764638901
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov272
num threads 12
total time 1401.9132692813873
2021-03-05 03:27:25.191529: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 03:27:25.759338: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 03:27:25.759808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 03:27:25.760434: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:27:25.760571: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:27:25.760714: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:27:25.760852: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:27:25.760984: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:27:25.761124: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:27:25.761251: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:27:25.761275: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 03:27:25.800301: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 03:27:25.800708: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f54b8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 03:27:25.800749: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 03:27:25.804697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 03:27:25.804737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 03:27:28.958660: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 03:27:28.958803: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 03:27:28.959085: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:27:28.959115: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:27:28.959133: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:27:28.959167: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:27:28.959225: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 03:27:28.959251: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:27:28.959266: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f54ea99d4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 03:45:44.029270: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:45:44.133082: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 03:45:44.193811: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3234096/plugins/profile/2021_03_05_03_45_44
2021-03-05 03:45:44.257900: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3234096/plugins/profile/2021_03_05_03_45_44/householder.trace.json.gz
2021-03-05 03:45:44.266283: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 03:45:44.270864: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 03:45:44.272890: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3234096/plugins/profile/2021_03_05_03_45_44Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3234096/plugins/profile/2021_03_05_03_45_44/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3234096/plugins/profile/2021_03_05_03_45_44/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3234096/plugins/profile/2021_03_05_03_45_44/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3234096/plugins/profile/2021_03_05_03_45_44/householder.kernel_stats.pb

Time for Epoch:224.31821703910828
Average single batch time this epoch: 16.022716658455984
Running Average Epoch time: 218.4629771709442

Time for Epoch:218.4629771709442
Average single batch time this epoch: 15.604486686842781
Running Average Epoch time: 217.3584579229355

Time for Epoch:216.25393867492676
Average single batch time this epoch: 15.446698835917882
Running Average Epoch time: 217.39826925595602

Time for Epoch:217.47789192199707
Average single batch time this epoch: 15.534123318535942
Running Average Epoch time: 217.68437176942825

Time for Epoch:218.54267930984497
Average single batch time this epoch: 15.610176512173243
Average time per Batch: 15.548871338367462
Average time per Epoch: 217.68437176942825
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov323
num threads 12
total time 1099.6660363674164
2021-03-05 03:45:48.576423: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 03:45:49.128178: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 03:45:49.128723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 03:45:49.129387: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:45:49.129554: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:45:49.129694: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:45:49.129831: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:45:49.129981: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:45:49.130117: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:45:49.130250: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:45:49.130275: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 03:45:49.168360: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 03:45:49.168756: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5c24000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 03:45:49.168796: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 03:45:49.172478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 03:45:49.172519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 03:45:52.314131: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 03:45:52.314286: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 03:45:52.314589: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 03:45:52.314620: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:45:52.314640: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:45:52.314675: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:45:52.314718: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 03:45:52.314742: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 03:45:52.314757: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f5c5946f4c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 04:05:27.560028: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:05:27.677402: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 04:05:27.740065: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3334096/plugins/profile/2021_03_05_04_05_27
2021-03-05 04:05:27.804883: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3334096/plugins/profile/2021_03_05_04_05_27/householder.trace.json.gz
2021-03-05 04:05:27.813431: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 04:05:27.818097: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 04:05:27.820043: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3334096/plugins/profile/2021_03_05_04_05_27Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3334096/plugins/profile/2021_03_05_04_05_27/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3334096/plugins/profile/2021_03_05_04_05_27/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3334096/plugins/profile/2021_03_05_04_05_27/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3334096/plugins/profile/2021_03_05_04_05_27/householder.kernel_stats.pb

Time for Epoch:240.24533009529114
Average single batch time this epoch: 17.160362107413157
Running Average Epoch time: 233.0727026462555

Time for Epoch:233.0727026462555
Average single batch time this epoch: 16.648033925465175
Running Average Epoch time: 233.48177528381348

Time for Epoch:233.89084792137146
Average single batch time this epoch: 16.706474236079625
Running Average Epoch time: 233.3591432571411

Time for Epoch:233.1138792037964
Average single batch time this epoch: 16.65097459724971
Running Average Epoch time: 233.746402323246

Time for Epoch:234.90817952156067
Average single batch time this epoch: 16.77913965497698
Average time per Batch: 16.696155603442875
Average time per Epoch: 233.746402323246
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov333
num threads 12
total time 1179.791928768158
2021-03-05 04:05:32.091035: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 04:05:32.652230: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 04:05:32.652712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 04:05:32.653487: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:05:32.653650: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:05:32.653802: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:05:32.653931: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:05:32.654064: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:05:32.654192: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:05:32.654319: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:05:32.654344: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 04:05:32.688380: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 04:05:32.688845: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa3e8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 04:05:32.688909: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 04:05:32.692941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 04:05:32.692983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 04:05:35.843060: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 04:05:35.843213: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 04:05:35.843516: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:05:35.843566: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:05:35.843585: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:05:35.843620: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:05:35.843680: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 04:05:35.843706: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:05:35.843722: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fa41b1c74c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 04:23:54.540237: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:23:54.572357: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 04:23:54.638037: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3344096/plugins/profile/2021_03_05_04_23_54
2021-03-05 04:23:54.706815: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3344096/plugins/profile/2021_03_05_04_23_54/householder.trace.json.gz
2021-03-05 04:23:54.716482: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 04:23:54.721225: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 04:23:54.723262: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3344096/plugins/profile/2021_03_05_04_23_54Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3344096/plugins/profile/2021_03_05_04_23_54/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3344096/plugins/profile/2021_03_05_04_23_54/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3344096/plugins/profile/2021_03_05_04_23_54/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3344096/plugins/profile/2021_03_05_04_23_54/householder.kernel_stats.pb

Time for Epoch:223.7089602947235
Average single batch time this epoch: 15.97919351713998
Running Average Epoch time: 214.52655863761902

Time for Epoch:214.52655863761902
Average single batch time this epoch: 15.323311277798243
Running Average Epoch time: 216.38839769363403

Time for Epoch:218.25023674964905
Average single batch time this epoch: 15.589286003793989
Running Average Epoch time: 217.43080457051596

Time for Epoch:219.51561832427979
Average single batch time this epoch: 15.67966890335083
Running Average Epoch time: 218.74322146177292

Time for Epoch:222.68047213554382
Average single batch time this epoch: 15.90572725023542
Average time per Batch: 15.624498358794622
Average time per Epoch: 218.74322146177292
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov334
num threads 12
total time 1103.268869638443
2021-03-05 04:23:59.114009: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 04:23:59.671914: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 04:23:59.672445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 04:23:59.673026: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:23:59.673164: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:23:59.673288: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:23:59.673410: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:23:59.673543: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:23:59.673686: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:23:59.673836: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:23:59.673860: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 04:23:59.708370: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 04:23:59.708760: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2394000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 04:23:59.708809: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 04:23:59.712035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 04:23:59.712076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 04:24:02.898216: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 04:24:02.898349: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 04:24:02.899148: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:24:02.899177: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:24:02.899195: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:24:02.899261: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:24:02.899328: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 04:24:02.899355: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:24:02.899370: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f23c97534c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 04:41:39.100127: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:41:39.222000: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 04:41:39.288221: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov4424096/plugins/profile/2021_03_05_04_41_39
2021-03-05 04:41:39.355698: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov4424096/plugins/profile/2021_03_05_04_41_39/householder.trace.json.gz
2021-03-05 04:41:39.364912: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 04:41:39.369693: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 04:41:39.371690: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov4424096/plugins/profile/2021_03_05_04_41_39Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov4424096/plugins/profile/2021_03_05_04_41_39/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov4424096/plugins/profile/2021_03_05_04_41_39/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov4424096/plugins/profile/2021_03_05_04_41_39/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov4424096/plugins/profile/2021_03_05_04_41_39/householder.kernel_stats.pb

Time for Epoch:224.28634023666382
Average single batch time this epoch: 16.020431348255702
Running Average Epoch time: 211.02065300941467

Time for Epoch:211.02065300941467
Average single batch time this epoch: 15.0728851045881
Running Average Epoch time: 210.56324124336243

Time for Epoch:210.10582947731018
Average single batch time this epoch: 15.007542150361198
Running Average Epoch time: 210.2789298693339

Time for Epoch:209.71030712127686
Average single batch time this epoch: 14.979289054870605
Running Average Epoch time: 207.9754187464714

Time for Epoch:201.0648853778839
Average single batch time this epoch: 14.36176676409585
Average time per Batch: 14.855370768478938
Average time per Epoch: 207.9754187464714
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov442
num threads 12
total time 1060.804672718048
2021-03-05 04:41:43.659657: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 04:41:44.192882: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 04:41:44.193382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 04:41:44.193923: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:41:44.194083: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:41:44.194227: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:41:44.194366: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:41:44.194493: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:41:44.194614: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:41:44.194741: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:41:44.194764: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 04:41:44.232280: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 04:41:44.232743: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc67c000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 04:41:44.232802: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 04:41:44.237906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 04:41:44.237950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 04:41:47.390743: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 04:41:47.390889: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 04:41:47.391191: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 04:41:47.391221: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:41:47.391240: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:41:47.391274: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:41:47.391315: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 04:41:47.391338: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:41:47.391353: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc6b17984c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 04:59:56.563051: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 04:59:56.688328: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 04:59:56.750870: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov4444096/plugins/profile/2021_03_05_04_59_56
2021-03-05 04:59:56.815984: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov4444096/plugins/profile/2021_03_05_04_59_56/householder.trace.json.gz
2021-03-05 04:59:56.824628: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 04:59:56.829259: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 04:59:56.831262: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov4444096/plugins/profile/2021_03_05_04_59_56Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov4444096/plugins/profile/2021_03_05_04_59_56/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov4444096/plugins/profile/2021_03_05_04_59_56/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov4444096/plugins/profile/2021_03_05_04_59_56/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov4444096/plugins/profile/2021_03_05_04_59_56/householder.kernel_stats.pb

Time for Epoch:220.18813514709473
Average single batch time this epoch: 15.727704082216535
Running Average Epoch time: 213.96690583229065

Time for Epoch:213.96690583229065
Average single batch time this epoch: 15.2833343233381
Running Average Epoch time: 216.76533675193787

Time for Epoch:219.56376767158508
Average single batch time this epoch: 15.683109862463814
Running Average Epoch time: 216.67059548695883

Time for Epoch:216.48111295700073
Average single batch time this epoch: 15.462920308113098
Running Average Epoch time: 217.2422171831131

Time for Epoch:218.95708227157593
Average single batch time this epoch: 15.639773539134435
Average time per Batch: 15.51728450826236
Average time per Epoch: 217.2422171831131
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov444
num threads 12
total time 1093.7320280075073
2021-03-05 05:00:01.146962: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 05:00:01.671902: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 05:00:01.672507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 05:00:01.673108: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:00:01.673268: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:00:01.673411: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:00:01.673536: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:00:01.673668: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:00:01.673791: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:00:01.673917: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:00:01.673942: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 05:00:01.708288: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 05:00:01.708747: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6b20000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 05:00:01.708814: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 05:00:01.713121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 05:00:01.713167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 05:00:04.858243: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 05:00:04.858521: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 05:00:04.858916: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:00:04.858992: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:00:04.859026: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:00:04.859134: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:00:04.859234: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 05:00:04.859274: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:00:04.859299: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f6b536b8430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 05:17:44.434090: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:17:44.572383: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 05:17:44.634663: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov5524096/plugins/profile/2021_03_05_05_17_44
2021-03-05 05:17:44.699352: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov5524096/plugins/profile/2021_03_05_05_17_44/householder.trace.json.gz
2021-03-05 05:17:44.707968: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 05:17:44.712588: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 05:17:44.714568: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov5524096/plugins/profile/2021_03_05_05_17_44Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov5524096/plugins/profile/2021_03_05_05_17_44/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov5524096/plugins/profile/2021_03_05_05_17_44/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov5524096/plugins/profile/2021_03_05_05_17_44/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov5524096/plugins/profile/2021_03_05_05_17_44/householder.kernel_stats.pb

Time for Epoch:217.25707983970642
Average single batch time this epoch: 15.518341081483024
Running Average Epoch time: 213.2882809638977

Time for Epoch:213.2882809638977
Average single batch time this epoch: 15.234857405935015
Running Average Epoch time: 211.01886439323425

Time for Epoch:208.7494478225708
Average single batch time this epoch: 14.910655651773725
Running Average Epoch time: 211.10368665059408

Time for Epoch:211.27333116531372
Average single batch time this epoch: 15.090934566089086
Running Average Epoch time: 210.57550144195557

Time for Epoch:208.99094581604004
Average single batch time this epoch: 14.927904282297407
Average time per Batch: 15.041087976523809
Average time per Epoch: 210.57550144195557
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov552
num threads 12
total time 1064.0861043930054
2021-03-05 05:17:48.997460: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 05:17:49.524636: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 05:17:49.525231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 05:17:49.525724: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:17:49.525879: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:17:49.526007: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:17:49.526131: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:17:49.526261: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:17:49.526397: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:17:49.526522: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:17:49.526546: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 05:17:49.564205: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 05:17:49.564665: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fd7cc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 05:17:49.564722: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 05:17:49.569783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 05:17:49.569830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 05:17:52.719734: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 05:17:52.719901: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 05:17:52.720187: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:17:52.720219: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:17:52.720238: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:17:52.720275: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:17:52.720317: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 05:17:52.720340: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:17:52.720355: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fd7ff7c84c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 05:35:49.662957: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:35:49.778058: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 05:35:49.845254: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov5554096/plugins/profile/2021_03_05_05_35_49
2021-03-05 05:35:49.914139: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov5554096/plugins/profile/2021_03_05_05_35_49/householder.trace.json.gz
2021-03-05 05:35:49.923592: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 05:35:49.928413: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 05:35:49.930434: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov5554096/plugins/profile/2021_03_05_05_35_49Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov5554096/plugins/profile/2021_03_05_05_35_49/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov5554096/plugins/profile/2021_03_05_05_35_49/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov5554096/plugins/profile/2021_03_05_05_35_49/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov5554096/plugins/profile/2021_03_05_05_35_49/householder.kernel_stats.pb

Time for Epoch:220.54130792617798
Average single batch time this epoch: 15.75292946611132
Running Average Epoch time: 216.97364163398743

Time for Epoch:216.97364163398743
Average single batch time this epoch: 15.498096432004656
Running Average Epoch time: 216.58785915374756

Time for Epoch:216.2020766735077
Average single batch time this epoch: 15.442987646375384
Running Average Epoch time: 215.33234357833862

Time for Epoch:212.82131242752075
Average single batch time this epoch: 15.20150455406734
Running Average Epoch time: 214.09650272130966

Time for Epoch:210.38898015022278
Average single batch time this epoch: 15.027770280838013
Average time per Batch: 15.292589728321348
Average time per Epoch: 214.09650272130966
batch size 4096
epochs 5
nodes 4096
num layers 4
algorithm smirnov555
num threads 12
total time 1081.4749829769135
2021-03-05 05:35:54.232877: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 05:35:54.787547: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 05:35:54.788274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 05:35:54.788716: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:35:54.788872: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:35:54.789004: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:35:54.789137: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:35:54.789263: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:35:54.789389: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:35:54.789517: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:35:54.789541: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 05:35:54.828051: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 05:35:54.828314: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fde48000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 05:35:54.828351: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 05:35:54.831701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 05:35:54.831732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 05:36:07.080223: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 05:36:07.080426: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 05:36:07.081270: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 05:36:07.081306: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:36:07.081328: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:36:07.081375: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:36:07.081429: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 05:36:07.081453: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 05:36:07.081468: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fde7cb09430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 06:36:50.653876: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 06:36:50.661908: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 06:36:50.697058: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_bini3228192/plugins/profile/2021_03_05_06_36_50
2021-03-05 06:36:50.731823: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_bini3228192/plugins/profile/2021_03_05_06_36_50/householder.trace.json.gz
2021-03-05 06:36:50.736077: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 06:36:50.738679: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 06:36:50.740578: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_bini3228192/plugins/profile/2021_03_05_06_36_50Dumped tool data for overview_page.pb to PAPER_12_threads_bini3228192/plugins/profile/2021_03_05_06_36_50/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_bini3228192/plugins/profile/2021_03_05_06_36_50/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_bini3228192/plugins/profile/2021_03_05_06_36_50/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_bini3228192/plugins/profile/2021_03_05_06_36_50/householder.kernel_stats.pb

Time for Epoch:835.9583351612091
Average single batch time this epoch: 119.42259185654777
Running Average Epoch time: 743.4158055782318

Time for Epoch:743.4158055782318
Average single batch time this epoch: 106.20223157746452
Running Average Epoch time: 715.915562748909

Time for Epoch:688.4153199195862
Average single batch time this epoch: 98.34501896585736
Running Average Epoch time: 707.2325212955475

Time for Epoch:689.8664383888245
Average single batch time this epoch: 98.55232279641288
Running Average Epoch time: 701.8994881510735

Time for Epoch:685.9003887176514
Average single batch time this epoch: 97.98574338640485
Average time per Batch: 100.27132918153491
Average time per Epoch: 701.8994881510735
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm bini322
num threads 12
total time 3657.2304499149323
2021-03-05 06:36:55.103649: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 06:36:55.651980: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 06:36:55.652580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 06:36:55.653224: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 06:36:55.653391: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 06:36:55.653537: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 06:36:55.653666: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 06:36:55.653792: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 06:36:55.653914: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 06:36:55.654040: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 06:36:55.654065: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 06:36:55.688262: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 06:36:55.688687: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7efbc0000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 06:36:55.688754: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 06:36:55.693017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 06:36:55.693059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 06:37:07.958892: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 06:37:07.959098: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 06:37:07.959954: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 06:37:07.960007: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 06:37:07.960042: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 06:37:07.960090: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 06:37:07.960141: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 06:37:07.960166: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 06:37:07.960181: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7efbf562f430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 07:24:55.903733: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 07:24:55.911181: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 07:24:55.948791: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_dgemm8192/plugins/profile/2021_03_05_07_24_55
2021-03-05 07:24:55.985227: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_dgemm8192/plugins/profile/2021_03_05_07_24_55/householder.trace.json.gz
2021-03-05 07:24:55.989966: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 07:24:55.992697: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 07:24:55.994585: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_dgemm8192/plugins/profile/2021_03_05_07_24_55Dumped tool data for overview_page.pb to PAPER_12_threads_dgemm8192/plugins/profile/2021_03_05_07_24_55/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_dgemm8192/plugins/profile/2021_03_05_07_24_55/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_dgemm8192/plugins/profile/2021_03_05_07_24_55/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_dgemm8192/plugins/profile/2021_03_05_07_24_55/householder.kernel_stats.pb

Time for Epoch:579.609949350357
Average single batch time this epoch: 82.80139313425336
Running Average Epoch time: 571.3359773159027

Time for Epoch:571.3359773159027
Average single batch time this epoch: 81.61939655031476
Running Average Epoch time: 573.380704164505

Time for Epoch:575.4254310131073
Average single batch time this epoch: 82.2036052090781
Running Average Epoch time: 572.9246050516764

Time for Epoch:572.0124068260193
Average single batch time this epoch: 81.71602787290301
Running Average Epoch time: 572.0779291987419

Time for Epoch:569.5379016399384
Average single batch time this epoch: 81.36253115109035
Average time per Batch: 81.72539019584656
Average time per Epoch: 572.0779291987419
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm dgemm
num threads 12
total time 2881.603268146515
2021-03-05 07:25:00.405832: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 07:25:00.968544: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 07:25:00.969018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 07:25:00.969619: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:00.969767: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:00.969912: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:00.970060: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:00.970200: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:00.970340: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:00.970466: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:00.970489: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 07:25:01.008337: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 07:25:01.008733: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc238000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 07:25:01.008770: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 07:25:01.012236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 07:25:01.012273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 07:25:13.118255: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 07:25:13.118402: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 07:25:13.119197: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:13.119226: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 07:25:13.119243: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 07:25:13.119277: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 07:25:13.119329: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 07:25:13.119354: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 07:25:13.119369: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

MKL num threads default:  12
MKL num threads set to:  1
Traceback (most recent call last):
  File "tensorboard_test.py", line 189, in <module>
    train_step(x_train[batch * batch_size:(batch + 1) * batch_size],
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 505, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2657, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/weisja15/miniconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    tensorboard_test.py:118 train_step  *
        predictions = model(images)
    tensorboard_test.py:107 call  *
        x = self.hidden[f'h{i}'](x)
    tensorboard_test.py:87 call  *
        return fast_mm_module.FastMatMul(a_matrix=inputs, b_matrix=self.w, epsilon=self.epsilon, steps=1, numthreads=num_threads) + self.b

    AttributeError: module '36b10d2919c9119d32b7b2e9df532f2d' has no attribute 'FastMatMul'

2021-03-05 07:25:13.900994: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 07:25:17.946842: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 07:25:18.487000: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 07:25:18.487578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 07:25:18.488020: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:18.488173: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:18.488297: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:18.488421: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:18.488552: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:18.488677: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:18.488803: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:18.488827: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 07:25:18.520114: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 07:25:18.520365: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f57b4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 07:25:18.520402: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 07:25:18.523022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 07:25:18.523047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 07:25:30.779054: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 07:25:30.779259: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 07:25:30.780123: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 07:25:30.780157: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 07:25:30.780176: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 07:25:30.780221: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 07:25:30.780270: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 07:25:30.780294: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 07:25:30.780310: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f57e77c1430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 08:28:43.062090: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 08:28:43.068294: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 08:28:43.102958: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_schonhage3338192/plugins/profile/2021_03_05_08_28_43
2021-03-05 08:28:43.138644: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_schonhage3338192/plugins/profile/2021_03_05_08_28_43/householder.trace.json.gz
2021-03-05 08:28:43.142889: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 08:28:43.145469: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 08:28:43.147324: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_schonhage3338192/plugins/profile/2021_03_05_08_28_43Dumped tool data for overview_page.pb to PAPER_12_threads_schonhage3338192/plugins/profile/2021_03_05_08_28_43/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_schonhage3338192/plugins/profile/2021_03_05_08_28_43/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_schonhage3338192/plugins/profile/2021_03_05_08_28_43/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_schonhage3338192/plugins/profile/2021_03_05_08_28_43/householder.kernel_stats.pb

Time for Epoch:760.7615699768066
Average single batch time this epoch: 108.68020296096802
Running Average Epoch time: 757.3093020915985

Time for Epoch:757.3093020915985
Average single batch time this epoch: 108.18702043805804
Running Average Epoch time: 756.7155493497849

Time for Epoch:756.1217966079712
Average single batch time this epoch: 108.01737904548645
Running Average Epoch time: 757.6838080088297

Time for Epoch:759.6203253269196
Average single batch time this epoch: 108.51716722760882
Running Average Epoch time: 757.8764978051186

Time for Epoch:758.454567193985
Average single batch time this epoch: 108.35063028335571
Average time per Batch: 108.26804924862725
Average time per Epoch: 757.8764978051186
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm schonhage333
num threads 12
total time 3805.918454647064
2021-03-05 08:28:47.499247: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 08:28:48.063296: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 08:28:48.063761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 08:28:48.064607: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 08:28:48.064766: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 08:28:48.064904: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 08:28:48.065050: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 08:28:48.065184: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 08:28:48.065312: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 08:28:48.065442: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 08:28:48.065467: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 08:28:48.100432: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 08:28:48.100892: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fbe78000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 08:28:48.100964: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 08:28:48.105024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 08:28:48.105066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 08:29:00.383790: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 08:29:00.383970: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 08:29:00.384839: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 08:29:00.384869: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 08:29:00.384888: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 08:29:00.384951: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 08:29:00.384998: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 08:29:00.385022: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 08:29:00.385037: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fbeab437430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 09:16:45.891662: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 09:16:45.901044: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 09:16:45.964022: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2248192/plugins/profile/2021_03_05_09_16_45
2021-03-05 09:16:45.999417: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2248192/plugins/profile/2021_03_05_09_16_45/householder.trace.json.gz
2021-03-05 09:16:46.003718: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 09:16:46.006341: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 09:16:46.008402: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2248192/plugins/profile/2021_03_05_09_16_45Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2248192/plugins/profile/2021_03_05_09_16_45/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2248192/plugins/profile/2021_03_05_09_16_45/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2248192/plugins/profile/2021_03_05_09_16_45/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2248192/plugins/profile/2021_03_05_09_16_45/householder.kernel_stats.pb

Time for Epoch:574.9889123439789
Average single batch time this epoch: 82.14123984745571
Running Average Epoch time: 572.6121442317963

Time for Epoch:572.6121442317963
Average single batch time this epoch: 81.80170103481838
Running Average Epoch time: 572.8351479768753

Time for Epoch:573.0581517219543
Average single batch time this epoch: 81.86541867256165
Running Average Epoch time: 572.2272189458212

Time for Epoch:571.0113608837128
Average single batch time this epoch: 81.57301964078631
Running Average Epoch time: 572.6245091557503

Time for Epoch:573.8163797855377
Average single batch time this epoch: 81.97373614992414
Average time per Batch: 81.80346887452262
Average time per Epoch: 572.6245091557503
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov224
num threads 12
total time 2879.220463514328
2021-03-05 09:16:50.401484: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 09:16:50.920539: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 09:16:50.920983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 09:16:50.921649: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 09:16:50.921787: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 09:16:50.921910: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 09:16:50.922033: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 09:16:50.922165: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 09:16:50.922290: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 09:16:50.922432: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 09:16:50.922455: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 09:16:50.956333: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 09:16:50.956851: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7faea8000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 09:16:50.956922: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 09:16:50.960878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 09:16:50.960923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 09:17:03.145992: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 09:17:03.146150: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 09:17:03.146987: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 09:17:03.147030: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 09:17:03.147055: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 09:17:03.147121: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 09:17:03.147170: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 09:17:03.147194: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 09:17:03.147209: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7faedc3e94c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 10:08:11.840147: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 10:08:11.848050: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 10:08:11.877809: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2258192/plugins/profile/2021_03_05_10_08_11
2021-03-05 10:08:11.912521: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2258192/plugins/profile/2021_03_05_10_08_11/householder.trace.json.gz
2021-03-05 10:08:11.916694: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 10:08:11.919326: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 10:08:11.921236: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2258192/plugins/profile/2021_03_05_10_08_11Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2258192/plugins/profile/2021_03_05_10_08_11/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2258192/plugins/profile/2021_03_05_10_08_11/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2258192/plugins/profile/2021_03_05_10_08_11/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2258192/plugins/profile/2021_03_05_10_08_11/householder.kernel_stats.pb

Time for Epoch:620.3502399921417
Average single batch time this epoch: 88.62142947741917
Running Average Epoch time: 612.7524101734161

Time for Epoch:612.7524101734161
Average single batch time this epoch: 87.53602484294346
Running Average Epoch time: 611.3533532619476

Time for Epoch:609.9542963504791
Average single batch time this epoch: 87.13629647663662
Running Average Epoch time: 611.9744710922241

Time for Epoch:613.2167067527771
Average single batch time this epoch: 87.60235486711774
Running Average Epoch time: 612.0810074210167

Time for Epoch:612.4006164073944
Average single batch time this epoch: 87.48577060018268
Average time per Batch: 87.44011169672012
Average time per Epoch: 612.0810074210167
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov225
num threads 12
total time 3082.256897211075
2021-03-05 10:08:16.321192: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 10:08:16.884541: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 10:08:16.885133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 10:08:16.885804: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 10:08:16.885961: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 10:08:16.886089: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 10:08:16.886217: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 10:08:16.886346: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 10:08:16.886470: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 10:08:16.886597: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 10:08:16.886623: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 10:08:16.920312: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 10:08:16.920686: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f00e4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 10:08:16.920736: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 10:08:16.924267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 10:08:16.924312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 10:08:29.187706: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 10:08:29.187930: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 10:08:29.188805: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 10:08:29.188837: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 10:08:29.188873: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 10:08:29.188921: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 10:08:29.188967: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 10:08:29.188991: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 10:08:29.189006: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f011922c430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 11:06:56.221657: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 11:06:56.229812: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 11:06:56.264690: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov2728192/plugins/profile/2021_03_05_11_06_56
2021-03-05 11:06:56.300009: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov2728192/plugins/profile/2021_03_05_11_06_56/householder.trace.json.gz
2021-03-05 11:06:56.304225: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 11:06:56.306818: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 11:06:56.308701: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov2728192/plugins/profile/2021_03_05_11_06_56Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov2728192/plugins/profile/2021_03_05_11_06_56/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov2728192/plugins/profile/2021_03_05_11_06_56/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov2728192/plugins/profile/2021_03_05_11_06_56/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov2728192/plugins/profile/2021_03_05_11_06_56/householder.kernel_stats.pb

Time for Epoch:708.641455411911
Average single batch time this epoch: 101.23446726799011
Running Average Epoch time: 695.8034117221832

Time for Epoch:695.8034117221832
Average single batch time this epoch: 99.40046000480652
Running Average Epoch time: 697.4813276529312

Time for Epoch:699.1592435836792
Average single batch time this epoch: 99.87986557824271
Running Average Epoch time: 698.0922675132751

Time for Epoch:699.314147233963
Average single batch time this epoch: 99.90199358122689
Running Average Epoch time: 699.5937415957451

Time for Epoch:704.0981638431549
Average single batch time this epoch: 100.58542507035392
Average time per Batch: 99.94193605865752
Average time per Epoch: 699.5937415957451
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov272
num threads 12
total time 3520.702243566513
2021-03-05 11:07:00.682051: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 11:07:01.239284: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 11:07:01.239739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 11:07:01.240407: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 11:07:01.240601: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 11:07:01.240753: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 11:07:01.240912: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 11:07:01.241046: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 11:07:01.241173: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 11:07:01.241301: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 11:07:01.241325: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 11:07:01.280273: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 11:07:01.280798: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fca90000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 11:07:01.280888: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 11:07:01.285943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 11:07:01.285987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 11:07:13.392592: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 11:07:13.392741: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 11:07:13.393539: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 11:07:13.393573: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 11:07:13.393595: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 11:07:13.393653: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 11:07:13.393703: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 11:07:13.393728: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 11:07:13.393744: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fcac4fe34c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 12:04:26.155246: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 12:04:26.163677: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 12:04:26.198143: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3238192/plugins/profile/2021_03_05_12_04_26
2021-03-05 12:04:26.232903: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3238192/plugins/profile/2021_03_05_12_04_26/householder.trace.json.gz
2021-03-05 12:04:26.237145: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 12:04:26.239784: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 12:04:26.241686: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3238192/plugins/profile/2021_03_05_12_04_26Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3238192/plugins/profile/2021_03_05_12_04_26/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3238192/plugins/profile/2021_03_05_12_04_26/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3238192/plugins/profile/2021_03_05_12_04_26/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3238192/plugins/profile/2021_03_05_12_04_26/householder.kernel_stats.pb

Time for Epoch:688.7687969207764
Average single batch time this epoch: 98.39551230839321
Running Average Epoch time: 688.3487448692322

Time for Epoch:688.3487448692322
Average single batch time this epoch: 98.33550255639213
Running Average Epoch time: 688.5327385663986

Time for Epoch:688.7167322635651
Average single batch time this epoch: 98.38807225227356
Running Average Epoch time: 687.3461225032806

Time for Epoch:684.9728903770447
Average single batch time this epoch: 97.85323994500297
Running Average Epoch time: 685.9936672449112

Time for Epoch:681.9363014698029
Average single batch time this epoch: 97.41943948609489
Average time per Batch: 97.99906355994088
Average time per Epoch: 685.9936672449112
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov323
num threads 12
total time 3446.292510509491
2021-03-05 12:04:30.642372: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 12:04:31.163267: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 12:04:31.163731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 12:04:31.164670: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 12:04:31.164834: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 12:04:31.164960: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 12:04:31.165084: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 12:04:31.165215: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 12:04:31.165341: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 12:04:31.165481: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 12:04:31.165509: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 12:04:31.196303: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 12:04:31.196709: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8724000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 12:04:31.196760: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 12:04:31.200116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 12:04:31.200157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 12:04:43.555239: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 12:04:43.555399: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 12:04:43.556233: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 12:04:43.556268: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 12:04:43.556301: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 12:04:43.556373: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 12:04:43.556421: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 12:04:43.556445: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 12:04:43.556460: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f8757f5a430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 13:06:30.665214: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 13:06:30.672607: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 13:06:30.706258: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3338192/plugins/profile/2021_03_05_13_06_30
2021-03-05 13:06:30.740871: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3338192/plugins/profile/2021_03_05_13_06_30/householder.trace.json.gz
2021-03-05 13:06:30.745115: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 13:06:30.747742: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 13:06:30.749604: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3338192/plugins/profile/2021_03_05_13_06_30Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3338192/plugins/profile/2021_03_05_13_06_30/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3338192/plugins/profile/2021_03_05_13_06_30/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3338192/plugins/profile/2021_03_05_13_06_30/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3338192/plugins/profile/2021_03_05_13_06_30/householder.kernel_stats.pb

Time for Epoch:755.6462008953094
Average single batch time this epoch: 107.94942814963204
Running Average Epoch time: 739.5787374973297

Time for Epoch:739.5787374973297
Average single batch time this epoch: 105.65407865388053
Running Average Epoch time: 740.5688273906708

Time for Epoch:741.5589172840118
Average single batch time this epoch: 105.9369592666626
Running Average Epoch time: 738.1937053998312

Time for Epoch:733.4434614181519
Average single batch time this epoch: 104.77760859898159
Running Average Epoch time: 737.8611209988594

Time for Epoch:736.8633677959442
Average single batch time this epoch: 105.26616784504482
Average time per Batch: 105.40870359114238
Average time per Epoch: 737.8611209988594
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov333
num threads 12
total time 3720.8419358730316
2021-03-05 13:06:35.176919: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 13:06:35.737175: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 13:06:35.737649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 13:06:35.738295: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 13:06:35.738441: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 13:06:35.738565: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 13:06:35.738687: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 13:06:35.738815: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 13:06:35.738936: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 13:06:35.739092: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 13:06:35.739115: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 13:06:35.776363: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 13:06:35.776727: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f49dc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 13:06:35.776789: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 13:06:35.780044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 13:06:35.780086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 13:06:47.934138: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 13:06:47.934291: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 13:06:47.935127: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 13:06:47.935157: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 13:06:47.935177: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 13:06:47.935245: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 13:06:47.935322: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 13:06:47.935349: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 13:06:47.935364: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f4a11d13430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 14:02:38.182650: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 14:02:38.192174: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 14:02:38.227035: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov3348192/plugins/profile/2021_03_05_14_02_38
2021-03-05 14:02:38.263317: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov3348192/plugins/profile/2021_03_05_14_02_38/householder.trace.json.gz
2021-03-05 14:02:38.267869: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 14:02:38.270497: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 14:02:38.272329: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov3348192/plugins/profile/2021_03_05_14_02_38Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov3348192/plugins/profile/2021_03_05_14_02_38/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov3348192/plugins/profile/2021_03_05_14_02_38/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov3348192/plugins/profile/2021_03_05_14_02_38/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov3348192/plugins/profile/2021_03_05_14_02_38/householder.kernel_stats.pb

Time for Epoch:674.0087184906006
Average single batch time this epoch: 96.28693669182914
Running Average Epoch time: 666.6706750392914

Time for Epoch:666.6706750392914
Average single batch time this epoch: 95.23864347594125
Running Average Epoch time: 667.8765610456467

Time for Epoch:669.082447052002
Average single batch time this epoch: 95.58318022319249
Running Average Epoch time: 668.6430826187134

Time for Epoch:670.1761257648468
Average single batch time this epoch: 95.73942419460842
Running Average Epoch time: 669.0556914806366

Time for Epoch:670.2935180664062
Average single batch time this epoch: 95.75619210515704
Average time per Batch: 95.5793599997248
Average time per Epoch: 669.0556914806366
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov334
num threads 12
total time 3363.823413848877
2021-03-05 14:02:42.724443: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 14:02:43.295312: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 14:02:43.295759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 14:02:43.297552: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:02:43.297716: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:02:43.297851: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:02:43.298015: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:02:43.298153: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:02:43.298282: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:02:43.298419: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:02:43.298448: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 14:02:43.332356: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 14:02:43.332801: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f08ac000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 14:02:43.332873: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 14:02:43.336657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 14:02:43.336700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 14:02:55.575772: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 14:02:55.575928: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 14:02:55.576752: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:02:55.576781: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 14:02:55.576799: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 14:02:55.576890: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 14:02:55.576940: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 14:02:55.576964: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 14:02:55.576979: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f08e130d430> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 14:48:16.506292: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 14:48:16.515179: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 14:48:16.553002: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov4428192/plugins/profile/2021_03_05_14_48_16
2021-03-05 14:48:16.590861: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov4428192/plugins/profile/2021_03_05_14_48_16/householder.trace.json.gz
2021-03-05 14:48:16.595717: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 14:48:16.598403: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 14:48:16.600335: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov4428192/plugins/profile/2021_03_05_14_48_16Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov4428192/plugins/profile/2021_03_05_14_48_16/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov4428192/plugins/profile/2021_03_05_14_48_16/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov4428192/plugins/profile/2021_03_05_14_48_16/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov4428192/plugins/profile/2021_03_05_14_48_16/householder.kernel_stats.pb

Time for Epoch:545.410936832428
Average single batch time this epoch: 77.9158228124891
Running Average Epoch time: 539.0052711963654

Time for Epoch:539.0052711963654
Average single batch time this epoch: 77.00072738102504
Running Average Epoch time: 539.3903913497925

Time for Epoch:539.7755115032196
Average single batch time this epoch: 77.11076409476144
Running Average Epoch time: 543.8908229668936

Time for Epoch:552.8916862010956
Average single batch time this epoch: 78.98449976103646
Running Average Epoch time: 543.8755195140839

Time for Epoch:543.8296091556549
Average single batch time this epoch: 77.68992062977382
Average time per Batch: 77.69647796664918
Average time per Epoch: 543.8755195140839
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov442
num threads 12
total time 2734.618849992752
2021-03-05 14:48:21.092925: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 14:48:21.651579: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 14:48:21.652358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 14:48:21.652791: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:48:21.652943: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:48:21.653071: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:48:21.653194: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:48:21.653324: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:48:21.653447: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:48:21.653587: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:48:21.653611: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 14:48:21.692180: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 14:48:21.692595: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3790000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 14:48:21.692639: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 14:48:21.696750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 14:48:21.696793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 14:48:33.901693: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 14:48:33.901882: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 14:48:33.902749: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 14:48:33.902780: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 14:48:33.902803: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 14:48:33.902846: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 14:48:33.902898: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 14:48:33.902923: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 14:48:33.902937: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f37c50434c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 15:36:45.052671: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 15:36:45.058798: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 15:36:45.093437: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov4448192/plugins/profile/2021_03_05_15_36_45
2021-03-05 15:36:45.128230: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov4448192/plugins/profile/2021_03_05_15_36_45/householder.trace.json.gz
2021-03-05 15:36:45.132478: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 15:36:45.135052: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 15:36:45.136921: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov4448192/plugins/profile/2021_03_05_15_36_45Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov4448192/plugins/profile/2021_03_05_15_36_45/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov4448192/plugins/profile/2021_03_05_15_36_45/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov4448192/plugins/profile/2021_03_05_15_36_45/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov4448192/plugins/profile/2021_03_05_15_36_45/householder.kernel_stats.pb

Time for Epoch:585.6903650760651
Average single batch time this epoch: 83.67003100258964
Running Average Epoch time: 575.2129752635956

Time for Epoch:575.2129752635956
Average single batch time this epoch: 82.1732576574598
Running Average Epoch time: 575.1163882017136

Time for Epoch:575.0198011398315
Average single batch time this epoch: 82.14566608837673
Running Average Epoch time: 575.349042971929

Time for Epoch:575.8143525123596
Average single batch time this epoch: 82.25917404038566
Running Average Epoch time: 576.3613825440407

Time for Epoch:579.398401260376
Average single batch time this epoch: 82.77117991447449
Average time per Batch: 82.33731942517417
Average time per Epoch: 576.3613825440407
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov444
num threads 12
total time 2904.765402317047
2021-03-05 15:36:49.519854: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 15:36:50.076375: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 15:36:50.076876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 15:36:50.077588: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 15:36:50.077762: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 15:36:50.077902: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 15:36:50.078032: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 15:36:50.078164: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 15:36:50.078291: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 15:36:50.078421: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 15:36:50.078447: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 15:36:50.112240: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 15:36:50.112667: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f3f10000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 15:36:50.112735: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 15:36:50.117105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 15:36:50.117151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 15:37:02.365288: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 15:37:02.365440: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 15:37:02.366302: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 15:37:02.366337: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 15:37:02.366357: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 15:37:02.366400: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 15:37:02.366455: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 15:37:02.366480: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 15:37:02.366496: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7f3f435f44c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 16:33:42.128847: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 16:33:42.137124: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 16:33:42.174443: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov5528192/plugins/profile/2021_03_05_16_33_42
2021-03-05 16:33:42.211068: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov5528192/plugins/profile/2021_03_05_16_33_42/householder.trace.json.gz
2021-03-05 16:33:42.215820: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 16:33:42.218561: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 16:33:42.220467: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov5528192/plugins/profile/2021_03_05_16_33_42Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov5528192/plugins/profile/2021_03_05_16_33_42/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov5528192/plugins/profile/2021_03_05_16_33_42/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov5528192/plugins/profile/2021_03_05_16_33_42/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov5528192/plugins/profile/2021_03_05_16_33_42/householder.kernel_stats.pb

Time for Epoch:692.1302602291107
Average single batch time this epoch: 98.87572503089905
Running Average Epoch time: 675.1800827980042

Time for Epoch:675.1800827980042
Average single batch time this epoch: 96.45427455220904
Running Average Epoch time: 676.3942161798477

Time for Epoch:677.6083495616913
Average single batch time this epoch: 96.80116643224444
Running Average Epoch time: 677.3291618029276

Time for Epoch:679.1990530490875
Average single batch time this epoch: 97.02841183117458
Running Average Epoch time: 676.9034377336502

Time for Epoch:675.6262655258179
Average single batch time this epoch: 96.51801344326564
Average time per Batch: 96.70046656472343
Average time per Epoch: 676.9034377336502
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov552
num threads 12
total time 3413.43781208992
2021-03-05 16:33:46.656874: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-05 16:33:47.196195: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-05 16:33:47.196707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVS 300 computeCapability: 1.2
coreClock: 1.23GHz coreCount: 2 deviceMemorySize: 511.62MiB deviceMemoryBandwidth: 11.77GiB/s
2021-03-05 16:33:47.197478: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 16:33:47.197657: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 16:33:47.197783: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 16:33:47.197926: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 16:33:47.198052: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 16:33:47.198173: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 16:33:47.198294: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 16:33:47.198318: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1598] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-03-05 16:33:47.232208: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1995235000 Hz
2021-03-05 16:33:47.232635: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc560000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-05 16:33:47.232712: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-05 16:33:47.236973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-05 16:33:47.237019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      
2021-03-05 16:33:59.588832: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 16:33:59.589035: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 1 GPUs
2021-03-05 16:33:59.589910: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2019.4.243/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2019.4.243/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2019.4.243/linux/mkl/lib/intel64_lin
2021-03-05 16:33:59.589942: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 16:33:59.589962: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 16:33:59.590022: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 16:33:59.590086: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.
2021-03-05 16:33:59.590110: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 16:33:59.590125: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.
WARNING:tensorflow:Layer my_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

WARNING:tensorflow:AutoGraph could not transform <function fast_mat_mul at 0x7fc5954634c0> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
MKL num threads default:  12
MKL num threads set to:  1
2021-03-05 17:28:48.944214: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.
2021-03-05 17:28:48.952707: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:216]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-03-05 17:28:48.987179: I tensorflow/core/profiler/rpc/client/save_profile.cc:168] Creating directory: PAPER_12_threads_smirnov5558192/plugins/profile/2021_03_05_17_28_48
2021-03-05 17:28:49.021745: I tensorflow/core/profiler/rpc/client/save_profile.cc:174] Dumped gzipped tool data for trace.json.gz to PAPER_12_threads_smirnov5558192/plugins/profile/2021_03_05_17_28_48/householder.trace.json.gz
2021-03-05 17:28:49.025925: E tensorflow/core/profiler/utils/hardware_type_utils.cc:60] Invalid GPU compute capability.
2021-03-05 17:28:49.028529: I tensorflow/core/profiler/utils/event_span.cc:288] Generation of step-events took 0.001 ms

2021-03-05 17:28:49.030414: I tensorflow/python/profiler/internal/profiler_wrapper.cc:87] Creating directory: PAPER_12_threads_smirnov5558192/plugins/profile/2021_03_05_17_28_48Dumped tool data for overview_page.pb to PAPER_12_threads_smirnov5558192/plugins/profile/2021_03_05_17_28_48/householder.overview_page.pb
Dumped tool data for input_pipeline.pb to PAPER_12_threads_smirnov5558192/plugins/profile/2021_03_05_17_28_48/householder.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to PAPER_12_threads_smirnov5558192/plugins/profile/2021_03_05_17_28_48/householder.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to PAPER_12_threads_smirnov5558192/plugins/profile/2021_03_05_17_28_48/householder.kernel_stats.pb

Time for Epoch:662.7891960144043
Average single batch time this epoch: 94.68414391790118
Running Average Epoch time: 655.6242663860321

Time for Epoch:655.6242663860321
Average single batch time this epoch: 93.66058073725019
Running Average Epoch time: 655.4622809886932

Time for Epoch:655.3002955913544
Average single batch time this epoch: 93.61430110250201
Running Average Epoch time: 655.5275038878123

Time for Epoch:655.6579496860504
Average single batch time this epoch: 93.6653938974653
Running Average Epoch time: 656.6373424530029

Time for Epoch:659.9668581485748
Average single batch time this epoch: 94.28095350946698
Average time per Batch: 93.80530731167111
Average time per Epoch: 656.6373424530029
batch size 8192
epochs 5
nodes 8192
num layers 4
algorithm smirnov555
num threads 12
total time 3303.0963895320892
